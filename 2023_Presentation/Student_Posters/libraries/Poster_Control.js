/*! For license information please see Poster_Control.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.poster=t():e.poster=t()}(this,(()=>(()=>{var t={264:function(e,t,r){(function(){"use strict";var e;function t(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}var n="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e},o=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof r.g&&r.g];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function s(e,t){if(t)e:{var r=o;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in r))break e;r=r[a]}(t=t(s=r[e=e[e.length-1]]))!=s&&null!=t&&n(r,e,{configurable:!0,writable:!0,value:t})}}function a(e){return(e={next:e})[Symbol.iterator]=function(){return this},e}function i(e){var r="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return r?r.call(e):{next:t(e)}}function l(e){if(!(e instanceof Array)){e=i(e);for(var t,r=[];!(t=e.next()).done;)r.push(t.value);e=r}return e}s("Symbol",(function(e){function t(e,t){this.g=e,n(this,"description",{configurable:!0,writable:!0,value:t})}if(e)return e;t.prototype.toString=function(){return this.g};var r="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",o=0;return function e(n){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new t(r+(n||"")+"_"+o++,n)}})),s("Symbol.iterator",(function(e){if(e)return e;e=Symbol("Symbol.iterator");for(var r="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),s=0;s<r.length;s++){var i=o[r[s]];"function"==typeof i&&"function"!=typeof i.prototype[e]&&n(i.prototype,e,{configurable:!0,writable:!0,value:function(){return a(t(this))}})}return e}));var u,c="function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t};if("function"==typeof Object.setPrototypeOf)u=Object.setPrototypeOf;else{var d;e:{var h={};try{h.__proto__={a:!0},d=h.a;break e}catch(e){}d=!1}u=d?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var p=u;function f(e,t){if(e.prototype=c(t.prototype),e.prototype.constructor=e,p)p(e,t);else for(var r in t)if("prototype"!=r)if(Object.defineProperties){var n=Object.getOwnPropertyDescriptor(t,r);n&&Object.defineProperty(e,r,n)}else e[r]=t[r];e.ea=t.prototype}function m(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function y(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function g(e,t){e.j={U:t,V:!0},e.g=e.m||e.s}function v(e,t,r){return e.g=r,{value:t}}function b(e){this.g=new m,this.h=e}function x(e,t,r,n){try{var o=t.call(e.g.i,r);if(!(o instanceof Object))throw new TypeError("Iterator result "+o+" is not an object");if(!o.done)return e.g.l=!1,o;var s=o.value}catch(t){return e.g.i=null,g(e.g,t),w(e)}return e.g.i=null,n.call(e.g,s),w(e)}function w(e){for(;e.g.g;)try{var t=e.h(e.g);if(t)return e.g.l=!1,{value:t.value,done:!1}}catch(t){e.g.h=void 0,g(e.g,t)}if(e.g.l=!1,e.g.j){if(t=e.g.j,e.g.j=null,t.V)throw t.U;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function _(e){this.next=function(t){return y(e.g),e.g.i?t=x(e,e.g.i.next,t,e.g.o):(e.g.o(t),t=w(e)),t},this.throw=function(t){return y(e.g),e.g.i?t=x(e,e.g.i.throw,t,e.g.o):(g(e.g,t),t=w(e)),t},this.return=function(t){return function(e,t){y(e.g);var r=e.g.i;return r?x(e,"return"in r?r.return:function(e){return{value:e,done:!0}},t,e.g.return):(e.g.return(t),w(e))}(e,t)},this[Symbol.iterator]=function(){return this}}function S(e,t){return t=new _(new b(t)),p&&e.prototype&&p(t,e.prototype),t}m.prototype.o=function(e){this.h=e},m.prototype.return=function(e){this.j={return:e},this.g=this.s};var k="function"==typeof Object.assign?Object.assign:function(e,t){for(var r=1;r<arguments.length;r++){var n=arguments[r];if(n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};s("Object.assign",(function(e){return e||k})),s("Promise",(function(e){function t(e){this.h=0,this.i=void 0,this.g=[],this.o=!1;var t=this.j();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}}function r(){this.g=null}function n(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;r.prototype.h=function(e){if(null==this.g){this.g=[];var t=this;this.i((function(){t.l()}))}this.g.push(e)};var s=o.setTimeout;r.prototype.i=function(e){s(e,0)},r.prototype.l=function(){for(;this.g&&this.g.length;){var e=this.g;this.g=[];for(var t=0;t<e.length;++t){var r=e[t];e[t]=null;try{r()}catch(e){this.j(e)}}}this.g=null},r.prototype.j=function(e){this.i((function(){throw e}))},t.prototype.j=function(){function e(e){return function(n){r||(r=!0,e.call(t,n))}}var t=this,r=!1;return{resolve:e(this.C),reject:e(this.l)}},t.prototype.C=function(e){if(e===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.F(e);else{e:switch(typeof e){case"object":var r=null!=e;break e;case"function":r=!0;break e;default:r=!1}r?this.u(e):this.m(e)}},t.prototype.u=function(e){var t=void 0;try{t=e.then}catch(e){return void this.l(e)}"function"==typeof t?this.G(t,e):this.m(e)},t.prototype.l=function(e){this.s(2,e)},t.prototype.m=function(e){this.s(1,e)},t.prototype.s=function(e,t){if(0!=this.h)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.h);this.h=e,this.i=t,2===this.h&&this.D(),this.A()},t.prototype.D=function(){var e=this;s((function(){if(e.B()){var t=o.console;void 0!==t&&t.error(e.i)}}),1)},t.prototype.B=function(){if(this.o)return!1;var e=o.CustomEvent,t=o.Event,r=o.dispatchEvent;return void 0===r||("function"==typeof e?e=new e("unhandledrejection",{cancelable:!0}):"function"==typeof t?e=new t("unhandledrejection",{cancelable:!0}):(e=o.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,e),e.promise=this,e.reason=this.i,r(e))},t.prototype.A=function(){if(null!=this.g){for(var e=0;e<this.g.length;++e)a.h(this.g[e]);this.g=null}};var a=new r;return t.prototype.F=function(e){var t=this.j();e.J(t.resolve,t.reject)},t.prototype.G=function(e,t){var r=this.j();try{e.call(t,r.resolve,r.reject)}catch(e){r.reject(e)}},t.prototype.then=function(e,r){function n(e,t){return"function"==typeof e?function(t){try{o(e(t))}catch(e){s(e)}}:t}var o,s,a=new t((function(e,t){o=e,s=t}));return this.J(n(e,o),n(r,s)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.J=function(e,t){function r(){switch(n.h){case 1:e(n.i);break;case 2:t(n.i);break;default:throw Error("Unexpected state: "+n.h)}}var n=this;null==this.g?a.h(r):this.g.push(r),this.o=!0},t.resolve=n,t.reject=function(e){return new t((function(t,r){r(e)}))},t.race=function(e){return new t((function(t,r){for(var o=i(e),s=o.next();!s.done;s=o.next())n(s.value).J(t,r)}))},t.all=function(e){var r=i(e),o=r.next();return o.done?n([]):new t((function(e,t){function s(t){return function(r){a[t]=r,0==--i&&e(a)}}var a=[],i=0;do{a.push(void 0),i++,n(o.value).J(s(a.length-1),t),o=r.next()}while(!o.done)}))},t})),s("Object.is",(function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}})),s("Array.prototype.includes",(function(e){return e||function(e,t){var r=this;r instanceof String&&(r=String(r));var n=r.length;for(0>(t=t||0)&&(t=Math.max(t+n,0));t<n;t++){var o=r[t];if(o===e||Object.is(o,e))return!0}return!1}})),s("String.prototype.includes",(function(e){return e||function(e,t){if(null==this)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(e instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return-1!==this.indexOf(e,t||0)}})),s("Array.prototype.keys",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var r=0,n=!1,o={next:function(){if(!n&&r<e.length){var o=r++;return{value:t(o,e[o]),done:!1}}return n=!0,{done:!0,value:void 0}}};return o[Symbol.iterator]=function(){return o},o}(this,(function(e){return e}))}}));var T=this||self;function E(e,t){e=e.split(".");var r,n=T;e[0]in n||void 0===n.execScript||n.execScript("var "+e[0]);for(;e.length&&(r=e.shift());)e.length||void 0===t?n=n[r]&&n[r]!==Object.prototype[r]?n[r]:n[r]={}:n[r]=t}function j(e,t){return t=String.fromCharCode.apply(null,t),null==e?t:e+t}var C,I,O="undefined"!=typeof TextDecoder,A="undefined"!=typeof TextEncoder;function R(e){if(A)e=(I||(I=new TextEncoder)).encode(e);else{var t=void 0;t=void 0!==t&&t;for(var r=0,n=new Uint8Array(3*e.length),o=0;o<e.length;o++){var s=e.charCodeAt(o);if(128>s)n[r++]=s;else{if(2048>s)n[r++]=s>>6|192;else{if(55296<=s&&57343>=s){if(56319>=s&&o<e.length){var a=e.charCodeAt(++o);if(56320<=a&&57343>=a){s=1024*(s-55296)+a-56320+65536,n[r++]=s>>18|240,n[r++]=s>>12&63|128,n[r++]=s>>6&63|128,n[r++]=63&s|128;continue}o--}if(t)throw Error("Found an unpaired surrogate");s=65533}n[r++]=s>>12|224,n[r++]=s>>6&63|128}n[r++]=63&s|128}}e=n.subarray(0,r)}return e}var N={},M=null;function P(e,t){void 0===t&&(t=0),L(),t=N[t];for(var r=Array(Math.floor(e.length/3)),n=t[64]||"",o=0,s=0;o<e.length-2;o+=3){var a=e[o],i=e[o+1],l=e[o+2],u=t[a>>2];a=t[(3&a)<<4|i>>4],i=t[(15&i)<<2|l>>6],l=t[63&l],r[s++]=u+a+i+l}switch(u=0,l=n,e.length-o){case 2:l=t[(15&(u=e[o+1]))<<2]||n;case 1:e=e[o],r[s]=t[e>>2]+t[(3&e)<<4|u>>4]+l+n}return r.join("")}function L(){if(!M){M={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],r=0;5>r;r++){var n=e.concat(t[r].split(""));N[r]=n;for(var o=0;o<n.length;o++){var s=n[o];void 0===M[s]&&(M[s]=o)}}}}var D,F="function"==typeof Uint8Array.prototype.slice;function $(e,t,r){return t===r?D||(D=new Uint8Array(0)):F?e.slice(t,r):new Uint8Array(e.subarray(t,r))}var B=0;function U(e,t){t=void 0!==(t=void 0===t?{}:t).v&&t.v,this.h=null,this.g=this.i=this.j=0,this.l=!1,this.v=t,e&&V(this,e)}function V(e,t){t=t.constructor===Uint8Array?t:t.constructor===ArrayBuffer||t.constructor===Array?new Uint8Array(t):t.constructor===String?function(e){var t=e.length,r=3*t/4;r%3?r=Math.floor(r):-1!="=.".indexOf(e[t-1])&&(r=-1!="=.".indexOf(e[t-2])?r-2:r-1);var n=new Uint8Array(r),o=0;return function(e,t){function r(t){for(;n<e.length;){var r=e.charAt(n++),o=M[r];if(null!=o)return o;if(!/^[\s\xa0]*$/.test(r))throw Error("Unknown base64 encoding at char: "+r)}return t}L();for(var n=0;;){var o=r(-1),s=r(0),a=r(64),i=r(64);if(64===i&&-1===o)break;t(o<<2|s>>4),64!=a&&(t(s<<4&240|a>>2),64!=i&&t(a<<6&192|i))}}(e,(function(e){n[o++]=e})),n.subarray(0,o)}(t):t instanceof Uint8Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e.h=t,e.j=0,e.i=e.h.length,e.g=e.j}function G(e){var t=e.h,r=t[e.g],n=127&r;return 128>r?(e.g+=1,n):(n|=(127&(r=t[e.g+1]))<<7,128>r?(e.g+=2,n):(n|=(127&(r=t[e.g+2]))<<14,128>r?(e.g+=3,n):(n|=(127&(r=t[e.g+3]))<<21,128>r?(e.g+=4,n):(n|=(15&(r=t[e.g+4]))<<28,128>r?(e.g+=5,n>>>0):(e.g+=5,128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&128<=t[e.g++]&&e.g++,n)))))}function z(e){var t=e.h[e.g],r=e.h[e.g+1],n=e.h[e.g+2],o=e.h[e.g+3];return e.g+=4,e=2*((r=(t<<0|r<<8|n<<16|o<<24)>>>0)>>31)+1,t=r>>>23&255,r&=8388607,255==t?r?NaN:1/0*e:0==t?e*Math.pow(2,-149)*r:e*Math.pow(2,t-150)*(r+Math.pow(2,23))}U.prototype.reset=function(){this.g=this.j};var W=[];function H(){this.g=new Uint8Array(64),this.h=0}function q(e,t){for(;127<t;)e.push(127&t|128),t>>>=7;e.push(t)}function X(e){var t={},r=void 0!==t.N&&t.N;this.o={v:void 0!==t.v&&t.v},this.N=r,t=this.o,W.length?(r=W.pop(),t&&(r.v=t.v),e&&V(r,e),e=r):e=new U(e,t),this.g=e,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}function Y(e){var t=e.g;if((t=t.g==t.i)||(t=e.j)||(t=(t=e.g).l||0>t.g||t.g>t.i),t)return!1;e.m=e.g.g;var r=7&(t=G(e.g));return 0!=r&&5!=r&&1!=r&&2!=r&&3!=r&&4!=r?(e.j=!0,!1):(e.i=t,e.l=t>>>3,e.h=r,!0)}function K(e){switch(e.h){case 0:if(0!=e.h)K(e);else{for(e=e.g;128&e.h[e.g];)e.g++;e.g++}break;case 1:1!=e.h?K(e):(e=e.g).g+=8;break;case 2:if(2!=e.h)K(e);else{var t=G(e.g);(e=e.g).g+=t}break;case 5:5!=e.h?K(e):(e=e.g).g+=4;break;case 3:for(t=e.l;;){if(!Y(e)){e.j=!0;break}if(4==e.h){e.l!=t&&(e.j=!0);break}K(e)}break;default:e.j=!0}}function Z(e,t,r){var n=e.g.i,o=G(e.g),s=e.g.g+o;if(e.g.i=s,r(t,e),0!=(r=s-e.g.g))throw Error("Message parsing ended unexpectedly. Expected to read "+o+" bytes, instead read "+(o-r)+" bytes, either the data ended unexpectedly or the message misreported its own length");return e.g.g=s,e.g.i=n,t}function Q(e){var t,r=G(e.g),n=(e=e.g).g;if(e.g+=r,e=e.h,O)(t=C)||(t=C=new TextDecoder("utf-8",{fatal:!1})),t=t.decode(e.subarray(n,n+r));else{r=n+r;for(var o,s,a,i=[],l=null;n<r;)128>(o=e[n++])?i.push(o):224>o?n>=r?i.push(65533):(s=e[n++],194>o||128!=(192&s)?(n--,i.push(65533)):i.push((31&o)<<6|63&s)):240>o?n>=r-1?i.push(65533):128!=(192&(s=e[n++]))||224===o&&160>s||237===o&&160<=s||128!=(192&(t=e[n++]))?(n--,i.push(65533)):i.push((15&o)<<12|(63&s)<<6|63&t):244>=o?n>=r-2?i.push(65533):128!=(192&(s=e[n++]))||0!=s-144+(o<<28)>>30||128!=(192&(t=e[n++]))||128!=(192&(a=e[n++]))?(n--,i.push(65533)):(o=(7&o)<<18|(63&s)<<12|(63&t)<<6|63&a,o-=65536,i.push(55296+(o>>10&1023),56320+(1023&o))):i.push(65533),8192<=i.length&&(l=j(l,i),i.length=0);t=j(l,i)}return t}function J(){this.h=[],this.i=0,this.g=new H}function ee(e,t){0!==t.length&&(e.h.push(t),e.i+=t.length)}function te(e){var t=e.i+e.g.length();if(0===t)return new Uint8Array(0);t=new Uint8Array(t);for(var r=e.h,n=r.length,o=0,s=0;s<n;s++){var a=r[s];0!==a.length&&(t.set(a,o),o+=a.length)}return 0!==(n=(r=e.g).h)&&(t.set(r.g.subarray(0,n),o),r.h=0),e.h=[t],t}function re(e,t,r){if(null!=r){q(e.g,8*t+5),e=e.g;var n=r;0===(n=(r=0>n?1:0)?-n:n)?B=0<1/n?0:2147483648:isNaN(n)?B=2147483647:34028234663852886e22<n?B=(r<<31|2139095040)>>>0:11754943508222875e-54>n?(n=Math.round(n/Math.pow(2,-149)),B=(r<<31|n)>>>0):(t=Math.floor(Math.log(n)/Math.LN2),n*=Math.pow(2,-t),16777216<=(n=Math.round(8388608*n))&&++t,B=(r<<31|t+127<<23|8388607&n)>>>0),r=B,e.push(r>>>0&255),e.push(r>>>8&255),e.push(r>>>16&255),e.push(r>>>24&255)}}H.prototype.push=function(e){if(!(this.h+1<this.g.length)){var t=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(t)}this.g[this.h++]=e},H.prototype.length=function(){return this.h},H.prototype.end=function(){var e=this.g,t=this.h;return this.h=0,$(e,0,t)},X.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};var ne="function"==typeof Uint8Array;function oe(e,t,r){if(null!=e)return"object"==typeof e?ne&&e instanceof Uint8Array?r(e):se(e,t,r):t(e)}function se(e,t,r){if(Array.isArray(e)){for(var n=Array(e.length),o=0;o<e.length;o++)n[o]=oe(e[o],t,r);return Array.isArray(e)&&e.W&&ue(n),n}for(o in n={},e)n[o]=oe(e[o],t,r);return n}function ae(e){return"number"==typeof e?isFinite(e)?e:String(e):e}var ie,le={W:{value:!0,configurable:!0}};function ue(e){return Array.isArray(e)&&!Object.isFrozen(e)&&Object.defineProperties(e,le),e}function ce(e,t,r){var n=ie;if(ie=null,e||(e=n),n=this.constructor.ca,e||(e=n?[n]:[]),this.j=n?0:-1,this.i=null,this.g=e,e=(n=this.g.length)-1,!n||null===(n=this.g[e])||"object"!=typeof n||Array.isArray(n)||ne&&n instanceof Uint8Array?void 0!==t&&-1<t?(this.l=Math.max(t,e+1-this.j),this.h=null):this.l=Number.MAX_VALUE:(this.l=e-this.j,this.h=n),r)for(t=0;t<r.length;t++)(e=r[t])<this.l?(e+=this.j,(n=this.g[e])?ue(n):this.g[e]=de):(he(this),(n=this.h[e])?ue(n):this.h[e]=de)}var de=Object.freeze(ue([]));function he(e){var t=e.l+e.j;e.g[t]||(e.h=e.g[t]={})}function pe(e,t,r){return-1===t?null:void 0!==r&&r||t>=e.l?e.h?e.h[t]:void 0:e.g[t+e.j]}function fe(e){var t=void 0!==t&&t,r=pe(e,1,t);return null==r&&(r=de),r===de&&ye(e,1,r=ue([]),t),r}function me(e,t,r){return null==(e=null==(e=pe(e,t))?e:+e)?void 0===r?0:r:e}function ye(e,t,r,n){void 0!==n&&n||t>=e.l?(he(e),e.h[t]=r):e.g[t+e.j]=r}function ge(e,t){e.i||(e.i={});var r=e.i[1];if(!r){var n=fe(e);r=[];for(var o=0;o<n.length;o++)r[o]=new t(n[o]);e.i[1]=r}return r}function ve(e,t,r,n){var o=ge(e,r);t=t||new r,e=fe(e),null!=n?(o.splice(n,0,t),e.splice(n,0,be(t,!1))):(o.push(t),e.push(be(t,!1)))}function be(e,t){if(e.i)for(var r in e.i){var n=e.i[r];if(Array.isArray(n))for(var o=0;o<n.length;o++)n[o]&&be(n[o],t);else n&&be(n,t)}return e.g}function xe(e,t){return null==(e=pe(e,t))?0:e}function we(e,t){return null==(e=pe(e,t))?"":e}function _e(e,t){if(e=e.m){ee(t,t.g.end());for(var r=0;r<e.length;r++)ee(t,e[r])}}function Se(e,t){if(4==t.h)return!1;var r=t.m;return K(t),t.N||(t=$(t.g.h,r,t.g.g),(r=e.m)?r.push(t):e.m=[t]),!0}function ke(e,t){var r=void 0;return new(r||(r=Promise))((function(n,o){function s(e){try{i(t.next(e))}catch(e){o(e)}}function a(e){try{i(t.throw(e))}catch(e){o(e)}}function i(e){e.done?n(e.value):new r((function(t){t(e.value)})).then(s,a)}i((t=t.apply(e,void 0)).next())}))}function Te(e){ce.call(this,e)}function Ee(e,t){for(;Y(t);)switch(t.i){case 8:var r=G(t.g);ye(e,1,r);break;case 21:ye(e,2,r=z(t.g));break;case 26:ye(e,3,r=Q(t));break;case 34:ye(e,4,r=Q(t));break;default:if(!Se(e,t))return e}return e}function je(e){ce.call(this,e,-1,Ce)}ce.prototype.toJSON=function(){return se(be(this,!1),ae,P)},ce.prototype.toString=function(){return be(this,!1).toString()},f(Te,ce),f(je,ce),je.prototype.addClassification=function(e,t){return ve(this,e,Te,t),this};var Ce=[1];function Ie(e){ce.call(this,e)}function Oe(e,t){for(;Y(t);)switch(t.i){case 13:var r=z(t.g);ye(e,1,r);break;case 21:ye(e,2,r=z(t.g));break;case 29:ye(e,3,r=z(t.g));break;case 37:ye(e,4,r=z(t.g));break;case 45:ye(e,5,r=z(t.g));break;default:if(!Se(e,t))return e}return e}function Ae(e){ce.call(this,e,-1,Re)}f(Ie,ce),f(Ae,ce);var Re=[1];function Ne(e){ce.call(this,e)}function Me(e,t,r){if(r=e.createShader(0===r?e.VERTEX_SHADER:e.FRAGMENT_SHADER),e.shaderSource(r,t),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw Error("Could not compile WebGL shader.\n\n"+e.getShaderInfoLog(r));return r}function Pe(e){return ge(e,Te).map((function(e){return{index:xe(e,1),Y:me(e,2),label:null!=pe(e,3)?we(e,3):void 0,displayName:null!=pe(e,4)?we(e,4):void 0}}))}function Le(e){return{x:me(e,1),y:me(e,2),z:me(e,3),visibility:null!=pe(e,4)?me(e,4):void 0}}function De(e){e:{var t=new Ae;for(e=new X(e);Y(e);)if(10===e.i)ve(t,Z(e,new Ie,Oe),Ie,void 0);else if(!Se(t,e))break e}return ge(t,Ie).map(Le)}function Fe(e,t){this.h=e,this.g=t,this.l=0}function $e(e,t,r){return function(e,t){var r=e.g;if(void 0===e.m){var n=Me(r,"\n  attribute vec2 aVertex;\n  attribute vec2 aTex;\n  varying vec2 vTex;\n  void main(void) {\n    gl_Position = vec4(aVertex, 0.0, 1.0);\n    vTex = aTex;\n  }",0),o=Me(r,"\n  precision mediump float;\n  varying vec2 vTex;\n  uniform sampler2D sampler0;\n  void main(){\n    gl_FragColor = texture2D(sampler0, vTex);\n  }",1),s=r.createProgram();if(r.attachShader(s,n),r.attachShader(s,o),r.linkProgram(s),!r.getProgramParameter(s,r.LINK_STATUS))throw Error("Could not compile WebGL program.\n\n"+r.getProgramInfoLog(s));n=e.m=s,r.useProgram(n),o=r.getUniformLocation(n,"sampler0"),e.j={I:r.getAttribLocation(n,"aVertex"),H:r.getAttribLocation(n,"aTex"),da:o},e.s=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.s),r.enableVertexAttribArray(e.j.I),r.vertexAttribPointer(e.j.I,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),e.o=r.createBuffer(),r.bindBuffer(r.ARRAY_BUFFER,e.o),r.enableVertexAttribArray(e.j.H),r.vertexAttribPointer(e.j.H,2,r.FLOAT,!1,0,0),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null),r.uniform1i(o,0)}n=e.j,r.useProgram(e.m),r.canvas.width=t.width,r.canvas.height=t.height,r.viewport(0,0,t.width,t.height),r.activeTexture(r.TEXTURE0),e.h.bindTexture2d(t.glName),r.enableVertexAttribArray(n.I),r.bindBuffer(r.ARRAY_BUFFER,e.s),r.vertexAttribPointer(n.I,2,r.FLOAT,!1,0,0),r.enableVertexAttribArray(n.H),r.bindBuffer(r.ARRAY_BUFFER,e.o),r.vertexAttribPointer(n.H,2,r.FLOAT,!1,0,0),r.bindFramebuffer(r.DRAW_FRAMEBUFFER?r.DRAW_FRAMEBUFFER:r.FRAMEBUFFER,null),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT),r.colorMask(!0,!0,!0,!0),r.drawArrays(r.TRIANGLE_FAN,0,4),r.disableVertexAttribArray(n.I),r.disableVertexAttribArray(n.H),r.bindBuffer(r.ARRAY_BUFFER,null),e.h.bindTexture2d(0)}(e,t),"function"==typeof e.g.canvas.transferToImageBitmap?Promise.resolve(e.g.canvas.transferToImageBitmap()):r?Promise.resolve(e.g.canvas):"function"==typeof createImageBitmap?createImageBitmap(e.g.canvas):(void 0===e.i&&(e.i=document.createElement("canvas")),new Promise((function(t){e.i.height=e.g.canvas.height,e.i.width=e.g.canvas.width,e.i.getContext("2d",{}).drawImage(e.g.canvas,0,0,e.g.canvas.width,e.g.canvas.height),t(e.i)})))}function Be(e){this.g=e}f(Ne,ce);var Ue=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Ve(e,t){return t+e}function Ge(e,t){window[e]=t}function ze(e){if(this.g=e,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=e&&e.locateFile||Ve,"object"==typeof window)var t=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if("undefined"==typeof location)throw Error("solutions can only be loaded on a web page or in a web worker");t=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.S=t,e.options)for(var r=(t=i(Object.keys(e.options))).next();!r.done;r=t.next()){r=r.value;var n=e.options[r].default;void 0!==n&&(this.j[r]="function"==typeof n?n():n)}}function We(e,t){return ke(e,(function e(){var r,n,o=this;return S(e,(function(e){return t in o.F?e.return(o.F[t]):(r=o.locateFile(t,""),n=fetch(r).then((function(e){return e.arrayBuffer()})),o.F[t]=n,e.return(n))}))}))}function He(e,t){for(var r=t.name||"$",n=[].concat(l(t.wants)),o=new e.h.StringList,s=i(t.wants),a=s.next();!a.done;a=s.next())o.push_back(a.value);s=e.h.PacketListener.implement({onResults:function(o){for(var s={},a=0;a<t.wants.length;++a)s[n[a]]=o.get(a);var l=e.listeners[r];l&&(e.C=function(e,t,r){return ke(e,(function e(){var n,o,s,a,l,u,c,d,h,p,f,m,y,g,b=this;return S(e,(function(e){switch(e.g){case 1:if(!r)return e.return(t);for(n={},o=0,s=i(Object.keys(r)),a=s.next();!a.done;a=s.next())l=a.value,"string"!=typeof(u=r[l])&&"texture"===u.type&&void 0!==t[u.stream]&&++o;1<o&&(b.G=!1),c=i(Object.keys(r)),a=c.next();case 2:if(a.done){e.g=4;break}if(d=a.value,"string"==typeof(h=r[d]))return y=n,g=d,v(e,function(e,t,r){return ke(e,(function e(){var n,o=this;return S(e,(function(e){return"number"==typeof r||r instanceof Uint8Array||r instanceof o.h.Uint8BlobList?e.return(r):r instanceof o.h.Texture2dDataOut?((n=o.s[t])||(n=new Fe(o.h,o.D),o.s[t]=n),e.return($e(n,r,o.G))):e.return(void 0)}))}))}(b,d,t[h]),14);if(p=t[h.stream],"detection_list"===h.type){if(p){for(var x=p.getRectList(),w=p.getLandmarksList(),_=p.getClassificationsList(),k=[],T=0;T<x.size();++T){var E=x.get(T);e:{var j=new Ne;for(E=new X(E);Y(E);)switch(E.i){case 13:var C=z(E.g);ye(j,1,C);break;case 21:ye(j,2,C=z(E.g));break;case 29:ye(j,3,C=z(E.g));break;case 37:ye(j,4,C=z(E.g));break;case 45:ye(j,5,C=z(E.g));break;case 48:for(var I=E.g,O=128,A=0,R=C=0;4>R&&128<=O;R++)A|=(127&(O=I.h[I.g++]))<<7*R;if(128<=O&&(A|=(127&(O=I.h[I.g++]))<<28,C|=(127&O)>>4),128<=O)for(R=0;5>R&&128<=O;R++)C|=(127&(O=I.h[I.g++]))<<7*R+3;128>O?(I=A>>>0,(C=2147483648&(O=C>>>0))&&(O=~O>>>0,0==(I=1+~I>>>0)&&(O=O+1>>>0)),I=4294967296*O+(I>>>0),C=C?-I:I):(I.l=!0,C=void 0),ye(j,6,C);break;default:if(!Se(j,E))break e}}j={Z:me(j,1),$:me(j,2),height:me(j,3),width:me(j,4),rotation:me(j,5,0),X:xe(j,6)},E=De(w.get(T)),I=_.get(T);e:for(C=new je,I=new X(I);Y(I);)if(10===I.i)C.addClassification(Z(I,new Te,Ee));else if(!Se(C,I))break e;j={T:j,O:E,M:Pe(C)},k.push(j)}x=k}else x=[];n[d]=x,e.g=7;break}if("proto_list"===h.type){if(p){for(x=Array(p.size()),w=0;w<p.size();w++)x[w]=p.get(w);p.delete()}else x=[];n[d]=x,e.g=7;break}if(void 0===p){e.g=3;break}if("float_list"===h.type){n[d]=p,e.g=7;break}if("proto"===h.type){n[d]=p,e.g=7;break}if("texture"!==h.type)throw Error("Unknown output config type: '"+h.type+"'");return(f=b.s[d])||(f=new Fe(b.h,b.D),b.s[d]=f),v(e,$e(f,p,b.G),13);case 13:m=e.h,n[d]=m;case 7:h.transform&&n[d]&&(n[d]=h.transform(n[d])),e.g=3;break;case 14:y[g]=e.h;case 3:a=c.next(),e.g=2;break;case 4:return e.return(n)}}))}))}(e,s,t.outs).then((function(r){r=l(r);for(var o=0;o<t.wants.length;++o){var a=s[n[o]];"object"==typeof a&&a.hasOwnProperty&&a.hasOwnProperty("delete")&&a.delete()}r&&(e.C=r)})))}}),e.i.attachMultiListener(o,s),o.delete()}function qe(e){switch(void 0===e&&(e=0),e){case 1:return"pose_landmark_full.tflite";case 2:return"pose_landmark_heavy.tflite";default:return"pose_landmark_lite.tflite"}}function Xe(e){var t=this;e=e||{},this.g=new ze({locateFile:e.locateFile,files:function(e){return[{url:"pose_solution_packed_assets_loader.js"},{simd:!1,url:"pose_solution_wasm_bin.js"},{simd:!0,url:"pose_solution_simd_wasm_bin.js"},{data:!0,url:qe(e.modelComplexity)}]},graph:{url:"pose_web.binarypb"},listeners:[{wants:["pose_landmarks","world_landmarks","segmentation_mask","image_transformed"],outs:{image:{type:"texture",stream:"image_transformed"},poseLandmarks:{type:"proto",stream:"pose_landmarks",transform:De},poseWorldLandmarks:{type:"proto",stream:"world_landmarks",transform:De},segmentationMask:{type:"texture",stream:"segmentation_mask"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},modelComplexity:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorModelComplexity",fieldName:"int_value"},onChange:function(e){return ke(t,(function t(){var r,n,o,s=this;return S(t,(function(t){return 1==t.g?(r=qe(e),n="third_party/mediapipe/modules/pose_landmark/"+r,v(t,We(s.g,r),2)):(o=t.h,s.g.overrideFile(n,o),t.return(!0))}))}))}},smoothLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothLandmarks",fieldName:"bool_value"}},enableSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorEnableSegmentation",fieldName:"bool_value"}},smoothSegmentation:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorSmoothSegmentation",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"poselandmarkgpu__posedetectiongpu__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"poselandmarkgpu__poselandmarkbyroigpu__tensorstoposelandmarksandsegmentation__ThresholdingCalculator",fieldName:"threshold"}}}})}(e=ze.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},e.reset=function(){return ke(this,(function e(){var t=this;return S(e,(function(e){t.i&&(t.i.reset(),t.m={},t.s={}),e.g=0}))}))},e.setOptions=function(e,t){var r=this;if(t=t||this.g.options){for(var n=[],o=[],s={},a=i(Object.keys(e)),l=a.next();!l.done;s={K:s.K,L:s.L},l=a.next()){var u=l.value;u in this.j&&this.j[u]===e[u]||(this.j[u]=e[u],void 0!==(l=t[u])&&(l.onChange&&(s.K=l.onChange,s.L=e[u],n.push(function(e){return function(){return ke(r,(function t(){var r=this;return S(t,(function(t){if(1==t.g)return v(t,e.K(e.L),2);!0===t.h&&(r.o=!0),t.g=0}))}))}}(s))),l.graphOptionXref&&(u={valueNumber:1===l.type?e[u]:0,valueBoolean:0===l.type&&e[u],valueString:2===l.type?e[u]:""},l=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),l.graphOptionXref),u),o.push(l))))}0===n.length&&0===o.length||(this.o=!0,this.A=(void 0===this.A?[]:this.A).concat(o),this.u=(void 0===this.u?[]:this.u).concat(n))}},e.initialize=function(){return ke(this,(function e(){var t=this;return S(e,(function(e){return 1==e.g?v(e,ke(t,(function e(){var t,r,n,o,s,a,i,u,c,d,h,p=this;return S(e,(function(e){switch(e.g){case 1:return t=p,p.R?(r=function(e,t){return void 0===e.g.files?[]:"function"==typeof e.g.files?e.g.files(t):e.g.files}(p,p.j),v(e,function(){return ke(this,(function e(){return S(e,(function(e){switch(e.g){case 1:return e.m=2,v(e,WebAssembly.instantiate(Ue),4);case 4:e.g=3,e.m=0;break;case 2:return e.m=0,e.j=null,e.return(!1);case 3:return e.return(!0)}}))}))}(),2)):e.return();case 2:if(n=e.h,"object"==typeof window)return Ge("createMediapipeSolutionsWasm",{locateFile:p.locateFile}),Ge("createMediapipeSolutionsPackedAssets",{locateFile:p.locateFile}),a=r.filter((function(e){return void 0!==e.data})),i=r.filter((function(e){return void 0===e.data})),u=Promise.all(a.map((function(e){var r=We(t,e.url);if(void 0!==e.path){var n=e.path;r=r.then((function(e){return t.overrideFile(n,e),Promise.resolve(e)}))}return r}))),c=Promise.all(i.map((function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n?function(e){var t=document.createElement("script");return t.setAttribute("src",e),t.setAttribute("crossorigin","anonymous"),new Promise((function(e){t.addEventListener("load",(function(){e()}),!1),t.addEventListener("error",(function(){e()}),!1),document.body.appendChild(t)}))}(t.locateFile(e.url,t.S)):Promise.resolve()}))).then((function(){return ke(t,(function e(){var t,r,n=this;return S(e,(function(e){if(1==e.g)return t=window.createMediapipeSolutionsWasm,r=window.createMediapipeSolutionsPackedAssets,v(e,t(r),2);n.h=e.h,e.g=0}))}))})),d=ke(t,(function e(){var t=this;return S(e,(function(e){return t.g.graph&&t.g.graph.url?e=v(e,We(t,t.g.graph.url),0):(e.g=0,e=void 0),e}))})),v(e,Promise.all([c,u,d]),7);if("function"!=typeof importScripts)throw Error("solutions can only be loaded on a web page or in a web worker");return o=r.filter((function(e){return void 0===e.simd||e.simd&&n||!e.simd&&!n})).map((function(e){return t.locateFile(e.url,t.S)})),importScripts.apply(null,l(o)),v(e,createMediapipeSolutionsWasm(Module),6);case 6:p.h=e.h,p.l=new OffscreenCanvas(1,1),p.h.canvas=p.l,s=p.h.GL.createContext(p.l,{antialias:!1,alpha:!1,ba:"undefined"!=typeof WebGL2RenderingContext?2:1}),p.h.GL.makeContextCurrent(s),e.g=4;break;case 7:if(p.l=document.createElement("canvas"),!(h=p.l.getContext("webgl2",{}))&&!(h=p.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),e.return();p.D=h,p.h.canvas=p.l,p.h.createContext(p.l,!0,!0,{});case 4:p.i=new p.h.SolutionWasm,p.R=!1,e.g=0}}))})),2):3!=e.g?v(e,ke(t,(function e(){var t,r,n,o,s,a,l,u,c=this;return S(e,(function(e){if(1==e.g)return c.g.graph&&c.g.graph.url&&c.P===c.g.graph.url?e.return():(c.o=!0,c.g.graph&&c.g.graph.url?(c.P=c.g.graph.url,v(e,We(c,c.g.graph.url),3)):void(e.g=2));for(2!=e.g&&(t=e.h,c.i.loadGraph(t)),r=i(Object.keys(c.B)),n=r.next();!n.done;n=r.next())o=n.value,c.i.overrideFile(o,c.B[o]);if(c.B={},c.g.listeners)for(s=i(c.g.listeners),a=s.next();!a.done;a=s.next())l=a.value,He(c,l);u=c.j,c.j={},c.setOptions(u),e.g=0}))})),3):v(e,function(e){return ke(e,(function e(){var t,r,n,o,s,a,l=this;return S(e,(function(e){switch(e.g){case 1:if(!l.o)return e.return();if(!l.u){e.g=2;break}t=i(l.u),r=t.next();case 3:if(r.done){e.g=5;break}return v(e,(0,r.value)(),4);case 4:r=t.next(),e.g=3;break;case 5:l.u=void 0;case 2:if(l.A){for(n=new l.h.GraphOptionChangeRequestList,o=i(l.A),s=o.next();!s.done;s=o.next())a=s.value,n.push_back(a);l.i.changeOptions(n),n.delete(),l.A=void 0}l.o=!1,e.g=0}}))}))}(t),0)}))}))},e.overrideFile=function(e,t){this.i?this.i.overrideFile(e,t):this.B[e]=t},e.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},e.send=function(e,t){return ke(this,(function r(){var n,o,s,a,l,u,c,d,h,p=this;return S(r,(function(r){switch(r.g){case 1:return p.g.inputs?(n=1e3*(null==t?performance.now():t),v(r,p.C,2)):r.return();case 2:return v(r,p.initialize(),3);case 3:for(o=new p.h.PacketDataList,s=i(Object.keys(e)),a=s.next();!a.done;a=s.next())if(l=a.value,u=p.g.inputs[l]){e:{var f=p,m=e[l];switch(u.type){case"video":var y=f.m[u.stream];if(y||(y=new Fe(f.h,f.D),f.m[u.stream]=y),0===(f=y).l&&(f.l=f.h.createTexture()),"undefined"!=typeof HTMLVideoElement&&m instanceof HTMLVideoElement){var g=m.videoWidth;y=m.videoHeight}else"undefined"!=typeof HTMLImageElement&&m instanceof HTMLImageElement?(g=m.naturalWidth,y=m.naturalHeight):(g=m.width,y=m.height);y={glName:f.l,width:g,height:y},(g=f.g).canvas.width=y.width,g.canvas.height=y.height,g.activeTexture(g.TEXTURE0),f.h.bindTexture2d(f.l),g.texImage2D(g.TEXTURE_2D,0,g.RGBA,g.RGBA,g.UNSIGNED_BYTE,m),f.h.bindTexture2d(0),f=y;break e;case"detections":for((y=f.m[u.stream])||(y=new Be(f.h),f.m[u.stream]=y),(f=y).data||(f.data=new f.g.DetectionListData),f.data.reset(m.length),y=0;y<m.length;++y){g=m[y];var b=f.data,x=b.setBoundingBox,w=y,_=g.T,S=new Ne;ye(S,1,_.Z),ye(S,2,_.$),ye(S,3,_.height),ye(S,4,_.width),ye(S,5,_.rotation),ye(S,6,_.X);var k=_=new J;re(k,1,pe(S,1)),re(k,2,pe(S,2)),re(k,3,pe(S,3)),re(k,4,pe(S,4)),re(k,5,pe(S,5));var T=pe(S,6);if(null!=T&&null!=T){q(k.g,48);var E=k.g,j=T;T=0>j;var C=(j=Math.abs(j))>>>0;for(j=Math.floor((j-C)/4294967296),j>>>=0,T&&(j=~j>>>0,4294967295<(C=1+(~C>>>0))&&(C=0,4294967295<++j&&(j=0))),T=B=C,C=j;0<C||127<T;)E.push(127&T|128),T=(T>>>7|C<<25)>>>0,C>>>=7;E.push(T)}if(_e(S,k),_=te(_),x.call(b,w,_),g.O)for(b=0;b<g.O.length;++b)k=!!(S=g.O[b]).visibility,w=(x=f.data).addNormalizedLandmark,_=y,S=Object.assign(Object.assign({},S),{visibility:k?S.visibility:0}),ye(k=new Ie,1,S.x),ye(k,2,S.y),ye(k,3,S.z),S.visibility&&ye(k,4,S.visibility),re(E=S=new J,1,pe(k,1)),re(E,2,pe(k,2)),re(E,3,pe(k,3)),re(E,4,pe(k,4)),re(E,5,pe(k,5)),_e(k,E),S=te(S),w.call(x,_,S);if(g.M)for(b=0;b<g.M.length;++b){if(w=(x=f.data).addClassification,_=y,S=g.M[b],ye(k=new Te,2,S.Y),S.index&&ye(k,1,S.index),S.label&&ye(k,3,S.label),S.displayName&&ye(k,4,S.displayName),E=S=new J,null!=(C=pe(k,1))&&null!=C)if(q(E.g,8),T=E.g,0<=C)q(T,C);else{for(j=0;9>j;j++)T.push(127&C|128),C>>=7;T.push(1)}re(E,2,pe(k,2)),null!=(T=pe(k,3))&&(T=R(T),q(E.g,26),q(E.g,T.length),ee(E,E.g.end()),ee(E,T)),null!=(T=pe(k,4))&&(T=R(T),q(E.g,34),q(E.g,T.length),ee(E,E.g.end()),ee(E,T)),_e(k,E),S=te(S),w.call(x,_,S)}}f=f.data;break e;default:f={}}}switch(c=f,d=u.stream,u.type){case"video":o.pushTexture2d(Object.assign(Object.assign({},c),{stream:d,timestamp:n}));break;case"detections":(h=c).stream=d,h.timestamp=n,o.pushDetectionList(h);break;default:throw Error("Unknown input config type: '"+u.type+"'")}}return p.i.send(o),v(r,p.C,4);case 4:o.delete(),r.g=0}}))}))},e.onResults=function(e,t){this.listeners[t||"$"]=e},E("Solution",ze),E("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(e=Xe.prototype).reset=function(){this.g.reset()},e.close=function(){return this.g.close(),Promise.resolve()},e.onResults=function(e){this.g.onResults(e)},e.initialize=function(){return ke(this,(function e(){var t=this;return S(e,(function(e){return v(e,t.g.initialize(),0)}))}))},e.send=function(e,t){return ke(this,(function r(){var n=this;return S(r,(function(r){return v(r,n.g.send(e,t),0)}))}))},e.setOptions=function(e){this.g.setOptions(e)},E("Pose",Xe),E("POSE_CONNECTIONS",[[0,1],[1,2],[2,3],[3,7],[0,4],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[13,15],[15,17],[15,19],[15,21],[17,19],[12,14],[14,16],[16,18],[16,20],[16,22],[18,20],[11,23],[12,24],[23,24],[23,25],[24,26],[25,27],[26,28],[27,29],[28,30],[29,31],[30,32],[27,31],[28,32]]),E("POSE_LANDMARKS",{NOSE:0,LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,LEFT_EAR:7,RIGHT_EAR:8,LEFT_RIGHT:9,RIGHT_LEFT:10,LEFT_SHOULDER:11,RIGHT_SHOULDER:12,LEFT_ELBOW:13,RIGHT_ELBOW:14,LEFT_WRIST:15,RIGHT_WRIST:16,LEFT_PINKY:17,RIGHT_PINKY:18,LEFT_INDEX:19,RIGHT_INDEX:20,LEFT_THUMB:21,RIGHT_THUMB:22,LEFT_HIP:23,RIGHT_HIP:24,LEFT_KNEE:25,RIGHT_KNEE:26,LEFT_ANKLE:27,RIGHT_ANKLE:28,LEFT_HEEL:29,RIGHT_HEEL:30,LEFT_FOOT_INDEX:31,RIGHT_FOOT_INDEX:32}),E("POSE_LANDMARKS_LEFT",{LEFT_EYE_INNER:1,LEFT_EYE:2,LEFT_EYE_OUTER:3,LEFT_EAR:7,LEFT_RIGHT:9,LEFT_SHOULDER:11,LEFT_ELBOW:13,LEFT_WRIST:15,LEFT_PINKY:17,LEFT_INDEX:19,LEFT_THUMB:21,LEFT_HIP:23,LEFT_KNEE:25,LEFT_ANKLE:27,LEFT_HEEL:29,LEFT_FOOT_INDEX:31}),E("POSE_LANDMARKS_RIGHT",{RIGHT_EYE_INNER:4,RIGHT_EYE:5,RIGHT_EYE_OUTER:6,RIGHT_EAR:8,RIGHT_LEFT:10,RIGHT_SHOULDER:12,RIGHT_ELBOW:14,RIGHT_WRIST:16,RIGHT_PINKY:18,RIGHT_INDEX:20,RIGHT_THUMB:22,RIGHT_HIP:24,RIGHT_KNEE:26,RIGHT_ANKLE:28,RIGHT_HEEL:30,RIGHT_FOOT_INDEX:32}),E("POSE_LANDMARKS_NEUTRAL",{NOSE:0}),E("VERSION","0.4.1633558788")}).call(this)},720:e=>{e.exports=r;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(e){}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function n(e){return!0===(e&&e.__isLong__)}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var o={},s={};function a(e,t){var r,n,a;return t?(a=0<=(e>>>=0)&&e<256)&&(n=s[e])?n:(r=l(e,(0|e)<0?-1:0,!0),a&&(s[e]=r),r):(a=-128<=(e|=0)&&e<128)&&(n=o[e])?n:(r=l(e,e<0?-1:0,!1),a&&(o[e]=r),r)}function i(e,t){if(isNaN(e))return t?g:y;if(t){if(e<0)return g;if(e>=p)return _}else{if(e<=-f)return S;if(e+1>=f)return w}return e<0?i(-e,t).neg():l(e%h|0,e/h|0,t)}function l(e,t,n){return new r(e,t,n)}r.fromInt=a,r.fromNumber=i,r.fromBits=l;var u=Math.pow;function c(e,t,r){if(0===e.length)throw Error("empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return y;if("number"==typeof t?(r=t,t=!1):t=!!t,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return c(e.substring(1),t,r).neg();for(var o=i(u(r,8)),s=y,a=0;a<e.length;a+=8){var l=Math.min(8,e.length-a),d=parseInt(e.substring(a,a+l),r);if(l<8){var h=i(u(r,l));s=s.mul(h).add(i(d))}else s=(s=s.mul(o)).add(i(d))}return s.unsigned=t,s}function d(e,t){return"number"==typeof e?i(e,t):"string"==typeof e?c(e,t):l(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=c,r.fromValue=d;var h=4294967296,p=h*h,f=p/2,m=a(1<<24),y=a(0);r.ZERO=y;var g=a(0,!0);r.UZERO=g;var v=a(1);r.ONE=v;var b=a(1,!0);r.UONE=b;var x=a(-1);r.NEG_ONE=x;var w=l(-1,2147483647,!1);r.MAX_VALUE=w;var _=l(-1,-1,!0);r.MAX_UNSIGNED_VALUE=_;var S=l(0,-2147483648,!1);r.MIN_VALUE=S;var k=r.prototype;k.toInt=function(){return this.unsigned?this.low>>>0:this.low},k.toNumber=function(){return this.unsigned?(this.high>>>0)*h+(this.low>>>0):this.high*h+(this.low>>>0)},k.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(S)){var t=i(e),r=this.div(t),n=r.mul(t).sub(this);return r.toString(e)+n.toInt().toString(e)}return"-"+this.neg().toString(e)}for(var o=i(u(e,6),this.unsigned),s=this,a="";;){var l=s.div(o),c=(s.sub(l.mul(o)).toInt()>>>0).toString(e);if((s=l).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},k.getHighBits=function(){return this.high},k.getHighBitsUnsigned=function(){return this.high>>>0},k.getLowBits=function(){return this.low},k.getLowBitsUnsigned=function(){return this.low>>>0},k.getNumBitsAbs=function(){if(this.isNegative())return this.eq(S)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&0==(e&1<<t);t--);return 0!=this.high?t+33:t+1},k.isZero=function(){return 0===this.high&&0===this.low},k.eqz=k.isZero,k.isNegative=function(){return!this.unsigned&&this.high<0},k.isPositive=function(){return this.unsigned||this.high>=0},k.isOdd=function(){return 1==(1&this.low)},k.isEven=function(){return 0==(1&this.low)},k.equals=function(e){return n(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},k.eq=k.equals,k.notEquals=function(e){return!this.eq(e)},k.neq=k.notEquals,k.ne=k.notEquals,k.lessThan=function(e){return this.comp(e)<0},k.lt=k.lessThan,k.lessThanOrEqual=function(e){return this.comp(e)<=0},k.lte=k.lessThanOrEqual,k.le=k.lessThanOrEqual,k.greaterThan=function(e){return this.comp(e)>0},k.gt=k.greaterThan,k.greaterThanOrEqual=function(e){return this.comp(e)>=0},k.gte=k.greaterThanOrEqual,k.ge=k.greaterThanOrEqual,k.compare=function(e){if(n(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},k.comp=k.compare,k.negate=function(){return!this.unsigned&&this.eq(S)?S:this.not().add(v)},k.neg=k.negate,k.add=function(e){n(e)||(e=d(e));var t=this.high>>>16,r=65535&this.high,o=this.low>>>16,s=65535&this.low,a=e.high>>>16,i=65535&e.high,u=e.low>>>16,c=0,h=0,p=0,f=0;return p+=(f+=s+(65535&e.low))>>>16,h+=(p+=o+u)>>>16,c+=(h+=r+i)>>>16,c+=t+a,l((p&=65535)<<16|(f&=65535),(c&=65535)<<16|(h&=65535),this.unsigned)},k.subtract=function(e){return n(e)||(e=d(e)),this.add(e.neg())},k.sub=k.subtract,k.multiply=function(e){if(this.isZero())return y;if(n(e)||(e=d(e)),t)return l(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return y;if(this.eq(S))return e.isOdd()?S:y;if(e.eq(S))return this.isOdd()?S:y;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(m)&&e.lt(m))return i(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,o=65535&this.high,s=this.low>>>16,a=65535&this.low,u=e.high>>>16,c=65535&e.high,h=e.low>>>16,p=65535&e.low,f=0,g=0,v=0,b=0;return v+=(b+=a*p)>>>16,g+=(v+=s*p)>>>16,v&=65535,g+=(v+=a*h)>>>16,f+=(g+=o*p)>>>16,g&=65535,f+=(g+=s*h)>>>16,g&=65535,f+=(g+=a*c)>>>16,f+=r*p+o*h+s*c+a*u,l((v&=65535)<<16|(b&=65535),(f&=65535)<<16|(g&=65535),this.unsigned)},k.mul=k.multiply,k.divide=function(e){if(n(e)||(e=d(e)),e.isZero())throw Error("division by zero");var r,o,s;if(t)return this.unsigned||-2147483648!==this.high||-1!==e.low||-1!==e.high?l((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return g;if(e.gt(this.shru(1)))return b;s=g}else{if(this.eq(S))return e.eq(v)||e.eq(x)?S:e.eq(S)?v:(r=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?v:x:(o=this.sub(e.mul(r)),s=r.add(o.div(e)));if(e.eq(S))return this.unsigned?g:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=y}for(o=this;o.gte(e);){r=Math.max(1,Math.floor(o.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),c=a<=48?1:u(2,a-48),h=i(r),p=h.mul(e);p.isNegative()||p.gt(o);)p=(h=i(r-=c,this.unsigned)).mul(e);h.isZero()&&(h=v),s=s.add(h),o=o.sub(p)}return s},k.div=k.divide,k.modulo=function(e){return n(e)||(e=d(e)),t?l((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},k.mod=k.modulo,k.rem=k.modulo,k.not=function(){return l(~this.low,~this.high,this.unsigned)},k.and=function(e){return n(e)||(e=d(e)),l(this.low&e.low,this.high&e.high,this.unsigned)},k.or=function(e){return n(e)||(e=d(e)),l(this.low|e.low,this.high|e.high,this.unsigned)},k.xor=function(e){return n(e)||(e=d(e)),l(this.low^e.low,this.high^e.high,this.unsigned)},k.shiftLeft=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):l(0,this.low<<e-32,this.unsigned)},k.shl=k.shiftLeft,k.shiftRight=function(e){return n(e)&&(e=e.toInt()),0==(e&=63)?this:e<32?l(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):l(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},k.shr=k.shiftRight,k.shiftRightUnsigned=function(e){if(n(e)&&(e=e.toInt()),0==(e&=63))return this;var t=this.high;return e<32?l(this.low>>>e|t<<32-e,t>>>e,this.unsigned):l(32===e?t:t>>>e-32,0,this.unsigned)},k.shru=k.shiftRightUnsigned,k.shr_u=k.shiftRightUnsigned,k.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},k.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},k.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},k.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},k.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,n){return n?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)}},87:function(e,t,r){e.exports=function(){"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function u(e,t){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},u(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=l(e);if(t){var o=l(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},d.apply(this,arguments)}function h(e){return Number(e)===e&&e%1==0}function p(e){return Number(e)===e}function f(e){return"string"==typeof e}function m(e){return"boolean"==typeof e}function y(e){return e===1/0}function g(e){return"[object Array]"===Object.prototype.toString.call(e)}function v(e){return"[object Object]"===Object.prototype.toString.call(e)}function b(e){return"function"==typeof e}function x(e){return e instanceof Uint8Array}function w(e){return void 0===e}function _(e){return null===e}function S(e){return e+3&-4}function k(e){return Object.prototype.hasOwnProperty.call(void 0!==r.g?r.g:window,e)}function T(e){if(h(e))return"i";if(t=e,Number(t)===t&&t%1!=0)return"f";if(f(e))return"s";if(x(e))return"b";if(m(e))return e?"T":"F";if(_(e))return"N";if(y(e))return"I";var t;throw new Error("OSC typeTag() found unknown value type")}function E(e){var t="";if(g(e))return"/".concat(e.join("/"));if(f(e))return(t=e).length>1&&"/"===t[t.length-1]&&(t=t.slice(0,t.length-1)),t.length>1&&"/"!==t[0]&&(t="/".concat(t)),t;throw new Error("OSC prepareAddress() needs addresses of type array or string")}function j(e){if(!f(e))throw new Error("OSC prepareRegExPattern() needs strings");return e.replace(/\./g,"\\.").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\{/g,"(").replace(/\}/g,")").replace(/,/g,"|").replace(/\[!/g,"[^").replace(/\?/g,".").replace(/\*/g,".*")}var C=function(){function e(){n(this,e),this.data=[],this.byteLength=0}return s(e,[{key:"add",value:function(e){if(m(e)||y(e)||_(e))return this;var t=e.pack();return this.byteLength+=t.byteLength,this.data.push(t),this}},{key:"merge",value:function(){var e=new Uint8Array(this.byteLength),t=0;return this.data.forEach((function(r){e.set(r,t),t+=r.byteLength})),e}}]),e}(),I=function(){function e(t){n(this,e),this.value=t,this.offset=0}return s(e,[{key:"pack",value:function(e,t){if(!e||!t)throw new Error("OSC Atomic cant't be packed without given method or byteLength");var r=new Uint8Array(t),n=new DataView(r.buffer);if(w(this.value))throw new Error("OSC Atomic cant't be encoded with empty value");return n[e](this.offset,this.value,!1),r}},{key:"unpack",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!(e&&t&&r))throw new Error("OSC Atomic cant't be unpacked without given dataView, method or byteLength");if(!(e instanceof DataView))throw new Error("OSC Atomic expects an instance of type DataView");return this.value=e[t](n,!1),this.offset=n+r,this.offset}}]),e}(),O=function(e){i(r,e);var t=c(r);function r(e){if(n(this,r),e&&!h(e))throw new Error("OSC AtomicInt32 constructor expects value of type number");return t.call(this,e)}return s(r,[{key:"pack",value:function(){return d(l(r.prototype),"pack",this).call(this,"setInt32",4)}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(l(r.prototype),"unpack",this).call(this,e,"getInt32",4,t)}}]),r}(I),A="utf-8";var R=function(e){i(r,e);var t=c(r);function r(e){if(n(this,r),e&&!f(e))throw new Error("OSC AtomicString constructor expects value of type string");return t.call(this,e)}return s(r,[{key:"pack",value:function(){if(w(this.value))throw new Error("OSC AtomicString can not be encoded with empty value");for(var e="".concat(this.value,"\0"),t=S(e.length),r=new Uint8Array(t),n=0;n<e.length;n+=1)r[n]=e.charCodeAt(n);return r}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(e instanceof DataView))throw new Error("OSC AtomicString expects an instance of type DataView");for(var r,n=t,o=[];n<e.byteLength;n+=1){if(0===(r=e.getUint8(n))){n+=1;break}o.push(r)}if(n===e.length)throw new Error("OSC AtomicString found a malformed OSC string");return this.offset=S(n),this.value=function(e){if(k("Buffer"))return Buffer.from(e).toString(A);if(k("TextDecoder"))return new TextDecoder(A).decode(new Int8Array(e));for(var t="",r=0;r<e.length;r+=65537)t+=String.fromCharCode.apply(null,e.slice(r,r+65537));return t}(o),this.offset}}]),r}(I),N=2208988800,M=4294967296,P=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n(this,e),!h(t)||!h(r))throw new Error("OSC Timetag constructor expects values of type integer number");this.seconds=t,this.fractions=r}return s(e,[{key:"timestamp",value:function(e){var t;if("number"==typeof e){t=e/1e3;var r=Math.floor(t);return this.seconds=r+N,this.fractions=Math.round(M*(t-r)),e}return 1e3*((t=this.seconds-N)+Math.round(this.fractions/M))}}]),e}(),L=function(e){i(r,e);var t=c(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();n(this,r);var o=new P;return e instanceof P?o=e:h(e)?o.timestamp(e):function(e){return e instanceof Date}(e)&&o.timestamp(e.getTime()),t.call(this,o)}return s(r,[{key:"pack",value:function(){if(w(this.value))throw new Error("OSC AtomicTimetag can not be encoded with empty value");var e=this.value,t=e.seconds,r=e.fractions,n=new Uint8Array(8),o=new DataView(n.buffer);return o.setInt32(0,t,!1),o.setInt32(4,r,!1),n}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(e instanceof DataView))throw new Error("OSC AtomicTimetag expects an instance of type DataView");var r=e.getUint32(t,!1),n=e.getUint32(t+4,!1);return this.value=new P(r,n),this.offset=t+8,this.offset}}]),r}(I),D=function(e){i(r,e);var t=c(r);function r(e){if(n(this,r),e&&!x(e))throw new Error("OSC AtomicBlob constructor expects value of type Uint8Array");return t.call(this,e)}return s(r,[{key:"pack",value:function(){if(w(this.value))throw new Error("OSC AtomicBlob can not be encoded with empty value");var e=S(this.value.byteLength),t=new Uint8Array(e+4);return new DataView(t.buffer).setInt32(0,this.value.byteLength,!1),t.set(this.value,4),t}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(e instanceof DataView))throw new Error("OSC AtomicBlob expects an instance of type DataView");var r=e.getInt32(t,!1);return this.value=new Uint8Array(e.buffer,t+4,r),this.offset=S(t+4+r),this.offset}}]),r}(I),F=function(e){i(r,e);var t=c(r);function r(e){if(n(this,r),e&&!p(e))throw new Error("OSC AtomicFloat32 constructor expects value of type float");return t.call(this,e)}return s(r,[{key:"pack",value:function(){return d(l(r.prototype),"pack",this).call(this,"setFloat32",4)}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(l(r.prototype),"unpack",this).call(this,e,"getFloat32",4,t)}}]),r}(I),$=function(e){i(r,e);var t=c(r);function r(e){if(n(this,r),e&&!p(e))throw new Error("OSC AtomicFloat64 constructor expects value of type float");return t.call(this,e)}return s(r,[{key:"pack",value:function(){return d(l(r.prototype),"pack",this).call(this,"setFloat64",8)}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(l(r.prototype),"unpack",this).call(this,e,"getFloat64",8,t)}}]),r}(I),B=BigInt("9223372036854775807"),U=BigInt("-9223372036854775808"),V=function(e){i(r,e);var t=c(r);function r(e){if(n(this,r),e&&"bigint"!=typeof e)throw new Error("OSC AtomicInt64 constructor expects value of type BigInt");if(e&&(e<U||e>B))throw new Error("OSC AtomicInt64 value is out of bounds");var o;return e&&(o=BigInt.asIntN(64,e)),t.call(this,o)}return s(r,[{key:"pack",value:function(){return d(l(r.prototype),"pack",this).call(this,"setBigInt64",8)}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(l(r.prototype),"unpack",this).call(this,e,"getBigInt64",8,t)}}]),r}(I),G=BigInt("18446744073709551615"),z=function(e){i(r,e);var t=c(r);function r(e){if(n(this,r),e&&"bigint"!=typeof e)throw new Error("OSC AtomicUInt64 constructor expects value of type BigInt");if(e&&(e<0||e>G))throw new Error("OSC AtomicUInt64 value is out of bounds");var o;return e&&(o=BigInt.asUintN(64,e)),t.call(this,o)}return s(r,[{key:"pack",value:function(){return d(l(r.prototype),"pack",this).call(this,"setBigUint64",8)}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(l(r.prototype),"unpack",this).call(this,e,"getBigUint64",8,t)}}]),r}(I),W=!0,H=!1,q=null,X=1/0,Y=function(){function e(t,r){var o=this;if(n(this,e),this.offset=0,this.address="",this.types="",this.args=[],!w(t)){if(!f(t)&&!g(t))throw new Error("OSC Message constructor first argument (address) must be a string or array");this.address=E(t)}if(!w(r)){if(!g(r))throw new Error("OSC Message constructor second argument (args) must be an array");r.forEach((function(e){return o.add(e.type,e.value)}))}}return s(e,[{key:"add",value:function(e,t){if(w(e))throw new Error("OSC Message needs a valid OSC Atomic Data Type");"N"===e?this.args.push(q):"T"===e?this.args.push(W):"F"===e?this.args.push(H):"I"===e?this.args.push(X):this.args.push(t),this.types+=e}},{key:"pack",value:function(){var e=this;if(0===this.address.length||"/"!==this.address[0])throw new Error("OSC Message has an invalid address");var t=new C;if(t.add(new R(this.address)),t.add(new R(",".concat(this.types))),this.args.length>0){var r;if(this.args.length>this.types.length)throw new Error("OSC Message argument and type tag mismatch");this.args.forEach((function(n,o){var s=e.types[o];if("i"===s)r=new O(n);else if("h"===s)r=new V(n);else if("t"===s)r=new z(n);else if("f"===s)r=new F(n);else if("d"===s)r=new $(n);else if("s"===s)r=new R(n);else if("b"===s)r=new D(n);else if("T"===s)r=W;else if("F"===s)r=H;else if("N"===s)r=q;else{if("I"!==s)throw new Error("OSC Message found unknown argument type");r=X}t.add(r)}))}return t.merge()}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(e instanceof DataView))throw new Error("OSC Message expects an instance of type DataView.");var r=new R;r.unpack(e,t);var n=new R;if(n.unpack(e,r.offset),0===r.value.length||"/"!==r.value[0])throw new Error("OSC Message found malformed or missing address string");if(0===n.value.length&&","!==n.value[0])throw new Error("OSC Message found malformed or missing type string");for(var o,s,a=n.offset,i=[],l=1;l<n.value.length;l+=1){if(o=null,"i"===(s=n.value[l]))o=new O;else if("h"===s)o=new V;else if("t"===s)o=new z;else if("f"===s)o=new F;else if("d"===s)o=new $;else if("s"===s)o=new R;else if("b"===s)o=new D;else if("T"===s)i.push(W);else if("F"===s)i.push(H);else if("N"===s)i.push(q);else{if("I"!==s)throw new Error("OSC Message found unsupported argument type");i.push(X)}o&&(a=o.unpack(e,a),i.push(o.value))}return this.offset=a,this.address=r.value,this.types=n.value,this.args=i,this.offset}}]),e}(),K=function(e){i(r,e);var t=c(r);function r(e){var o,s;n(this,r);for(var a=arguments.length,i=new Array(a>1?a-1:0),l=1;l<a;l++)i[l-1]=arguments[l];return i.length>0&&i[0]instanceof Array&&(s=i.shift()),o=t.call(this,e,s),i.length>0&&(o.types=i.map((function(e){return T(e)})).join(""),o.args=i),o}return s(r,[{key:"add",value:function(e){d(l(r.prototype),"add",this).call(this,T(e),e)}}]),r}(Y),Z="#bundle",Q=function(){function e(){var t=this;n(this,e),this.offset=0,this.timetag=new L,this.bundleElements=[];for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];o.length>0&&(o[0]instanceof Date||h(o[0])?this.timetag=new L(o[0]):g(o[0])?(o[0].forEach((function(e){t.add(e)})),o.length>1&&(o[1]instanceof Date||h(o[1]))&&(this.timetag=new L(o[1]))):o.forEach((function(e){t.add(e)})))}return s(e,[{key:"timestamp",value:function(e){if(!h(e))throw new Error("OSC Bundle needs an integer for setting the timestamp");this.timetag=new L(e)}},{key:"add",value:function(t){if(!(t instanceof K||t instanceof e))throw new Error("OSC Bundle contains only Messages and Bundles");this.bundleElements.push(t)}},{key:"pack",value:function(){var e=new C;return e.add(new R(Z)),this.timetag||(this.timetag=new L),e.add(this.timetag),this.bundleElements.forEach((function(t){e.add(new O(t.pack().byteLength)),e.add(t)})),e.merge()}},{key:"unpack",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(t instanceof DataView))throw new Error("OSC Bundle expects an instance of type DataView");var n=new R;if(n.unpack(t,r),n.value!==Z)throw new Error("OSC Bundle does not contain a valid #bundle head");var o=new L,s=o.unpack(t,n.offset);for(this.bundleElements=[];s<t.byteLength;){var a=new R;s=(new O).unpack(t,s);var i=void 0;a.unpack(t,s),s=(i=a.value===Z?new e:new K).unpack(t,s),this.bundleElements.push(i)}return this.offset=s,this.timetag=o,this.offset}}]),e}(),J=function(){function e(t){if(n(this,e),t&&!(t instanceof K||t instanceof Q))throw new Error("OSC Packet value has to be Message or Bundle");this.value=t,this.offset=0}return s(e,[{key:"pack",value:function(){if(!this.value)throw new Error("OSC Packet can not be encoded with empty body");return this.value.pack()}},{key:"unpack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!(e instanceof DataView))throw new Error("OSC Packet expects an instance of type DataView");if(e.byteLength%4!=0)throw new Error("OSC Packet byteLength has to be a multiple of four");var r,n=new R;return n.unpack(e,t),(r=n.value===Z?new Q:new K).unpack(e,t),this.offset=r.offset,this.value=r,this.offset}}]),e}(),ee={discardLateMessages:!1},te=function(){function e(r){n(this,e),this.options=t(t({},ee),r),this.addressHandlers=[],this.eventHandlers={open:[],error:[],close:[]},this.uuid=0}return s(e,[{key:"dispatch",value:function(e,t){var r=this;if(!(e instanceof J))throw new Error("OSC EventHander dispatch() accepts only arguments of type Packet");if(!e.value)throw new Error("OSC EventHander dispatch() can't read empty Packets");if(e.value instanceof Q){var n=e.value;return n.bundleElements.forEach((function(e){if(e instanceof Q){if(n.timetag.value.timestamp()<e.timetag.value.timestamp())throw new Error("OSC Bundle timestamp is older than the timestamp of enclosed Bundles");return r.dispatch(e)}if(e instanceof K){var o=e;return r.notify(o.address,o,n.timetag.value.timestamp(),t)}throw new Error("OSC EventHander dispatch() can't dispatch unknown Packet value")}))}if(e.value instanceof K){var o=e.value;return this.notify(o.address,o,0,t)}throw new Error("OSC EventHander dispatch() can't dispatch unknown Packet value")}},{key:"call",value:function(e,t,r){var n=!1;if(f(e)&&e in this.eventHandlers)return this.eventHandlers[e].forEach((function(e){e.callback(t,r),n=!0})),n;var o=Object.keys(this.addressHandlers),s=this.addressHandlers;return o.forEach((function(o){var a=!1,i=new RegExp(j(E(e)),"g");if(i.test(o)&&o.length===i.lastIndex&&(a=!0),!a){var l=new RegExp(j(E(o)),"g");l.test(e)&&e.length===l.lastIndex&&(a=!0)}a&&s[o].forEach((function(e){e.callback(t,r),n=!0}))})),n}},{key:"notify",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("OSC EventHandler can not be called without any argument");if(t[0]instanceof J)return this.dispatch(t[0],t[1]);if(t[0]instanceof Q||t[0]instanceof K)return this.dispatch(new J(t[0]),t[1]);if(!f(t[0])){var n=new J;return n.unpack(function(e){return e.buffer?new DataView(e.buffer):e instanceof ArrayBuffer?new DataView(e):new DataView(new Uint8Array(e))}(t[0])),this.dispatch(n,t[1])}var o=t[0],s=null;t.length>1&&(s=t[1]);var a=null;if(t.length>2)if(h(t[2]))a=t[2];else{if(!(t[2]instanceof Date))throw new Error("OSC EventHandler timestamp has to be a number or Date");a=t[2].getTime()}var i=null;if(t.length>=3&&(i=t[3]),a){var l=Date.now();if(l>a&&!this.options.discardLateMessages)return this.call(o,s,i);var u=this;return setTimeout((function(){u.call(o,s,i)}),a-l),!0}return this.call(o,s,i)}},{key:"on",value:function(e,t){if(!f(e)&&!g(e))throw new Error("OSC EventHandler accepts only strings or arrays for address patterns");if(!b(t))throw new Error("OSC EventHandler callback has to be a function");this.uuid+=1;var r={id:this.uuid,callback:t};if(f(e)&&e in this.eventHandlers)return this.eventHandlers[e].push(r),this.uuid;var n=E(e);return n in this.addressHandlers||(this.addressHandlers[n]=[]),this.addressHandlers[n].push(r),this.uuid}},{key:"off",value:function(e,t){if(!f(e)&&!g(e))throw new Error("OSC EventHandler accepts only strings or arrays for address patterns");if(!h(t))throw new Error("OSC EventHandler subscription id has to be a number");var r,n;return f(e)&&e in this.eventHandlers?(r=e,n=this.eventHandlers):(r=E(e),n=this.addressHandlers),r in n&&n[r].some((function(e,o){return e.id===t&&(n[r].splice(o,1),!0)}))}}]),e}(),re=function(){function e(){if(n(this,e),this.constructor===e)throw new Error("Plugin is an abstract class. Please create or use an implementation!")}return s(e,[{key:"status",value:function(){throw new Error("Abstract method!")}},{key:"open",value:function(){throw new Error("Abstract method!")}},{key:"close",value:function(){throw new Error("Abstract method!")}},{key:"send",value:function(e){throw new Error("Abstract method!")}}]),e}(),ne=function(e){i(o,e);var r=c(o);function o(){throw n(this,o),r.call(this),new Error("DatagramPlugin can not be used in browser context")}return s(o,[{key:"registerNotify",value:function(e){this.notify=e}},{key:"status",value:function(){return this.socketStatus}},{key:"open",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t(t({},this.options.open),r),o=n.port,s=n.exclusive;this.socketStatus=0,this.socket.bind({address:n.host,port:o,exclusive:s},(function(){e.socketStatus=1,e.notify("open")}))}},{key:"close",value:function(){var e=this;this.socketStatus=2,this.socket.close((function(){e.socketStatus=3,e.notify("close")}))}},{key:"send",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t(t({},this.options.send),r),o=n.port,s=n.host;this.socket.send(Buffer.from(e),0,e.byteLength,o,s)}}]),o}(re),oe="undefined"!=typeof WebSocket?WebSocket:"undefined"!=typeof MozWebSocket?MozWebSocket:void 0!==r.g?r.g.WebSocket||r.g.MozWebSocket:"undefined"!=typeof window?window.WebSocket||window.MozWebSocket:"undefined"!=typeof self?self.WebSocket||self.MozWebSocket:void 0,se=void 0,ae={udpServer:{host:"localhost",port:41234,exclusive:!1},udpClient:{host:"localhost",port:41235},wsServer:{host:"localhost",port:8080},receiver:"ws"};function ie(e,r){return t(t(t(t({},ae),e),r),{},{udpServer:t(t(t({},ae.udpServer),e.udpServer),r.udpServer),udpClient:t(t(t({},ae.udpClient),e.udpClient),r.udpClient),wsServer:t(t(t({},ae.wsServer),e.wsServer),r.wsServer)})}var le=function(e){i(r,e);var t=c(r);function r(){throw n(this,r),t.call(this),new Error("BridgePlugin can not be used in browser context")}return s(r,[{key:"registerNotify",value:function(e){this.notify=e}},{key:"status",value:function(){return this.socketStatus}},{key:"open",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=ie(this.options,t);this.socketStatus=0,this.socket.bind({address:r.udpServer.host,port:r.udpServer.port,exclusive:r.udpServer.exclusive},(function(){var t={};r.wsServer.server?t.server=r.wsServer.server:t=r.wsServer,e.websocket=new se(t),e.websocket.binaryType="arraybuffer",e.websocket.on("listening",(function(){e.socketStatus=1,e.notify("open")})),e.websocket.on("error",(function(t){e.notify("error",t)})),e.websocket.on("connection",(function(t){t.on("message",(function(t,r){e.send(t,{receiver:"udp"}),e.notify(new Uint8Array(t),r)}))}))}))}},{key:"close",value:function(){var e=this;this.socketStatus=2,this.socket.close((function(){e.websocket.close((function(){e.socketStatus=3,e.notify("close")}))}))}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=ie(this.options,t),n=r.receiver;if("udp"===n){var o=e instanceof Buffer?e:Buffer.from(e);this.socket.send(o,0,o.byteLength,r.udpClient.port,r.udpClient.host)}else{if("ws"!==n)throw new Error("BridgePlugin can not send message to unknown receiver");this.websocket.clients.forEach((function(t){t.send(e,{binary:!0})}))}}}]),r}(re),ue={host:"localhost",port:8080,secure:!1,protocol:[]},ce=function(e){i(o,e);var r=c(o);function o(e){var s;if(n(this,o),s=r.call(this),!oe)throw new Error("WebsocketClientPlugin can't find a WebSocket class");return s.options=t(t({},ue),e),s.socket=null,s.socketStatus=-1,s.notify=function(){},s}return s(o,[{key:"registerNotify",value:function(e){this.notify=e}},{key:"status",value:function(){return this.socketStatus}},{key:"open",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t(t({},this.options),r),o=n.port,s=n.host,a=n.secure,i=n.protocol;this.socket&&this.close();var l=a?"wss":"ws",u={address:s,family:l,port:o,size:0};this.socket=new oe("".concat(l,"://").concat(s,":").concat(o),i),this.socket.binaryType="arraybuffer",this.socketStatus=0,this.socket.onopen=function(){e.socketStatus=1,e.notify("open")},this.socket.onclose=function(){e.socketStatus=3,e.notify("close")},this.socket.onerror=function(t){e.notify("error",t)},this.socket.onmessage=function(t){e.notify(t.data,u)}}},{key:"close",value:function(){this.socketStatus=2,this.socket.close()}},{key:"send",value:function(e){this.socket.send(e)}}]),o}(re),de=function(e){i(o,e);var r=c(o);function o(e){throw n(this,o),r.call(this),new Error("WebsocketServerPlugin can not be used in browser context")}return s(o,[{key:"registerNotify",value:function(e){this.notify=e}},{key:"status",value:function(){return this.socketStatus}},{key:"open",value:function(){var e=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t(t({},this.options),r),o=n.port,s=n.host,a={address:s,family:"wsserver",port:o,size:0};this.socket&&this.close(),n.server?this.socket=new se({server:n.server}):this.socket=new se({host:s,port:o}),this.socket.binaryType="arraybuffer",this.socketStatus=0,this.socket.on("listening",(function(){e.socketStatus=1,e.notify("open")})),this.socket.on("error",(function(t){e.notify("error",t)})),this.socket.on("connection",(function(t){t.on("message",(function(t){e.notify(new Uint8Array(t),a)}))}))}},{key:"close",value:function(){var e=this;this.socketStatus=2,this.socket.close((function(){e.socketStatus=3,e.notify("close")}))}},{key:"send",value:function(e){this.socket.clients.forEach((function(t){t.send(e,{binary:!0})}))}}]),o}(re),he={discardLateMessages:!1,plugin:new ce},pe=function(){function e(r){if(n(this,e),r&&!v(r))throw new Error("OSC options argument has to be an object.");this.options=t(t({},he),r),this.eventHandler=new te({discardLateMessages:this.options.discardLateMessages});var o=this.eventHandler;this.options.plugin&&this.options.plugin.registerNotify&&this.options.plugin.registerNotify((function(){return o.notify.apply(o,arguments)}))}return s(e,[{key:"on",value:function(e,t){if(!f(e)||!b(t))throw new Error("OSC on() needs event- or address string and callback function");return this.eventHandler.on(e,t)}},{key:"off",value:function(e,t){if(!f(e)||!h(t))throw new Error("OSC off() needs string and number (subscriptionId) to unsubscribe");return this.eventHandler.off(e,t)}},{key:"open",value:function(e){if(e&&!v(e))throw new Error("OSC open() options argument needs to be an object");if(!this.options.plugin||!b(this.options.plugin.open))throw new Error("OSC Plugin API #open is not implemented!");return this.options.plugin.open(e)}},{key:"status",value:function(){if(!this.options.plugin||!b(this.options.plugin.status))throw new Error("OSC Plugin API #status is not implemented!");return this.options.plugin.status()}},{key:"close",value:function(){if(!this.options.plugin||!b(this.options.plugin.close))throw new Error("OSC Plugin API #close is not implemented!");return this.options.plugin.close()}},{key:"send",value:function(e,t){if(!this.options.plugin||!b(this.options.plugin.send))throw new Error("OSC Plugin API #send is not implemented!");if(!(e instanceof Y||e instanceof K||e instanceof Q||e instanceof J))throw new Error("OSC send() needs Messages, Bundles or Packets");if(t&&!v(t))throw new Error("OSC send() options argument has to be an object");return this.options.plugin.send(e.pack(),t)}}]),e}();return pe.STATUS={IS_NOT_INITIALIZED:-1,IS_CONNECTING:0,IS_OPEN:1,IS_CLOSING:2,IS_CLOSED:3},pe.Packet=J,pe.Bundle=Q,pe.Message=K,pe.TypedMessage=Y,pe.Plugin=re,pe.DatagramPlugin=ne,pe.WebsocketClientPlugin=ce,pe.WebsocketServerPlugin=de,pe.BridgePlugin=le,pe}()},35:(t,r,n)=>{!function(e){t.exports=e()}((function(){return function e(t,r,n){function o(a,i){if(!r[a]){if(!t[a]){var l=void 0;if(!i&&l)return require(a,!0);if(s)return s(a,!0);throw(i=new Error("Cannot find module '"+a+"'")).code="MODULE_NOT_FOUND",i}l=r[a]={exports:{}},t[a][0].call(l.exports,(function(e){return o(t[a][1][e]||e)}),l,l.exports,e,t,r,n)}return r[a].exports}for(var s=void 0,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(e,t,r){"use strict";r.byteLength=function(e){return 3*((e=l(e))[0]+(e=e[1]))/4-e},r.toByteArray=function(e){var t,r,n=(a=l(e))[0],a=a[1],i=new s(function(e,t){return 3*(e+t)/4-t}(n,a)),u=0,c=0<a?n-4:n;for(r=0;r<c;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],i[u++]=t>>16&255,i[u++]=t>>8&255,i[u++]=255&t;return 2===a&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,i[u++]=255&t),1===a&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,i[u++]=t>>8&255,i[u++]=255&t),i},r.fromByteArray=function(e){for(var t,r=e.length,o=r%3,s=[],a=0,i=r-o;a<i;a+=16383)s.push(function(e,t,r){for(var o,s=[],a=t;a<r;a+=3)o=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(function(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}(o));return s.join("")}(e,a,i<a+16383?i:a+16383));return 1==o?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2==o&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),s.join("")};for(var n=[],o=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0;i<64;++i)n[i]=a[i],o[a.charCodeAt(i)]=i;function l(e){var t=e.length;if(0<t%4)throw new Error("Invalid string. Length must be a multiple of 4");return t=(e=-1===(e=e.indexOf("="))?t:e)===t?0:4-e%4,[e,t]}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],2:[function(e,t,r){},{}],3:[function(e,t,r){arguments[4][2][0].apply(r,arguments)},{dup:2}],4:[function(e,t,r){(function(t){"use strict";var n=e("base64-js"),o=e("ieee754"),s="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null,a=(r.Buffer=t,r.SlowBuffer=function(e){return+e!=e&&(e=0),t.alloc(+e)},r.INSPECT_MAX_BYTES=50,2147483647);function i(e){if(a<e)throw new RangeError('The value "'+e+'" is invalid for option "size"');return e=new Uint8Array(e),Object.setPrototypeOf(e,t.prototype),e}function t(e,t,r){if("number"!=typeof e)return l(e,t,r);if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}function l(e,r,n){if("string"==typeof e){var o=e,s=r;if(t.isEncoding(s="string"==typeof s&&""!==s?s:"utf8"))return(o=(l=i(a=0|p(o,s))).write(o,s))!==a?l.slice(0,o):l;throw new TypeError("Unknown encoding: "+s)}if(ArrayBuffer.isView(e))return d(e);if(null!=e){if(A(e,ArrayBuffer)||e&&A(e.buffer,ArrayBuffer)){var a=e,l=n;if((o=r)<0||a.byteLength<o)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<o+(l||0))throw new RangeError('"length" is outside of buffer bounds');return a=void 0===o&&void 0===l?new Uint8Array(a):void 0===l?new Uint8Array(a,o):new Uint8Array(a,o,l),Object.setPrototypeOf(a,t.prototype),a}if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');if(null!=(s=e.valueOf&&e.valueOf())&&s!==e)return t.from(s,r,n);var u=function(e){var r,n;return t.isBuffer(e)?(0!==(n=i(r=0|h(e.length))).length&&e.copy(n,0,0,r),n):void 0!==e.length?"number"!=typeof e.length||R(e.length)?i(0):d(e):"Buffer"===e.type&&Array.isArray(e.data)?d(e.data):void 0}(e);if(u)return u;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return t.from(e[Symbol.toPrimitive]("string"),r,n)}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return u(e),i(e<0?0:0|h(e))}function d(e){for(var t=e.length<0?0:0|h(e.length),r=i(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function h(e){if(a<=e)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function p(e,r){if(t.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||A(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,o=2<arguments.length&&!0===arguments[2];if(!o&&0===n)return 0;for(var s=!1;;)switch(r){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return C(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return I(e).length;default:if(s)return o?-1:C(e).length;r=(""+r).toLowerCase(),s=!0}}function f(e,t,r){var o,s=!1;if((t=void 0===t||t<0?0:t)>this.length)return"";if((r=void 0===r||r>this.length?this.length:r)<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e=e||"utf8";;)switch(e){case"hex":var a=t,i=r,l=this.length;(!i||i<0||l<i)&&(i=l);for(var u="",c=a=!a||a<0?0:a;c<i;++c)u+=N[this[c]];return u;case"utf8":case"utf-8":return x(this,t,r);case"ascii":l=t;var d=r,h="";d=Math.min(this.length,d);for(var p=l;p<d;++p)h+=String.fromCharCode(127&this[p]);return h;case"latin1":case"binary":a=t;var f=r,m="";f=Math.min(this.length,f);for(var y=a;y<f;++y)m+=String.fromCharCode(this[y]);return m;case"base64":return g=this,o=r,0===(v=t)&&o===g.length?n.fromByteArray(g):n.fromByteArray(g.slice(v,o));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(var g=t,v=r,b=this.slice(g,v),w="",_=0;_<b.length;_+=2)w+=String.fromCharCode(b[_]+256*b[_+1]);return w;default:if(s)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),s=!0}}function m(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function y(e,r,n,o,s){if(0===e.length)return-1;if("string"==typeof n?(o=n,n=0):2147483647<n?n=2147483647:n<-2147483648&&(n=-2147483648),(n=(n=R(n=+n)?s?0:e.length-1:n)<0?e.length+n:n)>=e.length){if(s)return-1;n=e.length-1}else if(n<0){if(!s)return-1;n=0}if("string"==typeof r&&(r=t.from(r,o)),t.isBuffer(r))return 0===r.length?-1:g(e,r,n,o,s);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?(s?Uint8Array.prototype.indexOf:Uint8Array.prototype.lastIndexOf).call(e,r,n):g(e,[r],n,o,s);throw new TypeError("val must be string, number or Buffer")}function g(e,t,r,n,o){var s=1,a=e.length,i=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a/=s=2,i/=2,r/=2}function l(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(o)for(var u=-1,c=r;c<a;c++)if(l(e,c)===l(t,-1===u?0:c-u)){if(c-(u=-1===u?c:u)+1===i)return u*s}else-1!==u&&(c-=c-u),u=-1;else for(c=r=a<r+i?a-i:r;0<=c;c--){for(var d=!0,h=0;h<i;h++)if(l(e,c+h)!==l(t,h)){d=!1;break}if(d)return c}return-1}function v(e,t,r,n){return O(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function b(e,t,r,n){return O(function(e,t){for(var r,n,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=(n=e.charCodeAt(s))>>8,n%=256,o.push(n),o.push(r);return o}(t,e.length-r),e,r,n)}function x(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var s,a,i,l,u=e[o],c=null,d=239<u?4:223<u?3:191<u?2:1;if(o+d<=r)switch(d){case 1:u<128&&(c=u);break;case 2:128==(192&(s=e[o+1]))&&127<(l=(31&u)<<6|63&s)&&(c=l);break;case 3:s=e[o+1],a=e[o+2],128==(192&s)&&128==(192&a)&&2047<(l=(15&u)<<12|(63&s)<<6|63&a)&&(l<55296||57343<l)&&(c=l);break;case 4:s=e[o+1],a=e[o+2],i=e[o+3],128==(192&s)&&128==(192&a)&&128==(192&i)&&65535<(l=(15&u)<<18|(63&s)<<12|(63&a)<<6|63&i)&&l<1114112&&(c=l)}null===c?(c=65533,d=1):65535<c&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),o+=d}var h=n,p=h.length;if(p<=w)return String.fromCharCode.apply(String,h);for(var f="",m=0;m<p;)f+=String.fromCharCode.apply(String,h.slice(m,m+=w));return f}r.kMaxLength=a,(t.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}())||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(t.prototype,"parent",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.buffer}}),Object.defineProperty(t.prototype,"offset",{enumerable:!0,get:function(){if(t.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&t[Symbol.species]===t&&Object.defineProperty(t,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),t.poolSize=8192,t.from=l,Object.setPrototypeOf(t.prototype,Uint8Array.prototype),Object.setPrototypeOf(t,Uint8Array),t.alloc=function(e,t,r){return u(e),e<=0||void 0===t?i(e):"string"==typeof r?i(e).fill(t,r):i(e).fill(t)},t.allocUnsafe=c,t.allocUnsafeSlow=c,t.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==t.prototype},t.compare=function(e,r){if(A(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),A(r,Uint8Array)&&(r=t.from(r,r.offset,r.byteLength)),!t.isBuffer(e)||!t.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,o=r.length,s=0,a=Math.min(n,o);s<a;++s)if(e[s]!==r[s]){n=e[s],o=r[s];break}return n<o?-1:o<n?1:0},t.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},t.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return t.alloc(0);if(void 0===r)for(s=r=0;s<e.length;++s)r+=e[s].length;for(var n=t.allocUnsafe(r),o=0,s=0;s<e.length;++s){var a=e[s];if(A(a,Uint8Array)&&(a=t.from(a)),!t.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,o),o+=a.length}return n},t.byteLength=p,t.prototype._isBuffer=!0,t.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},t.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},t.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},t.prototype.toLocaleString=t.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?x(this,0,e):f.apply(this,arguments)},t.prototype.equals=function(e){if(t.isBuffer(e))return this===e||0===t.compare(this,e);throw new TypeError("Argument must be a Buffer")},t.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},s&&(t.prototype[s]=t.prototype.inspect),t.prototype.compare=function(e,r,n,o,s){if(A(e,Uint8Array)&&(e=t.from(e,e.offset,e.byteLength)),!t.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===s&&(s=this.length),(r=void 0===r?0:r)<0||n>e.length||o<0||s>this.length)throw new RangeError("out of range index");if(s<=o&&n<=r)return 0;if(s<=o)return-1;if(n<=r)return 1;if(this===e)return 0;for(var a=(s>>>=0)-(o>>>=0),i=(n>>>=0)-(r>>>=0),l=Math.min(a,i),u=this.slice(o,s),c=e.slice(r,n),d=0;d<l;++d)if(u[d]!==c[d]){a=u[d],i=c[d];break}return a<i?-1:i<a?1:0},t.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},t.prototype.indexOf=function(e,t,r){return y(this,e,t,r,!0)},t.prototype.lastIndexOf=function(e,t,r){return y(this,e,t,r,!1)},t.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||o<r)&&(r=o),0<e.length&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n=n||"utf8";for(var s,a,i,l=!1;;)switch(n){case"hex":var u=e,c=t,d=r,h=(c=Number(c)||0,this.length-c);(!d||h<(d=Number(d)))&&(d=h),(h=u.length)/2<d&&(d=h/2);for(var p=0;p<d;++p){var f=parseInt(u.substr(2*p,2),16);if(R(f))return p;this[c+p]=f}return p;case"utf8":case"utf-8":return h=t,i=r,O(C(e,(a=this).length-h),a,h,i);case"ascii":case"latin1":case"binary":return v(this,e,t,r);case"base64":return a=this,i=t,s=r,O(I(e),a,i,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return b(this,e,t,r);default:if(l)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),l=!0}},t.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var w=4096;function _(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(r<e+t)throw new RangeError("Trying to access beyond buffer length")}function S(e,r,n,o,s,a){if(!t.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(s<r||r<a)throw new RangeError('"value" argument is out of bounds');if(n+o>e.length)throw new RangeError("Index out of range")}function k(e,t,r,n){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function T(e,t,r,n,s){return t=+t,r>>>=0,s||k(e,0,r,4),o.write(e,t,r,n,23,4),r+4}function E(e,t,r,n,s){return t=+t,r>>>=0,s||k(e,0,r,8),o.write(e,t,r,n,52,8),r+8}t.prototype.slice=function(e,r){var n=this.length;return(e=~~e)<0?(e+=n)<0&&(e=0):n<e&&(e=n),(r=void 0===r?n:~~r)<0?(r+=n)<0&&(r=0):n<r&&(r=n),r<e&&(r=e),n=this.subarray(e,r),Object.setPrototypeOf(n,t.prototype),n},t.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return n},t.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var n=this[e+--t],o=1;0<t&&(o*=256);)n+=this[e+--t]*o;return n},t.prototype.readUInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),this[e]},t.prototype.readUInt16LE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]|this[e+1]<<8},t.prototype.readUInt16BE=function(e,t){return e>>>=0,t||_(e,2,this.length),this[e]<<8|this[e+1]},t.prototype.readUInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},t.prototype.readUInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},t.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var n=this[e],o=1,s=0;++s<t&&(o*=256);)n+=this[e+s]*o;return(o*=128)<=n&&(n-=Math.pow(2,8*t)),n},t.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||_(e,t,this.length);for(var n=t,o=1,s=this[e+--n];0<n&&(o*=256);)s+=this[e+--n]*o;return(o*=128)<=s&&(s-=Math.pow(2,8*t)),s},t.prototype.readInt8=function(e,t){return e>>>=0,t||_(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},t.prototype.readInt16LE=function(e,t){return e>>>=0,t||_(e,2,this.length),32768&(t=this[e]|this[e+1]<<8)?4294901760|t:t},t.prototype.readInt16BE=function(e,t){return e>>>=0,t||_(e,2,this.length),32768&(t=this[e+1]|this[e]<<8)?4294901760|t:t},t.prototype.readInt32LE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},t.prototype.readInt32BE=function(e,t){return e>>>=0,t||_(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},t.prototype.readFloatLE=function(e,t){return e>>>=0,t||_(e,4,this.length),o.read(this,e,!0,23,4)},t.prototype.readFloatBE=function(e,t){return e>>>=0,t||_(e,4,this.length),o.read(this,e,!1,23,4)},t.prototype.readDoubleLE=function(e,t){return e>>>=0,t||_(e,8,this.length),o.read(this,e,!0,52,8)},t.prototype.readDoubleBE=function(e,t){return e>>>=0,t||_(e,8,this.length),o.read(this,e,!1,52,8)},t.prototype.writeUIntLE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||S(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,s=0;for(this[t]=255&e;++s<r&&(o*=256);)this[t+s]=e/o&255;return t+r},t.prototype.writeUIntBE=function(e,t,r,n){e=+e,t>>>=0,r>>>=0,n||S(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,s=1;for(this[t+o]=255&e;0<=--o&&(s*=256);)this[t+o]=e/s&255;return t+r},t.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,1,255,0),this[t]=255&e,t+1},t.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},t.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeIntLE=function(e,t,r,n){e=+e,t>>>=0,n||S(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},t.prototype.writeIntBE=function(e,t,r,n){e=+e,t>>>=0,n||S(this,e,t,r,(n=Math.pow(2,8*r-1))-1,-n);var o=r-1,s=1,a=0;for(this[t+o]=255&e;0<=--o&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},t.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,1,127,-128),this[t]=255&(e=e<0?255+e+1:e),t+1},t.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},t.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},t.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},t.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||S(this,e,t,4,2147483647,-2147483648),this[t]=(e=e<0?4294967295+e+1:e)>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},t.prototype.writeFloatLE=function(e,t,r){return T(this,e,t,!0,r)},t.prototype.writeFloatBE=function(e,t,r){return T(this,e,t,!1,r)},t.prototype.writeDoubleLE=function(e,t,r){return E(this,e,t,!0,r)},t.prototype.writeDoubleBE=function(e,t,r){return E(this,e,t,!1,r)},t.prototype.copy=function(e,r,n,o){if(!t.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n=n||0,o||0===o||(o=this.length),r>=e.length&&(r=e.length),(o=0<o&&o<n?n:o)===n)return 0;if(0===e.length||0===this.length)return 0;if((r=r||0)<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length);var s=(o=e.length-r<o-n?e.length-r+n:o)-n;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(r,n,o);else if(this===e&&n<r&&r<o)for(var a=s-1;0<=a;--a)e[a+r]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,o),r);return s},t.prototype.fill=function(e,r,n,o){if("string"==typeof e){if("string"==typeof r?(o=r,r=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!t.isEncoding(o))throw new TypeError("Unknown encoding: "+o);var s;1===e.length&&(s=e.charCodeAt(0),("utf8"===o&&s<128||"latin1"===o)&&(e=s))}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");var a;if(!(n<=r))if(r>>>=0,n=void 0===n?this.length:n>>>0,"number"==typeof(e=e||0))for(a=r;a<n;++a)this[a]=e;else{var i=t.isBuffer(e)?e:t.from(e,o),l=i.length;if(0===l)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<n-r;++a)this[a+r]=i[a%l]}return this};var j=/[^+/0-9A-Za-z-_]/g;function C(e,t){t=t||1/0;for(var r,n=e.length,o=null,s=[],a=0;a<n;++a){if(55295<(r=e.charCodeAt(a))&&r<57344){if(!o){if(56319<r){-1<(t-=3)&&s.push(239,191,189);continue}if(a+1===n){-1<(t-=3)&&s.push(239,191,189);continue}o=r;continue}if(r<56320){-1<(t-=3)&&s.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&-1<(t-=3)&&s.push(239,191,189);if(o=null,r<128){if(--t<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function I(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function O(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function A(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function R(e){return e!=e}var N=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,o=0;o<16;++o)t[n+o]=e[r]+e[o];return t}()}).call(this,e("buffer").Buffer)},{"base64-js":1,buffer:4,ieee754:244}],5:[function(e,t,r){t.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},{}],6:[function(e,t,r){var n=e("../internals/is-object");t.exports=function(e){if(n(e)||null===e)return e;throw TypeError("Can't set "+String(e)+" as a prototype")}},{"../internals/is-object":74}],7:[function(e,t,r){var n=e("../internals/well-known-symbol"),o=e("../internals/object-create"),s=(e=e("../internals/object-define-property"),n("unscopables")),a=Array.prototype;null==a[s]&&e.f(a,s,{configurable:!0,value:o(null)}),t.exports=function(e){a[s][e]=!0}},{"../internals/object-create":90,"../internals/object-define-property":92,"../internals/well-known-symbol":148}],8:[function(e,t,r){"use strict";var n=e("../internals/string-multibyte").charAt;t.exports=function(e,t,r){return t+(r?n(e,t).length:1)}},{"../internals/string-multibyte":123}],9:[function(e,t,r){t.exports=function(e,t,r){if(e instanceof t)return e;throw TypeError("Incorrect "+(r?r+" ":"")+"invocation")}},{}],10:[function(e,t,r){var n=e("../internals/is-object");t.exports=function(e){if(n(e))return e;throw TypeError(String(e)+" is not an object")}},{"../internals/is-object":74}],11:[function(e,t,r){t.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},{}],12:[function(e,t,r){"use strict";function n(e){return l(e)&&u(E,c(e))}var o,s=e("../internals/array-buffer-native"),a=e("../internals/descriptors"),i=e("../internals/global"),l=e("../internals/is-object"),u=e("../internals/has"),c=e("../internals/classof"),d=e("../internals/create-non-enumerable-property"),h=e("../internals/redefine"),p=e("../internals/object-define-property").f,f=e("../internals/object-get-prototype-of"),m=e("../internals/object-set-prototype-of"),y=e("../internals/well-known-symbol"),g=(e=e("../internals/uid"),i.Int8Array),v=g&&g.prototype,b=(b=i.Uint8ClampedArray)&&b.prototype,x=g&&f(g),w=v&&f(v),_=Object.prototype,S=_.isPrototypeOf,k=(y=y("toStringTag"),e("TYPED_ARRAY_TAG")),T=s&&!!m&&"Opera"!==c(i.opera),E=(e=!1,{Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8});for(o in E)i[o]||(T=!1);if((!T||"function"!=typeof x||x===Function.prototype)&&(x=function(){throw TypeError("Incorrect invocation")},T))for(o in E)i[o]&&m(i[o],x);if((!T||!w||w===_)&&(w=x.prototype,T))for(o in E)i[o]&&m(i[o].prototype,w);if(T&&f(b)!==w&&m(b,w),a&&!u(w,y))for(o in e=!0,p(w,y,{get:function(){return l(this)?this[k]:void 0}}),E)i[o]&&d(i[o],k,o);t.exports={NATIVE_ARRAY_BUFFER_VIEWS:T,TYPED_ARRAY_TAG:e&&k,aTypedArray:function(e){if(n(e))return e;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(e){if(m){if(S.call(x,e))return e}else for(var t in E)if(u(E,o)&&(t=i[t])&&(e===t||S.call(t,e)))return e;throw TypeError("Target is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r){if(a){if(r)for(var n in E)(n=i[n])&&u(n.prototype,e)&&delete n.prototype[e];w[e]&&!r||h(w,e,!r&&T&&v[e]||t)}},exportTypedArrayStaticMethod:function(e,t,r){var n,o;if(a){if(m){if(r)for(n in E)(o=i[n])&&u(o,e)&&delete o[e];if(x[e]&&!r)return;try{return h(x,e,!r&&T&&g[e]||t)}catch(e){}}for(n in E)!(o=i[n])||o[e]&&!r||h(o,e,t)}},isView:function(e){return"DataView"===(e=c(e))||u(E,e)},isTypedArray:n,TypedArray:x,TypedArrayPrototype:w}},{"../internals/array-buffer-native":11,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/global":59,"../internals/has":60,"../internals/is-object":74,"../internals/object-define-property":92,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine":108,"../internals/uid":145,"../internals/well-known-symbol":148}],13:[function(e,t,r){"use strict";function n(e){return[255&e]}function o(e){return[255&e,e>>8&255]}function s(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function a(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function i(e){return B(e,23,4)}function l(e){return B(e,52,8)}function u(e,t){E(e[N],t,{get:function(){return I(this)[t]}})}function c(e,t,r,n){if((r=w(r))+t>(e=I(e)).byteLength)throw $(M);var o=I(e.buffer).bytes;return r+=e.byteOffset,e=o.slice(r,r+t),n?e:e.reverse()}function d(e,t,r,n,o,s){if((r=w(r))+t>(e=I(e)).byteLength)throw $(M);for(var a=I(e.buffer).bytes,i=r+e.byteOffset,l=n(+o),u=0;u<t;u++)a[i+u]=l[s?u:t-u-1]}var h=e("../internals/global"),p=e("../internals/descriptors"),f=e("../internals/array-buffer-native"),m=e("../internals/create-non-enumerable-property"),y=e("../internals/redefine-all"),g=e("../internals/fails"),v=e("../internals/an-instance"),b=e("../internals/to-integer"),x=e("../internals/to-length"),w=e("../internals/to-index"),_=e("../internals/ieee754"),S=e("../internals/object-get-prototype-of"),k=e("../internals/object-set-prototype-of"),T=e("../internals/object-get-own-property-names").f,E=e("../internals/object-define-property").f,j=e("../internals/array-fill"),C=e("../internals/set-to-string-tag"),I=(e=e("../internals/internal-state")).get,O=e.set,A="ArrayBuffer",R="DataView",N="prototype",M="Wrong index",P=h[A],L=P,D=h[R],F=(e=D&&D[N],Object.prototype),$=h.RangeError,B=_.pack,U=_.unpack;if(f){if(!g((function(){P(1)}))||!g((function(){new P(-1)}))||g((function(){return new P,new P(1.5),new P(NaN),P.name!=A}))){h=(L=function(e){return v(this,L),new P(w(e))})[N]=P[N];for(var V,G=T(P),z=0;G.length>z;)(V=G[z++])in L||m(L,V,P[V]);h.constructor=L}k&&S(e)!==F&&k(e,F),_=new D(new L(2));var W=e.setInt8;_.setInt8(0,2147483648),_.setInt8(1,2147483649),!_.getInt8(0)&&_.getInt8(1)||y(e,{setInt8:function(e,t){W.call(this,e,t<<24>>24)},setUint8:function(e,t){W.call(this,e,t<<24>>24)}},{unsafe:!0})}else L=function(e){v(this,L,A),e=w(e),O(this,{bytes:j.call(new Array(e),0),byteLength:e}),p||(this.byteLength=e)},D=function(e,t,r){v(this,D,R),v(e,L,R);var n=I(e).byteLength;if((t=b(t))<0||n<t)throw $("Wrong offset");if(n<t+(r=void 0===r?n-t:x(r)))throw $("Wrong length");O(this,{buffer:e,byteLength:r,byteOffset:t}),p||(this.buffer=e,this.byteLength=r,this.byteOffset=t)},p&&(u(L,"byteLength"),u(D,"buffer"),u(D,"byteLength"),u(D,"byteOffset")),y(D[N],{getInt8:function(e){return c(this,1,e)[0]<<24>>24},getUint8:function(e){return c(this,1,e)[0]},getInt16:function(e){return((e=c(this,2,e,1<arguments.length?arguments[1]:void 0))[1]<<8|e[0])<<16>>16},getUint16:function(e){return(e=c(this,2,e,1<arguments.length?arguments[1]:void 0))[1]<<8|e[0]},getInt32:function(e){return a(c(this,4,e,1<arguments.length?arguments[1]:void 0))},getUint32:function(e){return a(c(this,4,e,1<arguments.length?arguments[1]:void 0))>>>0},getFloat32:function(e){return U(c(this,4,e,1<arguments.length?arguments[1]:void 0),23)},getFloat64:function(e){return U(c(this,8,e,1<arguments.length?arguments[1]:void 0),52)},setInt8:function(e,t){d(this,1,e,n,t)},setUint8:function(e,t){d(this,1,e,n,t)},setInt16:function(e,t){d(this,2,e,o,t,2<arguments.length?arguments[2]:void 0)},setUint16:function(e,t){d(this,2,e,o,t,2<arguments.length?arguments[2]:void 0)},setInt32:function(e,t){d(this,4,e,s,t,2<arguments.length?arguments[2]:void 0)},setUint32:function(e,t){d(this,4,e,s,t,2<arguments.length?arguments[2]:void 0)},setFloat32:function(e,t){d(this,4,e,i,t,2<arguments.length?arguments[2]:void 0)},setFloat64:function(e,t){d(this,8,e,l,t,2<arguments.length?arguments[2]:void 0)}});C(L,A),C(D,R),t.exports={ArrayBuffer:L,DataView:D}},{"../internals/an-instance":9,"../internals/array-buffer-native":11,"../internals/array-fill":15,"../internals/create-non-enumerable-property":38,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":59,"../internals/ieee754":65,"../internals/internal-state":70,"../internals/object-define-property":92,"../internals/object-get-own-property-names":95,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine-all":107,"../internals/set-to-string-tag":117,"../internals/to-index":133,"../internals/to-integer":135,"../internals/to-length":136}],14:[function(e,t,r){"use strict";var n=e("../internals/to-object"),o=e("../internals/to-absolute-index"),s=e("../internals/to-length"),a=Math.min;t.exports=[].copyWithin||function(e,t){var r=n(this),i=s(r.length),l=o(e,i),u=o(t,i),c=a((void 0===(e=2<arguments.length?arguments[2]:void 0)?i:o(e,i))-u,i-l),d=1;for(u<l&&l<u+c&&(d=-1,u+=c-1,l+=c-1);0<c--;)u in r?r[l]=r[u]:delete r[l],l+=d,u+=d;return r}},{"../internals/to-absolute-index":132,"../internals/to-length":136,"../internals/to-object":137}],15:[function(e,t,r){"use strict";var n=e("../internals/to-object"),o=e("../internals/to-absolute-index"),s=e("../internals/to-length");t.exports=function(e){for(var t,r=n(this),a=s(r.length),i=o(1<(t=arguments.length)?arguments[1]:void 0,a),l=void 0===(t=2<t?arguments[2]:void 0)?a:o(t,a);i<l;)r[i++]=e;return r}},{"../internals/to-absolute-index":132,"../internals/to-length":136,"../internals/to-object":137}],16:[function(e,t,r){"use strict";var n=e("../internals/array-iteration").forEach,o=e("../internals/array-method-is-strict");e=e("../internals/array-method-uses-to-length"),o=o("forEach"),e=e("forEach"),t.exports=o&&e?[].forEach:function(e){return n(this,e,1<arguments.length?arguments[1]:void 0)}},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23}],17:[function(e,t,r){"use strict";var n=e("../internals/function-bind-context"),o=e("../internals/to-object"),s=e("../internals/call-with-safe-iteration-closing"),a=e("../internals/is-array-iterator-method"),i=e("../internals/to-length"),l=e("../internals/create-property"),u=e("../internals/get-iterator-method");t.exports=function(e){var t,r,c,d,h,p,f=o(e),m=(e="function"==typeof this?this:Array,arguments.length),y=1<m?arguments[1]:void 0,g=void 0!==y,v=u(f),b=0;if(g&&(y=n(y,2<m?arguments[2]:void 0,2)),null==v||e==Array&&a(v))for(r=new e(t=i(f.length));b<t;b++)p=g?y(f[b],b):f[b],l(r,b,p);else for(h=(d=v.call(f)).next,r=new e;!(c=h.call(d)).done;b++)p=g?s(d,y,[c.value,b],!0):c.value,l(r,b,p);return r.length=b,r}},{"../internals/call-with-safe-iteration-closing":26,"../internals/create-property":40,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":136,"../internals/to-object":137}],18:[function(e,t,r){function n(e){return function(t,r,n){var i,l=o(t),u=s(l.length),c=a(n,u);if(e&&r!=r){for(;c<u;)if((i=l[c++])!=i)return!0}else for(;c<u;c++)if((e||c in l)&&l[c]===r)return e||c||0;return!e&&-1}}var o=e("../internals/to-indexed-object"),s=e("../internals/to-length"),a=e("../internals/to-absolute-index");t.exports={includes:n(!0),indexOf:n(!1)}},{"../internals/to-absolute-index":132,"../internals/to-indexed-object":134,"../internals/to-length":136}],19:[function(e,t,r){function n(e){var t=1==e,r=2==e,n=3==e,c=4==e,d=6==e,h=5==e||d;return function(p,f,m,y){for(var g,v,b=a(p),x=s(b),w=o(f,m,3),_=i(x.length),S=0,k=(f=y||l,t?f(p,_):r?f(p,0):void 0);S<_;S++)if((h||S in x)&&(v=w(g=x[S],S,b),e))if(t)k[S]=v;else if(v)switch(e){case 3:return!0;case 5:return g;case 6:return S;case 2:u.call(k,g)}else if(c)return!1;return d?-1:n||c?c:k}}var o=e("../internals/function-bind-context"),s=e("../internals/indexed-object"),a=e("../internals/to-object"),i=e("../internals/to-length"),l=e("../internals/array-species-create"),u=[].push;t.exports={forEach:n(0),map:n(1),filter:n(2),some:n(3),every:n(4),find:n(5),findIndex:n(6)}},{"../internals/array-species-create":25,"../internals/function-bind-context":54,"../internals/indexed-object":66,"../internals/to-length":136,"../internals/to-object":137}],20:[function(e,t,r){"use strict";var n=e("../internals/to-indexed-object"),o=e("../internals/to-integer"),s=e("../internals/to-length"),a=e("../internals/array-method-is-strict"),i=(e=e("../internals/array-method-uses-to-length"),Math.min),l=[].lastIndexOf,u=!!l&&1/[1].lastIndexOf(1,-0)<0;a=a("lastIndexOf"),e=e("indexOf",{ACCESSORS:!0,1:0}),t.exports=!u&&a&&e?l:function(e){if(u)return l.apply(this,arguments)||0;var t=n(this),r=s(t.length),a=r-1;for((a=1<arguments.length?i(a,o(arguments[1])):a)<0&&(a=r+a);0<=a;a--)if(a in t&&t[a]===e)return a||0;return-1}},{"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/to-indexed-object":134,"../internals/to-integer":135,"../internals/to-length":136}],21:[function(e,t,r){var n=e("../internals/fails"),o=e("../internals/well-known-symbol"),s=e("../internals/engine-v8-version"),a=o("species");t.exports=function(e){return 51<=s||!n((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},{"../internals/engine-v8-version":48,"../internals/fails":51,"../internals/well-known-symbol":148}],22:[function(e,t,r){"use strict";var n=e("../internals/fails");t.exports=function(e,t){var r=[][e];return!!r&&n((function(){r.call(null,t||function(){throw 1},1)}))}},{"../internals/fails":51}],23:[function(e,t,r){function n(e){throw e}var o=e("../internals/descriptors"),s=e("../internals/fails"),a=e("../internals/has"),i=Object.defineProperty,l={};t.exports=function(e,t){var r,u,c,d;return a(l,e)?l[e]:(r=[][e],u=!!a(t=t||{},"ACCESSORS")&&t.ACCESSORS,c=a(t,0)?t[0]:n,d=a(t,1)?t[1]:void 0,l[e]=!!r&&!s((function(){if(u&&!o)return!0;var e={length:-1};u?i(e,1,{enumerable:!0,get:n}):e[1]=1,r.call(e,c,d)})))}},{"../internals/descriptors":43,"../internals/fails":51,"../internals/has":60}],24:[function(e,t,r){function n(e){return function(t,r,n,l){o(r);var u=s(t),c=a(u),d=i(u.length),h=e?d-1:0,p=e?-1:1;if(n<2)for(;;){if(h in c){l=c[h],h+=p;break}if(h+=p,e?h<0:d<=h)throw TypeError("Reduce of empty array with no initial value")}for(;e?0<=h:h<d;h+=p)h in c&&(l=r(l,c[h],h,u));return l}}var o=e("../internals/a-function"),s=e("../internals/to-object"),a=e("../internals/indexed-object"),i=e("../internals/to-length");t.exports={left:n(!1),right:n(!0)}},{"../internals/a-function":5,"../internals/indexed-object":66,"../internals/to-length":136,"../internals/to-object":137}],25:[function(e,t,r){var n=e("../internals/is-object"),o=e("../internals/is-array"),s=e("../internals/well-known-symbol")("species");t.exports=function(e,t){var r;return new(void 0===(r=o(e)&&("function"==typeof(r=e.constructor)&&(r===Array||o(r.prototype))||n(r)&&null===(r=r[s]))?void 0:r)?Array:r)(0===t?0:t)}},{"../internals/is-array":72,"../internals/is-object":74,"../internals/well-known-symbol":148}],26:[function(e,t,r){var n=e("../internals/an-object");t.exports=function(e,t,r,o){try{return o?t(n(r)[0],r[1]):t(r)}catch(t){throw void 0!==(o=e.return)&&n(o.call(e)),t}}},{"../internals/an-object":10}],27:[function(e,t,r){var n=e("../internals/well-known-symbol")("iterator"),o=!1;try{var s=0,a={next:function(){return{done:!!s++}},return:function(){o=!0}};a[n]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}t.exports=function(e,t){if(!t&&!o)return!1;var r=!1;try{var s={};s[n]=function(){return{next:function(){return{done:r=!0}}}},e(s)}catch(e){}return r}},{"../internals/well-known-symbol":148}],28:[function(e,t,r){var n={}.toString;t.exports=function(e){return n.call(e).slice(8,-1)}},{}],29:[function(e,t,r){var n=e("../internals/to-string-tag-support"),o=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("toStringTag"),a="Arguments"==o(function(){return arguments}());t.exports=n?o:function(e){var t;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(t=function(e,t){try{return e[t]}catch(e){}}(e=Object(e),s))?t:a?o(e):"Object"==(t=o(e))&&"function"==typeof e.callee?"Arguments":t}},{"../internals/classof-raw":28,"../internals/to-string-tag-support":141,"../internals/well-known-symbol":148}],30:[function(e,t,r){"use strict";var n=e("../internals/object-define-property").f,o=e("../internals/object-create"),s=e("../internals/redefine-all"),a=e("../internals/function-bind-context"),i=e("../internals/an-instance"),l=e("../internals/iterate"),u=e("../internals/define-iterator"),c=e("../internals/set-species"),d=e("../internals/descriptors"),h=e("../internals/internal-metadata").fastKey,p=(e=e("../internals/internal-state")).set,f=e.getterFor;t.exports={getConstructor:function(e,t,r,u){function c(e,t,r){var n,o=g(e),s=m(e,t);return s?s.value=r:(o.last=s={index:n=h(t,!0),key:t,value:r,previous:t=o.last,next:void 0,removed:!1},o.first||(o.first=s),t&&(t.next=s),d?o.size++:e.size++,"F"!==n&&(o.index[n]=s)),e}function m(e,t){e=g(e);var r,n=h(t);if("F"!==n)return e.index[n];for(r=e.first;r;r=r.next)if(r.key==t)return r}var y=e((function(e,n){i(e,y,t),p(e,{type:t,index:o(null),first:void 0,last:void 0,size:0}),d||(e.size=0),null!=n&&l(n,e[u],e,r)})),g=f(t);return s(y.prototype,{clear:function(){for(var e=g(this),t=e.index,r=e.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete t[r.index],r=r.next;e.first=e.last=void 0,d?e.size=0:this.size=0},delete:function(e){var t,r,n=g(this);return(e=m(this,e))&&(t=e.next,r=e.previous,delete n.index[e.index],e.removed=!0,r&&(r.next=t),t&&(t.previous=r),n.first==e&&(n.first=t),n.last==e&&(n.last=r),d?n.size--:this.size--),!!e},forEach:function(e){for(var t,r=g(this),n=a(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.next:r.first;)for(n(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!m(this,e)}}),s(y.prototype,r?{get:function(e){return(e=m(this,e))&&e.value},set:function(e,t){return c(this,0===e?0:e,t)}}:{add:function(e){return c(this,e=0===e?0:e,e)}}),d&&n(y.prototype,"size",{get:function(){return g(this).size}}),y},setStrong:function(e,t,r){var n=t+" Iterator",o=f(t),s=f(n);u(e,t,(function(e,t){p(this,{type:n,target:e,state:o(e),kind:t,last:void 0})}),(function(){for(var e=s(this),t=e.kind,r=e.last;r&&r.removed;)r=r.previous;return e.target&&(e.last=r=r?r.next:e.state.first)?"keys"==t?{value:r.key,done:!1}:"values"==t?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:{value:e.target=void 0,done:!0}}),r?"entries":"values",!r,!0),c(t)}}},{"../internals/an-instance":9,"../internals/define-iterator":41,"../internals/descriptors":43,"../internals/function-bind-context":54,"../internals/internal-metadata":69,"../internals/internal-state":70,"../internals/iterate":77,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/redefine-all":107,"../internals/set-species":116}],31:[function(e,t,r){"use strict";function n(e){return e.frozen||(e.frozen=new o)}function o(){this.entries=[]}function s(e,t){return y(e.entries,(function(e){return e[0]===t}))}var a=e("../internals/redefine-all"),i=e("../internals/internal-metadata").getWeakData,l=e("../internals/an-object"),u=e("../internals/is-object"),c=e("../internals/an-instance"),d=e("../internals/iterate"),h=e("../internals/array-iteration"),p=e("../internals/has"),f=(e=e("../internals/internal-state")).set,m=e.getterFor,y=h.find,g=h.findIndex,v=0;o.prototype={get:function(e){if(e=s(this,e))return e[1]},has:function(e){return!!s(this,e)},set:function(e,t){var r=s(this,e);r?r[1]=t:this.entries.push([e,t])},delete:function(e){var t=g(this.entries,(function(t){return t[0]===e}));return~t&&this.entries.splice(t,1),!!~t}},t.exports={getConstructor:function(e,t,r,o){function s(e,t,r){var o=y(e),s=i(l(t),!0);return!0===s?n(o).set(t,r):s[o.id]=r,e}var h=e((function(e,n){c(e,h,t),f(e,{type:t,id:v++,frozen:void 0}),null!=n&&d(n,e[o],e,r)})),y=m(t);return a(h.prototype,{delete:function(e){var t,r=y(this);return!!u(e)&&(!0===(t=i(e))?n(r).delete(e):t&&p(t,r.id)&&delete t[r.id])},has:function(e){var t,r=y(this);return!!u(e)&&(!0===(t=i(e))?n(r).has(e):t&&p(t,r.id))}}),a(h.prototype,r?{get:function(e){var t,r=y(this);if(u(e))return!0===(t=i(e))?n(r).get(e):t?t[r.id]:void 0},set:function(e,t){return s(this,e,t)}}:{add:function(e){return s(this,e,!0)}}),h}}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/array-iteration":19,"../internals/has":60,"../internals/internal-metadata":69,"../internals/internal-state":70,"../internals/is-object":74,"../internals/iterate":77,"../internals/redefine-all":107}],32:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/global"),s=e("../internals/is-forced"),a=e("../internals/redefine"),i=e("../internals/internal-metadata"),l=e("../internals/iterate"),u=e("../internals/an-instance"),c=e("../internals/is-object"),d=e("../internals/fails"),h=e("../internals/check-correctness-of-iteration"),p=e("../internals/set-to-string-tag"),f=e("../internals/inherit-if-required");t.exports=function(e,t,r){function m(e){var t=T[e];a(T,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(_&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return _&&!c(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(_&&!c(e))&&t.call(this,0===e?0:e)}:function(e,r){return t.call(this,0===e?0:e,r),this})}var y,g,v,b,x,w=-1!==e.indexOf("Map"),_=-1!==e.indexOf("Weak"),S=w?"set":"add",k=o[e],T=k&&k.prototype,E=k,j={};return s(e,"function"!=typeof k||!(_||T.forEach&&!d((function(){(new k).entries().next()}))))?(E=r.getConstructor(t,e,w,S),i.REQUIRED=!0):s(e,!0)&&(g=(y=new E)[S](_?{}:-0,1)!=y,v=d((function(){y.has(1)})),b=h((function(e){new k(e)})),x=!_&&d((function(){for(var e=new k,t=5;t--;)e[S](t,t);return!e.has(-0)})),b||(((E=t((function(t,r){return u(t,E,e),t=f(new k,t,E),null!=r&&l(r,t[S],t,w),t}))).prototype=T).constructor=E),(v||x)&&(m("delete"),m("has"),w&&m("get")),(x||g)&&m(S),_&&T.clear&&delete T.clear),j[e]=E,n({global:!0,forced:E!=k},j),p(E,e),_||r.setStrong(E,e,w),E}},{"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/export":50,"../internals/fails":51,"../internals/global":59,"../internals/inherit-if-required":67,"../internals/internal-metadata":69,"../internals/is-forced":73,"../internals/is-object":74,"../internals/iterate":77,"../internals/redefine":108,"../internals/set-to-string-tag":117}],33:[function(e,t,r){var n=e("../internals/has"),o=e("../internals/own-keys"),s=e("../internals/object-get-own-property-descriptor"),a=e("../internals/object-define-property");t.exports=function(e,t){for(var r=o(t),i=a.f,l=s.f,u=0;u<r.length;u++){var c=r[u];n(e,c)||i(e,c,l(t,c))}}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/own-keys":103}],34:[function(e,t,r){var n=e("../internals/well-known-symbol")("match");t.exports=function(e){var t=/./;try{"/./"[e](t)}catch(r){try{return t[n]=!1,"/./"[e](t)}catch(e){}}return!1}},{"../internals/well-known-symbol":148}],35:[function(e,t,r){e=e("../internals/fails"),t.exports=!e((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},{"../internals/fails":51}],36:[function(e,t,r){var n=e("../internals/require-object-coercible"),o=/"/g;t.exports=function(e,t,r,s){e=String(n(e));var a="<"+t;return""!==r&&(a+=" "+r+'="'+String(s).replace(o,"&quot;")+'"'),a+">"+e+"</"+t+">"}},{"../internals/require-object-coercible":113}],37:[function(e,t,r){"use strict";function n(){return this}var o=e("../internals/iterators-core").IteratorPrototype,s=e("../internals/object-create"),a=e("../internals/create-property-descriptor"),i=e("../internals/set-to-string-tag"),l=e("../internals/iterators");t.exports=function(e,t,r){return t+=" Iterator",e.prototype=s(o,{next:a(1,r)}),i(e,t,!1,!0),l[t]=n,e}},{"../internals/create-property-descriptor":39,"../internals/iterators":79,"../internals/iterators-core":78,"../internals/object-create":90,"../internals/set-to-string-tag":117}],38:[function(e,t,r){var n=e("../internals/descriptors"),o=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=n?function(e,t,r){return o.f(e,t,s(1,r))}:function(e,t,r){return e[t]=r,e}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/object-define-property":92}],39:[function(e,t,r){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],40:[function(e,t,r){"use strict";var n=e("../internals/to-primitive"),o=e("../internals/object-define-property"),s=e("../internals/create-property-descriptor");t.exports=function(e,t,r){(t=n(t))in e?o.f(e,t,s(0,r)):e[t]=r}},{"../internals/create-property-descriptor":39,"../internals/object-define-property":92,"../internals/to-primitive":140}],41:[function(e,t,r){"use strict";function n(){return this}var o=e("../internals/export"),s=e("../internals/create-iterator-constructor"),a=e("../internals/object-get-prototype-of"),i=e("../internals/object-set-prototype-of"),l=e("../internals/set-to-string-tag"),u=e("../internals/create-non-enumerable-property"),c=e("../internals/redefine"),d=e("../internals/well-known-symbol"),h=e("../internals/is-pure"),p=e("../internals/iterators"),f=(e=e("../internals/iterators-core")).IteratorPrototype,m=e.BUGGY_SAFARI_ITERATORS,y=d("iterator"),g="values",v="entries";t.exports=function(e,t,r,d,b,x,w){function _(e){if(e===b&&C)return C;if(!m&&e in E)return E[e];switch(e){case"keys":case g:case v:return function(){return new r(this,e)}}return function(){return new r(this)}}s(r,t,d),d=t+" Iterator";var S,k,T=!1,E=e.prototype,j=E[y]||E["@@iterator"]||b&&E[b],C=!m&&j||_(b),I="Array"==t&&E.entries||j;if(I&&(I=a(I.call(new e)),f!==Object.prototype&&I.next&&(h||a(I)===f||(i?i(I,f):"function"!=typeof I[y]&&u(I,y,n)),l(I,d,!0,!0),h&&(p[d]=n))),b==g&&j&&j.name!==g&&(T=!0,C=function(){return j.call(this)}),h&&!w||E[y]===C||u(E,y,C),p[t]=C,b)if(S={values:_(g),keys:x?C:_("keys"),entries:_(v)},w)for(k in S)!m&&!T&&k in E||c(E,k,S[k]);else o({target:t,proto:!0,forced:m||T},S);return S}},{"../internals/create-iterator-constructor":37,"../internals/create-non-enumerable-property":38,"../internals/export":50,"../internals/is-pure":75,"../internals/iterators":79,"../internals/iterators-core":78,"../internals/object-get-prototype-of":97,"../internals/object-set-prototype-of":101,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/well-known-symbol":148}],42:[function(e,t,r){var n=e("../internals/path"),o=e("../internals/has"),s=e("../internals/well-known-symbol-wrapped"),a=e("../internals/object-define-property").f;t.exports=function(e){var t=n.Symbol||(n.Symbol={});o(t,e)||a(t,e,{value:s.f(e)})}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/path":104,"../internals/well-known-symbol-wrapped":147}],43:[function(e,t,r){e=e("../internals/fails"),t.exports=!e((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},{"../internals/fails":51}],44:[function(e,t,r){var n=e("../internals/global"),o=(e=e("../internals/is-object"),n.document),s=e(o)&&e(o.createElement);t.exports=function(e){return s?o.createElement(e):{}}},{"../internals/global":59,"../internals/is-object":74}],45:[function(e,t,r){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},{}],46:[function(e,t,r){e=e("../internals/engine-user-agent"),t.exports=/(iphone|ipod|ipad).*applewebkit/i.test(e)},{"../internals/engine-user-agent":47}],47:[function(e,t,r){e=e("../internals/get-built-in"),t.exports=e("navigator","userAgent")||""},{"../internals/get-built-in":56}],48:[function(e,t,r){var n,o,s=e("../internals/global");e=e("../internals/engine-user-agent"),(s=(s=(s=s.process)&&s.versions)&&s.v8)?o=(n=s.split("."))[0]+n[1]:e&&(!(n=e.match(/Edge\/(\d+)/))||74<=n[1])&&(n=e.match(/Chrome\/(\d+)/))&&(o=n[1]),t.exports=o&&+o},{"../internals/engine-user-agent":47,"../internals/global":59}],49:[function(e,t,r){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],50:[function(e,t,r){var n=e("../internals/global"),o=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/create-non-enumerable-property"),a=e("../internals/redefine"),i=e("../internals/set-global"),l=e("../internals/copy-constructor-properties"),u=e("../internals/is-forced");t.exports=function(e,t){var r,c,d,h=e.target,p=e.global,f=e.stat,m=p?n:f?n[h]||i(h,{}):(n[h]||{}).prototype;if(m)for(r in t){if(c=t[r],d=e.noTargetGet?(d=o(m,r))&&d.value:m[r],!u(p?r:h+(f?".":"#")+r,e.forced)&&void 0!==d){if(typeof c==typeof d)continue;l(c,d)}(e.sham||d&&d.sham)&&s(c,"sham",!0),a(m,r,c,e)}}},{"../internals/copy-constructor-properties":33,"../internals/create-non-enumerable-property":38,"../internals/global":59,"../internals/is-forced":73,"../internals/object-get-own-property-descriptor":93,"../internals/redefine":108,"../internals/set-global":115}],51:[function(e,t,r){t.exports=function(e){try{return!!e()}catch(e){return!0}}},{}],52:[function(e,t,r){"use strict";e("../modules/es.regexp.exec");var n=e("../internals/redefine"),o=e("../internals/fails"),s=e("../internals/well-known-symbol"),a=e("../internals/regexp-exec"),i=e("../internals/create-non-enumerable-property"),l=s("species"),u=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),c="$0"==="a".replace(/./,"$0"),d=!!/./[e=s("replace")]&&""===/./[e]("a","$0"),h=!o((function(){var e=(t=/(?:)/).exec,t=(t.exec=function(){return e.apply(this,arguments)},"ab".split(t));return 2!==t.length||"a"!==t[0]||"b"!==t[1]}));t.exports=function(e,t,r,p){var f,m,y=s(e),g=!o((function(){var t={};return t[y]=function(){return 7},7!=""[e](t)})),v=g&&!o((function(){var t=!1,r=/a/;return"split"===e&&((r={constructor:{}}).constructor[l]=function(){return r},r.flags="",r[y]=/./[y]),r.exec=function(){return t=!0,null},r[y](""),!t}));g&&v&&("replace"!==e||u&&c&&!d)&&("split"!==e||h)||(f=/./[y],r=(v=r(y,""[e],(function(e,t,r,n,o){return t.exec===a?g&&!o?{done:!0,value:f.call(t,r,n)}:{done:!0,value:e.call(r,t,n)}:{done:!1}}),{REPLACE_KEEPS_$0:c,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:d}))[0],m=v[1],n(String.prototype,e,r),n(RegExp.prototype,y,2==t?function(e,t){return m.call(e,this,t)}:function(e){return m.call(e,this)})),p&&i(RegExp.prototype[y],"sham",!0)}},{"../internals/create-non-enumerable-property":38,"../internals/fails":51,"../internals/redefine":108,"../internals/regexp-exec":110,"../internals/well-known-symbol":148,"../modules/es.regexp.exec":185}],53:[function(e,t,r){e=e("../internals/fails"),t.exports=!e((function(){return Object.isExtensible(Object.preventExtensions({}))}))},{"../internals/fails":51}],54:[function(e,t,r){var n=e("../internals/a-function");t.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 0:return function(){return e.call(t)};case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},{"../internals/a-function":5}],55:[function(e,t,r){"use strict";var n=e("../internals/a-function"),o=e("../internals/is-object"),s=[].slice,a={};t.exports=Function.bind||function(e){var t=n(this),r=s.call(arguments,1),i=function(){var n=r.concat(s.call(arguments));if(this instanceof i){var o=t,l=n.length,u=n;if(!(l in a)){for(var c=[],d=0;d<l;d++)c[d]="a["+d+"]";a[l]=Function("C,a","return new C("+c.join(",")+")")}return a[l](o,u)}return t.apply(e,n)};return o(t.prototype)&&(i.prototype=t.prototype),i}},{"../internals/a-function":5,"../internals/is-object":74}],56:[function(e,t,r){function n(e){return"function"==typeof e?e:void 0}var o=e("../internals/path"),s=e("../internals/global");t.exports=function(e,t){return arguments.length<2?n(o[e])||n(s[e]):o[e]&&o[e][t]||s[e]&&s[e][t]}},{"../internals/global":59,"../internals/path":104}],57:[function(e,t,r){var n=e("../internals/classof"),o=e("../internals/iterators"),s=e("../internals/well-known-symbol")("iterator");t.exports=function(e){if(null!=e)return e[s]||e["@@iterator"]||o[n(e)]}},{"../internals/classof":29,"../internals/iterators":79,"../internals/well-known-symbol":148}],58:[function(e,t,r){var n=e("../internals/an-object"),o=e("../internals/get-iterator-method");t.exports=function(e){var t=o(e);if("function"!=typeof t)throw TypeError(String(e)+" is not iterable");return n(t.call(e))}},{"../internals/an-object":10,"../internals/get-iterator-method":57}],59:[function(e,t,r){(function(e){function r(e){return e&&e.Math==Math&&e}t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof e&&e)||Function("return this")()}).call(this,void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],60:[function(e,t,r){var n={}.hasOwnProperty;t.exports=function(e,t){return n.call(e,t)}},{}],61:[function(e,t,r){t.exports={}},{}],62:[function(e,t,r){var n=e("../internals/global");t.exports=function(e,t){var r=n.console;r&&r.error&&(1===arguments.length?r.error(e):r.error(e,t))}},{"../internals/global":59}],63:[function(e,t,r){e=e("../internals/get-built-in"),t.exports=e("document","documentElement")},{"../internals/get-built-in":56}],64:[function(e,t,r){var n=e("../internals/descriptors"),o=e("../internals/fails"),s=e("../internals/document-create-element");t.exports=!n&&!o((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},{"../internals/descriptors":43,"../internals/document-create-element":44,"../internals/fails":51}],65:[function(e,t,r){var n=Math.abs,o=Math.pow,s=Math.floor,a=Math.log,i=Math.LN2;t.exports={pack:function(e,t,r){var l,u,c,d=new Array(r),h=8*r-t-1,p=(r=(1<<h)-1)>>1,f=23===t?o(2,-24)-o(2,-77):0,m=e<0||0===e&&1/e<0?1:0,y=0;for((e=n(e))!=e||e===1/0?(u=e!=e?1:0,l=r):(l=s(a(e)/i),e*(c=o(2,-l))<1&&(l--,c*=2),2<=(e+=1<=l+p?f/c:f*o(2,1-p))*c&&(l++,c/=2),r<=l+p?(u=0,l=r):1<=l+p?(u=(e*c-1)*o(2,t),l+=p):(u=e*o(2,p-1)*o(2,t),l=0));8<=t;d[y++]=255&u,u/=256,t-=8);for(l=l<<t|u,h+=t;0<h;d[y++]=255&l,l/=256,h-=8);return d[--y]|=128*m,d},unpack:function(e,t){var r,n,s=e.length,a=(1<<(n=8*s-t-1))-1,i=a>>1,l=n-7,u=s-1,c=127&(n=e[u--]);for(n>>=7;0<l;c=256*c+e[u],u--,l-=8);for(r=c&(1<<-l)-1,c>>=-l,l+=t;0<l;r=256*r+e[u],u--,l-=8);if(0===c)c=1-i;else{if(c===a)return r?NaN:n?-1/0:1/0;r+=o(2,t),c-=i}return(n?-1:1)*r*o(2,c-t)}}},{}],66:[function(e,t,r){var n=e("../internals/fails"),o=e("../internals/classof-raw"),s="".split;t.exports=n((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?s.call(e,""):Object(e)}:Object},{"../internals/classof-raw":28,"../internals/fails":51}],67:[function(e,t,r){var n=e("../internals/is-object"),o=e("../internals/object-set-prototype-of");t.exports=function(e,t,r){return o&&"function"==typeof(t=t.constructor)&&t!==r&&n(t=t.prototype)&&t!==r.prototype&&o(e,t),e}},{"../internals/is-object":74,"../internals/object-set-prototype-of":101}],68:[function(e,t,r){e=e("../internals/shared-store");var n=Function.toString;"function"!=typeof e.inspectSource&&(e.inspectSource=function(e){return n.call(e)}),t.exports=e.inspectSource},{"../internals/shared-store":119}],69:[function(e,t,r){function n(e){i(e,c,{value:{objectID:"O"+ ++d,weakData:{}}})}var o=e("../internals/hidden-keys"),s=e("../internals/is-object"),a=e("../internals/has"),i=e("../internals/object-define-property").f,l=e("../internals/uid"),u=e("../internals/freezing"),c=l("meta"),d=0,h=Object.isExtensible||function(){return!0},p=t.exports={REQUIRED:!1,fastKey:function(e,t){if(!s(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!a(e,c)){if(!h(e))return"F";if(!t)return"E";n(e)}return e[c].objectID},getWeakData:function(e,t){if(!a(e,c)){if(!h(e))return!0;if(!t)return!1;n(e)}return e[c].weakData},onFreeze:function(e){return u&&p.REQUIRED&&h(e)&&!a(e,c)&&n(e),e}};o[c]=!0},{"../internals/freezing":53,"../internals/has":60,"../internals/hidden-keys":61,"../internals/is-object":74,"../internals/object-define-property":92,"../internals/uid":145}],70:[function(e,t,r){var n,o,s,a,i,l,u,c,d=e("../internals/native-weak-map"),h=e("../internals/global"),p=e("../internals/is-object"),f=e("../internals/create-non-enumerable-property"),m=e("../internals/has"),y=e("../internals/shared-key");e=e("../internals/hidden-keys"),h=h.WeakMap,u=d?(n=new h,o=n.get,s=n.has,a=n.set,i=function(e,t){return a.call(n,e,t),t},l=function(e){return o.call(n,e)||{}},function(e){return s.call(n,e)}):(e[c=y("state")]=!0,i=function(e,t){return f(e,c,t),t},l=function(e){return m(e,c)?e[c]:{}},function(e){return m(e,c)}),t.exports={set:i,get:l,has:u,enforce:function(e){return u(e)?l(e):i(e,{})},getterFor:function(e){return function(t){if(p(t)&&(t=l(t)).type===e)return t;throw TypeError("Incompatible receiver, "+e+" required")}}}},{"../internals/create-non-enumerable-property":38,"../internals/global":59,"../internals/has":60,"../internals/hidden-keys":61,"../internals/is-object":74,"../internals/native-weak-map":85,"../internals/shared-key":118}],71:[function(e,t,r){var n=e("../internals/well-known-symbol"),o=e("../internals/iterators"),s=n("iterator"),a=Array.prototype;t.exports=function(e){return void 0!==e&&(o.Array===e||a[s]===e)}},{"../internals/iterators":79,"../internals/well-known-symbol":148}],72:[function(e,t,r){var n=e("../internals/classof-raw");t.exports=Array.isArray||function(e){return"Array"==n(e)}},{"../internals/classof-raw":28}],73:[function(e,t,r){function n(e,t){return(e=i[a(e)])==u||e!=l&&("function"==typeof t?o(t):!!t)}var o=e("../internals/fails"),s=/#|\.prototype\./,a=n.normalize=function(e){return String(e).replace(s,".").toLowerCase()},i=n.data={},l=n.NATIVE="N",u=n.POLYFILL="P";t.exports=n},{"../internals/fails":51}],74:[function(e,t,r){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],75:[function(e,t,r){t.exports=!1},{}],76:[function(e,t,r){var n=e("../internals/is-object"),o=e("../internals/classof-raw"),s=e("../internals/well-known-symbol")("match");t.exports=function(e){var t;return n(e)&&(void 0!==(t=e[s])?!!t:"RegExp"==o(e))}},{"../internals/classof-raw":28,"../internals/is-object":74,"../internals/well-known-symbol":148}],77:[function(e,t,r){function n(e,t){this.stopped=e,this.result=t}var o=e("../internals/an-object"),s=e("../internals/is-array-iterator-method"),a=e("../internals/to-length"),i=e("../internals/function-bind-context"),l=e("../internals/get-iterator-method"),u=e("../internals/call-with-safe-iteration-closing");(t.exports=function(e,t,r,c,d){var h,p,f,m,y,g,v=i(t,r,c?2:1);if(d)h=e;else{if("function"!=typeof(t=l(e)))throw TypeError("Target is not iterable");if(s(t)){for(p=0,f=a(e.length);p<f;p++)if((m=c?v(o(g=e[p])[0],g[1]):v(e[p]))&&m instanceof n)return m;return new n(!1)}h=t.call(e)}for(y=h.next;!(g=y.call(h)).done;)if("object"==typeof(m=u(h,v,g.value,c))&&m&&m instanceof n)return m;return new n(!1)}).stop=function(e){return new n(!0,e)}},{"../internals/an-object":10,"../internals/call-with-safe-iteration-closing":26,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":136}],78:[function(e,t,r){"use strict";var n,o,s=e("../internals/object-get-prototype-of"),a=e("../internals/create-non-enumerable-property"),i=e("../internals/has"),l=e("../internals/well-known-symbol"),u=(e=e("../internals/is-pure"),l=l("iterator"),!1);[].keys&&("next"in(o=[].keys())?(s=s(s(o)))!==Object.prototype&&(n=s):u=!0),null==n&&(n={}),e||i(n,l)||a(n,l,(function(){return this})),t.exports={IteratorPrototype:n,BUGGY_SAFARI_ITERATORS:u}},{"../internals/create-non-enumerable-property":38,"../internals/has":60,"../internals/is-pure":75,"../internals/object-get-prototype-of":97,"../internals/well-known-symbol":148}],79:[function(e,t,r){t.exports={}},{}],80:[function(e,t,r){t.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},{}],81:[function(e,t,r){var n,o,s,a,i,l,u,c,d=e("../internals/global"),h=e("../internals/object-get-own-property-descriptor").f,p=e("../internals/classof-raw"),f=e("../internals/task").set,m=(e=e("../internals/engine-is-ios"),d.MutationObserver||d.WebKitMutationObserver),y=d.process,g=d.Promise,v="process"==p(y);p=h(d,"queueMicrotask"),(h=p&&p.value)||(n=function(){var e,t;for(v&&(e=y.domain)&&e.exit();o;){t=o.fn,o=o.next;try{t()}catch(e){throw o?a():s=void 0,e}}s=void 0,e&&e.enter()},a=v?function(){y.nextTick(n)}:m&&!e?(i=!0,l=document.createTextNode(""),new m(n).observe(l,{characterData:!0}),function(){l.data=i=!i}):g&&g.resolve?(u=g.resolve(void 0),c=u.then,function(){c.call(u,n)}):function(){f.call(d,n)}),t.exports=h||function(e){e={fn:e,next:void 0},s&&(s.next=e),o||(o=e,a()),s=e}},{"../internals/classof-raw":28,"../internals/engine-is-ios":46,"../internals/global":59,"../internals/object-get-own-property-descriptor":93,"../internals/task":130}],82:[function(e,t,r){e=e("../internals/global"),t.exports=e.Promise},{"../internals/global":59}],83:[function(e,t,r){e=e("../internals/fails"),t.exports=!!Object.getOwnPropertySymbols&&!e((function(){return!String(Symbol())}))},{"../internals/fails":51}],84:[function(e,t,r){var n=e("../internals/fails"),o=e("../internals/well-known-symbol"),s=e("../internals/is-pure"),a=o("iterator");t.exports=!n((function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach((function(e,n){t.delete("b"),r+=n+e})),s&&!e.toJSON||!t.sort||"http://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[a]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("http://").host||"#%D0%B1"!==new URL("http://a#").hash||"a1c3"!==r||"x"!==new URL("http://x",void 0).host}))},{"../internals/fails":51,"../internals/is-pure":75,"../internals/well-known-symbol":148}],85:[function(e,t,r){var n=e("../internals/global");e=e("../internals/inspect-source"),n=n.WeakMap,t.exports="function"==typeof n&&/native code/.test(e(n))},{"../internals/global":59,"../internals/inspect-source":68}],86:[function(e,t,r){"use strict";function n(e){var t,r;this.promise=new e((function(e,n){if(void 0!==t||void 0!==r)throw TypeError("Bad Promise constructor");t=e,r=n})),this.resolve=o(t),this.reject=o(r)}var o=e("../internals/a-function");t.exports.f=function(e){return new n(e)}},{"../internals/a-function":5}],87:[function(e,t,r){var n=e("../internals/is-regexp");t.exports=function(e){if(n(e))throw TypeError("The method doesn't accept regular expressions");return e}},{"../internals/is-regexp":76}],88:[function(e,t,r){var n=e("../internals/global").isFinite;t.exports=Number.isFinite||function(e){return"number"==typeof e&&n(e)}},{"../internals/global":59}],89:[function(e,t,r){"use strict";var n=e("../internals/descriptors"),o=e("../internals/fails"),s=e("../internals/object-keys"),a=e("../internals/object-get-own-property-symbols"),i=e("../internals/object-property-is-enumerable"),l=e("../internals/to-object"),u=e("../internals/indexed-object"),c=Object.assign,d=Object.defineProperty;t.exports=!c||o((function(){var e,t,r,o;return!(!n||1===c({b:1},c(d({},"a",{enumerable:!0,get:function(){d(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)||(t={},o="abcdefghijklmnopqrst",(e={})[r=Symbol()]=7,o.split("").forEach((function(e){t[e]=e})),7!=c({},e)[r]||s(c({},t)).join("")!=o)}))?function(e,t){for(var r=l(e),o=arguments.length,c=1,d=a.f,h=i.f;c<o;)for(var p,f=u(arguments[c++]),m=d?s(f).concat(d(f)):s(f),y=m.length,g=0;g<y;)p=m[g++],n&&!h.call(f,p)||(r[p]=f[p]);return r}:c},{"../internals/descriptors":43,"../internals/fails":51,"../internals/indexed-object":66,"../internals/object-get-own-property-symbols":96,"../internals/object-keys":99,"../internals/object-property-is-enumerable":100,"../internals/to-object":137}],90:[function(e,t,r){function n(){}var o,s=e("../internals/an-object"),a=e("../internals/object-define-properties"),i=e("../internals/enum-bug-keys"),l=e("../internals/hidden-keys"),u=e("../internals/html"),c=e("../internals/document-create-element"),d=(e=e("../internals/shared-key"),"prototype"),h="script",p=e("IE_PROTO"),f=function(e){return"<"+h+">"+e+"</"+h+">"},m=function(){try{o=document.domain&&new ActiveXObject("htmlfile")}catch(e){}m=o?((e=o).write(f("")),e.close(),t=e.parentWindow.Object,e=null,t):(e=c("iframe"),t="java"+h+":",e.style.display="none",u.appendChild(e),e.src=String(t),(t=e.contentWindow.document).open(),t.write(f("document.F=Object")),t.close(),t.F);for(var e,t,r=i.length;r--;)delete m[d][i[r]];return m()};l[p]=!0,t.exports=Object.create||function(e,t){var r;return null!==e?(n[d]=s(e),r=new n,n[d]=null,r[p]=e):r=m(),void 0===t?r:a(r,t)}},{"../internals/an-object":10,"../internals/document-create-element":44,"../internals/enum-bug-keys":49,"../internals/hidden-keys":61,"../internals/html":63,"../internals/object-define-properties":91,"../internals/shared-key":118}],91:[function(e,t,r){var n=e("../internals/descriptors"),o=e("../internals/object-define-property"),s=e("../internals/an-object"),a=e("../internals/object-keys");t.exports=n?Object.defineProperties:function(e,t){s(e);for(var r,n=a(t),i=n.length,l=0;l<i;)o.f(e,r=n[l++],t[r]);return e}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/object-define-property":92,"../internals/object-keys":99}],92:[function(e,t,r){var n=e("../internals/descriptors"),o=e("../internals/ie8-dom-define"),s=e("../internals/an-object"),a=e("../internals/to-primitive"),i=Object.defineProperty;r.f=n?i:function(e,t,r){if(s(e),t=a(t,!0),s(r),o)try{return i(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},{"../internals/an-object":10,"../internals/descriptors":43,"../internals/ie8-dom-define":64,"../internals/to-primitive":140}],93:[function(e,t,r){var n=e("../internals/descriptors"),o=e("../internals/object-property-is-enumerable"),s=e("../internals/create-property-descriptor"),a=e("../internals/to-indexed-object"),i=e("../internals/to-primitive"),l=e("../internals/has"),u=e("../internals/ie8-dom-define"),c=Object.getOwnPropertyDescriptor;r.f=n?c:function(e,t){if(e=a(e),t=i(t,!0),u)try{return c(e,t)}catch(e){}if(l(e,t))return s(!o.f.call(e,t),e[t])}},{"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/has":60,"../internals/ie8-dom-define":64,"../internals/object-property-is-enumerable":100,"../internals/to-indexed-object":134,"../internals/to-primitive":140}],94:[function(e,t,r){var n=e("../internals/to-indexed-object"),o=e("../internals/object-get-own-property-names").f,s={}.toString,a="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.f=function(e){if(!a||"[object Window]"!=s.call(e))return o(n(e));try{return o(e)}catch(e){return a.slice()}}},{"../internals/object-get-own-property-names":95,"../internals/to-indexed-object":134}],95:[function(e,t,r){var n=e("../internals/object-keys-internal"),o=e("../internals/enum-bug-keys").concat("length","prototype");r.f=Object.getOwnPropertyNames||function(e){return n(e,o)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":98}],96:[function(e,t,r){r.f=Object.getOwnPropertySymbols},{}],97:[function(e,t,r){var n=e("../internals/has"),o=e("../internals/to-object"),s=e("../internals/shared-key"),a=(e=e("../internals/correct-prototype-getter"),s("IE_PROTO")),i=Object.prototype;t.exports=e?Object.getPrototypeOf:function(e){return e=o(e),n(e,a)?e[a]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?i:null}},{"../internals/correct-prototype-getter":35,"../internals/has":60,"../internals/shared-key":118,"../internals/to-object":137}],98:[function(e,t,r){var n=e("../internals/has"),o=e("../internals/to-indexed-object"),s=e("../internals/array-includes").indexOf,a=e("../internals/hidden-keys");t.exports=function(e,t){var r,i=o(e),l=0,u=[];for(r in i)!n(a,r)&&n(i,r)&&u.push(r);for(;t.length>l;)!n(i,r=t[l++])||~s(u,r)||u.push(r);return u}},{"../internals/array-includes":18,"../internals/has":60,"../internals/hidden-keys":61,"../internals/to-indexed-object":134}],99:[function(e,t,r){var n=e("../internals/object-keys-internal"),o=e("../internals/enum-bug-keys");t.exports=Object.keys||function(e){return n(e,o)}},{"../internals/enum-bug-keys":49,"../internals/object-keys-internal":98}],100:[function(e,t,r){"use strict";var n={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,s=o&&!n.call({1:2},1);r.f=s?function(e){return!!(e=o(this,e))&&e.enumerable}:n},{}],101:[function(e,t,r){var n=e("../internals/an-object"),o=e("../internals/a-possible-prototype");t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),t=r instanceof Array}catch(r){}return function(r,s){return n(r),o(s),t?e.call(r,s):r.__proto__=s,r}}():void 0)},{"../internals/a-possible-prototype":6,"../internals/an-object":10}],102:[function(e,t,r){"use strict";var n=e("../internals/to-string-tag-support"),o=e("../internals/classof");t.exports=n?{}.toString:function(){return"[object "+o(this)+"]"}},{"../internals/classof":29,"../internals/to-string-tag-support":141}],103:[function(e,t,r){var n=e("../internals/get-built-in"),o=e("../internals/object-get-own-property-names"),s=e("../internals/object-get-own-property-symbols"),a=e("../internals/an-object");t.exports=n("Reflect","ownKeys")||function(e){var t=o.f(a(e)),r=s.f;return r?t.concat(r(e)):t}},{"../internals/an-object":10,"../internals/get-built-in":56,"../internals/object-get-own-property-names":95,"../internals/object-get-own-property-symbols":96}],104:[function(e,t,r){e=e("../internals/global"),t.exports=e},{"../internals/global":59}],105:[function(e,t,r){t.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},{}],106:[function(e,t,r){var n=e("../internals/an-object"),o=e("../internals/is-object"),s=e("../internals/new-promise-capability");t.exports=function(e,t){return n(e),o(t)&&t.constructor===e?t:((0,(e=s.f(e)).resolve)(t),e.promise)}},{"../internals/an-object":10,"../internals/is-object":74,"../internals/new-promise-capability":86}],107:[function(e,t,r){var n=e("../internals/redefine");t.exports=function(e,t,r){for(var o in t)n(e,o,t[o],r);return e}},{"../internals/redefine":108}],108:[function(e,t,r){var n=e("../internals/global"),o=e("../internals/create-non-enumerable-property"),s=e("../internals/has"),a=e("../internals/set-global"),i=e("../internals/inspect-source"),l=(e=e("../internals/internal-state")).get,u=e.enforce,c=String(String).split("String");(t.exports=function(e,t,r,i){var l=!!i&&!!i.unsafe,d=!!i&&!!i.enumerable;i=!!i&&!!i.noTargetGet,"function"==typeof r&&("string"!=typeof t||s(r,"name")||o(r,"name",t),u(r).source=c.join("string"==typeof t?t:"")),e===n?d?e[t]=r:a(t,r):(l?!i&&e[t]&&(d=!0):delete e[t],d?e[t]=r:o(e,t,r))})(Function.prototype,"toString",(function(){return"function"==typeof this&&l(this).source||i(this)}))},{"../internals/create-non-enumerable-property":38,"../internals/global":59,"../internals/has":60,"../internals/inspect-source":68,"../internals/internal-state":70,"../internals/set-global":115}],109:[function(e,t,r){var n=e("./classof-raw"),o=e("./regexp-exec");t.exports=function(e,t){var r=e.exec;if("function"==typeof r){if("object"!=typeof(r=r.call(e,t)))throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==n(e))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},{"./classof-raw":28,"./regexp-exec":110}],110:[function(e,t,r){"use strict";var n,o,s=e("./regexp-flags"),a=(e=e("./regexp-sticky-helpers"),RegExp.prototype.exec),i=String.prototype.replace,l=a,u=(n=/a/,o=/b*/g,a.call(n,"a"),a.call(o,"a"),0!==n.lastIndex||0!==o.lastIndex),c=e.UNSUPPORTED_Y||e.BROKEN_CARET,d=void 0!==/()??/.exec("")[1];t.exports=l=u||d||c?function(e){var t,r,n,o,l=this,h=c&&l.sticky,p=s.call(l),f=l.source,m=0,y=e;return h&&(-1===(p=p.replace("y","")).indexOf("g")&&(p+="g"),y=String(e).slice(l.lastIndex),0<l.lastIndex&&(!l.multiline||l.multiline&&"\n"!==e[l.lastIndex-1])&&(f="(?: "+f+")",y=" "+y,m++),r=new RegExp("^(?:"+f+")",p)),d&&(r=new RegExp("^"+f+"$(?!\\s)",p)),u&&(t=l.lastIndex),n=a.call(h?r:l,y),h?n?(n.input=n.input.slice(m),n[0]=n[0].slice(m),n.index=l.lastIndex,l.lastIndex+=n[0].length):l.lastIndex=0:u&&n&&(l.lastIndex=l.global?n.index+n[0].length:t),d&&n&&1<n.length&&i.call(n[0],r,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n}:l},{"./regexp-flags":111,"./regexp-sticky-helpers":112}],111:[function(e,t,r){"use strict";var n=e("../internals/an-object");t.exports=function(){var e=n(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},{"../internals/an-object":10}],112:[function(e,t,r){"use strict";function n(e,t){return RegExp(e,t)}e=e("./fails"),r.UNSUPPORTED_Y=e((function(){var e=n("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),r.BROKEN_CARET=e((function(){var e=n("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},{"./fails":51}],113:[function(e,t,r){t.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},{}],114:[function(e,t,r){t.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},{}],115:[function(e,t,r){var n=e("../internals/global"),o=e("../internals/create-non-enumerable-property");t.exports=function(e,t){try{o(n,e,t)}catch(r){n[e]=t}return t}},{"../internals/create-non-enumerable-property":38,"../internals/global":59}],116:[function(e,t,r){"use strict";var n=e("../internals/get-built-in"),o=e("../internals/object-define-property"),s=e("../internals/well-known-symbol"),a=e("../internals/descriptors"),i=s("species");t.exports=function(e){e=n(e);var t=o.f;a&&e&&!e[i]&&t(e,i,{configurable:!0,get:function(){return this}})}},{"../internals/descriptors":43,"../internals/get-built-in":56,"../internals/object-define-property":92,"../internals/well-known-symbol":148}],117:[function(e,t,r){var n=e("../internals/object-define-property").f,o=e("../internals/has"),s=e("../internals/well-known-symbol")("toStringTag");t.exports=function(e,t,r){e&&!o(e=r?e:e.prototype,s)&&n(e,s,{configurable:!0,value:t})}},{"../internals/has":60,"../internals/object-define-property":92,"../internals/well-known-symbol":148}],118:[function(e,t,r){var n=e("../internals/shared"),o=e("../internals/uid"),s=n("keys");t.exports=function(e){return s[e]||(s[e]=o(e))}},{"../internals/shared":120,"../internals/uid":145}],119:[function(e,t,r){var n=e("../internals/global"),o=(e=e("../internals/set-global"),"__core-js_shared__");n=n[o]||e(o,{}),t.exports=n},{"../internals/global":59,"../internals/set-global":115}],120:[function(e,t,r){var n=e("../internals/is-pure"),o=e("../internals/shared-store");(t.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:n?"pure":"global",copyright:" 2020 Denis Pushkarev (zloirock.ru)"})},{"../internals/is-pure":75,"../internals/shared-store":119}],121:[function(e,t,r){var n=e("../internals/an-object"),o=e("../internals/a-function"),s=e("../internals/well-known-symbol")("species");t.exports=function(e,t){return void 0===(e=n(e).constructor)||null==(e=n(e)[s])?t:o(e)}},{"../internals/a-function":5,"../internals/an-object":10,"../internals/well-known-symbol":148}],122:[function(e,t,r){var n=e("../internals/fails");t.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||3<t.split('"').length}))}},{"../internals/fails":51}],123:[function(e,t,r){function n(e){return function(t,r){t=String(s(t)),r=o(r);var n,a=t.length;return r<0||a<=r?e?"":void 0:(n=t.charCodeAt(r))<55296||56319<n||r+1===a||(a=t.charCodeAt(r+1))<56320||57343<a?e?t.charAt(r):n:e?t.slice(r,r+2):a-56320+(n-55296<<10)+65536}}var o=e("../internals/to-integer"),s=e("../internals/require-object-coercible");t.exports={codeAt:n(!1),charAt:n(!0)}},{"../internals/require-object-coercible":113,"../internals/to-integer":135}],124:[function(e,t,r){e=e("../internals/engine-user-agent"),t.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(e)},{"../internals/engine-user-agent":47}],125:[function(e,t,r){function n(e){return function(t,r,n){var l=(t=String(a(t))).length;return n=void 0===n?" ":String(n),(r=o(r))<=l||""==n?t:((l=s.call(n,i((r-=l)/n.length))).length>r&&(l=l.slice(0,r)),e?t+l:l+t)}}var o=e("../internals/to-length"),s=e("../internals/string-repeat"),a=e("../internals/require-object-coercible"),i=Math.ceil;t.exports={start:n(!1),end:n(!0)}},{"../internals/require-object-coercible":113,"../internals/string-repeat":127,"../internals/to-length":136}],126:[function(e,t,r){"use strict";function n(e){return e+22+75*(e<26)}function o(e){var t,r=[],o=(e=function(e){for(var t=[],r=0,n=e.length;r<n;){var o,s=e.charCodeAt(r++);55296<=s&&s<=56319&&r<n?56320==(64512&(o=e.charCodeAt(r++)))?t.push(((1023&s)<<10)+(1023&o)+65536):(t.push(s),r--):t.push(s)}return t}(e)).length,c=128,d=0,y=72;for(x=0;x<e.length;x++)(t=e[x])<128&&r.push(m(t));var g=r.length,v=g;for(g&&r.push("-");v<o;){for(var b=s,x=0;x<e.length;x++)c<=(t=e[x])&&t<b&&(b=t);var w=v+1;if(b-c>f((s-d)/w))throw RangeError(h);for(d+=(b-c)*w,c=b,x=0;x<e.length;x++){if((t=e[x])<c&&++d>s)throw RangeError(h);if(t==c){for(var _=d,S=a;;S+=a){var k=S<=y?1:y+i<=S?i:S-y;if(_<k)break;var T=_-k,E=a-k;r.push(m(n(k+T%E))),_=f(T/E)}r.push(m(n(_))),y=function(e,t,r){var n=0;for(e=r?f(e/u):e>>1,e+=f(e/t);p*i>>1<e;n+=a)e=f(e/p);return f(n+(p+1)*e/(e+l))}(d,w,v==g),d=0,++v}}++d,++c}return r.join("")}var s=2147483647,a=36,i=26,l=38,u=700,c=/[^\0-\u007E]/,d=/[.\u3002\uFF0E\uFF61]/g,h="Overflow: input needs wider integers to process",p=a-1,f=Math.floor,m=String.fromCharCode;t.exports=function(e){for(var t,r=[],n=e.toLowerCase().replace(d,".").split("."),s=0;s<n.length;s++)t=n[s],r.push(c.test(t)?"xn--"+o(t):t);return r.join(".")}},{}],127:[function(e,t,r){"use strict";var n=e("../internals/to-integer"),o=e("../internals/require-object-coercible");t.exports="".repeat||function(e){var t=String(o(this)),r="",s=n(e);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;0<s;(s>>>=1)&&(t+=t))1&s&&(r+=t);return r}},{"../internals/require-object-coercible":113,"../internals/to-integer":135}],128:[function(e,t,r){var n=e("../internals/fails"),o=e("../internals/whitespaces");t.exports=function(e){return n((function(){return!!o[e]()||""!=""[e]()||o[e].name!==e}))}},{"../internals/fails":51,"../internals/whitespaces":149}],129:[function(e,t,r){function n(e){return function(t){return t=String(o(t)),1&e&&(t=t.replace(s,"")),2&e?t.replace(a,""):t}}var o=e("../internals/require-object-coercible"),s=(e="["+e("../internals/whitespaces")+"]",RegExp("^"+e+e+"*")),a=RegExp(e+e+"*$");t.exports={start:n(1),end:n(2),trim:n(3)}},{"../internals/require-object-coercible":113,"../internals/whitespaces":149}],130:[function(e,t,r){function n(e){return function(){_(e)}}function o(e){_(e.data)}function s(e){i.postMessage(e+"",p.protocol+"//"+p.host)}var a,i=e("../internals/global"),l=e("../internals/fails"),u=e("../internals/classof-raw"),c=e("../internals/function-bind-context"),d=e("../internals/html"),h=e("../internals/document-create-element"),p=(e=e("../internals/engine-is-ios"),i.location),f=i.setImmediate,m=i.clearImmediate,y=i.process,g=i.MessageChannel,v=i.Dispatch,b=0,x={},w="onreadystatechange",_=function(e){var t;x.hasOwnProperty(e)&&(t=x[e],delete x[e],t())};f&&m||(f=function(e){for(var t=[],r=1;r<arguments.length;)t.push(arguments[r++]);return x[++b]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},a(b),b},m=function(e){delete x[e]},"process"==u(y)?a=function(e){y.nextTick(n(e))}:v&&v.now?a=function(e){v.now(n(e))}:g&&!e?(e=(u=new g).port2,u.port1.onmessage=o,a=c(e.postMessage,e,1)):!i.addEventListener||"function"!=typeof postMessage||i.importScripts||l(s)||"file:"===p.protocol?a=w in h("script")?function(e){d.appendChild(h("script"))[w]=function(){d.removeChild(this),_(e)}}:function(e){setTimeout(n(e),0)}:(a=s,i.addEventListener("message",o,!1))),t.exports={set:f,clear:m}},{"../internals/classof-raw":28,"../internals/document-create-element":44,"../internals/engine-is-ios":46,"../internals/fails":51,"../internals/function-bind-context":54,"../internals/global":59,"../internals/html":63}],131:[function(e,t,r){var n=e("../internals/classof-raw");t.exports=function(e){if("number"!=typeof e&&"Number"!=n(e))throw TypeError("Incorrect invocation");return+e}},{"../internals/classof-raw":28}],132:[function(e,t,r){var n=e("../internals/to-integer"),o=Math.max,s=Math.min;t.exports=function(e,t){return(e=n(e))<0?o(e+t,0):s(e,t)}},{"../internals/to-integer":135}],133:[function(e,t,r){var n=e("../internals/to-integer"),o=e("../internals/to-length");t.exports=function(e){if(void 0===e)return 0;e=n(e);var t=o(e);if(e!==t)throw RangeError("Wrong length or index");return t}},{"../internals/to-integer":135,"../internals/to-length":136}],134:[function(e,t,r){var n=e("../internals/indexed-object"),o=e("../internals/require-object-coercible");t.exports=function(e){return n(o(e))}},{"../internals/indexed-object":66,"../internals/require-object-coercible":113}],135:[function(e,t,r){var n=Math.ceil,o=Math.floor;t.exports=function(e){return isNaN(e=+e)?0:(0<e?o:n)(e)}},{}],136:[function(e,t,r){var n=e("../internals/to-integer"),o=Math.min;t.exports=function(e){return 0<e?o(n(e),9007199254740991):0}},{"../internals/to-integer":135}],137:[function(e,t,r){var n=e("../internals/require-object-coercible");t.exports=function(e){return Object(n(e))}},{"../internals/require-object-coercible":113}],138:[function(e,t,r){var n=e("../internals/to-positive-integer");t.exports=function(e,t){if((e=n(e))%t)throw RangeError("Wrong offset");return e}},{"../internals/to-positive-integer":139}],139:[function(e,t,r){var n=e("../internals/to-integer");t.exports=function(e){if((e=n(e))<0)throw RangeError("The argument can't be less than 0");return e}},{"../internals/to-integer":135}],140:[function(e,t,r){var n=e("../internals/is-object");t.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e))||"function"==typeof(r=e.valueOf)&&!n(o=r.call(e))||!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},{"../internals/is-object":74}],141:[function(e,t,r){var n={};n[e("../internals/well-known-symbol")("toStringTag")]="z",t.exports="[object z]"===String(n)},{"../internals/well-known-symbol":148}],142:[function(e,t,r){"use strict";function n(e,t){for(var r=0,n=t.length,o=new(q(e))(n);r<n;)o[r]=t[r++];return o}function o(e,t){D(e,t,{get:function(){return P(this)[t]}})}function s(e){return e instanceof U||"ArrayBuffer"==(e=S(e))||"SharedArrayBuffer"==e}function a(e,t){return X(e)&&"symbol"!=typeof t&&t in e&&String(+t)==String(t)}function i(e,t){return a(e,t=w(t,!0))?y(2,e[t]):F(e,t)}function l(e,t,r){return!(a(e,t=w(t,!0))&&k(r)&&_(r,"value"))||_(r,"get")||_(r,"set")||r.configurable||_(r,"writable")&&!r.writable||_(r,"enumerable")&&!r.enumerable?D(e,t,r):(e[t]=r.value,e)}var u=e("../internals/export"),c=e("../internals/global"),d=e("../internals/descriptors"),h=e("../internals/typed-array-constructors-require-wrappers"),p=e("../internals/array-buffer-view-core"),f=e("../internals/array-buffer"),m=e("../internals/an-instance"),y=e("../internals/create-property-descriptor"),g=e("../internals/create-non-enumerable-property"),v=e("../internals/to-length"),b=e("../internals/to-index"),x=e("../internals/to-offset"),w=e("../internals/to-primitive"),_=e("../internals/has"),S=e("../internals/classof"),k=e("../internals/is-object"),T=e("../internals/object-create"),E=e("../internals/object-set-prototype-of"),j=e("../internals/object-get-own-property-names").f,C=e("../internals/typed-array-from"),I=e("../internals/array-iteration").forEach,O=e("../internals/set-species"),A=e("../internals/object-define-property"),R=e("../internals/object-get-own-property-descriptor"),N=e("../internals/internal-state"),M=e("../internals/inherit-if-required"),P=N.get,L=N.set,D=A.f,F=R.f,$=Math.round,B=c.RangeError,U=f.ArrayBuffer,V=f.DataView,G=p.NATIVE_ARRAY_BUFFER_VIEWS,z=p.TYPED_ARRAY_TAG,W=p.TypedArray,H=p.TypedArrayPrototype,q=p.aTypedArrayConstructor,X=p.isTypedArray,Y="BYTES_PER_ELEMENT",K="Wrong length";d?(G||(R.f=i,A.f=l,o(H,"buffer"),o(H,"byteOffset"),o(H,"byteLength"),o(H,"length")),u({target:"Object",stat:!0,forced:!G},{getOwnPropertyDescriptor:i,defineProperty:l}),t.exports=function(e,t,r){function o(e,t){D(e,t,{get:function(){var e=this,r=t;return(e=P(e)).view[l](r*a+e.byteOffset,!0)},set:function(e){var n=this,o=t;n=P(n),r&&(e=(e=$(e))<0?0:255<e?255:255&e),n.view[d](o*a+n.byteOffset,e,!0)},enumerable:!0})}var a=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",l="get"+e,d="set"+e,p=c[i],f=p,y=(e=f&&f.prototype,{});G?h&&(f=t((function(e,t,r,o){return m(e,f,i),M(k(t)?s(t)?void 0!==o?new p(t,x(r,a),o):void 0!==r?new p(t,x(r,a)):new p(t):X(t)?n(f,t):C.call(f,t):new p(b(t)),e,f)})),E&&E(f,W),I(j(p),(function(e){e in f||g(f,e,p[e])})),f.prototype=e):(f=t((function(e,t,r,l){m(e,f,i);var u,c,d=0,h=0;if(k(t)){if(!s(t))return X(t)?n(f,t):C.call(f,t);var p=t;if(h=x(r,a),r=t.byteLength,void 0===l){if(r%a)throw B(K);if((u=r-h)<0)throw B(K)}else if(r<(u=v(l)*a)+h)throw B(K);c=u/a}else c=b(t),p=new U(u=c*a);for(L(e,{buffer:p,byteOffset:h,byteLength:u,length:c,view:new V(p)});d<c;)o(e,d++)})),E&&E(f,W),e=f.prototype=T(H)),e.constructor!==f&&g(e,"constructor",f),z&&g(e,z,i),y[i]=f,u({global:!0,forced:f!=p,sham:!G},y),Y in f||g(f,Y,a),Y in e||g(e,Y,a),O(i)}):t.exports=function(){}},{"../internals/an-instance":9,"../internals/array-buffer":13,"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/classof":29,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/descriptors":43,"../internals/export":50,"../internals/global":59,"../internals/has":60,"../internals/inherit-if-required":67,"../internals/internal-state":70,"../internals/is-object":74,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/object-set-prototype-of":101,"../internals/set-species":116,"../internals/to-index":133,"../internals/to-length":136,"../internals/to-offset":138,"../internals/to-primitive":140,"../internals/typed-array-constructors-require-wrappers":143,"../internals/typed-array-from":144}],143:[function(e,t,r){var n=e("../internals/global"),o=e("../internals/fails"),s=e("../internals/check-correctness-of-iteration"),a=(e=e("../internals/array-buffer-view-core").NATIVE_ARRAY_BUFFER_VIEWS,n.ArrayBuffer),i=n.Int8Array;t.exports=!e||!o((function(){i(1)}))||!o((function(){new i(-1)}))||!s((function(e){new i,new i(null),new i(1.5),new i(e)}),!0)||o((function(){return 1!==new i(new a(2),1,void 0).length}))},{"../internals/array-buffer-view-core":12,"../internals/check-correctness-of-iteration":27,"../internals/fails":51,"../internals/global":59}],144:[function(e,t,r){var n=e("../internals/to-object"),o=e("../internals/to-length"),s=e("../internals/get-iterator-method"),a=e("../internals/is-array-iterator-method"),i=e("../internals/function-bind-context"),l=e("../internals/array-buffer-view-core").aTypedArrayConstructor;t.exports=function(e){var t,r,u,c,d,h,p=n(e),f=arguments.length,m=1<f?arguments[1]:void 0,y=void 0!==m,g=s(p);if(null!=g&&!a(g))for(h=(d=g.call(p)).next,p=[];!(c=h.call(d)).done;)p.push(c.value);for(y&&2<f&&(m=i(m,arguments[2],2)),r=o(p.length),u=new(l(this))(r),t=0;t<r;t++)u[t]=y?m(p[t],t):p[t];return u}},{"../internals/array-buffer-view-core":12,"../internals/function-bind-context":54,"../internals/get-iterator-method":57,"../internals/is-array-iterator-method":71,"../internals/to-length":136,"../internals/to-object":137}],145:[function(e,t,r){var n=0,o=Math.random();t.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+o).toString(36)}},{}],146:[function(e,t,r){e=e("../internals/native-symbol"),t.exports=e&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},{"../internals/native-symbol":83}],147:[function(e,t,r){e=e("../internals/well-known-symbol"),r.f=e},{"../internals/well-known-symbol":148}],148:[function(e,t,r){var n=e("../internals/global"),o=e("../internals/shared"),s=e("../internals/has"),a=e("../internals/uid"),i=e("../internals/native-symbol"),l=(e=e("../internals/use-symbol-as-uid"),o("wks")),u=n.Symbol,c=e?u:u&&u.withoutSetter||a;t.exports=function(e){return s(l,e)||(i&&s(u,e)?l[e]=u[e]:l[e]=c("Symbol."+e)),l[e]}},{"../internals/global":59,"../internals/has":60,"../internals/native-symbol":83,"../internals/shared":120,"../internals/uid":145,"../internals/use-symbol-as-uid":146}],149:[function(e,t,r){t.exports="\t\n\v\f\r \u2028\u2029\ufeff"},{}],150:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/global"),s=e("../internals/array-buffer"),a=(e=e("../internals/set-species"),"ArrayBuffer");s=s[a],n({global:!0,forced:o[a]!==s},{ArrayBuffer:s}),e(a)},{"../internals/array-buffer":13,"../internals/export":50,"../internals/global":59,"../internals/set-species":116}],151:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/fails"),s=e("../internals/is-array"),a=e("../internals/is-object"),i=e("../internals/to-object"),l=e("../internals/to-length"),u=e("../internals/create-property"),c=e("../internals/array-species-create"),d=e("../internals/array-method-has-species-support"),h=e("../internals/well-known-symbol"),p=(e=e("../internals/engine-v8-version"),h("isConcatSpreadable")),f=9007199254740991,m="Maximum allowed index exceeded";h=51<=e||!o((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),e=d("concat"),n({target:"Array",proto:!0,forced:!h||!e},{concat:function(e){for(var t,r,n,o,d,h=i(this),y=c(h,0),g=0,v=-1,b=arguments.length;v<b;v++)if(d=void 0,a(o=n=-1===v?h:arguments[v])&&(void 0!==(d=o[p])?d:s(o))){if(r=l(n.length),f<g+r)throw TypeError(m);for(t=0;t<r;t++,g++)t in n&&u(y,g,n[t])}else{if(f<=g)throw TypeError(m);u(y,g++,n)}return y.length=g,y}})},{"../internals/array-method-has-species-support":21,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/fails":51,"../internals/is-array":72,"../internals/is-object":74,"../internals/to-length":136,"../internals/to-object":137,"../internals/well-known-symbol":148}],152:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/array-copy-within");e=e("../internals/add-to-unscopables"),n({target:"Array",proto:!0},{copyWithin:o}),e("copyWithin")},{"../internals/add-to-unscopables":7,"../internals/array-copy-within":14,"../internals/export":50}],153:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/array-iteration").every,s=e("../internals/array-method-is-strict");e=e("../internals/array-method-uses-to-length"),s=s("every"),e=e("every"),n({target:"Array",proto:!0,forced:!s||!e},{every:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],154:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/array-fill");e=e("../internals/add-to-unscopables"),n({target:"Array",proto:!0},{fill:o}),e("fill")},{"../internals/add-to-unscopables":7,"../internals/array-fill":15,"../internals/export":50}],155:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/array-iteration").filter,s=e("../internals/array-method-has-species-support");e=e("../internals/array-method-uses-to-length"),s=s("filter"),e=e("filter"),n({target:"Array",proto:!0,forced:!s||!e},{filter:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],156:[function(e,t,r){"use strict";var n=e("../internals/export");e=e("../internals/array-for-each"),n({target:"Array",proto:!0,forced:[].forEach!=e},{forEach:e})},{"../internals/array-for-each":16,"../internals/export":50}],157:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/array-from");n({target:"Array",stat:!0,forced:!e("../internals/check-correctness-of-iteration")((function(e){Array.from(e)}))},{from:o})},{"../internals/array-from":17,"../internals/check-correctness-of-iteration":27,"../internals/export":50}],158:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/array-includes").includes,s=e("../internals/add-to-unscopables");n({target:"Array",proto:!0,forced:!e("../internals/array-method-uses-to-length")("indexOf",{ACCESSORS:!0,1:0})},{includes:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}}),s("includes")},{"../internals/add-to-unscopables":7,"../internals/array-includes":18,"../internals/array-method-uses-to-length":23,"../internals/export":50}],159:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/array-includes").indexOf,s=e("../internals/array-method-is-strict"),a=(e=e("../internals/array-method-uses-to-length"),[].indexOf),i=!!a&&1/[1].indexOf(1,-0)<0;s=s("indexOf"),e=e("indexOf",{ACCESSORS:!0,1:0}),n({target:"Array",proto:!0,forced:i||!s||!e},{indexOf:function(e){return i?a.apply(this,arguments)||0:o(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-includes":18,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],160:[function(e,t,r){"use strict";var n=e("../internals/to-indexed-object"),o=e("../internals/add-to-unscopables"),s=e("../internals/iterators"),a=e("../internals/internal-state"),i=(e=e("../internals/define-iterator"),"Array Iterator"),l=a.set,u=a.getterFor(i);t.exports=e(Array,"Array",(function(e,t){l(this,{type:i,target:n(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?{value:e.target=void 0,done:!0}:"keys"==r?{value:n,done:!1}:"values"==r?{value:t[n],done:!1}:{value:[n,t[n]],done:!1}}),"values"),s.Arguments=s.Array,o("keys"),o("values"),o("entries")},{"../internals/add-to-unscopables":7,"../internals/define-iterator":41,"../internals/internal-state":70,"../internals/iterators":79,"../internals/to-indexed-object":134}],161:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/indexed-object"),s=e("../internals/to-indexed-object"),a=(e=e("../internals/array-method-is-strict"),[].join);o=o!=Object,e=e("join",","),n({target:"Array",proto:!0,forced:o||!e},{join:function(e){return a.call(s(this),void 0===e?",":e)}})},{"../internals/array-method-is-strict":22,"../internals/export":50,"../internals/indexed-object":66,"../internals/to-indexed-object":134}],162:[function(e,t,r){e("../internals/export")({target:"Array",proto:!0,forced:(e=e("../internals/array-last-index-of"))!==[].lastIndexOf},{lastIndexOf:e})},{"../internals/array-last-index-of":20,"../internals/export":50}],163:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/array-iteration").map,s=e("../internals/array-method-has-species-support");e=e("../internals/array-method-uses-to-length"),s=s("map"),e=e("map"),n({target:"Array",proto:!0,forced:!s||!e},{map:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/export":50}],164:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/is-object"),s=e("../internals/is-array"),a=e("../internals/to-absolute-index"),i=e("../internals/to-length"),l=e("../internals/to-indexed-object"),u=e("../internals/create-property"),c=e("../internals/well-known-symbol"),d=e("../internals/array-method-has-species-support"),h=(e=e("../internals/array-method-uses-to-length"),d=d("slice"),e=e("slice",{ACCESSORS:!0,0:0,1:2}),c("species")),p=[].slice,f=Math.max;n({target:"Array",proto:!0,forced:!d||!e},{slice:function(e,t){var r,n,c,d=l(this),m=i(d.length),y=a(e,m),g=a(void 0===t?m:t,m);if(s(d)&&((r="function"==typeof(r=d.constructor)&&(r===Array||s(r.prototype))||o(r)&&null===(r=r[h])?void 0:r)===Array||void 0===r))return p.call(d,y,g);for(n=new(void 0===r?Array:r)(f(g-y,0)),c=0;y<g;y++,c++)y in d&&u(n,c,d[y]);return n.length=c,n}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/create-property":40,"../internals/export":50,"../internals/is-array":72,"../internals/is-object":74,"../internals/to-absolute-index":132,"../internals/to-indexed-object":134,"../internals/to-length":136,"../internals/well-known-symbol":148}],165:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/array-iteration").some,s=e("../internals/array-method-is-strict");e=e("../internals/array-method-uses-to-length"),s=s("some"),e=e("some"),n({target:"Array",proto:!0,forced:!s||!e},{some:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/array-iteration":19,"../internals/array-method-is-strict":22,"../internals/array-method-uses-to-length":23,"../internals/export":50}],166:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/to-absolute-index"),s=e("../internals/to-integer"),a=e("../internals/to-length"),i=e("../internals/to-object"),l=e("../internals/array-species-create"),u=e("../internals/create-property"),c=e("../internals/array-method-has-species-support"),d=(e=e("../internals/array-method-uses-to-length"),c=c("splice"),e=e("splice",{ACCESSORS:!0,0:0,1:2}),Math.max),h=Math.min;n({target:"Array",proto:!0,forced:!c||!e},{splice:function(e,t){var r,n,c,p,f,m,y=i(this),g=a(y.length),v=o(e,g);if(0===(e=arguments.length)?r=n=0:n=1===e?(r=0,g-v):(r=e-2,h(d(s(t),0),g-v)),9007199254740991<g+r-n)throw TypeError("Maximum allowed length exceeded");for(c=l(y,n),p=0;p<n;p++)(f=v+p)in y&&u(c,p,y[f]);if(r<(c.length=n)){for(p=v;p<g-n;p++)m=p+r,(f=p+n)in y?y[m]=y[f]:delete y[m];for(p=g;g-n+r<p;p--)delete y[p-1]}else if(n<r)for(p=g-n;v<p;p--)m=p+r-1,(f=p+n-1)in y?y[m]=y[f]:delete y[m];for(p=0;p<r;p++)y[p+v]=arguments[p+2];return y.length=g-n+r,c}})},{"../internals/array-method-has-species-support":21,"../internals/array-method-uses-to-length":23,"../internals/array-species-create":25,"../internals/create-property":40,"../internals/export":50,"../internals/to-absolute-index":132,"../internals/to-integer":135,"../internals/to-length":136,"../internals/to-object":137}],167:[function(e,t,r){var n=e("../internals/descriptors"),o=(e=e("../internals/object-define-property").f,Function.prototype),s=o.toString,a=/^\s*function ([^ (]*)/;!n||"name"in o||e(o,"name",{configurable:!0,get:function(){try{return s.call(this).match(a)[1]}catch(e){return""}}})},{"../internals/descriptors":43,"../internals/object-define-property":92}],168:[function(e,t,r){"use strict";var n=e("../internals/collection");e=e("../internals/collection-strong"),t.exports=n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),e)},{"../internals/collection":32,"../internals/collection-strong":30}],169:[function(e,t,r){e=e("../internals/export");var n=Math.hypot,o=Math.abs,s=Math.sqrt;e({target:"Math",stat:!0,forced:!!n&&n(1/0,NaN)!==1/0},{hypot:function(e,t){for(var r,n,a=0,i=0,l=arguments.length,u=0;i<l;)u<(r=o(arguments[i++]))?(a=a*(n=u/r)*n+1,u=r):a+=0<r?(n=r/u)*n:r;return u===1/0?1/0:u*s(a)}})},{"../internals/export":50}],170:[function(e,t,r){e("../internals/export")({target:"Math",stat:!0},{sign:e("../internals/math-sign")})},{"../internals/export":50,"../internals/math-sign":80}],171:[function(e,t,r){"use strict";function n(e){var t,r,n,o,s,a,i,l=d(e,!1);if("string"==typeof l&&2<l.length)if(43===(e=(l=g(l)).charCodeAt(0))||45===e){if(88===(t=l.charCodeAt(2))||120===t)return NaN}else if(48===e){switch(l.charCodeAt(1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+l}for(s=(o=l.slice(2)).length,a=0;a<s;a++)if((i=o.charCodeAt(a))<48||n<i)return NaN;return parseInt(o,r)}return+l}var o=e("../internals/descriptors"),s=e("../internals/global"),a=e("../internals/is-forced"),i=e("../internals/redefine"),l=e("../internals/has"),u=e("../internals/classof-raw"),c=e("../internals/inherit-if-required"),d=e("../internals/to-primitive"),h=e("../internals/fails"),p=e("../internals/object-create"),f=e("../internals/object-get-own-property-names").f,m=e("../internals/object-get-own-property-descriptor").f,y=e("../internals/object-define-property").f,g=e("../internals/string-trim").trim,v="Number",b=s[v],x=b.prototype,w=u(p(x))==v;if(a(v,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var _,S=function(e){e=arguments.length<1?0:e;var t=this;return t instanceof S&&(w?h((function(){x.valueOf.call(t)})):u(t)!=v)?c(new b(n(e)),t,S):n(e)},k=o?f(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),T=0;k.length>T;T++)l(b,_=k[T])&&!l(S,_)&&y(S,_,m(b,_));(S.prototype=x).constructor=S,i(s,v,S)}},{"../internals/classof-raw":28,"../internals/descriptors":43,"../internals/fails":51,"../internals/global":59,"../internals/has":60,"../internals/inherit-if-required":67,"../internals/is-forced":73,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/redefine":108,"../internals/string-trim":129,"../internals/to-primitive":140}],172:[function(e,t,r){e("../internals/export")({target:"Number",stat:!0},{isFinite:e("../internals/number-is-finite")})},{"../internals/export":50,"../internals/number-is-finite":88}],173:[function(e,t,r){"use strict";function n(e,t,r){return 0===t?r:t%2==1?n(e,t-1,r*e):n(e*e,t/2,r)}var o=e("../internals/export"),s=e("../internals/to-integer"),a=e("../internals/this-number-value"),i=e("../internals/string-repeat"),l=(e=e("../internals/fails"),1..toFixed),u=Math.floor;o({target:"Number",proto:!0,forced:l&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!e((function(){l.call({})}))},{toFixed:function(e){function t(e,t){for(var r=-1,n=t;++r<6;)n+=e*h[r],h[r]=n%1e7,n=u(n/1e7)}function r(e){for(var t=6,r=0;0<=--t;)r+=h[t],h[t]=u(r/e),r=r%e*1e7}function o(){for(var e,t=6,r="";0<=--t;)""===r&&0!==t&&0===h[t]||(e=String(h[t]),r=""===r?e:r+i.call("0",7-e.length)+e);return r}var l,c,d=a(this),h=(e=s(e),[0,0,0,0,0,0]),p="",f="0";if(e<0||20<e)throw RangeError("Incorrect fraction digits");if(d!=d)return"NaN";if(d<=-1e21||1e21<=d)return String(d);if(d<0&&(p="-",d=-d),1e-21<d)if(d=(l=function(e){for(var t=0,r=e;4096<=r;)t+=12,r/=4096;for(;2<=r;)t+=1,r/=2;return t}(d*n(2,69,1))-69)<0?d*n(2,-l,1):d/n(2,l,1),d*=4503599627370496,0<(l=52-l)){for(t(0,d),c=e;7<=c;)t(1e7,0),c-=7;for(t(n(10,c,1),0),c=l-1;23<=c;)r(1<<23),c-=23;r(1<<c),t(1,1),r(2),f=o()}else t(0,d),t(1<<-l,0),f=o()+i.call("0",e);return 0<e?p+((d=f.length)<=e?"0."+i.call("0",e-d)+f:f.slice(0,d-e)+"."+f.slice(d-e)):p+f}})},{"../internals/export":50,"../internals/fails":51,"../internals/string-repeat":127,"../internals/this-number-value":131,"../internals/to-integer":135}],174:[function(e,t,r){var n=e("../internals/export");e=e("../internals/object-assign"),n({target:"Object",stat:!0,forced:Object.assign!==e},{assign:e})},{"../internals/export":50,"../internals/object-assign":89}],175:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/iterate"),s=e("../internals/create-property");n({target:"Object",stat:!0},{fromEntries:function(e){var t={};return o(e,(function(e,r){s(t,e,r)}),void 0,!0),t}})},{"../internals/create-property":40,"../internals/export":50,"../internals/iterate":77}],176:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/fails"),s=e("../internals/to-indexed-object"),a=e("../internals/object-get-own-property-descriptor").f;e=e("../internals/descriptors"),o=o((function(){a(1)})),n({target:"Object",stat:!0,forced:!e||o,sham:!e},{getOwnPropertyDescriptor:function(e,t){return a(s(e),t)}})},{"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-descriptor":93,"../internals/to-indexed-object":134}],177:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/fails");e=e("../internals/object-get-own-property-names-external").f,n({target:"Object",stat:!0,forced:o((function(){return!Object.getOwnPropertyNames(1)}))},{getOwnPropertyNames:e})},{"../internals/export":50,"../internals/fails":51,"../internals/object-get-own-property-names-external":94}],178:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/fails"),s=e("../internals/to-object"),a=e("../internals/object-get-prototype-of");e=e("../internals/correct-prototype-getter"),n({target:"Object",stat:!0,forced:o((function(){a(1)})),sham:!e},{getPrototypeOf:function(e){return a(s(e))}})},{"../internals/correct-prototype-getter":35,"../internals/export":50,"../internals/fails":51,"../internals/object-get-prototype-of":97,"../internals/to-object":137}],179:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/to-object"),s=e("../internals/object-keys");n({target:"Object",stat:!0,forced:e("../internals/fails")((function(){s(1)}))},{keys:function(e){return s(o(e))}})},{"../internals/export":50,"../internals/fails":51,"../internals/object-keys":99,"../internals/to-object":137}],180:[function(e,t,r){var n=e("../internals/to-string-tag-support"),o=e("../internals/redefine");e=e("../internals/object-to-string"),n||o(Object.prototype,"toString",e,{unsafe:!0})},{"../internals/object-to-string":102,"../internals/redefine":108,"../internals/to-string-tag-support":141}],181:[function(e,t,r){"use strict";var n,o,s,a,i=e("../internals/export"),l=e("../internals/is-pure"),u=e("../internals/global"),c=e("../internals/get-built-in"),d=e("../internals/native-promise-constructor"),h=e("../internals/redefine"),p=e("../internals/redefine-all"),f=e("../internals/set-to-string-tag"),m=e("../internals/set-species"),y=e("../internals/is-object"),g=e("../internals/a-function"),v=e("../internals/an-instance"),b=e("../internals/classof-raw"),x=e("../internals/inspect-source"),w=e("../internals/iterate"),_=e("../internals/check-correctness-of-iteration"),S=e("../internals/species-constructor"),k=e("../internals/task").set,T=e("../internals/microtask"),E=e("../internals/promise-resolve"),j=e("../internals/host-report-errors"),C=e("../internals/new-promise-capability"),I=e("../internals/perform"),O=e("../internals/internal-state"),A=e("../internals/is-forced"),R=e("../internals/well-known-symbol"),N=e("../internals/engine-v8-version"),M=R("species"),P="Promise",L=O.get,D=O.set,F=O.getterFor(P),$=d,B=u.TypeError,U=u.document,V=u.process,G=c("fetch"),z=C.f,W=z,H="process"==b(V),q=!!(U&&U.createEvent&&u.dispatchEvent),X="unhandledrejection",Y=(e=A(P,(function(){var e,t;if(x($)===String($)){if(66===N)return!0;if(!H&&"function"!=typeof PromiseRejectionEvent)return!0}return!((!l||$.prototype.finally)&&(51<=N&&/native code/.test($)||(t=function(e){e((function(){}),(function(){}))},((e=$.resolve(1)).constructor={})[M]=t,e.then((function(){}))instanceof t)))})),R=e||!_((function(e){$.all(e).catch((function(){}))})),function(e){var t;return!(!y(e)||"function"!=typeof(t=e.then))&&t}),K=function(e,t,r){var n;t.notified||(t.notified=!0,n=t.reactions,T((function(){for(var o,s,a=t.value,i=1==t.state,l=0;n.length>l;){var c,d,h,p=n[l++],f=i?p.ok:p.fail,m=p.resolve,y=p.reject,g=p.domain;try{f?(i||(2===t.rejection&&function(e,t){k.call(u,(function(){H?V.emit("rejectionHandled",e):Z("rejectionhandled",e,t.value)}))}(e,t),t.rejection=1),!0===f?c=a:(g&&g.enter(),c=f(a),g&&(g.exit(),h=!0)),c===p.promise?y(B("Promise-chain cycle")):(d=Y(c))?d.call(c,m,y):m(c)):y(a)}catch(a){g&&!h&&g.exit(),y(a)}}t.reactions=[],t.notified=!1,r&&!t.rejection&&(o=e,s=t,k.call(u,(function(){var e=s.value,t=Q(s);if(t&&(t=I((function(){H?V.emit("unhandledRejection",e,o):Z(X,o,e)})),s.rejection=H||Q(s)?2:1,t.error))throw t.value})))})))},Z=function(e,t,r){var n;q?((n=U.createEvent("Event")).promise=t,n.reason=r,n.initEvent(e,!1,!0),u.dispatchEvent(n)):n={promise:t,reason:r},(t=u["on"+e])?t(n):e===X&&j("Unhandled promise rejection",r)},Q=function(e){return 1!==e.rejection&&!e.parent},J=function(e,t,r,n){return function(o){e(t,r,o,n)}},ee=function(e,t,r,n){t.done||(t.done=!0,(t=n||t).value=r,t.state=2,K(e,t,!0))},te=function(e,t,r,n){if(!t.done){t.done=!0,n&&(t=n);try{if(e===r)throw B("Promise can't be resolved itself");var o=Y(r);o?T((function(){var n={done:!1};try{o.call(r,J(te,e,n,t),J(ee,e,n,t))}catch(r){ee(e,n,r,t)}})):(t.value=r,t.state=1,K(e,t,!1))}catch(r){ee(e,{done:!1},r,t)}}};e&&($=function(e){v(this,$,P),g(e),n.call(this);var t=L(this);try{e(J(te,this,t),J(ee,this,t))}catch(e){ee(this,t,e)}},(n=function(e){D(this,{type:P,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=p($.prototype,{then:function(e,t){var r=F(this),n=z(S(this,$));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=H?V.domain:void 0,r.parent=!0,r.reactions.push(n),0!=r.state&&K(this,r,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new n,t=L(e);this.promise=e,this.resolve=J(te,e,t),this.reject=J(ee,e,t)},C.f=z=function(e){return e===$||e===s?new o:W(e)},l||"function"!=typeof d||(a=d.prototype.then,h(d.prototype,"then",(function(e,t){var r=this;return new $((function(e,t){a.call(r,e,t)})).then(e,t)}),{unsafe:!0}),"function"==typeof G&&i({global:!0,enumerable:!0,forced:!0},{fetch:function(e){return E($,G.apply(u,arguments))}}))),i({global:!0,wrap:!0,forced:e},{Promise:$}),f($,P,!1,!0),m(P),s=c(P),i({target:P,stat:!0,forced:e},{reject:function(e){var t=z(this);return t.reject.call(void 0,e),t.promise}}),i({target:P,stat:!0,forced:l||e},{resolve:function(e){return E(l&&this===s?$:this,e)}}),i({target:P,stat:!0,forced:R},{all:function(e){var t=this,r=z(t),n=r.resolve,o=r.reject,s=I((function(){var r=g(t.resolve),s=[],a=0,i=1;w(e,(function(e){var l=a++,u=!1;s.push(void 0),i++,r.call(t,e).then((function(e){u||(u=!0,s[l]=e,--i||n(s))}),o)})),--i||n(s)}));return s.error&&o(s.value),r.promise},race:function(e){var t=this,r=z(t),n=r.reject,o=I((function(){var o=g(t.resolve);w(e,(function(e){o.call(t,e).then(r.resolve,n)}))}));return o.error&&n(o.value),r.promise}})},{"../internals/a-function":5,"../internals/an-instance":9,"../internals/check-correctness-of-iteration":27,"../internals/classof-raw":28,"../internals/engine-v8-version":48,"../internals/export":50,"../internals/get-built-in":56,"../internals/global":59,"../internals/host-report-errors":62,"../internals/inspect-source":68,"../internals/internal-state":70,"../internals/is-forced":73,"../internals/is-object":74,"../internals/is-pure":75,"../internals/iterate":77,"../internals/microtask":81,"../internals/native-promise-constructor":82,"../internals/new-promise-capability":86,"../internals/perform":105,"../internals/promise-resolve":106,"../internals/redefine":108,"../internals/redefine-all":107,"../internals/set-species":116,"../internals/set-to-string-tag":117,"../internals/species-constructor":121,"../internals/task":130,"../internals/well-known-symbol":148}],182:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/get-built-in"),s=e("../internals/a-function"),a=e("../internals/an-object"),i=e("../internals/is-object"),l=e("../internals/object-create"),u=e("../internals/function-bind"),c=(e=e("../internals/fails"),o("Reflect","construct")),d=e((function(){function e(){}return!(c((function(){}),[],e)instanceof e)})),h=!e((function(){c((function(){}))}));n({target:"Reflect",stat:!0,forced:o=d||h,sham:o},{construct:function(e,t){s(e),a(t);var r=arguments.length<3?e:s(arguments[2]);if(h&&!d)return c(e,t,r);if(e==r){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var n=[null];return n.push.apply(n,t),new(u.apply(e,n))}return n=r.prototype,r=l(i(n)?n:Object.prototype),n=Function.apply.call(e,r,t),i(n)?n:r}})},{"../internals/a-function":5,"../internals/an-object":10,"../internals/export":50,"../internals/fails":51,"../internals/function-bind":55,"../internals/get-built-in":56,"../internals/is-object":74,"../internals/object-create":90}],183:[function(e,t,r){var n=e("../internals/export"),o=e("../internals/is-object"),s=e("../internals/an-object"),a=e("../internals/has"),i=e("../internals/object-get-own-property-descriptor"),l=e("../internals/object-get-prototype-of");n({target:"Reflect",stat:!0},{get:function e(t,r){var n,u=arguments.length<3?t:arguments[2];return s(t)===u?t[r]:(n=i.f(t,r))?a(n,"value")?n.value:void 0===n.get?void 0:n.get.call(u):o(n=l(t))?e(n,r,u):void 0}})},{"../internals/an-object":10,"../internals/export":50,"../internals/has":60,"../internals/is-object":74,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-prototype-of":97}],184:[function(e,t,r){var n=e("../internals/descriptors"),o=e("../internals/global"),s=e("../internals/is-forced"),a=e("../internals/inherit-if-required"),i=e("../internals/object-define-property").f,l=e("../internals/object-get-own-property-names").f,u=e("../internals/is-regexp"),c=e("../internals/regexp-flags"),d=e("../internals/regexp-sticky-helpers"),h=e("../internals/redefine"),p=e("../internals/fails"),f=e("../internals/internal-state").set,m=e("../internals/set-species"),y=e("../internals/well-known-symbol")("match"),g=o.RegExp,v=g.prototype,b=/a/g,x=/a/g,w=new g(b)!==b,_=d.UNSUPPORTED_Y;if(n&&s("RegExp",!w||_||p((function(){return x[y]=!1,g(b)!=b||g(x)==x||"/a/i"!=g(b,"i")})))){for(var S=function(e,t){var r,n=this instanceof S,o=u(e),s=void 0===t;return!n&&o&&e.constructor===S&&s?e:(w?o&&!s&&(e=e.source):e instanceof S&&(s&&(t=c.call(e)),e=e.source),_&&(r=!!t&&-1<t.indexOf("y"))&&(t=t.replace(/y/g,"")),o=a(w?new g(e,t):g(e,t),n?this:v,S),_&&r&&f(o,{sticky:r}),o)},k=l(g),T=0;k.length>T;)!function(e){e in S||i(S,e,{configurable:!0,get:function(){return g[e]},set:function(t){g[e]=t}})}(k[T++]);(v.constructor=S).prototype=v,h(o,"RegExp",S)}m("RegExp")},{"../internals/descriptors":43,"../internals/fails":51,"../internals/global":59,"../internals/inherit-if-required":67,"../internals/internal-state":70,"../internals/is-forced":73,"../internals/is-regexp":76,"../internals/object-define-property":92,"../internals/object-get-own-property-names":95,"../internals/redefine":108,"../internals/regexp-flags":111,"../internals/regexp-sticky-helpers":112,"../internals/set-species":116,"../internals/well-known-symbol":148}],185:[function(e,t,r){"use strict";var n=e("../internals/export");e=e("../internals/regexp-exec"),n({target:"RegExp",proto:!0,forced:/./.exec!==e},{exec:e})},{"../internals/export":50,"../internals/regexp-exec":110}],186:[function(e,t,r){"use strict";var n=e("../internals/redefine"),o=e("../internals/an-object"),s=e("../internals/fails"),a=e("../internals/regexp-flags"),i=(e="toString",RegExp.prototype),l=i[e],u=(s=s((function(){return"/a/b"!=l.call({source:"a",flags:"b"})})),l.name!=e);(s||u)&&n(RegExp.prototype,e,(function(){var e=o(this),t=String(e.source),r=e.flags;return"/"+t+"/"+String(void 0===r&&e instanceof RegExp&&!("flags"in i)?a.call(e):r)}),{unsafe:!0})},{"../internals/an-object":10,"../internals/fails":51,"../internals/redefine":108,"../internals/regexp-flags":111}],187:[function(e,t,r){"use strict";var n=e("../internals/collection");e=e("../internals/collection-strong"),t.exports=n("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),e)},{"../internals/collection":32,"../internals/collection-strong":30}],188:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/to-length"),a=e("../internals/not-a-regexp"),i=e("../internals/require-object-coercible"),l=e("../internals/correct-is-regexp-logic"),u=(e=e("../internals/is-pure"),"".endsWith),c=Math.min;l=l("endsWith"),n({target:"String",proto:!0,forced:!(!e&&!l&&(n=o(String.prototype,"endsWith"))&&!n.writable||l)},{endsWith:function(e){var t=String(i(this)),r=(a(e),1<arguments.length?arguments[1]:void 0),n=s(t.length);return r=void 0===r?n:c(s(r),n),n=String(e),u?u.call(t,n,r):t.slice(r-n.length,r)===n}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/is-pure":75,"../internals/not-a-regexp":87,"../internals/object-get-own-property-descriptor":93,"../internals/require-object-coercible":113,"../internals/to-length":136}],189:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/not-a-regexp"),s=e("../internals/require-object-coercible");n({target:"String",proto:!0,forced:!e("../internals/correct-is-regexp-logic")("includes")},{includes:function(e){return!!~String(s(this)).indexOf(o(e),1<arguments.length?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/not-a-regexp":87,"../internals/require-object-coercible":113}],190:[function(e,t,r){"use strict";var n=e("../internals/string-multibyte").charAt,o=e("../internals/internal-state"),s=(e=e("../internals/define-iterator"),"String Iterator"),a=o.set,i=o.getterFor(s);e(String,"String",(function(e){a(this,{type:s,string:String(e),index:0})}),(function(){var e=i(this),t=e.string,r=e.index;return r>=t.length?{value:void 0,done:!0}:(t=n(t,r),e.index+=t.length,{value:t,done:!1})}))},{"../internals/define-iterator":41,"../internals/internal-state":70,"../internals/string-multibyte":123}],191:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),o=e("../internals/an-object"),s=e("../internals/to-length"),a=e("../internals/require-object-coercible"),i=e("../internals/advance-string-index"),l=e("../internals/regexp-exec-abstract");n("match",1,(function(e,t,r){return[function(t){var r=a(this),n=null==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n=r(t,e,this);if(n.done)return n.value;var a=o(e),u=String(this);if(!a.global)return l(a,u);for(var c=a.unicode,d=[],h=a.lastIndex=0;null!==(p=l(a,u));){var p=String(p[0]);""===(d[h]=p)&&(a.lastIndex=i(u,s(a.lastIndex),c)),h++}return 0===h?null:d}]}))},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/to-length":136}],192:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/string-pad").start;n({target:"String",proto:!0,forced:e("../internals/string-pad-webkit-bug")},{padStart:function(e){return o(this,e,1<arguments.length?arguments[1]:void 0)}})},{"../internals/export":50,"../internals/string-pad":125,"../internals/string-pad-webkit-bug":124}],193:[function(e,t,r){e("../internals/export")({target:"String",proto:!0},{repeat:e("../internals/string-repeat")})},{"../internals/export":50,"../internals/string-repeat":127}],194:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),o=e("../internals/an-object"),s=e("../internals/to-object"),a=e("../internals/to-length"),i=e("../internals/to-integer"),l=e("../internals/require-object-coercible"),u=e("../internals/advance-string-index"),c=e("../internals/regexp-exec-abstract"),d=Math.max,h=Math.min,p=Math.floor,f=/\$([$&'`]|\d\d?|<[^>]*>)/g,m=/\$([$&'`]|\d\d?)/g;n("replace",2,(function(e,t,r,n){var y=n.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,g=n.REPLACE_KEEPS_$0,v=y?"$":"$0";return[function(r,n){var o=l(this),s=null==r?void 0:r[e];return void 0!==s?s.call(r,o,n):t.call(String(o),r,n)},function(e,n){if(!y&&g||"string"==typeof n&&-1===n.indexOf(v)){var l=r(t,e,this,n);if(l.done)return l.value}for(var b,x=o(e),w=String(this),_="function"==typeof n,S=(_||(n=String(n)),x.global),k=(S&&(b=x.unicode,x.lastIndex=0),[]);null!==(I=c(x,w))&&(k.push(I),S);)""===String(I[0])&&(x.lastIndex=u(w,a(x.lastIndex),b));for(var T,E="",j=0,C=0;C<k.length;C++){for(var I=k[C],O=String(I[0]),A=d(h(i(I.index),w.length),0),R=[],N=1;N<I.length;N++)R.push(void 0===(T=I[N])?T:String(T));var M=I.groups,P=_?(P=[O].concat(R,A,w),void 0!==M&&P.push(M),String(n.apply(void 0,P))):function(e,r,n,o,a,i){var l=n+e.length,u=o.length,c=m;return void 0!==a&&(a=s(a),c=f),t.call(i,c,(function(t,s){var i;switch(s.charAt(0)){case"$":return"$";case"&":return e;case"`":return r.slice(0,n);case"'":return r.slice(l);case"<":i=a[s.slice(1,-1)];break;default:var c,d=+s;if(0==d)return t;if(u<d)return 0!==(c=p(d/10))&&c<=u?void 0===o[c-1]?s.charAt(1):o[c-1]+s.charAt(1):t;i=o[d-1]}return void 0===i?"":i}))}(O,w,A,R,M,n);j<=A&&(E+=w.slice(j,A)+P,j=A+O.length)}return E+w.slice(j)}]}))},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/to-integer":135,"../internals/to-length":136,"../internals/to-object":137}],195:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),o=e("../internals/an-object"),s=e("../internals/require-object-coercible"),a=e("../internals/same-value"),i=e("../internals/regexp-exec-abstract");n("search",1,(function(e,t,r){return[function(t){var r=s(this),n=null==t?void 0:t[e];return void 0!==n?n.call(t,r):new RegExp(t)[e](String(r))},function(e){var n,s=r(t,e,this);return s.done?s.value:(s=o(e),e=String(this),n=s.lastIndex,a(n,0)||(s.lastIndex=0),e=i(s,e),a(s.lastIndex,n)||(s.lastIndex=n),null===e?-1:e.index)}]}))},{"../internals/an-object":10,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/same-value":114}],196:[function(e,t,r){"use strict";var n=e("../internals/fix-regexp-well-known-symbol-logic"),o=e("../internals/is-regexp"),s=e("../internals/an-object"),a=e("../internals/require-object-coercible"),i=e("../internals/species-constructor"),l=e("../internals/advance-string-index"),u=e("../internals/to-length"),c=e("../internals/regexp-exec-abstract"),d=e("../internals/regexp-exec"),h=(e=e("../internals/fails"),[].push),p=Math.min,f=4294967295,m=!e((function(){return!RegExp(f,"y")}));n("split",2,(function(e,t,r){var n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||1<".".split(/()()/).length||"".split(/.?/).length?function(e,r){var n=String(a(this)),s=void 0===r?f:r>>>0;if(0==s)return[];if(void 0===e)return[n];if(!o(e))return t.call(n,e,s);for(var i,l,u,c=[],p=(r=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),0),m=new RegExp(e.source,r+"g");(i=d.call(m,n))&&!(p<(l=m.lastIndex)&&(c.push(n.slice(p,i.index)),1<i.length&&i.index<n.length&&h.apply(c,i.slice(1)),u=i[0].length,p=l,c.length>=s));)m.lastIndex===i.index&&m.lastIndex++;return p===n.length?!u&&m.test("")||c.push(""):c.push(n.slice(p)),c.length>s?c.slice(0,s):c}:"0".split(void 0,0).length?function(e,r){return void 0===e&&0===r?[]:t.call(this,e,r)}:t;return[function(t,r){var o=a(this),s=null==t?void 0:t[e];return void 0!==s?s.call(t,o,r):n.call(String(o),t,r)},function(e,o){if((a=r(n,e,this,o,n!==t)).done)return a.value;var a=s(e),d=String(this),h=(e=i(a,RegExp),a.unicode),y=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(m?"y":"g"),g=new e(m?a:"^(?:"+a.source+")",y),v=void 0===o?f:o>>>0;if(0==v)return[];if(0===d.length)return null===c(g,d)?[d]:[];for(var b=0,x=0,w=[];x<d.length;){g.lastIndex=m?x:0;var _,S=c(g,m?d:d.slice(x));if(null===S||(_=p(u(g.lastIndex+(m?0:x)),d.length))===b)x=l(d,x,h);else{if(w.push(d.slice(b,x)),w.length===v)return w;for(var k=1;k<=S.length-1;k++)if(w.push(S[k]),w.length===v)return w;x=b=_}}return w.push(d.slice(b)),w}]}),!m)},{"../internals/advance-string-index":8,"../internals/an-object":10,"../internals/fails":51,"../internals/fix-regexp-well-known-symbol-logic":52,"../internals/is-regexp":76,"../internals/regexp-exec":110,"../internals/regexp-exec-abstract":109,"../internals/require-object-coercible":113,"../internals/species-constructor":121,"../internals/to-length":136}],197:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/object-get-own-property-descriptor").f,s=e("../internals/to-length"),a=e("../internals/not-a-regexp"),i=e("../internals/require-object-coercible"),l=e("../internals/correct-is-regexp-logic"),u=(e=e("../internals/is-pure"),"".startsWith),c=Math.min;l=l("startsWith"),n({target:"String",proto:!0,forced:!(!e&&!l&&(n=o(String.prototype,"startsWith"))&&!n.writable||l)},{startsWith:function(e){var t=String(i(this)),r=(a(e),s(c(1<arguments.length?arguments[1]:void 0,t.length)));return e=String(e),u?u.call(t,e,r):t.slice(r,r+e.length)===e}})},{"../internals/correct-is-regexp-logic":34,"../internals/export":50,"../internals/is-pure":75,"../internals/not-a-regexp":87,"../internals/object-get-own-property-descriptor":93,"../internals/require-object-coercible":113,"../internals/to-length":136}],198:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/create-html");n({target:"String",proto:!0,forced:e("../internals/string-html-forced")("sub")},{sub:function(){return o(this,"sub","","")}})},{"../internals/create-html":36,"../internals/export":50,"../internals/string-html-forced":122}],199:[function(e,t,r){"use strict";var n=e("../internals/export"),o=e("../internals/string-trim").trim;n({target:"String",proto:!0,forced:e("../internals/string-trim-forced")("trim")},{trim:function(){return o(this)}})},{"../internals/export":50,"../internals/string-trim":129,"../internals/string-trim-forced":128}],200:[function(e,t,r){"use strict";var n,o,s,a,i,l=e("../internals/export"),u=e("../internals/descriptors"),c=e("../internals/global"),d=e("../internals/has"),h=e("../internals/is-object"),p=e("../internals/object-define-property").f,f=(e=e("../internals/copy-constructor-properties"),c.Symbol);!u||"function"!=typeof f||"description"in f.prototype&&void 0===f().description||(n={},e(o=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof o?new f(e):void 0===e?f():f(e);return""===e&&(n[t]=!0),t},f),(c=o.prototype=f.prototype).constructor=o,s=c.toString,a="Symbol(test)"==String(f("test")),i=/^Symbol\((.*)\)[^)]+$/,p(c,"description",{configurable:!0,get:function(){var e=h(this)?this.valueOf():this,t=s.call(e);return d(n,e)?"":""===(e=a?t.slice(7,-1):t.replace(i,"$1"))?void 0:e}}),l({global:!0,forced:!0},{Symbol:o}))},{"../internals/copy-constructor-properties":33,"../internals/descriptors":43,"../internals/export":50,"../internals/global":59,"../internals/has":60,"../internals/is-object":74,"../internals/object-define-property":92}],201:[function(e,t,r){e("../internals/define-well-known-symbol")("iterator")},{"../internals/define-well-known-symbol":42}],202:[function(e,t,r){"use strict";function n(e,t){var r=te[e]=S(Y[W]);return H(r,{type:z,tag:e,description:t}),d||(r.description=t),r}function o(e,t){v(e);var r=x(t);return t=k(r).concat(ce(r)),V(t,(function(t){d&&!ue.call(r,t)||le(e,t,r[t])})),e}function s(e,t){var r;if(e=x(e),t=w(t,!0),e!==X||!m(te,t)||m(re,t))return!(r=Z(e,t))||!m(te,t)||m(e,G)&&e[G][t]||(r.enumerable=!0),r}function a(e){e=J(x(e));var t=[];return V(e,(function(e){m(te,e)||m(P,e)||t.push(e)})),t}var i=e("../internals/export"),l=e("../internals/global"),u=e("../internals/get-built-in"),c=e("../internals/is-pure"),d=e("../internals/descriptors"),h=e("../internals/native-symbol"),p=e("../internals/use-symbol-as-uid"),f=e("../internals/fails"),m=e("../internals/has"),y=e("../internals/is-array"),g=e("../internals/is-object"),v=e("../internals/an-object"),b=e("../internals/to-object"),x=e("../internals/to-indexed-object"),w=e("../internals/to-primitive"),_=e("../internals/create-property-descriptor"),S=e("../internals/object-create"),k=e("../internals/object-keys"),T=e("../internals/object-get-own-property-names"),E=e("../internals/object-get-own-property-names-external"),j=e("../internals/object-get-own-property-symbols"),C=e("../internals/object-get-own-property-descriptor"),I=e("../internals/object-define-property"),O=e("../internals/object-property-is-enumerable"),A=e("../internals/create-non-enumerable-property"),R=e("../internals/redefine"),N=e("../internals/shared"),M=e("../internals/shared-key"),P=e("../internals/hidden-keys"),L=e("../internals/uid"),D=e("../internals/well-known-symbol"),F=e("../internals/well-known-symbol-wrapped"),$=e("../internals/define-well-known-symbol"),B=e("../internals/set-to-string-tag"),U=e("../internals/internal-state"),V=e("../internals/array-iteration").forEach,G=M("hidden"),z="Symbol",W="prototype",H=(e=D("toPrimitive"),U.set),q=U.getterFor(z),X=Object[W],Y=l.Symbol,K=u("JSON","stringify"),Z=C.f,Q=I.f,J=E.f,ee=O.f,te=N("symbols"),re=N("op-symbols"),ne=N("string-to-symbol-registry"),oe=N("symbol-to-string-registry"),se=(M=N("wks"),!(U=l.QObject)||!U[W]||!U[W].findChild),ae=d&&f((function(){return 7!=S(Q({},"a",{get:function(){return Q(this,"a",{value:7}).a}})).a}))?function(e,t,r){var n=Z(X,t);n&&delete X[t],Q(e,t,r),n&&e!==X&&Q(X,t,n)}:Q,ie=p?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Y},le=function(e,t,r){return e===X&&le(re,t,r),v(e),t=w(t,!0),v(r),(m(te,t)?(r.enumerable?(m(e,G)&&e[G][t]&&(e[G][t]=!1),r=S(r,{enumerable:_(0,!1)})):(m(e,G)||Q(e,G,_(1,{})),e[G][t]=!0),ae):Q)(e,t,r)},ue=function(e){e=w(e,!0);var t=ee.call(this,e);return!(this===X&&m(te,e)&&!m(re,e))&&(!(t||!m(this,e)||!m(te,e)||m(this,G)&&this[G][e])||t)},ce=function(e){var t=e===X,r=(e=J(t?re:x(e)),[]);return V(e,(function(e){!m(te,e)||t&&!m(X,e)||r.push(te[e])})),r};h||(R((Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=L(e),r=function(e){this===X&&r.call(re,e),m(this,G)&&m(this[G],t)&&(this[G][t]=!1),ae(this,t,_(1,e))};return d&&se&&ae(X,t,{configurable:!0,set:r}),n(t,e)})[W],"toString",(function(){return q(this).tag})),R(Y,"withoutSetter",(function(e){return n(L(e),e)})),O.f=ue,I.f=le,C.f=s,T.f=E.f=a,j.f=ce,F.f=function(e){return n(D(e),e)},d&&(Q(Y[W],"description",{configurable:!0,get:function(){return q(this).description}}),c||R(X,"propertyIsEnumerable",ue,{unsafe:!0}))),i({global:!0,wrap:!0,forced:!h,sham:!h},{Symbol:Y}),V(k(M),(function(e){$(e)})),i({target:z,stat:!0,forced:!h},{for:function(e){var t;return e=String(e),m(ne,e)?ne[e]:(t=Y(e),ne[e]=t,oe[t]=e,t)},keyFor:function(e){if(!ie(e))throw TypeError(e+" is not a symbol");if(m(oe,e))return oe[e]},useSetter:function(){se=!0},useSimple:function(){se=!1}}),i({target:"Object",stat:!0,forced:!h,sham:!d},{create:function(e,t){return void 0===t?S(e):o(S(e),t)},defineProperty:le,defineProperties:o,getOwnPropertyDescriptor:s}),i({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:a,getOwnPropertySymbols:ce}),i({target:"Object",stat:!0,forced:f((function(){j.f(1)}))},{getOwnPropertySymbols:function(e){return j.f(b(e))}}),K&&i({target:"JSON",stat:!0,forced:!h||f((function(){var e=Y();return"[null]"!=K([e])||"{}"!=K({a:e})||"{}"!=K(Object(e))}))},{stringify:function(e,t,r){for(var n,o=[e],s=1;s<arguments.length;)o.push(arguments[s++]);if((g(n=t)||void 0!==e)&&!ie(e))return y(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!ie(t))return t}),o[1]=t,K.apply(null,o)}}),Y[W][e]||A(Y[W],e,Y[W].valueOf),B(Y,z),P[G]=!0},{"../internals/an-object":10,"../internals/array-iteration":19,"../internals/create-non-enumerable-property":38,"../internals/create-property-descriptor":39,"../internals/define-well-known-symbol":42,"../internals/descriptors":43,"../internals/export":50,"../internals/fails":51,"../internals/get-built-in":56,"../internals/global":59,"../internals/has":60,"../internals/hidden-keys":61,"../internals/internal-state":70,"../internals/is-array":72,"../internals/is-object":74,"../internals/is-pure":75,"../internals/native-symbol":83,"../internals/object-create":90,"../internals/object-define-property":92,"../internals/object-get-own-property-descriptor":93,"../internals/object-get-own-property-names":95,"../internals/object-get-own-property-names-external":94,"../internals/object-get-own-property-symbols":96,"../internals/object-keys":99,"../internals/object-property-is-enumerable":100,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/shared":120,"../internals/shared-key":118,"../internals/to-indexed-object":134,"../internals/to-object":137,"../internals/to-primitive":140,"../internals/uid":145,"../internals/use-symbol-as-uid":146,"../internals/well-known-symbol":148,"../internals/well-known-symbol-wrapped":147}],203:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-copy-within"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("copyWithin",(function(e,t){return o.call(s(this),e,t,2<arguments.length?arguments[2]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-copy-within":14}],204:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-iteration").every,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("every",(function(e){return o(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],205:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-fill"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("fill",(function(e){return o.apply(s(this),arguments)}))},{"../internals/array-buffer-view-core":12,"../internals/array-fill":15}],206:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-iteration").filter,s=e("../internals/species-constructor"),a=n.aTypedArray,i=n.aTypedArrayConstructor;(0,n.exportTypedArrayMethod)("filter",(function(e){for(var t=o(a(this),e,1<arguments.length?arguments[1]:void 0),r=(e=s(this,this.constructor),0),n=t.length,l=new(i(e))(n);r<n;)l[r]=t[r++];return l}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":121}],207:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-iteration").findIndex,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("findIndex",(function(e){return o(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],208:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-iteration").find,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("find",(function(e){return o(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],209:[function(e,t,r){e("../internals/typed-array-constructor")("Float32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":142}],210:[function(e,t,r){e("../internals/typed-array-constructor")("Float64",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":142}],211:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-iteration").forEach,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("forEach",(function(e){o(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],212:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-includes").includes,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("includes",(function(e){return o(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],213:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-includes").indexOf,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("indexOf",(function(e){return o(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-includes":18}],214:[function(e,t,r){e("../internals/typed-array-constructor")("Int16",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":142}],215:[function(e,t,r){e("../internals/typed-array-constructor")("Int32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":142}],216:[function(e,t,r){"use strict";function n(){return i.call(c(this))}var o=e("../internals/global"),s=e("../internals/array-buffer-view-core"),a=e("../modules/es.array.iterator"),i=(e=e("../internals/well-known-symbol")("iterator"),o=o.Uint8Array,a.values),l=a.keys,u=a.entries,c=s.aTypedArray;a=s.exportTypedArrayMethod,o=!!(s=o&&o.prototype[e])&&("values"==s.name||null==s.name),a("entries",(function(){return u.call(c(this))})),a("keys",(function(){return l.call(c(this))})),a("values",n,!o),a(e,n,!o)},{"../internals/array-buffer-view-core":12,"../internals/global":59,"../internals/well-known-symbol":148,"../modules/es.array.iterator":160}],217:[function(e,t,r){"use strict";var n=(e=e("../internals/array-buffer-view-core")).aTypedArray,o=(e=e.exportTypedArrayMethod,[].join);e("join",(function(e){return o.apply(n(this),arguments)}))},{"../internals/array-buffer-view-core":12}],218:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-last-index-of"),s=n.aTypedArray;(0,n.exportTypedArrayMethod)("lastIndexOf",(function(e){return o.apply(s(this),arguments)}))},{"../internals/array-buffer-view-core":12,"../internals/array-last-index-of":20}],219:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-iteration").map,s=e("../internals/species-constructor"),a=n.aTypedArray,i=n.aTypedArrayConstructor;(0,n.exportTypedArrayMethod)("map",(function(e){return o(a(this),e,1<arguments.length?arguments[1]:void 0,(function(e,t){return new(i(s(e,e.constructor)))(t)}))}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19,"../internals/species-constructor":121}],220:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-reduce").right,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduceRight",(function(e){return o(s(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],221:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-reduce").left,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("reduce",(function(e){return o(s(this),e,arguments.length,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-reduce":24}],222:[function(e,t,r){"use strict";var n=(e=e("../internals/array-buffer-view-core")).aTypedArray,o=(e=e.exportTypedArrayMethod,Math.floor);e("reverse",(function(){for(var e,t=n(this).length,r=o(t/2),s=0;s<r;)e=this[s],this[s++]=this[--t],this[t]=e;return this}))},{"../internals/array-buffer-view-core":12}],223:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/to-length"),s=e("../internals/to-offset"),a=e("../internals/to-object"),i=(e=e("../internals/fails"),n.aTypedArray);(0,n.exportTypedArrayMethod)("set",(function(e){i(this);var t=s(1<arguments.length?arguments[1]:void 0,1),r=this.length,n=a(e),l=o(n.length),u=0;if(r<l+t)throw RangeError("Wrong length");for(;u<l;)this[t+u]=n[u++]}),e((function(){new Int8Array(1).set({})})))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/to-length":136,"../internals/to-object":137,"../internals/to-offset":138}],224:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/species-constructor"),s=(e=e("../internals/fails"),n.aTypedArray),a=n.aTypedArrayConstructor,i=(n=n.exportTypedArrayMethod,[].slice);n("slice",(function(e,t){for(var r=i.call(s(this),e,t),n=(e=o(this,this.constructor),0),l=r.length,u=new(a(e))(l);n<l;)u[n]=r[n++];return u}),e((function(){new Int8Array(1).slice()})))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/species-constructor":121}],225:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/array-iteration").some,s=n.aTypedArray;(0,n.exportTypedArrayMethod)("some",(function(e){return o(s(this),e,1<arguments.length?arguments[1]:void 0)}))},{"../internals/array-buffer-view-core":12,"../internals/array-iteration":19}],226:[function(e,t,r){"use strict";var n=(e=e("../internals/array-buffer-view-core")).aTypedArray,o=(e=e.exportTypedArrayMethod,[].sort);e("sort",(function(e){return o.call(n(this),e)}))},{"../internals/array-buffer-view-core":12}],227:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core"),o=e("../internals/to-length"),s=e("../internals/to-absolute-index"),a=e("../internals/species-constructor"),i=n.aTypedArray;(0,n.exportTypedArrayMethod)("subarray",(function(e,t){var r=i(this),n=r.length;return e=s(e,n),new(a(r,r.constructor))(r.buffer,r.byteOffset+e*r.BYTES_PER_ELEMENT,o((void 0===t?n:s(t,n))-e))}))},{"../internals/array-buffer-view-core":12,"../internals/species-constructor":121,"../internals/to-absolute-index":132,"../internals/to-length":136}],228:[function(e,t,r){"use strict";var n=e("../internals/global"),o=e("../internals/array-buffer-view-core"),s=(e=e("../internals/fails"),n.Int8Array),a=o.aTypedArray,i=(n=o.exportTypedArrayMethod,[].toLocaleString),l=[].slice,u=!!s&&e((function(){i.call(new s(1))}));n("toLocaleString",(function(){return i.apply(u?l.call(a(this)):a(this),arguments)}),e((function(){return[1,2].toLocaleString()!=new s([1,2]).toLocaleString()}))||!e((function(){s.prototype.toLocaleString.call([1,2])})))},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":59}],229:[function(e,t,r){"use strict";var n=e("../internals/array-buffer-view-core").exportTypedArrayMethod,o=e("../internals/fails"),s=(e=(e=e("../internals/global").Uint8Array)&&e.prototype||{},[].toString),a=[].join;o((function(){s.call({})}))&&(s=function(){return a.call(this)}),o=e.toString!=s,n("toString",s,o)},{"../internals/array-buffer-view-core":12,"../internals/fails":51,"../internals/global":59}],230:[function(e,t,r){e("../internals/typed-array-constructor")("Uint16",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":142}],231:[function(e,t,r){e("../internals/typed-array-constructor")("Uint32",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":142}],232:[function(e,t,r){e("../internals/typed-array-constructor")("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}))},{"../internals/typed-array-constructor":142}],233:[function(e,t,r){e("../internals/typed-array-constructor")("Uint8",(function(e){return function(t,r,n){return e(this,t,r,n)}}),!0)},{"../internals/typed-array-constructor":142}],234:[function(e,t,r){"use strict";function n(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}var o,s,a,i,l,u=e("../internals/global"),c=e("../internals/redefine-all"),d=e("../internals/internal-metadata"),h=e("../internals/collection"),p=e("../internals/collection-weak"),f=e("../internals/is-object"),m=e("../internals/internal-state").enforce,y=(e=e("../internals/native-weak-map"),u=!u.ActiveXObject&&"ActiveXObject"in u,Object.isExtensible);t=t.exports=h("WeakMap",n,p),e&&u&&(o=p.getConstructor(n,"WeakMap",!0),d.REQUIRED=!0,h=t.prototype,s=h.delete,a=h.has,i=h.get,l=h.set,c(h,{delete:function(e){var t;return f(e)&&!y(e)?((t=m(this)).frozen||(t.frozen=new o),s.call(this,e)||t.frozen.delete(e)):s.call(this,e)},has:function(e){var t;return f(e)&&!y(e)?((t=m(this)).frozen||(t.frozen=new o),a.call(this,e)||t.frozen.has(e)):a.call(this,e)},get:function(e){var t;return!f(e)||y(e)||((t=m(this)).frozen||(t.frozen=new o),a.call(this,e))?i.call(this,e):t.frozen.get(e)},set:function(e,t){var r;return!f(e)||y(e)||((r=m(this)).frozen||(r.frozen=new o),a.call(this,e))?l.call(this,e,t):r.frozen.set(e,t),this}}))},{"../internals/collection":32,"../internals/collection-weak":31,"../internals/global":59,"../internals/internal-metadata":69,"../internals/internal-state":70,"../internals/is-object":74,"../internals/native-weak-map":85,"../internals/redefine-all":107}],235:[function(e,t,r){var n,o=e("../internals/global"),s=e("../internals/dom-iterables"),a=e("../internals/array-for-each"),i=e("../internals/create-non-enumerable-property");for(n in s){var l;if((l=(l=o[n])&&l.prototype)&&l.forEach!==a)try{i(l,"forEach",a)}catch(e){l.forEach=a}}},{"../internals/array-for-each":16,"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":59}],236:[function(e,t,r){var n,o=e("../internals/global"),s=e("../internals/dom-iterables"),a=e("../modules/es.array.iterator"),i=e("../internals/create-non-enumerable-property"),l=(e=e("../internals/well-known-symbol"))("iterator"),u=e("toStringTag"),c=a.values;for(n in s){var d=o[n],h=d&&d.prototype;if(h){if(h[l]!==c)try{i(h,l,c)}catch(e){h[l]=c}if(h[u]||i(h,u,n),s[n])for(var p in a)if(h[p]!==a[p])try{i(h,p,a[p])}catch(e){h[p]=a[p]}}}},{"../internals/create-non-enumerable-property":38,"../internals/dom-iterables":45,"../internals/global":59,"../internals/well-known-symbol":148,"../modules/es.array.iterator":160}],237:[function(e,t,r){"use strict";function n(e){try{return decodeURIComponent(e)}catch(t){return e}}function o(e){return F[e]}function s(e){return encodeURIComponent(e).replace(D,o)}function a(e){this.entries.length=0,$(this.entries,e)}function i(e,t){if(e<t)throw TypeError("Not enough arguments")}function l(){g(this,l,I);var e,t,r,n,o,s,i,u,c=0<arguments.length?arguments[0]:void 0,d=[];if(A(this,{type:I,entries:d,updateURL:function(){},updateSearchParams:a}),void 0!==c)if(_(c))if("function"==typeof(e=E(c)))for(r=(t=e.call(c)).next;!(n=r.call(t)).done;){if((s=(o=(n=T(w(n.value))).next).call(n)).done||(i=o.call(n)).done||!o.call(n).done)throw TypeError("Expected sequence with length 2");d.push({key:s.value+"",value:i.value+""})}else for(u in c)v(c,u)&&d.push({key:u,value:c[u]+""});else $(d,"string"==typeof c?"?"===c.charAt(0)?c.slice(1):c:c+"")}e("../modules/es.array.iterator");var u=e("../internals/export"),c=e("../internals/get-built-in"),d=e("../internals/native-url"),h=e("../internals/redefine"),p=e("../internals/redefine-all"),f=e("../internals/set-to-string-tag"),m=e("../internals/create-iterator-constructor"),y=e("../internals/internal-state"),g=e("../internals/an-instance"),v=e("../internals/has"),b=e("../internals/function-bind-context"),x=e("../internals/classof"),w=e("../internals/an-object"),_=e("../internals/is-object"),S=e("../internals/object-create"),k=e("../internals/create-property-descriptor"),T=e("../internals/get-iterator"),E=e("../internals/get-iterator-method"),j=(e=e("../internals/well-known-symbol"),c("fetch")),C=c("Headers"),I=(c=e("iterator"),"URLSearchParams"),O=I+"Iterator",A=y.set,R=y.getterFor(I),N=y.getterFor(O),M=/\+/g,P=Array(4),L=function(e){var t,r=e.replace(M," "),o=4;try{return decodeURIComponent(r)}catch(e){for(;o;)r=r.replace((t=o--,P[t-1]||(P[t-1]=RegExp("((?:%[\\da-f]{2}){"+t+"})","gi"))),n);return r}},D=/[!'()~]|%20/g,F={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},$=function(e,t){if(t)for(var r,n=t.split("&"),o=0;o<n.length;)(r=n[o++]).length&&(r=r.split("="),e.push({key:L(r.shift()),value:L(r.join("="))}))},B=m((function(e,t){A(this,{type:O,iterator:T(R(e).entries),kind:t})}),"Iterator",(function(){var e,t=(e=N(this)).kind,r=(e=e.iterator.next()).value;return e.done||(e.value="keys"===t?r.key:"values"===t?r.value:[r.key,r.value]),e}));p(e=l.prototype,{append:function(e,t){i(arguments.length,2);var r=R(this);r.entries.push({key:e+"",value:t+""}),r.updateURL()},delete:function(e){i(arguments.length,1);for(var t=R(this),r=t.entries,n=e+"",o=0;o<r.length;)r[o].key===n?r.splice(o,1):o++;t.updateURL()},get:function(e){i(arguments.length,1);for(var t=R(this).entries,r=e+"",n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){i(arguments.length,1);for(var t=R(this).entries,r=e+"",n=[],o=0;o<t.length;o++)t[o].key===r&&n.push(t[o].value);return n},has:function(e){i(arguments.length,1);for(var t=R(this).entries,r=e+"",n=0;n<t.length;)if(t[n++].key===r)return!0;return!1},set:function(e,t){i(arguments.length,1);for(var r,n=R(this),o=n.entries,s=!1,a=e+"",l=t+"",u=0;u<o.length;u++)(r=o[u]).key===a&&(s?o.splice(u--,1):(s=!0,r.value=l));s||o.push({key:a,value:l}),n.updateURL()},sort:function(){for(var e,t,r=R(this),n=r.entries,o=n.slice(),s=n.length=0;s<o.length;s++){for(e=o[s],t=0;t<s;t++)if(n[t].key>e.key){n.splice(t,0,e);break}t===s&&n.push(e)}r.updateURL()},forEach:function(e){for(var t,r=R(this).entries,n=b(e,1<arguments.length?arguments[1]:void 0,3),o=0;o<r.length;)n((t=r[o++]).value,t.key,this)},keys:function(){return new B(this,"keys")},values:function(){return new B(this,"values")},entries:function(){return new B(this,"entries")}},{enumerable:!0}),h(e,c,e.entries),h(e,"toString",(function(){for(var e,t=R(this).entries,r=[],n=0;n<t.length;)e=t[n++],r.push(s(e.key)+"="+s(e.value));return r.join("&")}),{enumerable:!0}),f(l,I),u({global:!0,forced:!d},{URLSearchParams:l}),d||"function"!=typeof j||"function"!=typeof C||u({global:!0,enumerable:!0,forced:!0},{fetch:function(e){var t,r,n;return e=[e],1<arguments.length&&(_(t=arguments[1])&&(r=t.body,x(r)===I&&((n=t.headers?new C(t.headers):new C).has("content-type")||n.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),t=S(t,{body:k(0,String(r)),headers:k(0,n)}))),e.push(t)),j.apply(this,e)}}),t.exports={URLSearchParams:l,getState:R}},{"../internals/an-instance":9,"../internals/an-object":10,"../internals/classof":29,"../internals/create-iterator-constructor":37,"../internals/create-property-descriptor":39,"../internals/export":50,"../internals/function-bind-context":54,"../internals/get-built-in":56,"../internals/get-iterator":58,"../internals/get-iterator-method":57,"../internals/has":60,"../internals/internal-state":70,"../internals/is-object":74,"../internals/native-url":84,"../internals/object-create":90,"../internals/redefine":108,"../internals/redefine-all":107,"../internals/set-to-string-tag":117,"../internals/well-known-symbol":148,"../modules/es.array.iterator":160}],238:[function(e,t,r){"use strict";function n(e){var t,r,n,o;if("number"==typeof e){for(t=[],r=0;r<4;r++)t.unshift(e%256),e=O(e/256);return t.join(".")}if("object"!=typeof e)return e;for(t="",n=X(e),r=0;r<8;r++)o&&0===e[r]||(o=o&&!1,n===r?(t+=r?":":"::",o=!0):(t+=e[r].toString(16),r<7&&(t+=":")));return"["+t+"]"}function o(e){return!e.host||e.cannotBeABaseURL||"file"==e.scheme}function s(e,t,r,n){var o,s,a,i=r||le,u=0,c="",d=!1,h=!1,p=!1;for(r||(e.scheme="",e.username="",e.password="",e.host=null,e.port=null,e.path=[],e.query=null,e.fragment=null,e.cannotBeABaseURL=!1,t=t.replace(W,"")),t=t.replace(H,""),o=x(t);u<=o.length;){switch(s=o[u],i){case le:if(!s||!L.test(s)){if(r)return N;i=ce;continue}c+=s.toLowerCase(),i=ue;break;case ue:if(s&&(D.test(s)||"+"==s||"-"==s||"."==s))c+=s.toLowerCase();else{if(":"!=s){if(r)return N;c="",i=ce,u=0;continue}if(r&&(te(e)!=v(ee,c)||"file"==c&&(re(e)||null!==e.port)||"file"==e.scheme&&!e.host))return;if(e.scheme=c,r)return void(te(e)&&ee[e.scheme]==e.port&&(e.port=null));c="","file"==e.scheme?i=we:te(e)&&n&&n.scheme==e.scheme?i=de:te(e)?i=me:"/"==o[u+1]?(i=he,u++):(e.cannotBeABaseURL=!0,e.path.push(""),i=Ee)}break;case ce:if(!n||n.cannotBeABaseURL&&"#"!=s)return N;if(n.cannotBeABaseURL&&"#"==s){e.scheme=n.scheme,e.path=n.path.slice(),e.query=n.query,e.fragment="",e.cannotBeABaseURL=!0,i=Ce;break}i="file"==n.scheme?we:pe;continue;case de:if("/"!=s||"/"!=o[u+1]){i=pe;continue}i=ye,u++;break;case he:if("/"==s){i=ge;break}i=Te;continue;case pe:if(e.scheme=n.scheme,s==l)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query;else if("/"==s||"\\"==s&&te(e))i=fe;else if("?"==s)e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query="",i=je;else{if("#"!=s){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.path.pop(),i=Te;continue}e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,e.path=n.path.slice(),e.query=n.query,e.fragment="",i=Ce}break;case fe:if(!te(e)||"/"!=s&&"\\"!=s){if("/"!=s){e.username=n.username,e.password=n.password,e.host=n.host,e.port=n.port,i=Te;continue}i=ge}else i=ye;break;case me:if(i=ye,"/"!=s||"/"!=c.charAt(u+1))continue;u++;break;case ye:if("/"==s||"\\"==s)break;i=ge;continue;case ge:if("@"==s){d&&(c="%40"+c),d=!0;for(var f=x(c),m=0;m<f.length;m++){var y=f[m];":"!=y||p?(y=J(y,Q),p?e.password+=y:e.username+=y):p=!0}c=""}else if(s==l||"/"==s||"?"==s||"#"==s||"\\"==s&&te(e)){if(d&&""==c)return R;u-=x(c).length+1,c="",i=ve}else c+=s;break;case ve:case be:if(r&&"file"==e.scheme){i=Se;continue}if(":"!=s||h){if(s==l||"/"==s||"?"==s||"#"==s||"\\"==s&&te(e)){if(te(e)&&""==c)return M;if(r&&""==c&&(re(e)||null!==e.port))return;if(a=q(e,c))return a;if(c="",i=ke,r)return;continue}"["==s?h=!0:"]"==s&&(h=!1),c+=s}else{if(""==c)return M;if(a=q(e,c))return a;if(c="",i=xe,r==be)return}break;case xe:if(!F.test(s)){if(s==l||"/"==s||"?"==s||"#"==s||"\\"==s&&te(e)||r){if(""!=c){var g=parseInt(c,10);if(65535<g)return P;e.port=te(e)&&g===ee[e.scheme]?null:g,c=""}if(r)return;i=ke;continue}return P}c+=s;break;case we:if(e.scheme="file","/"==s||"\\"==s)i=_e;else{if(!n||"file"!=n.scheme){i=Te;continue}if(s==l)e.host=n.host,e.path=n.path.slice(),e.query=n.query;else if("?"==s)e.host=n.host,e.path=n.path.slice(),e.query="",i=je;else{if("#"!=s){oe(o.slice(u).join(""))||(e.host=n.host,e.path=n.path.slice(),se(e)),i=Te;continue}e.host=n.host,e.path=n.path.slice(),e.query=n.query,e.fragment="",i=Ce}}break;case _e:if("/"==s||"\\"==s){i=Se;break}n&&"file"==n.scheme&&!oe(o.slice(u).join(""))&&(ne(n.path[0],!0)?e.path.push(n.path[0]):e.host=n.host),i=Te;continue;case Se:if(s==l||"/"==s||"\\"==s||"?"==s||"#"==s){if(!r&&ne(c))i=Te;else{if(""==c){if(e.host="",r)return}else{if(a=q(e,c))return a;if("localhost"==e.host&&(e.host=""),r)return;c=""}i=ke}continue}c+=s;break;case ke:if(te(e)){if(i=Te,"/"!=s&&"\\"!=s)continue}else if(r||"?"!=s)if(r||"#"!=s){if(s!=l&&(i=Te,"/"!=s))continue}else e.fragment="",i=Ce;else e.query="",i=je;break;case Te:if(s==l||"/"==s||"\\"==s&&te(e)||!r&&("?"==s||"#"==s)){if(ie(c)?(se(e),"/"==s||"\\"==s&&te(e)||e.path.push("")):ae(c)?"/"==s||"\\"==s&&te(e)||e.path.push(""):("file"==e.scheme&&!e.path.length&&ne(c)&&(e.host&&(e.host=""),c=c.charAt(0)+":"),e.path.push(c)),c="","file"==e.scheme&&(s==l||"?"==s||"#"==s))for(;1<e.path.length&&""===e.path[0];)e.path.shift();"?"==s?(e.query="",i=je):"#"==s&&(e.fragment="",i=Ce)}else c+=J(s,Z);break;case Ee:"?"==s?(e.query="",i=je):"#"==s?(e.fragment="",i=Ce):s!=l&&(e.path[0]+=J(s,Y));break;case je:r||"#"!=s?s!=l&&("'"==s&&te(e)?e.query+="%27":e.query+="#"==s?"%23":J(s,Y)):(e.fragment="",i=Ce);break;case Ce:s!=l&&(e.fragment+=J(s,K))}u++}}function a(e){var t,r,n=g(this,a,"URL"),o=1<arguments.length?arguments[1]:void 0,i=(e=String(e),C(n,{type:"URL"}));if(void 0!==o)if(o instanceof a)t=I(o);else if(r=s(t={},String(o)))throw TypeError(r);if(r=s(i,e,null,t))throw TypeError(r);var l=i.searchParams=new E;(o=j(l)).updateSearchParams(i.query),o.updateURL=function(){i.query=String(l)||null},h||(n.href=Ie.call(n),n.origin=Oe.call(n),n.protocol=Ae.call(n),n.username=Re.call(n),n.password=Ne.call(n),n.host=Me.call(n),n.hostname=Pe.call(n),n.port=Le.call(n),n.pathname=De.call(n),n.search=Fe.call(n),n.searchParams=$e.call(n),n.hash=Be.call(n))}function i(e,t){return{get:e,set:t,configurable:!0,enumerable:!0}}e("../modules/es.string.iterator");var l,u,c,d=e("../internals/export"),h=e("../internals/descriptors"),p=e("../internals/native-url"),f=e("../internals/global"),m=e("../internals/object-define-properties"),y=e("../internals/redefine"),g=e("../internals/an-instance"),v=e("../internals/has"),b=e("../internals/object-assign"),x=e("../internals/array-from"),w=e("../internals/string-multibyte").codeAt,_=e("../internals/string-punycode-to-ascii"),S=e("../internals/set-to-string-tag"),k=e("../modules/web.url-search-params"),T=(e=e("../internals/internal-state"),f.URL),E=k.URLSearchParams,j=k.getState,C=e.set,I=e.getterFor("URL"),O=Math.floor,A=Math.pow,R="Invalid authority",N="Invalid scheme",M="Invalid host",P="Invalid port",L=/[A-Za-z]/,D=/[\d+-.A-Za-z]/,F=/\d/,$=/^(0x|0X)/,B=/^[0-7]+$/,U=/^\d+$/,V=/^[\dA-Fa-f]+$/,G=/[\u0000\u0009\u000A\u000D #%/:?@[\\]]/,z=/[\u0000\u0009\u000A\u000D #/:?@[\\]]/,W=/^[\u0000-\u001F ]+|[\u0000-\u001F ]+$/g,H=/[\u0009\u000A\u000D]/g,q=function(e,t){var r,n,o;if("["==t.charAt(0))return"]"==t.charAt(t.length-1)&&(r=function(e){var t,r,n,o,s,a,i,l=[0,0,0,0,0,0,0,0],u=0,c=null,d=0,h=function(){return e.charAt(d)};if(":"==h()){if(":"!=e.charAt(1))return;d+=2,c=++u}for(;h();){if(8==u)return;if(":"!=h()){for(t=r=0;r<4&&V.test(h());)t=16*t+parseInt(h(),16),d++,r++;if("."==h()){if(0==r)return;if(d-=r,u>6)return;for(n=0;h();){if(o=null,n>0){if(!("."==h()&&n<4))return;d++}if(!F.test(h()))return;for(;F.test(h());){if(s=parseInt(h(),10),null===o)o=s;else{if(0==o)return;o=10*o+s}if(o>255)return;d++}l[u]=256*l[u]+o,2!=++n&&4!=n||u++}if(4!=n)return;break}if(":"==h()){if(d++,!h())return}else if(h())return;l[u++]=t}else{if(null!==c)return;d++,c=++u}}if(null!==c)for(a=u-c,u=7;0!=u&&a>0;)i=l[u],l[u--]=l[c+a-1],l[c+--a]=i;else if(8!=u)return;return l}(t.slice(1,-1)))?void(e.host=r):M;if(te(e))return t=_(t),G.test(t)||null===(r=function(e){var t,r,n,o,s,a,i,l=e.split(".");if(l.length&&""==l[l.length-1]&&l.pop(),(t=l.length)>4)return e;for(r=[],n=0;n<t;n++){if(""==(o=l[n]))return e;if(s=10,o.length>1&&"0"==o.charAt(0)&&(s=$.test(o)?16:8,o=o.slice(8==s?1:2)),""===o)a=0;else{if(!(10==s?U:8==s?B:V).test(o))return e;a=parseInt(o,s)}r.push(a)}for(n=0;n<t;n++)if(a=r[n],n==t-1){if(a>=A(256,5-t))return null}else if(a>255)return null;for(i=r.pop(),n=0;n<r.length;n++)i+=r[n]*A(256,3-n);return i}(t))?M:void(e.host=r);if(z.test(t))return M;for(r="",n=x(t),o=0;o<n.length;o++)r+=J(n[o],Y);e.host=r},X=function(e){for(var t=null,r=1,n=null,o=0,s=0;s<8;s++)0!==e[s]?(r<o&&(t=n,r=o),n=null,o=0):(null===n&&(n=s),++o);return r<o&&(t=n,r=o),t},Y={},K=b({},Y,{" ":1,'"':1,"<":1,">":1,"`":1}),Z=b({},K,{"#":1,"?":1,"{":1,"}":1}),Q=b({},Z,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),J=function(e,t){var r=w(e,0);return 32<r&&r<127&&!v(t,e)?e:encodeURIComponent(e)},ee={ftp:21,file:null,http:80,https:443,ws:80,wss:443},te=function(e){return v(ee,e.scheme)},re=function(e){return""!=e.username||""!=e.password},ne=function(e,t){return 2==e.length&&L.test(e.charAt(0))&&(":"==(e=e.charAt(1))||!t&&"|"==e)},oe=function(e){return 1<e.length&&ne(e.slice(0,2))&&(2==e.length||"/"===(e=e.charAt(2))||"\\"===e||"?"===e||"#"===e)},se=function(e){var t=e.path,r=t.length;!r||"file"==e.scheme&&1==r&&ne(t[0],!0)||t.pop()},ae=function(e){return"."===e||"%2e"===e.toLowerCase()},ie=function(e){return".."===(e=e.toLowerCase())||"%2e."===e||".%2e"===e||"%2e%2e"===e},le={},ue={},ce={},de={},he={},pe={},fe={},me={},ye={},ge={},ve={},be={},xe={},we={},_e={},Se={},ke={},Te={},Ee={},je={},Ce={},Ie=(f=a.prototype,function(){var e=I(this),t=e.scheme,r=e.username,o=e.password,s=e.host,a=e.port,i=e.path,l=e.query,u=e.fragment,c=t+":";return null!==s?(c+="//",re(e)&&(c+=r+(o?":"+o:"")+"@"),c+=n(s),null!==a&&(c+=":"+a)):"file"==t&&(c+="//"),c+=e.cannotBeABaseURL?i[0]:i.length?"/"+i.join("/"):"",null!==l&&(c+="?"+l),null!==u&&(c+="#"+u),c}),Oe=function(){var e=I(this),t=e.scheme,r=e.port;if("blob"==t)try{return new URL(t.path[0]).origin}catch(e){return"null"}return"file"!=t&&te(e)?t+"://"+n(e.host)+(null!==r?":"+r:""):"null"},Ae=function(){return I(this).scheme+":"},Re=function(){return I(this).username},Ne=function(){return I(this).password},Me=function(){var e=(t=I(this)).host,t=t.port;return null===e?"":null===t?n(e):n(e)+":"+t},Pe=function(){var e=I(this).host;return null===e?"":n(e)},Le=function(){var e=I(this).port;return null===e?"":String(e)},De=function(){var e=I(this),t=e.path;return e.cannotBeABaseURL?t[0]:t.length?"/"+t.join("/"):""},Fe=function(){var e=I(this).query;return e?"?"+e:""},$e=function(){return I(this).searchParams},Be=function(){var e=I(this).fragment;return e?"#"+e:""};h&&m(f,{href:i(Ie,(function(e){var t=I(this);if(e=s(t,e=String(e)))throw TypeError(e);j(t.searchParams).updateSearchParams(t.query)})),origin:i(Oe),protocol:i(Ae,(function(e){s(I(this),String(e)+":",le)})),username:i(Re,(function(e){var t=I(this),r=x(String(e));if(!o(t)){t.username="";for(var n=0;n<r.length;n++)t.username+=J(r[n],Q)}})),password:i(Ne,(function(e){var t=I(this),r=x(String(e));if(!o(t)){t.password="";for(var n=0;n<r.length;n++)t.password+=J(r[n],Q)}})),host:i(Me,(function(e){var t=I(this);t.cannotBeABaseURL||s(t,String(e),ve)})),hostname:i(Pe,(function(e){var t=I(this);t.cannotBeABaseURL||s(t,String(e),be)})),port:i(Le,(function(e){var t=I(this);o(t)||(""==(e=String(e))?t.port=null:s(t,e,xe))})),pathname:i(De,(function(e){var t=I(this);t.cannotBeABaseURL||(t.path=[],s(t,e+"",ke))})),search:i(Fe,(function(e){var t=I(this);""==(e=String(e))?t.query=null:("?"==e.charAt(0)&&(e=e.slice(1)),t.query="",s(t,e,je)),j(t.searchParams).updateSearchParams(t.query)})),searchParams:i($e),hash:i(Be,(function(e){var t=I(this);""==(e=String(e))?t.fragment=null:("#"==e.charAt(0)&&(e=e.slice(1)),t.fragment="",s(t,e,Ce))}))}),y(f,"toJSON",(function(){return Ie.call(this)}),{enumerable:!0}),y(f,"toString",(function(){return Ie.call(this)}),{enumerable:!0}),T&&(u=T.createObjectURL,c=T.revokeObjectURL,u&&y(a,"createObjectURL",(function(e){return u.apply(T,arguments)})),c&&y(a,"revokeObjectURL",(function(e){return c.apply(T,arguments)}))),S(a,"URL"),d({global:!0,forced:!p,sham:!h},{URL:a})},{"../internals/an-instance":9,"../internals/array-from":17,"../internals/descriptors":43,"../internals/export":50,"../internals/global":59,"../internals/has":60,"../internals/internal-state":70,"../internals/native-url":84,"../internals/object-assign":89,"../internals/object-define-properties":91,"../internals/redefine":108,"../internals/set-to-string-tag":117,"../internals/string-multibyte":123,"../internals/string-punycode-to-ascii":126,"../modules/es.string.iterator":190,"../modules/web.url-search-params":237}],239:[function(e,t,r){"use strict";t.exports=e("./").polyfill()},{"./":240}],240:[function(e,t,r){(function(n,o){var s;s=function(){"use strict";function t(e){return"function"==typeof e}var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=0,a=void 0,i=void 0,l=function(e,t){f[s]=e,f[s+1]=t,2===(s+=2)&&(i?i(m):b())},u="undefined"!=typeof window?window:void 0,c=(c=u||{}).MutationObserver||c.WebKitMutationObserver,d="undefined"==typeof self&&void 0!==n&&"[object process]"==={}.toString.call(n),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(m,1)}}var f=new Array(1e3);function m(){for(var e=0;e<s;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;s=0}var y,g,v,b=void 0;function x(e,t){var r,n=this,o=new this.constructor(S),s=(void 0===o[_]&&L(o),n._state);return s?(r=arguments[s-1],l((function(){return M(s,o,r,n._result)}))):R(n,o,e,t),o}function w(e){var t;return e&&"object"==typeof e&&e.constructor===this?e:(C(t=new this(S),e),t)}b=d?function(){return n.nextTick(m)}:c?(g=0,d=new c(m),v=document.createTextNode(""),d.observe(v,{characterData:!0}),function(){v.data=g=++g%2}):h?((y=new MessageChannel).port1.onmessage=m,function(){return y.port2.postMessage(0)}):(void 0===u&&"function"==typeof e?function(){try{var e=Function("return this")().require("vertx");return void 0!==(a=e.runOnLoop||e.runOnContext)?function(){a(m)}:p()}catch(e){return p()}}:p)();var _=Math.random().toString(36).substring(2);function S(){}var k=void 0,T=1,E=2;function j(e,r,n){var o,s;r.constructor===e.constructor&&n===x&&r.constructor.resolve===w?(o=e,(s=r)._state===T?O(o,s._result):s._state===E?A(o,s._result):R(s,void 0,(function(e){return C(o,e)}),(function(e){return A(o,e)}))):void 0!==n&&t(n)?function(e,t,r){l((function(e){var n=!1,o=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,(t!==r?C:O)(e,r))}),(function(t){n||(n=!0,A(e,t))}),e._label);!n&&o&&(n=!0,A(e,o))}),e)}(e,r,n):O(e,r)}function C(e,t){if(e===t)A(e,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof t,null===t||"object"!=r&&"function"!=r)O(e,t);else{r=void 0;try{r=t.then}catch(t){return void A(e,t)}j(e,t,r)}var r}function I(e){e._onerror&&e._onerror(e._result),N(e)}function O(e,t){e._state===k&&(e._result=t,e._state=T,0!==e._subscribers.length&&l(N,e))}function A(e,t){e._state===k&&(e._state=E,e._result=t,l(I,e))}function R(e,t,r,n){var o=e._subscribers,s=o.length;e._onerror=null,o[s]=t,o[s+T]=r,o[s+E]=n,0===s&&e._state&&l(N,e)}function N(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n,o=void 0,s=e._result,a=0;a<t.length;a+=3)n=t[a],o=t[a+r],n?M(r,n,o,s):o(s);e._subscribers.length=0}}function M(e,r,n,o){var s=t(n),a=void 0,i=void 0,l=!0;if(s){try{a=n(o)}catch(e){l=!1,i=e}if(r===a)return void A(r,new TypeError("A promises callback cannot return that same promise."))}else a=o;r._state===k&&(s&&l?C(r,a):!1===l?A(r,i):e===T?O(r,a):e===E&&A(r,a))}var P=0;function L(e){e[_]=P++,e._state=void 0,e._result=void 0,e._subscribers=[]}F.prototype._enumerate=function(e){for(var t=0;this._state===k&&t<e.length;t++)this._eachEntry(e[t],t)},F.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===w){var o,s=void 0,a=void 0,i=!1;try{s=e.then}catch(t){i=!0,a=t}s===x&&e._state!==k?this._settledAt(e._state,t,e._result):"function"!=typeof s?(this._remaining--,this._result[t]=e):r===$?(o=new r(S),i?A(o,a):j(o,e,s),this._willSettleAt(o,t)):this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},F.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===k&&(this._remaining--,e===E?A(n,r):this._result[t]=r),0===this._remaining&&O(n,this._result)},F.prototype._willSettleAt=function(e,t){var r=this;R(e,void 0,(function(e){return r._settledAt(T,t,e)}),(function(e){return r._settledAt(E,t,e)}))};var D=F;function F(e,t){this._instanceConstructor=e,this.promise=new e(S),this.promise[_]||L(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0!==this.length&&(this.length=this.length||0,this._enumerate(t),0!==this._remaining)||O(this.promise,this._result)):A(this.promise,new Error("Array Methods must be provided an Array"))}B.prototype.catch=function(e){return this.then(null,e)},B.prototype.finally=function(e){var r=this.constructor;return t(e)?this.then((function(t){return r.resolve(e()).then((function(){return t}))}),(function(t){return r.resolve(e()).then((function(){throw t}))})):this.then(e,e)};var $=B;function B(e){if(this[_]=P++,this._result=this._state=void 0,this._subscribers=[],S!==e){if("function"!=typeof e)throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof B))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");var t=this;try{e((function(e){C(t,e)}),(function(e){A(t,e)}))}catch(e){A(t,e)}}}return $.prototype.then=x,$.all=function(e){return new D(this,e).promise},$.race=function(e){var t=this;return r(e)?new t((function(r,n){for(var o=e.length,s=0;s<o;s++)t.resolve(e[s]).then(r,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},$.resolve=w,$.reject=function(e){var t=new this(S);return A(t,e),t},$._setScheduler=function(e){i=e},$._setAsap=function(e){l=e},$._asap=l,$.polyfill=function(){var e=void 0;if(void 0!==o)e=o;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=$},$.Promise=$},"object"==typeof r&&void 0!==t?t.exports=s():this.ES6Promise=s()}).call(this,e("_process"),void 0!==n.g?n.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:249}],241:[function(e,t,r){var n;n=function(e,t){"use strict";function r(e){try{delete window[e]}catch(t){window[e]=void 0}}function n(e){(e=document.getElementById(e))&&document.getElementsByTagName("head")[0].removeChild(e)}t.exports=function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=e,s=t.timeout||5e3,a=t.jsonpCallback||"callback",i=void 0;return new Promise((function(l,u){var c=t.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),d=a+"_"+c,h=(window[c]=function(e){l({ok:!0,json:function(){return Promise.resolve(e)}}),i&&clearTimeout(i),n(d),r(c)},o+=-1===o.indexOf("?")?"?":"&",document.createElement("script"));h.setAttribute("src",""+o+a+"="+c),t.charset&&h.setAttribute("charset",t.charset),h.id=d,document.getElementsByTagName("head")[0].appendChild(h),i=setTimeout((function(){u(new Error("JSONP request to "+e+" timed out")),r(c),n(d),window[c]=function(){r(c)}}),s),h.onerror=function(){u(new Error("JSONP request to "+e+" failed")),r(c),n(d),i&&clearTimeout(i)}}))}},void 0!==r&&void 0!==t?n(0,t):(n(n={exports:{}},n),this.fetchJsonp=n.exports)},{}],242:[function(e,t,r){var n=function(e){"use strict";var t,r,n,o,s,a,i,l,u,c;if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent)))return c=e.document,t=function(){return e.URL||e.webkitURL||e},r=c.createElementNS("http://www.w3.org/1999/xhtml","a"),n="download"in r,o=/constructor/i.test(e.HTMLElement)||e.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),a=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},i=function(e){setTimeout((function(){"string"==typeof e?t().revokeObjectURL(e):e.remove()}),4e4)},l=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},c=(u=function(u,c,d){d||(u=l(u));var h,p,f=this,m=(d="application/octet-stream"===u.type,function(){for(var e=f,t="writestart progress write writeend".split(" "),r=(t=[].concat(t)).length;r--;){var n=e["on"+t[r]];if("function"==typeof n)try{n.call(e,e)}catch(e){a(e)}}});f.readyState=f.INIT,n?(h=t().createObjectURL(u),setTimeout((function(){var e,t;r.href=h,r.download=c,e=r,t=new MouseEvent("click"),e.dispatchEvent(t),m(),i(h),f.readyState=f.DONE}))):(s||d&&o)&&e.FileReader?((p=new FileReader).onloadend=function(){var t=s?p.result:p.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,f.readyState=f.DONE,m()},p.readAsDataURL(u),f.readyState=f.INIT):(h=h||t().createObjectURL(u),!d&&e.open(h,"_blank")||(e.location.href=h),f.readyState=f.DONE,m(),i(h))}).prototype,"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,r){return t=t||e.name||"download",r||(e=l(e)),navigator.msSaveOrOpenBlob(e,t)}:(c.abort=function(){},c.readyState=c.INIT=0,c.WRITING=1,c.DONE=2,c.error=c.onwritestart=c.onprogress=c.onwrite=c.onabort=c.onerror=c.onwriteend=null,function(e,t,r){return new u(e,t||e.name||"download",r)})}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==t&&t.exports&&(t.exports.saveAs=n)},{}],243:[function(e,t,r){var n,o=Object.defineProperty,s=(o(r,"__esModule",{value:!0}),r),a={GIFEncoder:()=>_,applyPalette:()=>function(e,t,r="rgb565"){if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");if(256<t.length)throw new Error("applyPalette() only works with 256 colors or less");const n=new Uint32Array(e.buffer),o=n.length,s="rgb444"===r?4096:65536,a=new Uint8Array(o),i=new Array(s);if("rgba4444"===r)for(let e=0;e<o;e++){var l,u=(l=n[e])>>24&255,c=l>>16&255,f=l>>8&255,m=(m=h(l&=255,f,c,u))in i?i[m]:i[m]=function(e,t,r,n,o){let s=0,a=1e100;for(let u=0;u<o.length;u++){var i=o[u],l=b(i[3]-n);l>a||(l+=b(i[0]-e))>a||(l+=b(i[1]-t))>a||(l+=b(i[2]-r))>a||(a=l,s=u)}return s}(l,f,c,u,t);a[e]=m}else{const e="rgb444"===r?p:d;for(let r=0;r<o;r++){var y,g=(y=n[r])>>16&255,v=y>>8&255,x=(x=e(y&=255,v,g))in i?i[x]:i[x]=function(e,t,r,n){let o=0,s=1e100;for(let l=0;l<n.length;l++){var a=n[l],i=b(a[0]-e);i>s||(i+=b(a[1]-t))>s||(i+=b(a[2]-r))>s||(s=i,o=l)}return o}(y,v,g,t);a[r]=x}}return a},default:()=>j,nearestColor:()=>function(e,t,r=g){return e[x(e,t,r)]},nearestColorIndex:()=>x,nearestColorIndexWithDistance:()=>w,prequantize:()=>function(e,{roundRGB:t=5,roundAlpha:r=10,oneBitAlpha:n=null}={}){const o=new Uint32Array(e.buffer);for(let e=0;e<o.length;e++){let l=(i=o[e])>>24&255;var s=i>>16&255,a=i>>8&255,i=255&i;l=v(l,r),n&&(l=l<=("number"==typeof n?n:127)?0:255),i=v(i,t),a=v(a,t),s=v(s,t),o[e]=l<<24|s<<16|a<<8|i<<0}},quantize:()=>function(e,t,r={}){var{format:n="rgb565",clearAlpha:o=!0,clearAlphaColor:s=0,clearAlphaThreshold:a=0,oneBitAlpha:i=!1}=r;if(!e||!e.buffer)throw new Error("quantize() expected RGBA Uint8Array data");if(!(e instanceof Uint8Array||e instanceof Uint8ClampedArray))throw new Error("quantize() expected RGBA Uint8Array data");e=new Uint32Array(e.buffer);let l=!1!==r.useSqrt;const u="rgba4444"===n,c=function(e,t){const r=new Array("rgb444"===t?4096:65536),n=e.length;if("rgba4444"===t)for(let t=0;t<n;++t){var o,s=(o=e[t])>>24&255,a=o>>16&255,i=o>>8&255,l=h(o&=255,i,a,s);let n=l in r?r[l]:r[l]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};n.rc+=o,n.gc+=i,n.bc+=a,n.ac+=s,n.cnt++}else if("rgb444"===t)for(let t=0;t<n;++t){var u,c=(u=e[t])>>16&255,f=u>>8&255,m=p(u&=255,f,c);let n=m in r?r[m]:r[m]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};n.rc+=u,n.gc+=f,n.bc+=c,n.cnt++}else for(let t=0;t<n;++t){var y,g=(y=e[t])>>16&255,v=y>>8&255,b=d(y&=255,v,g);let n=b in r?r[b]:r[b]={ac:0,rc:0,gc:0,bc:0,cnt:0,nn:0,fw:0,bk:0,tm:0,mtm:0,err:0};n.rc+=y,n.gc+=v,n.bc+=g,n.cnt++}return r}(e,n),g=c.length,v=g-1,b=new Uint32Array(g+1);for(var x=0,w=0;w<g;++w){const e=c[w];null!=e&&(R=1/e.cnt,u&&(e.ac*=R),e.rc*=R,e.gc*=R,e.bc*=R,c[x++]=e)}var _,S,k;for(m(t)/x<.022&&(l=!1),w=0;w<x-1;++w)c[w].fw=w+1,c[w+1].bk=w,l&&(c[w].cnt=Math.sqrt(c[w].cnt));for(l&&(c[w].cnt=Math.sqrt(c[w].cnt)),w=0;w<x;++w){y(c,w,!1);var T=c[w].err;for(S=++b[0];1<S&&!(c[_=b[k=S>>1]].err<=T);S=k)b[S]=_;b[S]=w}var E,j=x-t;for(w=0;w<j;){for(;;){var C=b[1];if((E=c[C]).tm>=E.mtm&&c[E.nn].mtm<=E.tm)break;for(E.mtm==v?C=b[1]=b[b[0]--]:(y(c,C,!1),E.tm=w),T=c[C].err,S=1;(k=S+S)<=b[0]&&(k<b[0]&&c[b[k]].err>c[b[k+1]].err&&k++,!(T<=c[_=b[k]].err));S=k)b[S]=_;b[S]=C}var I=c[E.nn],O=E.cnt,A=I.cnt,R=1/(O+A);u&&(E.ac=R*(O*E.ac+A*I.ac)),E.rc=R*(O*E.rc+A*I.rc),E.gc=R*(O*E.gc+A*I.gc),E.bc=R*(O*E.bc+A*I.bc),E.cnt+=I.cnt,E.mtm=++w,c[I.bk].fw=I.fw,c[I.fw].bk=I.bk,I.mtm=v}let N=[];for(w=0;;0){let e=f(Math.round(c[w].rc),0,255),t=f(Math.round(c[w].gc),0,255),r=f(Math.round(c[w].bc),0,255),n=255;u&&(n=f(Math.round(c[w].ac),0,255),i&&(n=n<=(M="number"==typeof i?i:127)?0:255),o&&n<=a&&(e=t=r=s,n=0));var M=u?[e,t,r,n]:[e,t,r];if(function(e,t){for(let o=0;o<e.length;o++){var r=(n=e[o])[0]===t[0]&&n[1]===t[1]&&n[2]===t[2],n=!(4<=n.length&&4<=t.length)||n[3]===t[3];if(r&&n)return!0}return!1}(N,M)||N.push(M),0==(w=c[w].fw))break}return N},snapColorsToPalette:()=>function(e,t,r=5){if(e.length&&t.length){var n=e.map((e=>e.slice(0,3))),o=r*r,s=e[0].length;for(let r=0;r<t.length;r++){let l=t[r];l=l.length<s?[l[0],l[1],l[2],255]:l.length>s?l.slice(0,3):l.slice();var a,i=(a=w(n,l.slice(0,3),g))[0];0<(a=a[1])&&a<=o&&(e[i]=l)}}}};for(n in a)o(s,n,{get:a[n],enumerable:!0});var i={signature:"GIF",version:"89a",trailer:59,extensionIntroducer:33,applicationExtensionLabel:255,graphicControlExtensionLabel:249,imageSeparator:44,signatureSize:3,versionSize:3,globalColorTableFlagMask:128,colorResolutionMask:112,sortFlagMask:8,globalColorTableSizeMask:7,applicationIdentifierSize:8,applicationAuthCodeSize:3,disposalMethodMask:28,userInputFlagMask:2,transparentColorFlagMask:1,localColorTableFlagMask:128,interlaceFlagMask:64,idSortFlagMask:32,localColorTableSizeMask:7};function l(e=256){let t=0,r=new Uint8Array(e);return{get buffer(){return r.buffer},reset(){t=0},bytesView:()=>r.subarray(0,t),bytes:()=>r.slice(0,t),writeByte(e){n(t+1),r[t]=e,t++},writeBytes(e,o=0,s=e.length){n(t+s);for(let n=0;n<s;n++)r[t++]=e[n+o]},writeBytesView(e,o=0,s=e.byteLength){n(t+s),r.set(e.subarray(o,o+s),t),t+=s}};function n(e){var n=r.length;if(!(e<=n)){e=Math.max(e,n*(n<1048576?2:1.125)>>>0),0!=n&&(e=Math.max(e,256));const o=r;r=new Uint8Array(e),0<t&&r.set(o.subarray(0,t),0)}}}var u=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],c=function(e,t,r,n,o=l(512),s=new Uint8Array(256),a=new Int32Array(5003),i=new Int32Array(5003)){var c=a.length;n=Math.max(2,n),s.fill(0),i.fill(0),a.fill(-1);let d=0,h=0;var p=n+1;const f=p;let m=!1,y=f,g=(1<<y)-1;var v=1<<p-1;const b=1+v;let x=2+v,w=0,_=r[0],S=0;for(let e=c;e<65536;e*=2)++S;S=8-S,o.writeByte(n),C(v);var k=r.length;for(let e=1;e<k;e++)e:{var T=r[e],E=(T<<12)+_;let t=T<<S^_;if(a[t]===E)_=i[t];else{for(var j=0===t?1:c-t;0<=a[t];)if((t-=j)<0&&(t+=c),a[t]===E){_=i[t];break e}C(_),_=T,x<4096?(i[t]=x++,a[t]=E):(a.fill(-1),x=2+v,m=!0,C(v))}}return C(_),C(b),o.writeByte(0),o.bytesView();function C(e){for(d&=u[h],0<h?d|=e<<h:d=e,h+=y;8<=h;)s[w++]=255&d,254<=w&&(o.writeByte(w),o.writeBytesView(s,0,w),w=0),d>>=8,h-=8;if((x>g||m)&&(m?(y=f,g=(1<<y)-1,m=!1):(++y,g=12===y?1<<y:(1<<y)-1)),e==b){for(;0<h;)s[w++]=255&d,254<=w&&(o.writeByte(w),o.writeBytesView(s,0,w),w=0),d>>=8,h-=8;0<w&&(o.writeByte(w),o.writeBytesView(s,0,w),w=0)}}};function d(e,t,r){return e<<8&63488|t<<2&992|r>>3}function h(e,t,r,n){return e>>4|240&t|(240&r)<<4|(240&n)<<8}function p(e,t,r){return e>>4<<8|240&t|r>>4}function f(e,t,r){return e<t?t:r<e?r:e}function m(e){return e*e}function y(e,t,r){var n=0,o=1e100;const s=e[t];for(var a=s.cnt,i=s.ac,l=s.rc,u=s.gc,c=s.bc,d=s.fw;0!=d;d=e[d].fw){var h,p,f=e[d];o<=(p=a*(p=f.cnt)/(a+p))||(h=0,r&&o<=(h+=p*m(f.ac-i))||o<=(h+=p*m(f.rc-l))||o<=(h+=p*m(f.gc-u))||o<=(h+=p*m(f.bc-c))||(o=h,n=d))}s.err=o,s.nn=n}function g(e,t){for(var r=0,n=0;n<e.length;n++){var o=e[n]-t[n];r+=o*o}return r}function v(e,t){return 1<t?Math.round(e/t)*t:e}function b(e){return e*e}function x(e,t,r=g){let n=1/0,o=-1;for(let a=0;a<e.length;a++){var s=r(t,e[a]);s<n&&(n=s,o=a)}return o}function w(e,t,r=g){let n=1/0,o=-1;for(let a=0;a<e.length;a++){var s=r(t,e[a]);s<n&&(n=s,o=a)}return[o,n]}function _(e={}){const{initialCapacity:t=4096,auto:r=!0}=e,n=l(t),o=new Uint8Array(256),s=new Int32Array(5003),a=new Int32Array(5003);let u=!1;return{reset(){n.reset(),u=!1},finish(){n.writeByte(i.trailer)},bytes:()=>n.bytes(),bytesView:()=>n.bytesView(),get buffer(){return n.buffer},get stream(){return n},writeHeader:d,writeFrame(e,t,i,l={}){var{transparent:h=!1,transparentIndex:p=0,delay:f=0,palette:m=null,repeat:y=0,colorDepth:g=8,dispose:v=-1}=l;let b=!1;if(r?u||(b=!0,d(),u=!0):b=Boolean(l.first),t=Math.max(0,Math.floor(t)),i=Math.max(0,Math.floor(i)),b){if(!m)throw new Error("First frame must include a { palette } option");var[l,x,w,_,j=8]=[n,t,i,m,g];j=128|j-1<<4|(_=E(_.length)-1),k(l,x),k(l,w),l.writeBytes([j,0,0]),S(n,m),0<=y&&(x=y,(_=n).writeByte(33),_.writeByte(255),_.writeByte(11),T(_,"NETSCAPE2.0"),_.writeByte(3),_.writeByte(1),k(_,x),_.writeByte(0))}var C,w,j=v,y=w=Math.round(f/10),x=h,_=p,f=((l=n).writeByte(33),l.writeByte(249),l.writeByte(4),_<0&&(_=0,x=!1),x=x?(C=1,2):C=0,0<=j&&(x=7&j),x<<=2,l.writeByte(0|x|C),k(l,y),l.writeByte(_||0),l.writeByte(0),Boolean(m)&&!b);h=t,p=i,C=f?m:null,(v=n).writeByte(44),k(v,0),k(v,0),k(v,h),k(v,p),C?(h=E(C.length)-1,v.writeByte(128|h)):v.writeByte(0),f&&S(n,m),[y,l,p,h,v=8,f,m,e]=[n,e,t,i,g,o,s,a],c(p,h,l,v,y,f,m,e)}};function d(){T(n,"GIF89a")}}function S(e,t){var r=1<<E(t.length);for(let n=0;n<r;n++){let r=[0,0,0];n<t.length&&(r=t[n]),e.writeByte(r[0]),e.writeByte(r[1]),e.writeByte(r[2])}}function k(e,t){e.writeByte(255&t),e.writeByte(t>>8&255)}function T(e,t){for(var r=0;r<t.length;r++)e.writeByte(t.charCodeAt(r))}function E(e){return Math.max(Math.ceil(Math.log2(e)),1)}var j=_},{}],244:[function(e,t,r){r.read=function(e,t,r,n,o){var s,a,i=8*o-n-1,l=(1<<i)-1,u=l>>1,c=-7,d=r?o-1:0,h=r?-1:1;for(o=e[t+d],d+=h,s=o&(1<<-c)-1,o>>=-c,c+=i;0<c;s=256*s+e[t+d],d+=h,c-=8);for(a=s&(1<<-c)-1,s>>=-c,c+=n;0<c;a=256*a+e[t+d],d+=h,c-=8);if(0===s)s=1-u;else{if(s===l)return a?NaN:1/0*(o?-1:1);a+=Math.pow(2,n),s-=u}return(o?-1:1)*a*Math.pow(2,s-n)},r.write=function(e,t,r,n,o,s){var a,i,l=8*s-o-1,u=(1<<l)-1,c=u>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:s-1,p=n?1:-1;for(s=t<0||0===t&&1/t<0?1:0,t=Math.abs(t),isNaN(t)||t===1/0?(i=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(n=Math.pow(2,-a))<1&&(a--,n*=2),2<=(t+=1<=a+c?d/n:d*Math.pow(2,1-c))*n&&(a++,n/=2),u<=a+c?(i=0,a=u):1<=a+c?(i=(t*n-1)*Math.pow(2,o),a+=c):(i=t*Math.pow(2,c-1)*Math.pow(2,o),a=0));8<=o;e[r+h]=255&i,h+=p,i/=256,o-=8);for(a=a<<o|i,l+=o;0<l;e[r+h]=255&a,h+=p,a/=256,l-=8);e[r+h-p]|=128*s}},{}],245:[function(e,t,r){"use strict";var n;function o(e,t){return e.b===t.b&&e.a===t.a}function s(e,t){return e.b<t.b||e.b===t.b&&e.a<=t.a}function a(e,t,r){var n=t.b-e.b,o=r.b-t.b;return 0<n+o?n<o?t.a-e.a+n/(n+o)*(e.a-r.a):t.a-r.a+o/(n+o)*(r.a-e.a):0}function i(e,t,r){var n=t.b-e.b,o=r.b-t.b;return 0<n+o?(t.a-r.a)*n+(t.a-e.a)*o:0}function l(e,t){return e.a<t.a||e.a===t.a&&e.b<=t.b}function u(e,t,r){var n=t.a-e.a,o=r.a-t.a;return 0<n+o?n<o?t.b-e.b+n/(n+o)*(e.b-r.b):t.b-r.b+o/(n+o)*(r.b-e.b):0}function c(e,t,r){var n=t.a-e.a,o=r.a-t.a;return 0<n+o?(t.b-r.b)*n+(t.b-e.b)*o:0}function d(e,t,r,n){return(e=e<0?0:e)<=(r=r<0?0:r)?0===r?(t+n)/2:t+e/(e+r)*(n-t):n+r/(e+r)*(t-n)}function h(e){var t=g(e.b);return b(t,e.c),b(t.b,e.c),x(t,e.a),t}function p(e,t){var r=!1,n=!1;e!==t&&(t.a!==e.a&&(n=!0,_(t.a,e.a)),t.d!==e.d&&(r=!0,S(t.d,e.d)),v(t,e),n||(b(t,e.a),e.a.c=e),r||(x(t,e.d),e.d.a=e))}function f(e){var t=e.b,r=!1;e.d!==e.b.d&&(r=!0,S(e.d,e.b.d)),e.c===e?_(e.a,null):(e.b.d.a=e.b.e,e.a.c=e.c,v(e,e.b.e),r||x(e,e.d)),t.c===t?(_(t.a,null),S(t.d,null)):(e.d.a=t.b.e,t.a.c=t.c,v(t,t.b.e)),w(e)}function m(e){var t=g(e),r=t.b;return v(t,e.e),t.a=e.b.a,b(r,t.a),t.d=r.d=e.d,t=t.b,v(e.b,e.b.b.e),v(e.b,t),e.b.a=t.a,t.b.a.c=t.b,t.b.d=e.b.d,t.f=e.f,t.b.f=e.b.f,t}function y(e,t){var r=!1,n=g(e),o=n.b;return t.d!==e.d&&(r=!0,S(t.d,e.d)),v(n,e.e),v(o,t),n.a=e.b.a,o.a=t.a,n.d=o.d=e.d,e.d.a=o,r||x(n,e.d),n}function g(e){var t=new Y,r=new Y,n=e.b.h;return(((r.h=n).b.h=t).h=e).b.h=r,t.b=r,((t.c=t).e=r).b=t,(r.c=r).e=t}function v(e,t){var r=e.c,n=t.c;r.b.e=t,(n.b.e=e).c=n,t.c=r}function b(e,t){var r=t.f,n=new Z(t,r);for(r.e=n,r=(t.f=n).c=e;r.a=n,(r=r.c)!==e;);}function x(e,t){var r=t.d,n=new X(t,r);for(r.b=n,(t.d=n).a=e,n.c=t.c,r=e;r.d=n,(r=r.e)!==e;);}function w(e){var t=e.h;e=e.b.h,(t.b.h=e).b.h=t}function _(e,t){for(var r=e.c,n=r;n.a=t,(n=n.c)!==r;);r=e.f,((n=e.e).f=r).e=n}function S(e,t){for(var r=e.a,n=r;n.d=t,(n=n.e)!==r;);r=e.d,((n=e.b).d=r).b=n}function k(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])?2:t}function T(e,t){e.f+=t.f,e.b.f+=t.b.f}function E(e,t,r){return e=e.a,t=t.a,r=r.a,t.b.a===e?r.b.a===e?s(t.a,r.a)?i(r.b.a,t.a,r.a)<=0:0<=i(t.b.a,r.a,t.a):i(r.b.a,e,r.a)<=0:r.b.a===e?0<=i(t.b.a,e,t.a):(t=a(t.b.a,e,t.a),(e=a(r.b.a,e,r.a))<=t)}function j(e){e.a.i=null;var t=e.e;t.a.c=t.c,t.c.a=t.a,e.e=null}function C(e,t){f(e.a),e.c=!1,(e.a=t).i=e}function I(e){for(var t=e.a.a;(e=ue(e)).a.a===t;);return e.c&&(C(e,t=y(le(e).a.b,e.a.e)),e=ue(e)),e}function O(e,t,r){var n=new ie;return n.a=r,n.e=G(e.f,t.e,n),r.i=n}function A(e,t){switch(e.s){case 100130:return 0!=(1&t);case 100131:return 0!==t;case 100132:return 0<t;case 100133:return t<0;case 100134:return 2<=t||t<=-2}return!1}function R(e){var t=e.a,r=t.d;r.c=e.d,r.a=t,j(e)}function N(e,t,r){for(t=(e=t).a;e!==r;){e.c=!1;var n=le(e),o=n.a;if(o.a!==t.a){if(!n.c){R(e);break}C(n,o=y(t.c.b,o.b))}t.c!==o&&(p(o.b.e,o),p(t,o)),R(e),t=n.a,e=n}return t}function M(e,t,r,n,o,s){for(var a=!0;O(e,t,r.b),(r=r.c)!==n;);for(null===o&&(o=le(t).a.b.c);(r=(n=le(t)).a.b).a===o.a;)r.c!==o&&(p(r.b.e,r),p(o.b.e,r)),n.f=t.f-r.f,n.d=A(e,n.f),t.b=!0,!a&&F(e,t)&&(T(r,o),j(t),f(o)),a=!1,t=n,o=r;t.b=!0,s&&B(e,t)}function P(e,t,r,n,o){var s=[t.g[0],t.g[1],t.g[2]];t.d=null,t.d=e.o&&e.o(s,r,n,e.c)||null,null===t.d&&(o?e.n||(q(e,100156),e.n=!0):t.d=r[0])}function L(e,t,r){var n=[null,null,null,null];n[0]=t.a.d,n[1]=r.a.d,P(e,t.a,n,[.5,.5,0,0],!1),p(t,r)}function D(e,t,r,n,o){var s=Math.abs(t.b-e.b)+Math.abs(t.a-e.a),a=Math.abs(r.b-e.b)+Math.abs(r.a-e.a),i=o+1;n[o]=.5*a/(s+a),n[i]=.5*s/(s+a),e.g[0]+=n[o]*t.g[0]+n[i]*r.g[0],e.g[1]+=n[o]*t.g[1]+n[i]*r.g[1],e.g[2]+=n[o]*t.g[2]+n[i]*r.g[2]}function F(e,t){var r=le(t),n=t.a,a=r.a;if(s(n.a,a.a)){if(0<i(a.b.a,n.a,a.a))return;if(o(n.a,a.a)){if(n.a!==a.a){r=e.e;var l=n.a.h;if(0<=l){var u=(r=r.b).d,c=r.e,d=r.c,h=d[l];u[h]=u[r.a],(d[u[h]]=h)<=--r.a&&(h<=1||s(c[u[h>>1]],c[u[h]])?se:ae)(r,h),c[l]=null,d[l]=r.b,r.b=l}else for(r.c[-(l+1)]=null;0<r.a&&null===r.c[r.d[r.a-1]];)--r.a;L(e,a.b.e,n)}}else m(a.b),p(n,a.b.e),t.b=r.b=!0}else{if(i(n.b.a,a.a,n.a)<0)return;ue(t).b=t.b=!0,m(n.b),p(a.b.e,n)}return 1}function $(e,t){var r=le(t),n=t.a,h=r.a,f=n.a,y=h.a,g=n.b.a,v=h.b.a,b=new Z;if(i(g,e.a,f),i(v,e.a,y),!(f===y||Math.min(f.a,g.a)>Math.max(y.a,v.a))){if(s(f,y)){if(0<i(v,f,y))return}else if(i(g,y,f)<0)return;var x,w,_=g,S=f,k=v,T=y;if(s(_,S)||(x=_,_=S,S=x),s(k,T)||(x=k,k=T,T=x),s(_,k)||(x=_,_=k,k=x,x=S,S=T,T=x),s(k,S)?s(S,T)?((x=a(_,k,S))+(w=a(k,S,T))<0&&(x=-x,w=-w),b.b=d(x,k.b,w,S.b)):((x=i(_,k,S))+(w=-i(_,T,S))<0&&(x=-x,w=-w),b.b=d(x,k.b,w,T.b)):b.b=(k.b+S.b)/2,l(_,S)||(x=_,_=S,S=x),l(k,T)||(x=k,k=T,T=x),l(_,k)||(x=_,_=k,k=x,x=S,S=T,T=x),l(k,S)?l(S,T)?((x=u(_,k,S))+(w=u(k,S,T))<0&&(x=-x,w=-w),b.a=d(x,k.a,w,S.a)):((x=c(_,k,S))+(w=-c(_,T,S))<0&&(x=-x,w=-w),b.a=d(x,k.a,w,T.a)):b.a=(k.a+S.a)/2,s(b,e.a)&&(b.b=e.a.b,b.a=e.a.a),_=s(f,y)?f:y,s(_,b)&&(b.b=_.b,b.a=_.a),o(b,f)||o(b,y))return F(e,t),0;if(!o(g,e.a)&&0<=i(g,e.a,b)||!o(v,e.a)&&i(v,e.a,b)<=0){if(v===e.a)m(n.b),p(h.b,n),n=le(t=I(t)).a,N(e,le(t),r),M(e,t,n.b.e,n,n,!0);else{if(g!==e.a)return 0<=i(g,e.a,b)&&(ue(t).b=t.b=!0,m(n.b),n.a.b=e.a.b,n.a.a=e.a.a),void(i(v,e.a,b)<=0&&(t.b=r.b=!0,m(h.b),h.a.b=e.a.b,h.a.a=e.a.a));for(m(h.b),p(n.e,h.b.e),y=(f=r=t).a.b.a;(f=ue(f)).a.b.a===y;);f=le(t=f).a.b.c,r.a=h.b.e,M(e,t,(h=N(e,r,null)).c,n.b.c,f,!0)}return 1}m(n.b),m(h.b),p(h.b.e,n),n.a.b=b.b,n.a.a=b.a,n.a.h=J(e.e,n.a),n=n.a,h=[0,0,0,0],b=[f.d,g.d,y.d,v.d],n.g[0]=n.g[1]=n.g[2]=0,D(n,f,g,h,0),D(n,y,v,h,2),P(e,n,b,h,!0),ue(t).b=t.b=r.b=!0}}function B(e,t){for(var r=le(t);;){for(;r.b;)r=le(t=r);if(!(t.b||null!==(t=ue(r=t))&&t.b))break;t.b=!1;var n=t.a,o=r.a;if(a=n.b.a!==o.b.a)e:{var a,l=le(a=t),u=a.a,c=l.a,d=void 0;if(s(u.b.a,c.b.a)){if(i(u.b.a,c.b.a,u.a)<0){a=!1;break e}ue(a).b=a.b=!0,d=m(u),p(c.b,d),d.d.c=a.d}else{if(0<i(c.b.a,u.b.a,c.a)){a=!1;break e}a.b=l.b=!0,d=m(c),p(u.e,c.b),d.b.d.c=a.d}a=!0}if(a&&(r.c?(j(r),f(o),o=(r=le(t)).a):t.c&&(j(t),f(n),n=(t=ue(r)).a)),n.a!==o.a)if(n.b.a===o.b.a||t.c||r.c||n.b.a!==e.a&&o.b.a!==e.a)F(e,t);else if($(e,t))break;n.a===o.a&&n.b.a===o.b.a&&(T(o,n),j(t),f(n),t=ue(r))}}function U(e,t){var r=new ie,n=h(e.b);n.a.b=4e150,n.a.a=t,n.b.a.b=-4e150,n.b.a.a=t,e.a=n.b.a,r.a=n,r.f=0,r.d=!1,r.c=!1,r.h=!0,r.b=!1,n=G(n=e.f,n.a,r),r.e=n}function V(e){this.a=new z,this.b=e,this.c=E}function G(e,t,r){for(;null!==(t=t.c).b&&!e.c(e.b,t.b,r););return e=new z(r,t.a,t),t.a.c=e,t.a=e}function z(e,t,r){this.b=e||null,this.a=t||this,this.c=r||this}function W(){this.d=0,this.p=this.b=this.q=null,this.j=[0,0,0],this.s=100130,this.n=!1,this.o=this.a=this.e=this.f=null,this.m=!1,this.c=this.r=this.i=this.k=this.l=this.h=null}function H(e,t){if(e.d!==t)for(;e.d!==t;)if(e.d<t)switch(e.d){case 0:q(e,100151),e.u(null);break;case 1:q(e,100152),e.t()}else switch(e.d){case 2:q(e,100154),e.v();break;case 1:q(e,100153),e.w()}}function q(e,t){e.p&&e.p(t,e.c)}function X(e,t){this.b=e||this,this.d=t||this,this.a=null,this.c=!1}function Y(){(this.h=this).i=this.d=this.a=this.e=this.c=this.b=null,this.f=0}function K(){this.c=new Z,this.a=new X,this.b=new Y,this.d=new Y,this.b.b=this.d,this.d.b=this.b}function Z(e,t){this.e=e||this,this.f=t||this,this.d=this.c=null,this.g=[0,0,0],this.h=this.a=this.b=0}function Q(){this.c=[],this.d=null,this.a=0,this.e=!1,this.b=new te}function J(e,t){var r,n,o;return e.e?(2*(n=++(r=e.b).a)>r.f&&(r.f*=2,r.c=re(r.c,r.f+1)),0===r.b?o=n:(o=r.b,r.b=r.c[r.b]),r.e[o]=t,r.c[o]=n,r.d[n]=o,r.h&&ae(r,n),o):(r=e.a++,e.c[r]=t,-(r+1))}function ee(e){if(0===e.a)return oe(e.b);var t=e.c[e.d[e.a-1]];if(0!==e.b.a&&s(ne(e.b),t))return oe(e.b);for(;--e.a,0<e.a&&null===e.c[e.d[e.a-1]];);return t}function te(){this.d=re([0],33),this.e=[null,null],this.c=[0,0],this.a=0,this.f=32,this.b=0,this.h=!1,this.d[1]=1}function re(e,t){for(var r=Array(t),n=0;n<e.length;n++)r[n]=e[n];for(;n<t;n++)r[n]=0;return r}function ne(e){return e.e[e.d[1]]}function oe(e){var t=e.d,r=e.e,n=e.c,o=t[1],s=r[o];return 0<e.a&&(t[1]=t[e.a],n[t[1]]=1,r[o]=null,n[o]=e.b,e.b=o,0<--e.a&&se(e,1)),s}function se(e,t){for(var r=e.d,n=e.e,o=e.c,a=t,i=r[a];;){var l=a<<1,u=(l<e.a&&s(n[r[l+1]],n[r[l]])&&(l+=1),r[l]);if(l>e.a||s(n[i],n[u])){o[r[a]=i]=a;break}o[r[a]=u]=a,a=l}}function ae(e,t){for(var r=e.d,n=e.e,o=e.c,a=t,i=r[a];;){var l=a>>1,u=r[l];if(0==l||s(n[u],n[i])){o[r[a]=i]=a;break}o[r[a]=u]=a,a=l}}function ie(){this.e=this.a=null,this.f=0,this.c=this.b=this.h=this.d=!1}function le(e){return e.e.c.b}function ue(e){return e.e.a.b}(n=W.prototype).x=function(){H(this,0)},n.B=function(e,t){switch(e){case 100142:return;case 100140:switch(t){case 100130:case 100131:case 100132:case 100133:case 100134:return void(this.s=t)}break;case 100141:return void(this.m=!!t);default:return void q(this,100900)}q(this,100901)},n.y=function(e){switch(e){case 100142:return 0;case 100140:return this.s;case 100141:return this.m;default:q(this,100900)}return!1},n.A=function(e,t,r){this.j[0]=e,this.j[1]=t,this.j[2]=r},n.z=function(e,t){var r=t||null;switch(e){case 100100:case 100106:this.h=r;break;case 100104:case 100110:this.l=r;break;case 100101:case 100107:this.k=r;break;case 100102:case 100108:this.i=r;break;case 100103:case 100109:this.p=r;break;case 100105:case 100111:this.o=r;break;case 100112:this.r=r;break;default:q(this,100900)}},n.C=function(e,t){var r=!1,n=[0,0,0];H(this,2);for(var o=0;o<3;++o){var s=e[o];s<-1e150&&(s=-1e150,r=!0),1e150<s&&(s=1e150,r=!0),n[o]=s}r&&q(this,100155),null===(r=this.q)?p(r=h(this.b),r.b):(m(r),r=r.e),r.a.d=t,r.a.g[0]=n[0],r.a.g[1]=n[1],r.a.g[2]=n[2],r.f=1,r.b.f=-1,this.q=r},n.u=function(e){H(this,0),this.d=1,this.b=new K,this.c=e},n.t=function(){H(this,1),this.d=2,this.q=null},n.v=function(){H(this,2),this.d=1},n.w=function(){H(this,1),this.d=0;var e,t,r=!1,n=[d=this.j[0],a=this.j[1],u=this.j[2]];if(0===d&&0===a&&0===u){for(var a=[-2e150,-2e150,-2e150],l=[2e150,2e150,2e150],u=[],c=[],d=(r=this.b.c).e;d!==r;d=d.e)for(var h=0;h<3;++h){var g=d.g[h];g<l[h]&&(l[h]=g,c[h]=d),g>a[h]&&(a[h]=g,u[h]=d)}if(a[1]-l[1]>a[d=0]-l[0]&&(d=1),l[d=a[2]-l[2]>a[d]-l[d]?2:d]>=a[d])n[0]=0,n[1]=0,n[2]=1;else{for(l=c[d],u=u[d],c=[a=0,0,0],l=[l.g[0]-u.g[0],l.g[1]-u.g[1],l.g[2]-u.g[2]],h=[0,0,0],d=r.e;d!==r;d=d.e)h[0]=d.g[0]-u.g[0],h[1]=d.g[1]-u.g[1],h[2]=d.g[2]-u.g[2],c[0]=l[1]*h[2]-l[2]*h[1],c[1]=l[2]*h[0]-l[0]*h[2],c[2]=l[0]*h[1]-l[1]*h[0],a<(g=c[0]*c[0]+c[1]*c[1]+c[2]*c[2])&&(a=g,n[0]=c[0],n[1]=c[1],n[2]=c[2]);a<=0&&(n[0]=n[1]=n[2]=0,n[k(l)]=1)}r=!0}for(c=k(n),d=this.b.c,a=(c+1)%3,u=(c+2)%3,c=0<n[c]?1:-1,n=d.e;n!==d;n=n.e)n.b=n.g[a],n.a=c*n.g[u];if(r){for(n=0,d=(r=this.b.a).b;d!==r;d=d.b)if(!((a=d.a).f<=0))for(;n+=(a.a.b-a.b.a.b)*(a.a.a+a.b.a.a),(a=a.e)!==d.a;);if(n<0)for(r=(n=this.b.c).e;r!==n;r=r.e)r.a=-r.a}for(this.n=!1,d=(n=this.b.b).h;d!==n;d=r)r=d.h,a=d.e,o(d.a,d.b.a)&&d.e.e!==d&&(L(this,a,d),f(d),a=(d=a).e),a.e===d&&(a!==d&&(a!==r&&a!==r.b||(r=r.h),f(a)),d!==r&&d!==r.b||(r=r.h),f(d));for(this.e=n=new Q,d=(r=this.b.c).e;d!==r;d=d.e)d.h=J(n,d);var b=n;b.d=[];for(var x=0;x<b.a;x++)b.d[x]=x;b.d.sort(function(e){return function(t,r){return s(e[t],e[r])?1:-1}}(b.c)),b.e=!0;for(var S=b.b,E=S.a;1<=E;--E)se(S,E);for(S.h=!0,this.f=new V(this),U(this,-4e150),U(this,4e150);null!==(n=ee(this.e));){for(;;){e:if(0===(d=this.e).a)r=ne(d.b);else if(r=d.c[d.d[d.a-1]],0!==d.b.a&&s(d=ne(d.b),r)){r=d;break e}if(null===r||!o(r,n))break;r=ee(this.e),L(this,n.c,r.c)}!function e(t,r){for(var n,a=(t.a=r).c;null===a.i;)if((a=a.c)===r.c){a=t;var l=r;(g=new ie).a=l.c.b;for(var u=(c=a.f).a;null!==(u=u.a).b&&!c.c(c.b,g,u.b););var c,d,h=le(c=u.b),g=c.a;return u=h.a,void(0===i(g.b.a,l,g.a)?o((g=c.a).a,l)||o(g.b.a,l)||(m(g.b),c.c&&(f(g.c),c.c=!1),p(l.c,g),e(a,l)):(d=s(u.b.a,g.b.a)?c:h,h=void 0,c.d||d.c?(h=d===c?y(l.c.b,g.e):y(u.b.c.b,l.c).b,d.c?C(d,h):((c=O(g=a,c,h)).f=ue(c).f+c.a.f,c.d=A(g,c.f)),e(a,l)):M(a,c,l.c,l.c,null,!0)))}c=(g=le(a=I(a.i))).a,(g=N(t,g,null)).c===c?(g=(c=g).c,u=le(a),h=a.a,d=u.a,n=!1,h.b.a!==d.b.a&&$(t,a),o(h.a,t.a)&&(p(g.b.e,h),g=le(a=I(a)).a,N(t,le(a),u),n=!0),o(d.a,t.a)&&(p(c,d.b.e),c=N(t,u,null),n=!0),n?M(t,a,c.c,g,g,!0):(l=s(d.a,h.a)?d.b.e:h,M(t,a,l=y(c.c.b,l),l.c,l.c,!1),l.b.i.c=!0,B(t,a))):M(t,a,g.c,c,c,!0)}(this,n)}for(this.a=this.f.a.a.b.a.a,n=0;null!==(r=this.f.a.a.b);)r.h||++n,j(r);for(this.f=null,(n=this.e).b=null,n.d=null,this.e=n.c=null,d=(n=this.b).a.b;d!==n.a;d=r)r=d.b,(d=d.a).e.e===d&&(T(d.c,d),f(d));if(!this.n){if(n=this.b,this.m)for(d=n.b.h;d!==n.b;d=r)r=d.h,d.b.d.c!==d.d.c?d.f=d.d.c?1:-1:f(d);else for(d=n.a.b;d!==n.a;d=r)if(r=d.b,d.c){for(d=d.a;s(d.b.a,d.a);d=d.c.b);for(;s(d.a,d.b.a);d=d.e);for(a=d.c.b,u=void 0;d.e!==a;)if(s(d.b.a,a.a)){for(;a.e!==d&&(s((t=a.e).b.a,t.a)||i(a.a,a.b.a,a.e.b.a)<=0);)a=(u=y(a.e,a)).b;a=a.c.b}else{for(;a.e!==d&&(s((e=d.c.b).a,e.b.a)||0<=i(d.b.a,d.a,d.c.b.a));)d=(u=y(d,d.c.b)).b;d=d.e}for(;a.e.e!==d;)a=(u=y(a.e,a)).b}if(this.h||this.i||this.k||this.l)if(this.m){for(r=(n=this.b).a.b;r!==n.a;r=r.b)if(r.c){for(this.h&&this.h(2,this.c),d=r.a;this.k&&this.k(d.a.d,this.c),(d=d.e)!==r.a;);this.i&&this.i(this.c)}}else{for(n=this.b,r=!!this.l,d=!1,a=-1,u=n.a.d;u!==n.a;u=u.d)if(u.c)for(d||(this.h&&this.h(4,this.c),d=!0),c=u.a;r&&a!==(l=c.b.d.c?0:1)&&(a=l,this.l&&this.l(!!a,this.c)),this.k&&this.k(c.a.d,this.c),(c=c.e)!==u.a;);d&&this.i&&this.i(this.c)}if(this.r){for(d=(n=this.b).a.b;d!==n.a;d=r)if(r=d.b,!d.c){for(u=(a=d.a).e,c=void 0;u=(c=u).e,(c.d=null)===c.b.d&&(c.c===c?_(c.a,null):(c.a.c=c.c,v(c,c.b.e)),(l=c.b).c===l?_(l.a,null):(l.a.c=l.c,v(l,l.b.e)),w(c)),c!==a;);a=d.d,((d=d.b).d=a).b=d}return this.r(this.b),void(this.c=this.b=null)}}this.b=this.c=null},this.libtess={GluTesselator:W,windingRule:{GLU_TESS_WINDING_ODD:100130,GLU_TESS_WINDING_NONZERO:100131,GLU_TESS_WINDING_POSITIVE:100132,GLU_TESS_WINDING_NEGATIVE:100133,GLU_TESS_WINDING_ABS_GEQ_TWO:100134},primitiveType:{GL_LINE_LOOP:2,GL_TRIANGLES:4,GL_TRIANGLE_STRIP:5,GL_TRIANGLE_FAN:6},errorType:{GLU_TESS_MISSING_BEGIN_POLYGON:100151,GLU_TESS_MISSING_END_POLYGON:100153,GLU_TESS_MISSING_BEGIN_CONTOUR:100152,GLU_TESS_MISSING_END_CONTOUR:100154,GLU_TESS_COORD_TOO_LARGE:100155,GLU_TESS_NEED_COMBINE_CALLBACK:100156},gluEnum:{GLU_TESS_MESH:100112,GLU_TESS_TOLERANCE:100142,GLU_TESS_WINDING_RULE:100140,GLU_TESS_BOUNDARY_ONLY:100141,GLU_INVALID_ENUM:100900,GLU_INVALID_VALUE:100901,GLU_TESS_BEGIN:100100,GLU_TESS_VERTEX:100101,GLU_TESS_END:100102,GLU_TESS_ERROR:100103,GLU_TESS_EDGE_FLAG:100104,GLU_TESS_COMBINE:100105,GLU_TESS_BEGIN_DATA:100106,GLU_TESS_VERTEX_DATA:100107,GLU_TESS_END_DATA:100108,GLU_TESS_ERROR_DATA:100109,GLU_TESS_EDGE_FLAG_DATA:100110,GLU_TESS_COMBINE_DATA:100111}},W.prototype.gluDeleteTess=W.prototype.x,W.prototype.gluTessProperty=W.prototype.B,W.prototype.gluGetTessProperty=W.prototype.y,W.prototype.gluTessNormal=W.prototype.A,W.prototype.gluTessCallback=W.prototype.z,W.prototype.gluTessVertex=W.prototype.C,W.prototype.gluTessBeginPolygon=W.prototype.u,W.prototype.gluTessBeginContour=W.prototype.t,W.prototype.gluTessEndContour=W.prototype.v,W.prototype.gluTessEndPolygon=W.prototype.w,void 0!==t&&(t.exports=this.libtess)},{}],246:[function(e,t,r){"use strict";function n(e,t,r,n){for(var o=e[t++],s=1<<o,a=1+s,i=1+a,l=o+1,u=(1<<l)-1,c=0,d=0,h=0,p=e[t++],f=new Int32Array(4096),m=null;;){for(;c<16&&0!==p;)d|=e[t++]<<c,c+=8,1===p?p=e[t++]:--p;if(c<l)break;var y=d&u;if(d>>=l,c-=l,y==s)i=1+a,u=(1<<(l=o+1))-1,m=null;else{if(y==a)break;for(var g=y<i?y:m,v=0,b=g;s<b;)b=f[b]>>8,++v;var x=b;if(n<h+v+(g!==y?1:0))return void console.log("Warning, gif stream longer than expected.");r[h++]=x;var w=h+=v;for(g!==y&&(r[h++]=x),b=g;v--;)b=f[b],r[--w]=255&b,b>>=8;null!==m&&i<4096&&(f[i++]=m<<8|x,u+1<=i&&l<12&&(++l,u=u<<1|1)),m=y}}h!==n&&console.log("Warning, gif stream shorter than expected.")}try{r.GifWriter=function(e,t,r,n){var o=0,s=void 0===(n=void 0===n?{}:n).loop?null:n.loop,a=void 0===n.palette?null:n.palette;if(t<=0||r<=0||65535<t||65535<r)throw new Error("Width/Height invalid.");function i(e){if((e=e.length)<2||256<e||e&e-1)throw new Error("Invalid code/color length, must be power of 2 and 2 .. 256.");return e}e[o++]=71,e[o++]=73,e[o++]=70,e[o++]=56,e[o++]=57,e[o++]=97;var l=0,u=0;if(null!==a){for(var c=i(a);c>>=1;)++l;if(c=1<<l,--l,void 0!==n.background){if(c<=(u=n.background))throw new Error("Background index out of range.");if(0===u)throw new Error("Background index explicitly passed as 0.")}}if(e[o++]=255&t,e[o++]=t>>8&255,e[o++]=255&r,e[o++]=r>>8&255,e[o++]=(null!==a?128:0)|l,e[o++]=u,e[o++]=0,null!==a)for(var d=0,h=a.length;d<h;++d){var p=a[d];e[o++]=p>>16&255,e[o++]=p>>8&255,e[o++]=255&p}if(null!==s){if(s<0||65535<s)throw new Error("Loop count invalid.");e[o++]=33,e[o++]=255,e[o++]=11,e[o++]=78,e[o++]=69,e[o++]=84,e[o++]=83,e[o++]=67,e[o++]=65,e[o++]=80,e[o++]=69,e[o++]=50,e[o++]=46,e[o++]=48,e[o++]=3,e[o++]=1,e[o++]=255&s,e[o++]=s>>8&255,e[o++]=0}var f=!1;this.addFrame=function(t,r,n,s,l,u){if(!0===f&&(--o,f=!1),u=void 0===u?{}:u,t<0||r<0||65535<t||65535<r)throw new Error("x/y invalid.");if(n<=0||s<=0||65535<n||65535<s)throw new Error("Width/Height invalid.");if(l.length<n*s)throw new Error("Not enough pixels for the frame size.");var c=!0,d=u.palette;if(null==d&&(c=!1,d=a),null==d)throw new Error("Must supply either a local or global palette.");for(var h=i(d),p=0;h>>=1;)++p;h=1<<p;var m=void 0===u.delay?0:u.delay,y=void 0===u.disposal?0:u.disposal;if(y<0||3<y)throw new Error("Disposal out of range.");var g=!1,v=0;if(void 0!==u.transparent&&null!==u.transparent&&(g=!0,(v=u.transparent)<0||h<=v))throw new Error("Transparent color index.");if(0===y&&!g&&0===m||(e[o++]=33,e[o++]=249,e[o++]=4,e[o++]=y<<2|(!0===g?1:0),e[o++]=255&m,e[o++]=m>>8&255,e[o++]=v,e[o++]=0),e[o++]=44,e[o++]=255&t,e[o++]=t>>8&255,e[o++]=255&r,e[o++]=r>>8&255,e[o++]=255&n,e[o++]=n>>8&255,e[o++]=255&s,e[o++]=s>>8&255,e[o++]=!0===c?128|p-1:0,!0===c)for(var b=0,x=d.length;b<x;++b){var w=d[b];e[o++]=w>>16&255,e[o++]=w>>8&255,e[o++]=255&w}return o=function(e,t,r,n){e[t++]=r;var o=t++,s=1<<r,a=s-1,i=1+s,l=1+i,u=r+1,c=0,d=0;function h(r){for(;r<=c;)e[t++]=255&d,d>>=8,c-=8,t===o+256&&(e[o]=255,o=t++)}function p(e){d|=e<<c,c+=u,h(8)}var f=n[0]&a,m={};p(s);for(var y=1,g=n.length;y<g;++y){var v=n[y]&a,b=f<<8|v,x=m[b];if(void 0===x){for(d|=f<<c,c+=u;8<=c;)e[t++]=255&d,d>>=8,c-=8,t===o+256&&(e[o]=255,o=t++);4096===l?(p(s),l=1+i,u=r+1,m={}):(1<<u<=l&&++u,m[b]=l++),f=v}else f=x}return p(f),p(i),h(1),o+1===t?e[o]=0:(e[o]=t-o-1,e[t++]=0),t}(e,o,p<2?2:p,l)},this.end=function(){return!1===f&&(e[o++]=59,f=!0),o},this.getOutputBuffer=function(){return e},this.setOutputBuffer=function(t){e=t},this.getOutputBufferPosition=function(){return o},this.setOutputBufferPosition=function(e){o=e}},r.GifReader=function(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,o=e[t++]|e[t++]<<8,s=e[t++],a=1<<1+(7&s),i=(e[t++],e[t++],null),l=null,u=(s>>7&&(i=t,t+=3*(l=a)),!0),c=[],d=0,h=null,p=0,f=null;for(this.width=r,this.height=o;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,f=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!(0<=(y=e[t++])))throw Error("Invalid block size");if(0===y)break;t+=y}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var m=e[t++];d=e[t++]|e[t++]<<8,h=e[t++],0==(1&m)&&(h=null),p=m>>2&7,t++;break;case 254:for(;;){if(!(0<=(y=e[t++])))throw Error("Invalid block size");if(0===y)break;t+=y}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y,g=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,w=(T=e[t++])>>6&1,_=i,S=l,k=!1,T=(T>>7&&(k=!0,_=t,t+=3*(S=1<<1+(7&T))),t);for(t++;;){if(!(0<=(y=e[t++])))throw Error("Invalid block size");if(0===y)break;t+=y}c.push({x:g,y:v,width:b,height:x,has_local_palette:k,palette_offset:_,palette_size:S,data_offset:T,data_length:t-T,transparent_index:h,interlaced:!!w,delay:d,disposal:p});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return f},this.frameInfo=function(e){if(e<0||e>=c.length)throw new Error("Frame index out of range.");return c[e]},this.decodeAndBlitFrameBGRA=function(t,o){for(var s=(t=this.frameInfo(t)).width*t.height,a=new Uint8Array(s),i=(n(e,t.data_offset,a,s),t.palette_offset),l=t.transparent_index,u=(null===l&&(l=256),t.width),c=r-u,d=u,h=4*(t.y*r+t.x),p=4*((t.y+t.height)*r+t.x),f=h,m=4*c,y=(!0===t.interlaced&&(m+=4*r*7),8),g=0,v=a.length;g<v;++g){var b,x,w=a[g];0===d&&(d=u,p<=(f+=m)&&(m=4*c+4*r*(y-1),f=h+(u+c)*(y<<1),y>>=1)),w===l?f+=4:(b=e[i+3*w],x=e[i+3*w+1],w=e[i+3*w+2],o[f++]=w,o[f++]=x,o[f++]=b,o[f++]=255),--d}},this.decodeAndBlitFrameRGBA=function(t,o){for(var s=(t=this.frameInfo(t)).width*t.height,a=new Uint8Array(s),i=(n(e,t.data_offset,a,s),t.palette_offset),l=t.transparent_index,u=(null===l&&(l=256),t.width),c=r-u,d=u,h=4*(t.y*r+t.x),p=4*((t.y+t.height)*r+t.x),f=h,m=4*c,y=(!0===t.interlaced&&(m+=4*r*7),8),g=0,v=a.length;g<v;++g){var b,x,w=a[g];0===d&&(d=u,p<=(f+=m)&&(m=4*c+4*r*(y-1),f=h+(u+c)*(y<<1),y>>=1)),w===l?f+=4:(b=e[i+3*w],x=e[i+3*w+1],w=e[i+3*w+2],o[f++]=b,o[f++]=x,o[f++]=w,o[f++]=255),--d}}}}catch(e){}},{}],247:[function(e,t,r){(function(n){var o;o=function(t){"use strict";function r(e){if(null==this)throw TypeError();var t,r=String(this),n=r.length;if(!((e=(e=e?Number(e):0)!=e?0:e)<0||n<=e))return 55296<=(t=r.charCodeAt(e))&&t<=56319&&e+1<n&&56320<=(n=r.charCodeAt(e+1))&&n<=57343?1024*(t-55296)+n-56320+65536:t}var o;function s(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function a(e,t){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=t,this.destLen=0,this.ltree=new s,this.dtree=new s}String.prototype.codePointAt||((o=function(){try{var e={},t=Object.defineProperty,r=t(e,e,e)&&t}catch(e){}return r}())?o(String.prototype,"codePointAt",{value:r,configurable:!0,writable:!0}):String.prototype.codePointAt=r);var i=new s,l=new s,u=new Uint8Array(30),c=new Uint16Array(30),d=new Uint8Array(30),h=new Uint16Array(30),p=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=new s,m=new Uint8Array(320);function y(e,t,r,n){for(var o,s=0;s<r;++s)e[s]=0;for(s=0;s<30-r;++s)e[s+r]=s/r|0;for(o=n,s=0;s<30;++s)t[s]=o,o+=1<<e[s]}var g=new Uint16Array(16);function v(e,t,r,n){for(var o,s=0;s<16;++s)e.table[s]=0;for(s=0;s<n;++s)e.table[t[r+s]]++;for(s=o=e.table[0]=0;s<16;++s)g[s]=o,o+=e.table[s];for(s=0;s<n;++s)t[r+s]&&(e.trans[g[t[r+s]]++]=s)}function b(e,t,r){if(!t)return r;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-t;return e.tag>>>=t,e.bitcount-=t,n+r}function x(e,t){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;for(var r=0,n=0,o=0,s=e.tag;n=2*n+(1&s),s>>>=1,r+=t.table[++o],0<=(n-=t.table[o]););return e.tag=s,e.bitcount-=o,t.trans[r+n]}function w(e,t,r){for(;;){if(256===(s=x(e,t)))return 0;if(s<256)e.dest[e.destLen++]=s;else for(var n,o=b(e,u[s-=257],c[s]),s=x(e,r),a=n=e.destLen-b(e,d[s],h[s]);a<n+o;++a)e.dest[e.destLen++]=e.dest[a]}}for(var _=i,S=l,k=0;k<7;++k)_.table[k]=0;for(_.table[7]=24,_.table[8]=152,_.table[9]=112,k=0;k<24;++k)_.trans[k]=256+k;for(k=0;k<144;++k)_.trans[24+k]=k;for(k=0;k<8;++k)_.trans[168+k]=280+k;for(k=0;k<112;++k)_.trans[176+k]=144+k;for(k=0;k<5;++k)S.table[k]=0;for(S.table[5]=32,k=0;k<32;++k)S.trans[k]=k;y(u,c,4,3),y(d,h,2,1),u[28]=0,c[28]=258;var T=function(e,t){var r,n,o,s=new a(e,t);do{switch((n=s).bitcount--||(n.tag=n.source[n.sourceIndex++],n.bitcount=7),o=1&n.tag,n.tag>>>=1,n=o,b(s,2,0)){case 0:r=function(e){for(var t,r;8<e.bitcount;)e.sourceIndex--,e.bitcount-=8;if((t=256*e.source[e.sourceIndex+1]+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return-3;for(e.sourceIndex+=4,r=t;r;--r)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,0}(s);break;case 1:r=w(s,i,l);break;case 2:E=T=k=j=u=S=void 0;for(var u,c=s,d=s.ltree,h=s.dtree,y=b(c,5,257),g=b(c,5,1),_=b(c,4,4),S=0;S<19;++S)m[S]=0;for(S=0;S<_;++S){var k=b(c,3,0);m[p[S]]=k}for(v(f,m,0,19),u=0;u<y+g;){var T=x(c,f);switch(T){case 16:for(var E=m[u-1],j=b(c,2,3);j;--j)m[u++]=E;break;case 17:for(j=b(c,3,3);j;--j)m[u++]=0;break;case 18:for(j=b(c,7,11);j;--j)m[u++]=0;break;default:m[u++]=T}}v(d,m,0,y),v(h,m,y,g),r=w(s,s.ltree,s.dtree);break;default:r=-3}if(0!==r)throw new Error("Data error")}while(!n);return s.destLen<s.dest.length?"function"==typeof s.dest.slice?s.dest.slice(0,s.destLen):s.dest.subarray(0,s.destLen):s.dest};function E(e,t,r,n,o){return Math.pow(1-o,3)*e+3*Math.pow(1-o,2)*o*t+3*(1-o)*Math.pow(o,2)*r+Math.pow(o,3)*n}function j(){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN}function C(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}function I(e){throw new Error(e)}function O(e,t){e||I(t)}j.prototype.isEmpty=function(){return isNaN(this.x1)||isNaN(this.y1)||isNaN(this.x2)||isNaN(this.y2)},j.prototype.addPoint=function(e,t){"number"==typeof e&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=e,this.x2=e),e<this.x1&&(this.x1=e),e>this.x2&&(this.x2=e)),"number"==typeof t&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=t,this.y2=t),t<this.y1&&(this.y1=t),t>this.y2&&(this.y2=t))},j.prototype.addX=function(e){this.addPoint(e,null)},j.prototype.addY=function(e){this.addPoint(null,e)},j.prototype.addBezier=function(e,t,r,n,o,s,a,i){var l=[e,t],u=[r,n],c=[o,s],d=[a,i];this.addPoint(e,t),this.addPoint(a,i);for(var h=0;h<=1;h++){var p,f=6*l[h]-12*u[h]+6*c[h],m=-3*l[h]+9*u[h]-9*c[h]+3*d[h],y=3*u[h]-3*l[h];0==m?0==f||0<(p=-y/f)&&p<1&&(0===h&&this.addX(E(l[h],u[h],c[h],d[h],p)),1===h&&this.addY(E(l[h],u[h],c[h],d[h],p))):(p=Math.pow(f,2)-4*y*m)<0||(0<(y=(-f+Math.sqrt(p))/(2*m))&&y<1&&(0===h&&this.addX(E(l[h],u[h],c[h],d[h],y)),1===h&&this.addY(E(l[h],u[h],c[h],d[h],y))),0<(y=(-f-Math.sqrt(p))/(2*m))&&y<1&&(0===h&&this.addX(E(l[h],u[h],c[h],d[h],y)),1===h&&this.addY(E(l[h],u[h],c[h],d[h],y))))}},j.prototype.addQuad=function(e,t,r,n,o,s){r=e+2/3*(r-e),n=t+2/3*(n-t),this.addBezier(e,t,r,n,r+1/3*(o-e),n+1/3*(s-t),o,s)},C.prototype.moveTo=function(e,t){this.commands.push({type:"M",x:e,y:t})},C.prototype.lineTo=function(e,t){this.commands.push({type:"L",x:e,y:t})},C.prototype.curveTo=C.prototype.bezierCurveTo=function(e,t,r,n,o,s){this.commands.push({type:"C",x1:e,y1:t,x2:r,y2:n,x:o,y:s})},C.prototype.quadTo=C.prototype.quadraticCurveTo=function(e,t,r,n){this.commands.push({type:"Q",x1:e,y1:t,x:r,y:n})},C.prototype.close=C.prototype.closePath=function(){this.commands.push({type:"Z"})},C.prototype.extend=function(e){var t;if(e.commands)e=e.commands;else if(e instanceof j)return t=e,this.moveTo(t.x1,t.y1),this.lineTo(t.x2,t.y1),this.lineTo(t.x2,t.y2),this.lineTo(t.x1,t.y2),void this.close();Array.prototype.push.apply(this.commands,e)},C.prototype.getBoundingBox=function(){for(var e=new j,t=0,r=0,n=0,o=0,s=0;s<this.commands.length;s++){var a=this.commands[s];switch(a.type){case"M":e.addPoint(a.x,a.y),t=n=a.x,r=o=a.y;break;case"L":e.addPoint(a.x,a.y),n=a.x,o=a.y;break;case"Q":e.addQuad(n,o,a.x1,a.y1,a.x,a.y),n=a.x,o=a.y;break;case"C":e.addBezier(n,o,a.x1,a.y1,a.x2,a.y2,a.x,a.y),n=a.x,o=a.y;break;case"Z":n=t,o=r;break;default:throw new Error("Unexpected path command "+a.type)}}return e.isEmpty()&&e.addPoint(0,0),e},C.prototype.draw=function(e){e.beginPath();for(var t=0;t<this.commands.length;t+=1){var r=this.commands[t];"M"===r.type?e.moveTo(r.x,r.y):"L"===r.type?e.lineTo(r.x,r.y):"C"===r.type?e.bezierCurveTo(r.x1,r.y1,r.x2,r.y2,r.x,r.y):"Q"===r.type?e.quadraticCurveTo(r.x1,r.y1,r.x,r.y):"Z"===r.type&&e.closePath()}this.fill&&(e.fillStyle=this.fill,e.fill()),this.stroke&&(e.strokeStyle=this.stroke,e.lineWidth=this.strokeWidth,e.stroke())},C.prototype.toPathData=function(e){function t(){for(var t=arguments,r="",n=0;n<arguments.length;n+=1){var o=t[n];0<=o&&0<n&&(r+=" "),r+=Math.round(o)===o?""+Math.round(o):o.toFixed(e)}return r}e=void 0!==e?e:2;for(var r="",n=0;n<this.commands.length;n+=1){var o=this.commands[n];"M"===o.type?r+="M"+t(o.x,o.y):"L"===o.type?r+="L"+t(o.x,o.y):"C"===o.type?r+="C"+t(o.x1,o.y1,o.x2,o.y2,o.x,o.y):"Q"===o.type?r+="Q"+t(o.x1,o.y1,o.x,o.y):"Z"===o.type&&(r+="Z")}return r},C.prototype.toSVG=function(e){var t=(t='<path d="')+this.toPathData(e)+'"';return this.fill&&"black"!==this.fill&&(null===this.fill?t+=' fill="none"':t+=' fill="'+this.fill+'"'),this.stroke&&(t+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),t+"/>"},C.prototype.toDOMElement=function(e){e=this.toPathData(e);var t=document.createElementNS("http://www.w3.org/2000/svg","path");return t.setAttribute("d",e),t};var A={fail:I,argument:O,assert:O},R={},N={},M={};function P(e){return function(){return e}}N.BYTE=function(e){return A.argument(0<=e&&e<=255,"Byte value should be between 0 and 255."),[e]},M.BYTE=P(1),N.CHAR=function(e){return[e.charCodeAt(0)]},M.CHAR=P(1),N.CHARARRAY=function(e){for(var t=[],r=0;r<e.length;r+=1)t[r]=e.charCodeAt(r);return t},M.CHARARRAY=function(e){return e.length},N.USHORT=function(e){return[e>>8&255,255&e]},M.USHORT=P(2),N.SHORT=function(e){return[(e=32768<=e?-(65536-e):e)>>8&255,255&e]},M.SHORT=P(2),N.UINT24=function(e){return[e>>16&255,e>>8&255,255&e]},M.UINT24=P(3),N.ULONG=function(e){return[e>>24&255,e>>16&255,e>>8&255,255&e]},M.ULONG=P(4),N.LONG=function(e){return[(e=2147483648<=e?-(4294967296-e):e)>>24&255,e>>16&255,e>>8&255,255&e]},M.LONG=P(4),N.FIXED=N.ULONG,M.FIXED=M.ULONG,N.FWORD=N.SHORT,M.FWORD=M.SHORT,N.UFWORD=N.USHORT,M.UFWORD=M.USHORT,N.LONGDATETIME=function(e){return[0,0,0,0,e>>24&255,e>>16&255,e>>8&255,255&e]},M.LONGDATETIME=P(8),N.TAG=function(e){return A.argument(4===e.length,"Tag should be exactly 4 ASCII characters."),[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]},M.TAG=P(4),N.Card8=N.BYTE,M.Card8=M.BYTE,N.Card16=N.USHORT,M.Card16=M.USHORT,N.OffSize=N.BYTE,M.OffSize=M.BYTE,N.SID=N.USHORT,M.SID=M.USHORT,N.NUMBER=function(e){return-107<=e&&e<=107?[e+139]:108<=e&&e<=1131?[247+((e-=108)>>8),255&e]:-1131<=e&&e<=-108?[251+((e=-e-108)>>8),255&e]:-32768<=e&&e<=32767?N.NUMBER16(e):N.NUMBER32(e)},M.NUMBER=function(e){return N.NUMBER(e).length},N.NUMBER16=function(e){return[28,e>>8&255,255&e]},M.NUMBER16=P(3),N.NUMBER32=function(e){return[29,e>>24&255,e>>16&255,e>>8&255,255&e]},M.NUMBER32=P(5),N.REAL=function(e){for(var t=e.toString(),r=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(t),n=(r&&(r=parseFloat("1e"+((r[2]?+r[2]:0)+r[1].length)),t=(Math.round(e*r)/r).toString()),""),o=0,s=t.length;o<s;o+=1){var a=t[o];n+="e"===a?"-"===t[++o]?"c":"b":"."===a?"a":"-"===a?"e":a}for(var i=[30],l=0,u=(n+=1&n.length?"f":"ff").length;l<u;l+=2)i.push(parseInt(n.substr(l,2),16));return i},M.REAL=function(e){return N.REAL(e).length},N.NAME=N.CHARARRAY,M.NAME=M.CHARARRAY,N.STRING=N.CHARARRAY,M.STRING=M.CHARARRAY,R.UTF8=function(e,t,r){for(var n=[],o=r,s=0;s<o;s++,t+=1)n[s]=e.getUint8(t);return String.fromCharCode.apply(null,n)},R.UTF16=function(e,t,r){for(var n=[],o=r/2,s=0;s<o;s++,t+=2)n[s]=e.getUint16(t);return String.fromCharCode.apply(null,n)},N.UTF16=function(e){for(var t=[],r=0;r<e.length;r+=1){var n=e.charCodeAt(r);t[t.length]=n>>8&255,t[t.length]=255&n}return t},M.UTF16=function(e){return 2*e.length};var L,D={"x-mac-croatian":"","x-mac-cyrillic":"","x-mac-gaelic":"","x-mac-greek":"","x-mac-icelandic":"","x-mac-inuit":"","x-mac-ce":"",macintosh:"","x-mac-romanian":"","x-mac-turkish":""},F=(R.MACSTRING=function(e,t,r,n){var o=D[n];if(void 0!==o){for(var s="",a=0;a<r;a++){var i=e.getUint8(t+a);s+=i<=127?String.fromCharCode(i):o[127&i]}return s}},"function"==typeof WeakMap&&new WeakMap);function $(e){return-128<=e&&e<=127}N.MACSTRING=function(e,t){var r=function(e){if(!L)for(var t in L={},D)L[t]=new String(t);var r=L[e];if(void 0!==r){if(F){var n=F.get(r);if(void 0!==n)return n}var o=D[e];if(void 0!==o){for(var s={},a=0;a<o.length;a++)s[o.charCodeAt(a)]=a+128;return F&&F.set(r,s),s}}}(t);if(void 0!==r){for(var n=[],o=0;o<e.length;o++){var s=e.charCodeAt(o);if(128<=s&&void 0===(s=r[s]))return;n[o]=s}return n}},M.MACSTRING=function(e,t){return void 0!==(e=N.MACSTRING(e,t))?e.length:0},N.VARDELTAS=function(e){for(var t=0,r=[];t<e.length;){var n=e[t];t=(0===n?function(e,t,r){for(var n=0,o=e.length;t<o&&n<64&&0===e[t];)++t,++n;return r.push(128|n-1),t}:-128<=n&&n<=127?function(e,t,r){for(var n=0,o=e.length,s=t;s<o&&n<64;){var a=e[s];if(!$(a))break;if(0===a&&s+1<o&&0===e[s+1])break;++s,++n}r.push(n-1);for(var i=t;i<s;++i)r.push(e[i]+256&255);return s}:function(e,t,r){for(var n=0,o=e.length,s=t;s<o&&n<64;){var a=e[s];if(0===a)break;if($(a)&&s+1<o&&$(e[s+1]))break;++s,++n}r.push(64|n-1);for(var i=t;i<s;++i){var l=e[i];r.push(l+65536>>8&255,l+256&255)}return s})(e,t,r)}return r},N.INDEX=function(e){for(var t=1,r=[t],n=[],o=0;o<e.length;o+=1){var s=N.OBJECT(e[o]);Array.prototype.push.apply(n,s),t+=s.length,r.push(t)}if(0===n.length)return[0,0];for(var a=[],i=1+Math.floor(Math.log(t)/Math.log(2))/8|0,l=[void 0,N.BYTE,N.USHORT,N.UINT24,N.ULONG][i],u=0;u<r.length;u+=1){var c=l(r[u]);Array.prototype.push.apply(a,c)}return Array.prototype.concat(N.Card16(e.length),N.OffSize(i),a,n)},M.INDEX=function(e){return N.INDEX(e).length},N.DICT=function(e){for(var t=[],r=Object.keys(e),n=r.length,o=0;o<n;o+=1){var s=parseInt(r[o],0),a=e[s];t=(t=t.concat(N.OPERAND(a.value,a.type))).concat(N.OPERATOR(s))}return t},M.DICT=function(e){return N.DICT(e).length},N.OPERATOR=function(e){return e<1200?[e]:[12,e-1200]},N.OPERAND=function(e,t){var r=[];if(Array.isArray(t))for(var n=0;n<t.length;n+=1)A.argument(e.length===t.length,"Not enough arguments given for type"+t),r=r.concat(N.OPERAND(e[n],t[n]));else if("SID"===t)r=r.concat(N.NUMBER(e));else if("offset"===t)r=r.concat(N.NUMBER32(e));else if("number"===t)r=r.concat(N.NUMBER(e));else{if("real"!==t)throw new Error("Unknown operand type "+t);r=r.concat(N.REAL(e))}return r},N.OP=N.BYTE,M.OP=M.BYTE;var B="function"==typeof WeakMap&&new WeakMap;function U(e,t,r){for(var n=0;n<t.length;n+=1){var o=t[n];this[o.name]=o.value}if(this.tableName=e,this.fields=t,r)for(var s=Object.keys(r),a=0;a<s.length;a+=1){var i=s[a],l=r[i];void 0!==this[i]&&(this[i]=l)}}function V(e,t,r){void 0===r&&(r=t.length);var n=new Array(t.length+1);n[0]={name:e+"Count",type:"USHORT",value:r};for(var o=0;o<t.length;o++)n[o+1]={name:e+o,type:"USHORT",value:t[o]};return n}function G(e,t,r){var n=t.length,o=new Array(n+1);o[0]={name:e+"Count",type:"USHORT",value:n};for(var s=0;s<n;s++)o[s+1]={name:e+s,type:"TABLE",value:r(t[s],s)};return o}function z(e,t,r){var n=t.length,o=[];o[0]={name:e+"Count",type:"USHORT",value:n};for(var s=0;s<n;s++)o=o.concat(r(t[s],s));return o}function W(e){1===e.format?U.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(V("glyph",e.glyphs))):A.assert(!1,"Can't create coverage table format 2 yet.")}function H(e){U.call(this,"scriptListTable",z("scriptRecord",e,(function(e,t){var r=e.script,n=r.defaultLangSys;return A.assert(!!n,"Unable to write GSUB: script "+e.tag+" has no default language system."),[{name:"scriptTag"+t,type:"TAG",value:e.tag},{name:"script"+t,type:"TABLE",value:new U("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new U("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:n.reqFeatureIndex}].concat(V("featureIndex",n.featureIndexes)))}].concat(z("langSys",r.langSysRecords,(function(e,t){var r=e.langSys;return[{name:"langSysTag"+t,type:"TAG",value:e.tag},{name:"langSys"+t,type:"TABLE",value:new U("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:r.reqFeatureIndex}].concat(V("featureIndex",r.featureIndexes)))}]}))))}]})))}function q(e){U.call(this,"featureListTable",z("featureRecord",e,(function(e,t){var r=e.feature;return[{name:"featureTag"+t,type:"TAG",value:e.tag},{name:"feature"+t,type:"TABLE",value:new U("featureTable",[{name:"featureParams",type:"USHORT",value:r.featureParams}].concat(V("lookupListIndex",r.lookupListIndexes)))}]})))}function X(e,t){U.call(this,"lookupListTable",G("lookup",e,(function(e){var r=t[e.lookupType];return A.assert(!!r,"Unable to write GSUB lookup type "+e.lookupType+" tables."),new U("lookupTable",[{name:"lookupType",type:"USHORT",value:e.lookupType},{name:"lookupFlag",type:"USHORT",value:e.lookupFlag}].concat(G("subtable",e.subtables,r)))})))}N.CHARSTRING=function(e){if(B){var t=B.get(e);if(void 0!==t)return t}for(var r=[],n=e.length,o=0;o<n;o+=1){var s=e[o];r=r.concat(N[s.type](s.value))}return B&&B.set(e,r),r},M.CHARSTRING=function(e){return N.CHARSTRING(e).length},N.OBJECT=function(e){var t=N[e.type];return A.argument(void 0!==t,"No encoding function for type "+e.type),t(e.value)},M.OBJECT=function(e){var t=M[e.type];return A.argument(void 0!==t,"No sizeOf function for type "+e.type),t(e.value)},N.TABLE=function(e){for(var t=[],r=e.fields.length,n=[],o=[],s=0;s<r;s+=1){var a=e.fields[s],i=N[a.type],l=(A.argument(void 0!==i,"No encoding function for field type "+a.type+" ("+a.name+")"),e[a.name]);i=i(l=void 0===l?a.value:l),"TABLE"===a.type?(o.push(t.length),t=t.concat([0,0]),n.push(i)):t=t.concat(i)}for(var u=0;u<n.length;u+=1){var c=o[u],d=t.length;A.argument(d<65536,"Table "+e.tableName+" too big."),t[c]=d>>8,t[c+1]=255&d,t=t.concat(n[u])}return t},M.TABLE=function(e){for(var t=0,r=e.fields.length,n=0;n<r;n+=1){var o=e.fields[n],s=M[o.type],a=(A.argument(void 0!==s,"No sizeOf function for field type "+o.type+" ("+o.name+")"),e[o.name]);t+=s(a=void 0===a?o.value:a),"TABLE"===o.type&&(t+=2)}return t},N.RECORD=N.TABLE,M.RECORD=M.TABLE,N.LITERAL=function(e){return e},M.LITERAL=function(e){return e.length},U.prototype.encode=function(){return N.TABLE(this)},U.prototype.sizeOf=function(){return M.TABLE(this)};var Y={Table:U,Record:U,Coverage:(W.prototype=Object.create(U.prototype)).constructor=W,ScriptList:(H.prototype=Object.create(U.prototype)).constructor=H,FeatureList:(q.prototype=Object.create(U.prototype)).constructor=q,LookupList:(X.prototype=Object.create(U.prototype)).constructor=X,ushortList:V,tableList:G,recordList:z};function K(e,t){return e.getUint8(t)}function Z(e,t){return e.getUint16(t,!1)}function Q(e,t){return e.getUint32(t,!1)}function J(e,t){return e.getInt16(t,!1)+e.getUint16(t+2,!1)/65535}var ee={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};function te(e,t){this.data=e,this.offset=t,this.relativeOffset=0}te.prototype.parseByte=function(){var e=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},te.prototype.parseChar=function(){var e=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,e},te.prototype.parseCard8=te.prototype.parseByte,te.prototype.parseCard16=te.prototype.parseUShort=function(){var e=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},te.prototype.parseSID=te.prototype.parseUShort,te.prototype.parseOffset16=te.prototype.parseUShort,te.prototype.parseShort=function(){var e=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,e},te.prototype.parseF2Dot14=function(){var e=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,e},te.prototype.parseOffset32=te.prototype.parseULong=function(){var e=Q(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},te.prototype.parseFixed=function(){var e=J(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,e},te.prototype.parseString=function(e){var t=this.data,r=this.offset+this.relativeOffset,n="";this.relativeOffset+=e;for(var o=0;o<e;o++)n+=String.fromCharCode(t.getUint8(r+o));return n},te.prototype.parseTag=function(){return this.parseString(4)},te.prototype.parseLongDateTime=function(){var e=Q(this.data,this.offset+this.relativeOffset+4);return e-=2082844800,this.relativeOffset+=8,e},te.prototype.parseVersion=function(e){var t=Z(this.data,this.offset+this.relativeOffset),r=Z(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,t+r/(e=void 0===e?4096:e)/10},te.prototype.skip=function(e,t){this.relativeOffset+=ee[e]*(t=void 0===t?1:t)},te.prototype.parseULongList=function(e){void 0===e&&(e=this.parseULong());for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,o=0;o<e;o++)t[o]=r.getUint32(n),n+=4;return this.relativeOffset+=4*e,t},te.prototype.parseOffset16List=te.prototype.parseUShortList=function(e){void 0===e&&(e=this.parseUShort());for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,o=0;o<e;o++)t[o]=r.getUint16(n),n+=2;return this.relativeOffset+=2*e,t},te.prototype.parseShortList=function(e){for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,o=0;o<e;o++)t[o]=r.getInt16(n),n+=2;return this.relativeOffset+=2*e,t},te.prototype.parseByteList=function(e){for(var t=new Array(e),r=this.data,n=this.offset+this.relativeOffset,o=0;o<e;o++)t[o]=r.getUint8(n++);return this.relativeOffset+=e,t},te.prototype.parseList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),n=0;n<e;n++)r[n]=t.call(this);return r},te.prototype.parseList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),n=0;n<e;n++)r[n]=t.call(this);return r},te.prototype.parseRecordList=function(e,t){t||(t=e,e=this.parseUShort());for(var r=new Array(e),n=Object.keys(t),o=0;o<e;o++){for(var s={},a=0;a<n.length;a++){var i=n[a],l=t[i];s[i]=l.call(this)}r[o]=s}return r},te.prototype.parseRecordList32=function(e,t){t||(t=e,e=this.parseULong());for(var r=new Array(e),n=Object.keys(t),o=0;o<e;o++){for(var s={},a=0;a<n.length;a++){var i=n[a],l=t[i];s[i]=l.call(this)}r[o]=s}return r},te.prototype.parseStruct=function(e){if("function"==typeof e)return e.call(this);for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n],s=e[o];r[o]=s.call(this)}return r},te.prototype.parseValueRecord=function(e){var t;if(0!==(e=void 0===e?this.parseUShort():e))return t={},1&e&&(t.xPlacement=this.parseShort()),2&e&&(t.yPlacement=this.parseShort()),4&e&&(t.xAdvance=this.parseShort()),8&e&&(t.yAdvance=this.parseShort()),16&e&&(t.xPlaDevice=void 0,this.parseShort()),32&e&&(t.yPlaDevice=void 0,this.parseShort()),64&e&&(t.xAdvDevice=void 0,this.parseShort()),128&e&&(t.yAdvDevice=void 0,this.parseShort()),t},te.prototype.parseValueRecordList=function(){for(var e=this.parseUShort(),t=this.parseUShort(),r=new Array(t),n=0;n<t;n++)r[n]=this.parseValueRecord(e);return r},te.prototype.parsePointer=function(e){var t=this.parseOffset16();if(0<t)return new te(this.data,this.offset+t).parseStruct(e)},te.prototype.parsePointer32=function(e){var t=this.parseOffset32();if(0<t)return new te(this.data,this.offset+t).parseStruct(e)},te.prototype.parseListOfLists=function(e){for(var t=this.parseOffset16List(),r=t.length,n=this.relativeOffset,o=new Array(r),s=0;s<r;s++){var a=t[s];if(0===a)o[s]=void 0;else if(this.relativeOffset=a,e){for(var i=this.parseOffset16List(),l=new Array(i.length),u=0;u<i.length;u++)this.relativeOffset=a+i[u],l[u]=e.call(this);o[s]=l}else o[s]=this.parseUShortList()}return this.relativeOffset=n,o},te.prototype.parseCoverage=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort(),r=this.parseUShort();if(1===t)return{format:1,glyphs:this.parseUShortList(r)};if(2!==t)throw new Error("0x"+e.toString(16)+": Coverage format must be 1 or 2.");for(var n=new Array(r),o=0;o<r;o++)n[o]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:n}},te.prototype.parseClassDef=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();if(1===t)return{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()};if(2===t)return{format:2,ranges:this.parseRecordList({start:te.uShort,end:te.uShort,classId:te.uShort})};throw new Error("0x"+e.toString(16)+": ClassDef format must be 1 or 2.")},te.list=function(e,t){return function(){return this.parseList(e,t)}},te.list32=function(e,t){return function(){return this.parseList32(e,t)}},te.recordList=function(e,t){return function(){return this.parseRecordList(e,t)}},te.recordList32=function(e,t){return function(){return this.parseRecordList32(e,t)}},te.pointer=function(e){return function(){return this.parsePointer(e)}},te.pointer32=function(e){return function(){return this.parsePointer32(e)}},te.tag=te.prototype.parseTag,te.byte=te.prototype.parseByte,te.uShort=te.offset16=te.prototype.parseUShort,te.uShortList=te.prototype.parseUShortList,te.uLong=te.offset32=te.prototype.parseULong,te.uLongList=te.prototype.parseULongList,te.struct=te.prototype.parseStruct,te.coverage=te.prototype.parseCoverage,te.classDef=te.prototype.parseClassDef;var re={reserved:te.uShort,reqFeatureIndex:te.uShort,featureIndexes:te.uShortList},ne=(te.prototype.parseScriptList=function(){return this.parsePointer(te.recordList({tag:te.tag,script:te.pointer({defaultLangSys:te.pointer(re),langSysRecords:te.recordList({tag:te.tag,langSys:te.pointer(re)})})}))||[]},te.prototype.parseFeatureList=function(){return this.parsePointer(te.recordList({tag:te.tag,feature:te.pointer({featureParams:te.offset16,lookupListIndexes:te.uShortList})}))||[]},te.prototype.parseLookupList=function(e){return this.parsePointer(te.list(te.pointer((function(){var t=this.parseUShort(),r=(A.argument(1<=t&&t<=9,"GPOS/GSUB lookup type "+t+" unknown."),this.parseUShort()),n=16&r;return{lookupType:t,lookupFlag:r,subtables:this.parseList(te.pointer(e[t])),markFilteringSet:n?this.parseUShort():void 0}}))))||[]},te.prototype.parseFeatureVariationsList=function(){return this.parsePointer32((function(){var e=this.parseUShort(),t=this.parseUShort();return A.argument(1===e&&t<1,"GPOS/GSUB feature variations table unknown."),this.parseRecordList32({conditionSetOffset:te.offset32,featureTableSubstitutionOffset:te.offset32})}))||[]},{getByte:K,getCard8:K,getUShort:Z,getCard16:Z,getShort:function(e,t){return e.getInt16(t,!1)},getULong:Q,getFixed:J,getTag:function(e,t){for(var r="",n=t;n<t+4;n+=1)r+=String.fromCharCode(e.getInt8(n));return r},getOffset:function(e,t,r){for(var n=0,o=0;o<r;o+=1)n=(n<<=8)+e.getUint8(t+o);return n},getBytes:function(e,t,r){for(var n=[],o=t;o<r;o+=1)n.push(e.getUint8(o));return n},bytesToString:function(e){for(var t="",r=0;r<e.length;r+=1)t+=String.fromCharCode(e[r]);return t},Parser:te}),oe=function(e,t){for(var r={},n=(r.version=ne.getUShort(e,t),A.argument(0===r.version,"cmap table version should be 0."),r.numTables=ne.getUShort(e,t+2),-1),o=r.numTables-1;0<=o;--o){var s=ne.getUShort(e,t+4+8*o),a=ne.getUShort(e,t+4+8*o+2);if(3===s&&(0===a||1===a||10===a)||0===s&&(0===a||1===a||2===a||3===a||4===a)){n=ne.getULong(e,t+4+8*o+4);break}}if(-1===n)throw new Error("No valid cmap sub-tables found.");var i=new ne.Parser(e,t+n);if(r.format=i.parseUShort(),12===r.format){var l,u=r,c=i;c.parseUShort(),u.length=c.parseULong(),u.language=c.parseULong(),u.groupCount=l=c.parseULong(),u.glyphIndexMap={};for(var d=0;d<l;d+=1)for(var h=c.parseULong(),p=c.parseULong(),f=c.parseULong(),m=h;m<=p;m+=1)u.glyphIndexMap[m]=f,f++}else{if(4!==r.format)throw new Error("Only format 4 and 12 cmap tables are supported (found format "+r.format+").");var y=r,g=e,v=t,b=n;y.length=i.parseUShort(),y.language=i.parseUShort(),y.segCount=x=i.parseUShort()>>1,i.skip("uShort",3),y.glyphIndexMap={};for(var x,w=new ne.Parser(g,v+b+14),_=new ne.Parser(g,v+b+16+2*x),S=new ne.Parser(g,v+b+16+4*x),k=new ne.Parser(g,v+b+16+6*x),T=v+b+16+8*x,E=0;E<x-1;E+=1)for(var j=void 0,C=w.parseUShort(),I=_.parseUShort(),O=S.parseShort(),R=k.parseUShort(),N=I;N<=C;N+=1)0!==R?(T=(T=k.offset+k.relativeOffset-2)+R+2*(N-I),0!==(j=ne.getUShort(g,T))&&(j=j+O&65535)):j=N+O&65535,y.glyphIndexMap[N]=j}return r},se=function(e){for(var t=!0,r=e.length-1;0<r;--r)if(65535<e.get(r).unicode){console.log("Adding CMAP format 12 (needed!)"),t=!1;break}var n,o,s=[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:t?1:2},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:t?12:20}],a=(s=(s=t?s:s.concat([{name:"cmap12PlatformID",type:"USHORT",value:3},{name:"cmap12EncodingID",type:"USHORT",value:10},{name:"cmap12Offset",type:"ULONG",value:0}])).concat([{name:"format",type:"USHORT",value:4},{name:"cmap4Length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),new Y.Table("cmap",s));for(a.segments=[],r=0;r<e.length;r+=1){for(var i=e.get(r),l=0;l<i.unicodes.length;l+=1)n=i.unicodes[l],o=r,a.segments.push({end:n,start:n,delta:-(n-o),offset:0,glyphIndex:o});a.segments=a.segments.sort((function(e,t){return e.start-t.start}))}a.segments.push({end:65535,start:65535,delta:1,offset:0});var u=a.segments.length,c=0,d=[],h=[],p=[],f=[],m=[],y=[];for(r=0;r<u;r+=1){var g=a.segments[r];g.end<=65535&&g.start<=65535?(d=d.concat({name:"end_"+r,type:"USHORT",value:g.end}),h=h.concat({name:"start_"+r,type:"USHORT",value:g.start}),p=p.concat({name:"idDelta_"+r,type:"SHORT",value:g.delta}),f=f.concat({name:"idRangeOffset_"+r,type:"USHORT",value:g.offset}),void 0!==g.glyphId&&(m=m.concat({name:"glyph_"+r,type:"USHORT",value:g.glyphId}))):c+=1,t||void 0===g.glyphIndex||(y=(y=(y=y.concat({name:"cmap12Start_"+r,type:"ULONG",value:g.start})).concat({name:"cmap12End_"+r,type:"ULONG",value:g.end})).concat({name:"cmap12Glyph_"+r,type:"ULONG",value:g.glyphIndex}))}return a.segCountX2=2*(u-c),a.searchRange=2*Math.pow(2,Math.floor(Math.log(u-c)/Math.log(2))),a.entrySelector=Math.log(a.searchRange/2)/Math.log(2),a.rangeShift=a.segCountX2-a.searchRange,a.fields=a.fields.concat(d),a.fields.push({name:"reservedPad",type:"USHORT",value:0}),a.fields=a.fields.concat(h),a.fields=a.fields.concat(p),a.fields=a.fields.concat(f),a.fields=a.fields.concat(m),a.cmap4Length=14+2*d.length+2+2*h.length+2*p.length+2*f.length+2*m.length,t||(s=16+4*y.length,a.cmap12Offset=20+a.cmap4Length,a.fields=a.fields.concat([{name:"cmap12Format",type:"USHORT",value:12},{name:"cmap12Reserved",type:"USHORT",value:0},{name:"cmap12Length",type:"ULONG",value:s},{name:"cmap12Language",type:"ULONG",value:0},{name:"cmap12nGroups",type:"ULONG",value:y.length/3}]),a.fields=a.fields.concat(y)),a},ae=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],ie=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],le=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],ue=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"];function ce(e){this.font=e}function de(e){this.cmap=e}function he(e,t){this.encoding=e,this.charset=t}function pe(e){switch(e.version){case 1:this.names=ue.slice();break;case 2:this.names=new Array(e.numberOfGlyphs);for(var t=0;t<e.numberOfGlyphs;t++)e.glyphNameIndex[t]<ue.length?this.names[t]=ue[e.glyphNameIndex[t]]:this.names[t]=e.names[e.glyphNameIndex[t]-ue.length];break;case 2.5:this.names=new Array(e.numberOfGlyphs);for(var r=0;r<e.numberOfGlyphs;r++)this.names[r]=ue[r+e.glyphNameIndex[r]];break;default:this.names=[]}}ce.prototype.charToGlyphIndex=function(e){var t=e.codePointAt(0),r=this.font.glyphs;if(r)for(var n=0;n<r.length;n+=1)for(var o=r.get(n),s=0;s<o.unicodes.length;s+=1)if(o.unicodes[s]===t)return n;return null},de.prototype.charToGlyphIndex=function(e){return this.cmap.glyphIndexMap[e.codePointAt(0)]||0},he.prototype.charToGlyphIndex=function(e){return e=e.codePointAt(0),e=this.encoding[e],this.charset.indexOf(e)},pe.prototype.nameToGlyphIndex=function(e){return this.names.indexOf(e)},pe.prototype.glyphIndexToName=function(e){return this.names[e]};var fe=function(e,t,r,n,o){e.beginPath(),e.moveTo(t,r),e.lineTo(n,o),e.stroke()};function me(e){this.bindConstructorValues(e)}function ye(e,t,r){Object.defineProperty(e,t,{get:function(){return e.path,e[r]},set:function(t){e[r]=t},enumerable:!0,configurable:!0})}function ge(e,t){if(this.font=e,this.glyphs={},Array.isArray(t))for(var r=0;r<t.length;r++)this.glyphs[r]=t[r];this.length=t&&t.length||0}me.prototype.bindConstructorValues=function(e){var t;this.index=e.index||0,this.name=e.name||null,this.unicode=e.unicode||void 0,this.unicodes=e.unicodes||void 0!==e.unicode?[e.unicode]:[],e.xMin&&(this.xMin=e.xMin),e.yMin&&(this.yMin=e.yMin),e.xMax&&(this.xMax=e.xMax),e.yMax&&(this.yMax=e.yMax),e.advanceWidth&&(this.advanceWidth=e.advanceWidth),Object.defineProperty(this,"path",(e=e.path,t=e||new C,{configurable:!0,get:function(){return t="function"==typeof t?t():t},set:function(e){t=e}}))},me.prototype.addUnicode=function(e){0===this.unicodes.length&&(this.unicode=e),this.unicodes.push(e)},me.prototype.getBoundingBox=function(){return this.path.getBoundingBox()},me.prototype.getPath=function(e,t,r,n,o){e=void 0!==e?e:0,t=void 0!==t?t:0,r=void 0!==r?r:72;for(var s,a,i=(n=n||{}).xScale,l=n.yScale,u=((s=n.hinting&&o&&o.hinting?this.path&&o.hinting.exec(this,r):s)?(a=o.hinting.getCommands(s),e=Math.round(e),t=Math.round(t),i=l=1):(a=this.path.commands,n=1/this.path.unitsPerEm*r,void 0===i&&(i=n),void 0===l&&(l=n)),new C),c=0;c<a.length;c+=1){var d=a[c];"M"===d.type?u.moveTo(e+d.x*i,t+-d.y*l):"L"===d.type?u.lineTo(e+d.x*i,t+-d.y*l):"Q"===d.type?u.quadraticCurveTo(e+d.x1*i,t+-d.y1*l,e+d.x*i,t+-d.y*l):"C"===d.type?u.curveTo(e+d.x1*i,t+-d.y1*l,e+d.x2*i,t+-d.y2*l,e+d.x*i,t+-d.y*l):"Z"===d.type&&u.closePath()}return u},me.prototype.getContours=function(){if(void 0===this.points)return[];for(var e=[],t=[],r=0;r<this.points.length;r+=1){var n=this.points[r];t.push(n),n.lastPointOfContour&&(e.push(t),t=[])}return A.argument(0===t.length,"There are still points left in the current contour."),e},me.prototype.getMetrics=function(){for(var e=this.path.commands,t=[],r=[],n=0;n<e.length;n+=1){var o=e[n];"Z"!==o.type&&(t.push(o.x),r.push(o.y)),"Q"!==o.type&&"C"!==o.type||(t.push(o.x1),r.push(o.y1)),"C"===o.type&&(t.push(o.x2),r.push(o.y2))}var s={xMin:Math.min.apply(null,t),yMin:Math.min.apply(null,r),xMax:Math.max.apply(null,t),yMax:Math.max.apply(null,r),leftSideBearing:this.leftSideBearing};return isFinite(s.xMin)||(s.xMin=0),isFinite(s.xMax)||(s.xMax=this.advanceWidth),isFinite(s.yMin)||(s.yMin=0),isFinite(s.yMax)||(s.yMax=0),s.rightSideBearing=this.advanceWidth-s.leftSideBearing-(s.xMax-s.xMin),s},me.prototype.draw=function(e,t,r,n,o){this.getPath(t,r,n,o).draw(e)},me.prototype.drawPoints=function(e,t,r,n){function o(t,r,n,o){var s=2*Math.PI;e.beginPath();for(var a=0;a<t.length;a+=1)e.moveTo(r+t[a].x*o,n+t[a].y*o),e.arc(r+t[a].x*o,n+t[a].y*o,2,0,s,!1);e.closePath(),e.fill()}t=void 0!==t?t:0,r=void 0!==r?r:0,n=1/this.path.unitsPerEm*(n=void 0!==n?n:24);for(var s=[],a=[],i=this.path,l=0;l<i.commands.length;l+=1){var u=i.commands[l];void 0!==u.x&&s.push({x:u.x,y:-u.y}),void 0!==u.x1&&a.push({x:u.x1,y:-u.y1}),void 0!==u.x2&&a.push({x:u.x2,y:-u.y2})}e.fillStyle="blue",o(s,t,r,n),e.fillStyle="red",o(a,t,r,n)},me.prototype.drawMetrics=function(e,t,r,n){t=void 0!==t?t:0,r=void 0!==r?r:0,n=1/this.path.unitsPerEm*(n=void 0!==n?n:24),e.lineWidth=1,e.strokeStyle="black",fe(e,t,-1e4,t,1e4),fe(e,-1e4,r,1e4,r);var o=this.xMin||0,s=this.yMin||0,a=this.xMax||0,i=this.yMax||0,l=this.advanceWidth||0;e.strokeStyle="blue",fe(e,t+o*n,-1e4,t+o*n,1e4),fe(e,t+a*n,-1e4,t+a*n,1e4),fe(e,-1e4,r+-s*n,1e4,r+-s*n),fe(e,-1e4,r+-i*n,1e4,r+-i*n),e.strokeStyle="green",fe(e,t+l*n,-1e4,t+l*n,1e4)},ge.prototype.get=function(e){return"function"==typeof this.glyphs[e]&&(this.glyphs[e]=this.glyphs[e]()),this.glyphs[e]},ge.prototype.push=function(e,t){this.glyphs[e]=t,this.length++};var ve={GlyphSet:ge,glyphLoader:function(e,t){return new me({index:t,font:e})},ttfGlyphLoader:function(e,t,r,n,o,s){return function(){var a=new me({index:t,font:e});return a.path=function(){r(a,n,o);var t=s(e.glyphs,a);return t.unitsPerEm=e.unitsPerEm,t},ye(a,"xMin","_xMin"),ye(a,"xMax","_xMax"),ye(a,"yMin","_yMin"),ye(a,"yMax","_yMax"),a}},cffGlyphLoader:function(e,t,r,n){return function(){var o=new me({index:t,font:e});return o.path=function(){var t=r(e,o,n);return t.unitsPerEm=e.unitsPerEm,t},o}}};function be(e){return e.length<1240?107:e.length<33900?1131:32768}function xe(e,t,r){var n,o=[],s=[],a=ne.getCard16(e,t);if(0!==a){for(var i=ne.getByte(e,t+2),l=t+(a+1)*i+2,u=t+3,c=0;c<a+1;c+=1)o.push(ne.getOffset(e,u,i)),u+=i;n=l+o[a]}else n=t+2;for(var d=0;d<o.length-1;d+=1){var h=ne.getBytes(e,l+o[d],l+o[d+1]);r&&(h=r(h)),s.push(h)}return{objects:s,startOffset:t,endOffset:n}}function we(e,t){if(28===t)return e.parseByte()<<8|e.parseByte();if(29===t)return e.parseByte()<<24|e.parseByte()<<16|e.parseByte()<<8|e.parseByte();if(30===t){for(var r=e,n="",o=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var s=(a=r.parseByte())>>4,a=15&a;if(15==s)break;if(n+=o[s],15==a)break;n+=o[a]}return parseFloat(n)}if(32<=t&&t<=246)return t-139;if(247<=t&&t<=250)return 256*(t-247)+e.parseByte()+108;if(251<=t&&t<=254)return 256*-(t-251)-e.parseByte()-108;throw new Error("Invalid b0 "+t)}function _e(e,t,r){var n=new ne.Parser(e,t=void 0!==t?t:0),o=[],s=[];for(r=void 0!==r?r:e.length;n.relativeOffset<r;){var a=n.parseByte();a<=21?(12===a&&(a=1200+n.parseByte()),o.push([a,s]),s=[]):s.push(we(n,a))}for(var i=o,l={},u=0;u<i.length;u+=1){var c=i[u][0],d=i[u][1],h=1===d.length?d[0]:d;if(l.hasOwnProperty(c)&&!isNaN(l[c]))throw new Error("Object "+l+" already has key "+c);l[c]=h}return l}function Se(e,t){return t<=390?ae[t]:e[t-391]}function ke(e,t,r){for(var n,o={},s=0;s<t.length;s+=1){var a=t[s];if(Array.isArray(a.type)){var i=[];i.length=a.type.length;for(var l=0;l<a.type.length;l++)void 0===(n=void 0!==e[a.op]?e[a.op][l]:void 0)&&(n=void 0!==a.value&&void 0!==a.value[l]?a.value[l]:null),"SID"===a.type[l]&&(n=Se(r,n)),i[l]=n;o[a.name]=i}else void 0===(n=e[a.op])&&(n=void 0!==a.value?a.value:null),"SID"===a.type&&(n=Se(r,n)),o[a.name]=n}return o}var Te=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]},{name:"ros",op:1230,type:["SID","SID","number"]},{name:"cidFontVersion",op:1231,type:"number",value:0},{name:"cidFontRevision",op:1232,type:"number",value:0},{name:"cidFontType",op:1233,type:"number",value:0},{name:"cidCount",op:1234,type:"number",value:8720},{name:"uidBase",op:1235,type:"number"},{name:"fdArray",op:1236,type:"offset"},{name:"fdSelect",op:1237,type:"offset"},{name:"fontName",op:1238,type:"SID"}],Ee=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];function je(e,t,r,n){return ke(_e(e,t,r),Ee,n)}function Ce(e,t,r,n){for(var o=[],s=0;s<r.length;s+=1){var a,i=((i=n,a=ke(_e(a=new DataView(new Uint8Array(r[s]).buffer),0,a.byteLength),Te,i))._subrs=[],a._subrsBias=0,a.private[0]),l=a.private[1];0!==i&&0!==l&&(i=je(e,l+t,i,n),a._defaultWidthX=i.defaultWidthX,a._nominalWidthX=i.nominalWidthX,0!==i.subrs&&(l=xe(e,l+i.subrs+t),a._subrs=l.objects,a._subrsBias=be(a._subrs)),a._privateDict=i),o.push(a)}return o}function Ie(e,t,r){var n,o,s,a,i,l,u,c,d,h=new C,p=[],f=0,m=!1,y=!1,g=0,v=0,b=(d=(e.isCIDFont?(i=e.tables.cff.topDict._fdSelect[t.index],i=e.tables.cff.topDict._fdArray[i],l=i._subrs,u=i._subrsBias,c=i._defaultWidthX,i):(l=e.tables.cff.topDict._subrs,u=e.tables.cff.topDict._subrsBias,c=e.tables.cff.topDict._defaultWidthX,e.tables.cff.topDict))._nominalWidthX,c);function x(e,t){y&&h.closePath(),h.moveTo(e,t),y=!0}function w(){p.length%2==0||m||(b=p.shift()+d),f+=p.length>>1,p.length=0,m=!0}return function r(i){for(var c,_,S,k,T,E,j,C,I,O,A,R,N=0;N<i.length;){var M=i[N];switch(N+=1,M){case 1:case 3:case 18:case 23:w();break;case 4:1<p.length&&!m&&(b=p.shift()+d,m=!0),v+=p.pop(),x(g,v);break;case 5:for(;0<p.length;)g+=p.shift(),v+=p.shift(),h.lineTo(g,v);break;case 6:for(;0<p.length&&(g+=p.shift(),h.lineTo(g,v),0!==p.length);)v+=p.shift(),h.lineTo(g,v);break;case 7:for(;0<p.length&&(v+=p.shift(),h.lineTo(g,v),0!==p.length);)g+=p.shift(),h.lineTo(g,v);break;case 8:for(;0<p.length;)n=g+p.shift(),o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),g=s+p.shift(),v=a+p.shift(),h.curveTo(n,o,s,a,g,v);break;case 10:T=p.pop()+u,(E=l[T])&&r(E);break;case 11:return;case 12:switch(M=i[N],N+=1,M){case 35:n=g+p.shift(),o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),j=s+p.shift(),C=a+p.shift(),I=j+p.shift(),O=C+p.shift(),A=I+p.shift(),R=O+p.shift(),g=A+p.shift(),v=R+p.shift(),p.shift(),h.curveTo(n,o,s,a,j,C),h.curveTo(I,O,A,R,g,v);break;case 34:n=g+p.shift(),o=v,s=n+p.shift(),a=o+p.shift(),j=s+p.shift(),C=a,I=j+p.shift(),O=a,A=I+p.shift(),R=v,g=A+p.shift(),h.curveTo(n,o,s,a,j,C),h.curveTo(I,O,A,R,g,v);break;case 36:n=g+p.shift(),o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),j=s+p.shift(),C=a,I=j+p.shift(),O=a,A=I+p.shift(),R=O+p.shift(),g=A+p.shift(),h.curveTo(n,o,s,a,j,C),h.curveTo(I,O,A,R,g,v);break;case 37:n=g+p.shift(),o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),j=s+p.shift(),C=a+p.shift(),I=j+p.shift(),O=C+p.shift(),A=I+p.shift(),R=O+p.shift(),Math.abs(A-g)>Math.abs(R-v)?g=A+p.shift():v=R+p.shift(),h.curveTo(n,o,s,a,j,C),h.curveTo(I,O,A,R,g,v);break;default:console.log("Glyph "+t.index+": unknown operator 1200"+M),p.length=0}break;case 14:0<p.length&&!m&&(b=p.shift()+d,m=!0),y&&(h.closePath(),y=!1);break;case 19:case 20:w(),N+=f+7>>3;break;case 21:2<p.length&&!m&&(b=p.shift()+d,m=!0),v+=p.pop(),x(g+=p.pop(),v);break;case 22:1<p.length&&!m&&(b=p.shift()+d,m=!0),x(g+=p.pop(),v);break;case 24:for(;2<p.length;)n=g+p.shift(),o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),g=s+p.shift(),v=a+p.shift(),h.curveTo(n,o,s,a,g,v);g+=p.shift(),v+=p.shift(),h.lineTo(g,v);break;case 25:for(;6<p.length;)g+=p.shift(),v+=p.shift(),h.lineTo(g,v);n=g+p.shift(),o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),g=s+p.shift(),v=a+p.shift(),h.curveTo(n,o,s,a,g,v);break;case 26:for(p.length%2&&(g+=p.shift());0<p.length;)n=g,o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),g=s,v=a+p.shift(),h.curveTo(n,o,s,a,g,v);break;case 27:for(p.length%2&&(v+=p.shift());0<p.length;)n=g+p.shift(),o=v,s=n+p.shift(),a=o+p.shift(),g=s+p.shift(),v=a,h.curveTo(n,o,s,a,g,v);break;case 28:c=i[N],_=i[N+1],p.push((c<<24|_<<16)>>16),N+=2;break;case 29:T=p.pop()+e.gsubrsBias,(E=e.gsubrs[T])&&r(E);break;case 30:for(;0<p.length&&(n=g,o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),g=s+p.shift(),v=a+(1===p.length?p.shift():0),h.curveTo(n,o,s,a,g,v),0!==p.length);)n=g+p.shift(),o=v,s=n+p.shift(),a=o+p.shift(),v=a+p.shift(),g=s+(1===p.length?p.shift():0),h.curveTo(n,o,s,a,g,v);break;case 31:for(;0<p.length&&(n=g+p.shift(),o=v,s=n+p.shift(),a=o+p.shift(),v=a+p.shift(),g=s+(1===p.length?p.shift():0),h.curveTo(n,o,s,a,g,v),0!==p.length);)n=g,o=v+p.shift(),s=n+p.shift(),a=o+p.shift(),g=s+p.shift(),v=a+(1===p.length?p.shift():0),h.curveTo(n,o,s,a,g,v);break;default:M<32?console.log("Glyph "+t.index+": unknown operator "+M):M<247?p.push(M-139):M<251?(c=i[N],N+=1,p.push(256*(M-247)+c+108)):M<255?(c=i[N],N+=1,p.push(256*-(M-251)-c-108)):(c=i[N],_=i[N+1],S=i[N+2],k=i[N+3],N+=4,p.push((c<<24|_<<16|S<<8|k)/65536))}}}(r),t.advanceWidth=b,h}function Oe(e,t){var r,n=ae.indexOf(e);return 0<=n&&(r=n),0<=(n=t.indexOf(e))?r=n+ae.length:(r=ae.length+t.length,t.push(e)),r}function Ae(e,t,r){for(var n={},o=0;o<e.length;o+=1){var s=e[o],a=t[s.name];void 0===a||function e(t,r){if(t===r)return 1;if(Array.isArray(t)&&Array.isArray(r)&&t.length===r.length){for(var n=0;n<t.length;n+=1)if(!e(t[n],r[n]))return;return 1}}(a,s.value)||("SID"===s.type&&(a=Oe(a,r)),n[s.op]={name:s.name,type:s.type,value:a})}return n}function Re(e,t){var r=new Y.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return r.dict=Ae(Te,e,t),r}function Ne(e){var t=new Y.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return t.topDicts=[{name:"topDict_0",type:"TABLE",value:e}],t}var Me=function(e,t,r){r.tables.cff={},n=e,o=t,(s={}).formatMajor=ne.getCard8(n,o),s.formatMinor=ne.getCard8(n,o+1),s.size=ne.getCard8(n,o+2),s.offsetSize=ne.getCard8(n,o+3),s.startOffset=o,s.endOffset=o+4;var n=xe(e,s.endOffset,ne.bytesToString),o=xe(e,n.endOffset),s=xe(e,o.endOffset,ne.bytesToString);if(n=xe(e,s.endOffset),r.gsubrs=n.objects,r.gsubrsBias=be(r.gsubrs),1!==(n=Ce(e,t,o.objects,s.objects)).length)throw new Error("CFF table has too many fonts in 'FontSet' - count of fonts NameIndex.length = "+n.length);if(o=n[0],(r.tables.cff.topDict=o)._privateDict&&(r.defaultWidthX=o._privateDict.defaultWidthX,r.nominalWidthX=o._privateDict.nominalWidthX),void 0!==o.ros[0]&&void 0!==o.ros[1]&&(r.isCIDFont=!0),r.isCIDFont){n=o.fdArray;var a=o.fdSelect;if(0===n||0===a)throw new Error("Font is marked as a CID font, but FDArray and/or FDSelect information is missing");n=Ce(e,t,xe(e,n+=t).objects,s.objects),o._fdArray=n,o._fdSelect=function(e,t,r,n){var o,s=[],a=new ne.Parser(e,t);if(0===(e=a.parseCard8()))for(var i=0;i<r;i++){if(n<=(o=a.parseCard8()))throw new Error("CFF table CID Font FDSelect has bad FD index value "+o+" (FD count "+n+")");s.push(o)}else{if(3!==e)throw new Error("CFF Table CID Font FDSelect table has unsupported format "+e);var l,u=a.parseCard16(),c=a.parseCard16();if(0!==c)throw new Error("CFF Table CID Font FDSelect format 3 range has bad initial GID "+c);for(var d=0;d<u;d++){if(o=a.parseCard8(),l=a.parseCard16(),n<=o)throw new Error("CFF table CID Font FDSelect has bad FD index value "+o+" (FD count "+n+")");if(r<l)throw new Error("CFF Table CID Font FDSelect format 3 range has bad GID "+l);for(;c<l;c++)s.push(o);c=l}if(l!==r)throw new Error("CFF Table CID Font FDSelect format 3 range has bad final GID "+l)}return s}(e,a+=t,r.numGlyphs,n.length)}n=je(e,a=t+o.private[1],o.private[0],s.objects);var i=(r.defaultWidthX=n.defaultWidthX,r.nominalWidthX=n.nominalWidthX,0!==n.subrs?(a=xe(e,a+n.subrs),r.subrs=a.objects,r.subrsBias=be(r.subrs)):(r.subrs=[],r.subrsBias=0),xe(e,t+o.charStrings));r.nGlyphs=i.objects.length,n=function(e,t,r,n){var o=new ne.Parser(e,t),s=(--r,[".notdef"]);if(0===(e=o.parseCard8()))for(var a=0;a<r;a+=1)i=o.parseSID(),s.push(Se(n,i));else if(1===e)for(;s.length<=r;)for(var i=o.parseSID(),l=o.parseCard8(),u=0;u<=l;u+=1)s.push(Se(n,i)),i+=1;else{if(2!==e)throw new Error("Unknown charset format "+e);for(;s.length<=r;){i=o.parseSID(),l=o.parseCard16();for(var c=0;c<=l;c+=1)s.push(Se(n,i)),i+=1}}return s}(e,t+o.charset,r.nGlyphs,s.objects),0===o.encoding?r.cffEncoding=new he(ie,n):1===o.encoding?r.cffEncoding=new he(le,n):r.cffEncoding=function(e,t,r){var n={},o=new ne.Parser(e,t);if(0===(e=o.parseCard8()))for(var s=o.parseCard8(),a=0;a<s;a+=1)n[l=o.parseCard8()]=a;else{if(1!==e)throw new Error("Unknown encoding format "+e);for(var i=o.parseCard8(),l=1,u=0;u<i;u+=1)for(var c=o.parseCard8(),d=o.parseCard8(),h=c;h<=c+d;h+=1)n[h]=l,l+=1}return new he(n,r)}(e,t+o.encoding,n),r.encoding=r.encoding||r.cffEncoding,r.glyphs=new ve.GlyphSet(r);for(var l=0;l<r.nGlyphs;l+=1){var u=i.objects[l];r.glyphs.push(l,ve.cffGlyphLoader(r,l,Ie,u))}},Pe=function(e,t){for(var r,n=new Y.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),o=1/t.unitsPerEm,s=(o={version:t.version,fullName:t.fullName,familyName:t.familyName,weight:t.weightName,fontBBox:t.fontBBox||[0,0,0,0],fontMatrix:[o,0,0,o,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},[]),a=1;a<e.length;a+=1)r=e.get(a),s.push(r.name);var i,l,u=[],c=(n.header=new Y.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),n.nameIndex=function(e){var t=new Y.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);t.names=[];for(var r=0;r<e.length;r+=1)t.names.push({name:"name_"+r,type:"NAME",value:e[r]});return t}([t.postScriptName]),t=Re(o,u),n.topDictIndex=Ne(t),n.globalSubrIndex=new Y.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),n.charsets=function(e,t){for(var r=new Y.Record("Charsets",[{name:"format",type:"Card8",value:0}]),n=0;n<e.length;n+=1){var o=Oe(e[n],t);r.fields.push({name:"glyph_"+n,type:"SID",value:o})}return r}(s,u),n.charStringsIndex=function(e){for(var t=new Y.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),r=0;r<e.length;r+=1){var n=e.get(r),o=function(e){for(var t=[],r=e.path,n=(t.push({name:"width",type:"NUMBER",value:e.advanceWidth}),0),o=0,s=0;s<r.commands.length;s+=1){var a,i,l,u,c=void 0,d=void 0,h=r.commands[s];"M"===(h="Q"===h.type?{type:"C",x:h.x,y:h.y,x1:1/3*n+2/3*h.x1,y1:1/3*o+2/3*h.y1,x2:1/3*h.x+2/3*h.x1,y2:1/3*h.y+2/3*h.y1}:h).type?(c=Math.round(h.x-n),d=Math.round(h.y-o),t.push({name:"dx",type:"NUMBER",value:c}),t.push({name:"dy",type:"NUMBER",value:d}),t.push({name:"rmoveto",type:"OP",value:21}),n=Math.round(h.x),o=Math.round(h.y)):"L"===h.type?(c=Math.round(h.x-n),d=Math.round(h.y-o),t.push({name:"dx",type:"NUMBER",value:c}),t.push({name:"dy",type:"NUMBER",value:d}),t.push({name:"rlineto",type:"OP",value:5}),n=Math.round(h.x),o=Math.round(h.y)):"C"===h.type&&(a=Math.round(h.x1-n),i=Math.round(h.y1-o),l=Math.round(h.x2-h.x1),u=Math.round(h.y2-h.y1),c=Math.round(h.x-h.x2),d=Math.round(h.y-h.y2),t.push({name:"dx1",type:"NUMBER",value:a}),t.push({name:"dy1",type:"NUMBER",value:i}),t.push({name:"dx2",type:"NUMBER",value:l}),t.push({name:"dy2",type:"NUMBER",value:u}),t.push({name:"dx",type:"NUMBER",value:c}),t.push({name:"dy",type:"NUMBER",value:d}),t.push({name:"rrcurveto",type:"OP",value:8}),n=Math.round(h.x),o=Math.round(h.y))}return t.push({name:"endchar",type:"OP",value:14}),t}(n);t.charStrings.push({name:n.name,type:"CHARSTRING",value:o})}return t}(e),n.privateDict=(c={},i=u,(l=new Y.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=Ae(Ee,c,i),l),n.stringIndex=function(e){var t=new Y.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);t.strings=[];for(var r=0;r<e.length;r+=1)t.strings.push({name:"string_"+r,type:"STRING",value:e[r]});return t}(u),n.header.sizeOf()+n.nameIndex.sizeOf()+n.topDictIndex.sizeOf()+n.stringIndex.sizeOf()+n.globalSubrIndex.sizeOf());return o.charset=c,o.encoding=0,o.charStrings=o.charset+n.charsets.sizeOf(),o.private[1]=o.charStrings+n.charStringsIndex.sizeOf(),t=Re(o,u),n.topDictIndex=Ne(t),n},Le=function(e,t){var r={};return e=new ne.Parser(e,t),r.version=e.parseVersion(),r.fontRevision=Math.round(1e3*e.parseFixed())/1e3,r.checkSumAdjustment=e.parseULong(),r.magicNumber=e.parseULong(),A.argument(1594834165===r.magicNumber,"Font header has wrong magic number."),r.flags=e.parseUShort(),r.unitsPerEm=e.parseUShort(),r.created=e.parseLongDateTime(),r.modified=e.parseLongDateTime(),r.xMin=e.parseShort(),r.yMin=e.parseShort(),r.xMax=e.parseShort(),r.yMax=e.parseShort(),r.macStyle=e.parseUShort(),r.lowestRecPPEM=e.parseUShort(),r.fontDirectionHint=e.parseShort(),r.indexToLocFormat=e.parseShort(),r.glyphDataFormat=e.parseShort(),r},De=function(e){var t=Math.round((new Date).getTime()/1e3)+2082844800,r=t;return e.createdTimestamp&&(r=e.createdTimestamp+2082844800),new Y.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:r},{name:"modified",type:"LONGDATETIME",value:t},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],e)},Fe=function(e,t){var r={};return e=new ne.Parser(e,t),r.version=e.parseVersion(),r.ascender=e.parseShort(),r.descender=e.parseShort(),r.lineGap=e.parseShort(),r.advanceWidthMax=e.parseUShort(),r.minLeftSideBearing=e.parseShort(),r.minRightSideBearing=e.parseShort(),r.xMaxExtent=e.parseShort(),r.caretSlopeRise=e.parseShort(),r.caretSlopeRun=e.parseShort(),r.caretOffset=e.parseShort(),e.relativeOffset+=8,r.metricDataFormat=e.parseShort(),r.numberOfHMetrics=e.parseUShort(),r},$e=function(e){return new Y.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],e)},Be=function(e){for(var t=new Y.Table("hmtx",[]),r=0;r<e.length;r+=1){var n=(o=e.get(r)).advanceWidth||0,o=o.leftSideBearing||0;t.fields.push({name:"advanceWidth_"+r,type:"USHORT",value:n}),t.fields.push({name:"leftSideBearing_"+r,type:"SHORT",value:o})}return t},Ue=function(e){for(var t=new Y.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:e.length}]),r="",n=12+4*e.length,o=0;o<e.length;++o){var s=r.indexOf(e[o]);s<0&&(s=r.length,r+=e[o]),t.fields.push({name:"offset "+o,type:"USHORT",value:n+s}),t.fields.push({name:"length "+o,type:"USHORT",value:e[o].length})}return t.fields.push({name:"stringPool",type:"CHARARRAY",value:r}),t},Ve=function(e,t){for(var r=new ne.Parser(e,t),n=r.parseULong(),o=(A.argument(1===n,"Unsupported ltag table version."),r.skip("uLong",1),r.parseULong()),s=[],a=0;a<o;a++){for(var i="",l=t+r.parseUShort(),u=r.parseUShort(),c=l;c<l+u;++c)i+=String.fromCharCode(e.getInt8(c));s.push(i)}return s},Ge=function(e,t){var r={};return e=new ne.Parser(e,t),r.version=e.parseVersion(),r.numGlyphs=e.parseUShort(),1===r.version&&(r.maxPoints=e.parseUShort(),r.maxContours=e.parseUShort(),r.maxCompositePoints=e.parseUShort(),r.maxCompositeContours=e.parseUShort(),r.maxZones=e.parseUShort(),r.maxTwilightPoints=e.parseUShort(),r.maxStorage=e.parseUShort(),r.maxFunctionDefs=e.parseUShort(),r.maxInstructionDefs=e.parseUShort(),r.maxStackElements=e.parseUShort(),r.maxSizeOfInstructions=e.parseUShort(),r.maxComponentElements=e.parseUShort(),r.maxComponentDepth=e.parseUShort()),r},ze=function(e){return new Y.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:e}])},We=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],He={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},qe={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},Xe={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},Ye="utf-16",Ke={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},Ze={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};function Qe(e,t,r){switch(e){case 0:return Ye;case 1:return Ze[r]||Ke[t];case 3:if(1===t||10===t)return Ye}}function Je(e){var t,r={};for(t in e)r[e[t]]=parseInt(t);return r}function et(e,t,r,n,o,s){return new Y.Record("NameRecord",[{name:"platformID",type:"USHORT",value:e},{name:"encodingID",type:"USHORT",value:t},{name:"languageID",type:"USHORT",value:r},{name:"nameID",type:"USHORT",value:n},{name:"length",type:"USHORT",value:o},{name:"offset",type:"USHORT",value:s}])}function tt(e,t){if((r=function(e,t){var r=e.length,n=t.length-r+1;e:for(var o=0;o<n;o++)for(;o<n;o++){for(var s=0;s<r;s++)if(t[o+s]!==e[s])continue e;return o}return-1}(e,t))<0)for(var r=t.length,n=0,o=e.length;n<o;++n)t.push(e[n]);return r}var rt=function(e,t,r){for(var n={},o=new ne.Parser(e,t),s=(t=o.parseUShort(),o.parseUShort()),a=o.offset+o.parseUShort(),i=0;i<s;i++){var l=o.parseUShort(),u=o.parseUShort(),c=o.parseUShort(),d=o.parseUShort(),h=(d=We[d]||d,o.parseUShort()),p=o.parseUShort(),f=function(e,t,r){switch(e){case 0:if(65535===t)return"und";if(r)return r[t];break;case 1:return He[t];case 3:return Xe[t]}}(l,c,r);void 0!==(l=Qe(l,u,c))&&void 0!==f&&(u=void 0,(u=l===Ye?R.UTF16(e,a+p,h):R.MACSTRING(e,a+p,h,l))&&((c=void 0===(c=n[d])?n[d]={}:c)[f]=u))}return 1===t&&o.parseUShort(),n},nt=function(e,t){var r,n=[],o={},s=Je(We);for(r in e){var a=s[r];if(void 0===a&&(a=r),h=parseInt(a),isNaN(h))throw new Error('Name table entry "'+r+'" does not exist, see nameTableNames for complete list.');o[h]=e[r],n.push(h)}for(var i=Je(He),l=Je(Xe),u=[],c=[],d=0;d<n.length;d++){var h,p,f=o[h=n[d]];for(p in f){var m=f[p],y=1,g=i[p],v=qe[g],b=Qe(y,v,g),x=(void 0===(b=N.MACSTRING(m,b))&&(y=0,(g=t.indexOf(p))<0&&(g=t.length,t.push(p)),v=4,b=N.UTF16(m)),tt(b,c));void 0!==(u.push(et(y,v,g,h,b.length,x)),y=l[p])&&(g=tt(v=N.UTF16(m),c),u.push(et(3,1,y,h,v.length,g)))}}u.sort((function(e,t){return e.platformID-t.platformID||e.encodingID-t.encodingID||e.languageID-t.languageID||e.nameID-t.nameID}));for(var w=new Y.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:u.length},{name:"stringOffset",type:"USHORT",value:6+12*u.length}]),_=0;_<u.length;_++)w.fields.push({name:"record_"+_,type:"RECORD",value:u[_]});return w.fields.push({name:"strings",type:"LITERAL",value:c}),w},ot=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}],st=function(e,t){var r={},n=new ne.Parser(e,t);r.version=n.parseUShort(),r.xAvgCharWidth=n.parseShort(),r.usWeightClass=n.parseUShort(),r.usWidthClass=n.parseUShort(),r.fsType=n.parseUShort(),r.ySubscriptXSize=n.parseShort(),r.ySubscriptYSize=n.parseShort(),r.ySubscriptXOffset=n.parseShort(),r.ySubscriptYOffset=n.parseShort(),r.ySuperscriptXSize=n.parseShort(),r.ySuperscriptYSize=n.parseShort(),r.ySuperscriptXOffset=n.parseShort(),r.ySuperscriptYOffset=n.parseShort(),r.yStrikeoutSize=n.parseShort(),r.yStrikeoutPosition=n.parseShort(),r.sFamilyClass=n.parseShort(),r.panose=[];for(var o=0;o<10;o++)r.panose[o]=n.parseByte();return r.ulUnicodeRange1=n.parseULong(),r.ulUnicodeRange2=n.parseULong(),r.ulUnicodeRange3=n.parseULong(),r.ulUnicodeRange4=n.parseULong(),r.achVendID=String.fromCharCode(n.parseByte(),n.parseByte(),n.parseByte(),n.parseByte()),r.fsSelection=n.parseUShort(),r.usFirstCharIndex=n.parseUShort(),r.usLastCharIndex=n.parseUShort(),r.sTypoAscender=n.parseShort(),r.sTypoDescender=n.parseShort(),r.sTypoLineGap=n.parseShort(),r.usWinAscent=n.parseUShort(),r.usWinDescent=n.parseUShort(),1<=r.version&&(r.ulCodePageRange1=n.parseULong(),r.ulCodePageRange2=n.parseULong()),2<=r.version&&(r.sxHeight=n.parseShort(),r.sCapHeight=n.parseShort(),r.usDefaultChar=n.parseUShort(),r.usBreakChar=n.parseUShort(),r.usMaxContent=n.parseUShort()),r},at=function(e){return new Y.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],e)},it=function(e){for(var t=0;t<ot.length;t+=1){var r=ot[t];if(e>=r.begin&&e<r.end)return t}return-1},lt=function(e,t){var r={},n=new ne.Parser(e,t);switch(r.version=n.parseVersion(),r.italicAngle=n.parseFixed(),r.underlinePosition=n.parseShort(),r.underlineThickness=n.parseShort(),r.isFixedPitch=n.parseULong(),r.minMemType42=n.parseULong(),r.maxMemType42=n.parseULong(),r.minMemType1=n.parseULong(),r.maxMemType1=n.parseULong(),r.version){case 1:r.names=ue.slice();break;case 2:r.numberOfGlyphs=n.parseUShort(),r.glyphNameIndex=new Array(r.numberOfGlyphs);for(var o=0;o<r.numberOfGlyphs;o++)r.glyphNameIndex[o]=n.parseUShort();r.names=[];for(var s,a=0;a<r.numberOfGlyphs;a++)r.glyphNameIndex[a]>=ue.length&&(s=n.parseChar(),r.names.push(n.parseString(s)));break;case 2.5:r.numberOfGlyphs=n.parseUShort(),r.offset=new Array(r.numberOfGlyphs);for(var i=0;i<r.numberOfGlyphs;i++)r.offset[i]=n.parseChar()}return r},ut=function(){return new Y.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])},ct=new Array(9),dt=(ct[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(te.coverage),deltaGlyphId:this.parseUShort()}:2===t?{substFormat:2,coverage:this.parsePointer(te.coverage),substitute:this.parseOffset16List()}:void A.assert(!1,"0x"+e.toString(16)+": lookup type 1 format must be 1 or 2.")},ct[2]=function(){var e=this.parseUShort();return A.argument(1===e,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(te.coverage),sequences:this.parseListOfLists()}},ct[3]=function(){var e=this.parseUShort();return A.argument(1===e,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(te.coverage),alternateSets:this.parseListOfLists()}},ct[4]=function(){var e=this.parseUShort();return A.argument(1===e,"GSUB ligature table identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(te.coverage),ligatureSets:this.parseListOfLists((function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}}))}},{sequenceIndex:te.uShort,lookupListIndex:te.uShort});ct[5]=function(){var e,t,r=this.offset+this.relativeOffset,n=this.parseUShort();return 1===n?{substFormat:n,coverage:this.parsePointer(te.coverage),ruleSets:this.parseListOfLists((function(){var e=this.parseUShort(),t=this.parseUShort();return{input:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,dt)}}))}:2===n?{substFormat:n,coverage:this.parsePointer(te.coverage),classDef:this.parsePointer(te.classDef),classSets:this.parseListOfLists((function(){var e=this.parseUShort(),t=this.parseUShort();return{classes:this.parseUShortList(e-1),lookupRecords:this.parseRecordList(t,dt)}}))}:3===n?(e=this.parseUShort(),t=this.parseUShort(),{substFormat:n,coverages:this.parseList(e,te.pointer(te.coverage)),lookupRecords:this.parseRecordList(t,dt)}):void A.assert(!1,"0x"+r.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},ct[6]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{substFormat:1,coverage:this.parsePointer(te.coverage),chainRuleSets:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(dt)}}))}:2===t?{substFormat:2,coverage:this.parsePointer(te.coverage),backtrackClassDef:this.parsePointer(te.classDef),inputClassDef:this.parsePointer(te.classDef),lookaheadClassDef:this.parsePointer(te.classDef),chainClassSet:this.parseListOfLists((function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(dt)}}))}:3===t?{substFormat:3,backtrackCoverage:this.parseList(te.pointer(te.coverage)),inputCoverage:this.parseList(te.pointer(te.coverage)),lookaheadCoverage:this.parseList(te.pointer(te.coverage)),lookupRecords:this.parseRecordList(dt)}:void A.assert(!1,"0x"+e.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},ct[7]=function(){var e=this.parseUShort(),t=(A.argument(1===e,"GSUB Extension Substitution subtable identifier-format must be 1"),e=this.parseUShort(),new te(this.data,this.offset+this.parseULong()));return{substFormat:1,lookupType:e,extension:ct[e].call(t)}},ct[8]=function(){var e=this.parseUShort();return A.argument(1===e,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:e,coverage:this.parsePointer(te.coverage),backtrackCoverage:this.parseList(te.pointer(te.coverage)),lookaheadCoverage:this.parseList(te.pointer(te.coverage)),substitutes:this.parseUShortList()}};var ht=new Array(9);ht[1]=function(e){return 1===e.substFormat?new Y.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Y.Coverage(e.coverage)},{name:"deltaGlyphID",type:"USHORT",value:e.deltaGlyphId}]):new Y.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new Y.Coverage(e.coverage)}].concat(Y.ushortList("substitute",e.substitute)))},ht[3]=function(e){return A.assert(1===e.substFormat,"Lookup type 3 substFormat must be 1."),new Y.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Y.Coverage(e.coverage)}].concat(Y.tableList("altSet",e.alternateSets,(function(e){return new Y.Table("alternateSetTable",Y.ushortList("alternate",e))}))))},ht[4]=function(e){return A.assert(1===e.substFormat,"Lookup type 4 substFormat must be 1."),new Y.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new Y.Coverage(e.coverage)}].concat(Y.tableList("ligSet",e.ligatureSets,(function(e){return new Y.Table("ligatureSetTable",Y.tableList("ligature",e,(function(e){return new Y.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:e.ligGlyph}].concat(Y.ushortList("component",e.components,e.components.length+1)))})))}))))};var pt=function(e,t){return t=(e=new te(e,t=t||0)).parseVersion(1),A.argument(1===t||1.1===t,"Unsupported GSUB table version."),1===t?{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(ct)}:{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(ct),variations:e.parseFeatureVariationsList()}},ft=function(e){return new Y.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new Y.ScriptList(e.scripts)},{name:"features",type:"TABLE",value:new Y.FeatureList(e.features)},{name:"lookups",type:"TABLE",value:new Y.LookupList(e.lookups,ht)}])},mt=function(e,t){for(var r=new ne.Parser(e,t),n=r.parseULong(),o=(A.argument(1===n,"Unsupported META table version."),r.parseULong(),r.parseULong(),r.parseULong()),s={},a=0;a<o;a++){var i=r.parseTag(),l=r.parseULong(),u=r.parseULong();l=R.UTF8(e,t+l,u),s[i]=l}return s},yt=function(e){var t,r=Object.keys(e).length,n="",o=16+12*r,s=new Y.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:o},{name:"numTags",type:"ULONG",value:r}]);for(t in e){var a=n.length;n+=e[t],s.fields.push({name:"tag "+t,type:"TAG",value:t}),s.fields.push({name:"offset "+t,type:"ULONG",value:o+a}),s.fields.push({name:"length "+t,type:"ULONG",value:e[t].length})}return s.fields.push({name:"stringPool",type:"CHARARRAY",value:n}),s};function gt(e){return Math.log(e)/Math.log(2)|0}function vt(e){for(;e.length%4!=0;)e.push(0);for(var t=0,r=0;r<e.length;r+=4)t+=(e[r]<<24)+(e[r+1]<<16)+(e[r+2]<<8)+e[r+3];return t%Math.pow(2,32)}function bt(e,t,r,n){return new Y.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==e?e:""},{name:"checkSum",type:"ULONG",value:void 0!==t?t:0},{name:"offset",type:"ULONG",value:void 0!==r?r:0},{name:"length",type:"ULONG",value:void 0!==n?n:0}])}function xt(e){for(var t=new Y.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]),r=(t.tables=e,t.numTables=e.length,Math.pow(2,gt(t.numTables))),n=(t.searchRange=16*r,t.entrySelector=gt(r),t.rangeShift=16*t.numTables-t.searchRange,[]),o=[],s=t.sizeOf()+bt().sizeOf()*t.numTables;s%4!=0;)s+=1,o.push({name:"padding",type:"BYTE",value:0});for(var a=0;a<e.length;a+=1){var i=e[a],l=(A.argument(4===i.tableName.length,"Table name"+i.tableName+" is invalid."),i.sizeOf()),u=bt(i.tableName,vt(i.encode()),s,l);for(n.push({name:u.tag+" Table Record",type:"RECORD",value:u}),o.push({name:i.tableName+" table",type:"RECORD",value:i}),s+=l,A.argument(!isNaN(s),"Something went wrong calculating the offset.");s%4!=0;)s+=1,o.push({name:"padding",type:"BYTE",value:0})}return n.sort((function(e,t){return e.value.tag>t.value.tag?1:-1})),t.fields=t.fields.concat(n),t.fields=t.fields.concat(o),t}function wt(e,t,r){for(var n=0;n<t.length;n+=1){var o=e.charToGlyphIndex(t[n]);if(0<o)return e.glyphs.get(o).getMetrics()}return r}function _t(e,t){for(var r=0,n=e.length-1;r<=n;){var o=r+n>>>1,s=e[o].tag;if(s===t)return o;s<t?r=1+o:n=o-1}return-r-1}function St(e,t){for(var r=0,n=e.length-1;r<=n;){var o=r+n>>>1,s=e[o];if(s===t)return o;s<t?r=1+o:n=o-1}return-r-1}function kt(e,t){for(var r=0,n=e.length-1;r<=n;){var o,s=r+n>>>1,a=(o=e[s]).start;if(a===t)return o;a<t?r=1+s:n=s-1}if(0<r)return t>(o=e[r-1]).end?0:o}function Tt(e,t){this.font=e,this.tableName=t}function Et(e){Tt.call(this,e,"gpos")}function jt(e){Tt.call(this,e,"gsub")}function Ct(e,t,r){for(var n=e.subtables,o=0;o<n.length;o++){var s=n[o];if(s.substFormat===t)return s}if(r)return n.push(r),r}function It(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;++n)r[n]=e[n];return t}function Ot(e,t){if(!e)throw t}function At(e,t,r,n,o){var s=0<(t&n)?(s=e.parseByte(),r+(s=0==(t&o)?-s:s)):0<(t&o)?r:r+e.parseShort();return s}function Rt(e,t,r){var n,o=new ne.Parser(t,r);if(e.numberOfContours=o.parseShort(),e._xMin=o.parseShort(),e._yMin=o.parseShort(),e._xMax=o.parseShort(),e._yMax=o.parseShort(),0<e.numberOfContours){for(var s=e.endPointIndices=[],a=0;a<e.numberOfContours;a+=1)s.push(o.parseUShort());e.instructionLength=o.parseUShort(),e.instructions=[];for(var i=0;i<e.instructionLength;i+=1)e.instructions.push(o.parseByte());for(var l=s[s.length-1]+1,u=[],c=0;c<l;c+=1)if(n=o.parseByte(),u.push(n),0<(8&n))for(var d=o.parseByte(),h=0;h<d;h+=1)u.push(n),c+=1;if(A.argument(u.length===l,"Bad flags."),0<s.length){var p,f=[];if(0<l){for(var m=0;m<l;m+=1)n=u[m],(p={}).onCurve=!!(1&n),p.lastPointOfContour=0<=s.indexOf(m),f.push(p);for(var y=0,g=0;g<l;g+=1)n=u[g],(p=f[g]).x=At(o,n,y,2,16),y=p.x;for(var v=0,b=0;b<l;b+=1)n=u[b],(p=f[b]).y=At(o,n,v,4,32),v=p.y}e.points=f}else e.points=[]}else if(0===e.numberOfContours)e.points=[];else{e.isComposite=!0,e.points=[],e.components=[];for(var x=!0;x;){u=o.parseUShort();var w={glyphIndex:o.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};0<(1&u)?0<(2&u)?(w.dx=o.parseShort(),w.dy=o.parseShort()):w.matchedPoints=[o.parseUShort(),o.parseUShort()]:0<(2&u)?(w.dx=o.parseChar(),w.dy=o.parseChar()):w.matchedPoints=[o.parseByte(),o.parseByte()],0<(8&u)?w.xScale=w.yScale=o.parseF2Dot14():0<(64&u)?(w.xScale=o.parseF2Dot14(),w.yScale=o.parseF2Dot14()):0<(128&u)&&(w.xScale=o.parseF2Dot14(),w.scale01=o.parseF2Dot14(),w.scale10=o.parseF2Dot14(),w.yScale=o.parseF2Dot14()),e.components.push(w),x=!!(32&u)}if(256&u){e.instructionLength=o.parseUShort(),e.instructions=[];for(var _=0;_<e.instructionLength;_+=1)e.instructions.push(o.parseByte())}}}function Nt(e,t){for(var r=[],n=0;n<e.length;n+=1){var o=e[n];o={x:t.xScale*o.x+t.scale01*o.y+t.dx,y:t.scale10*o.x+t.yScale*o.y+t.dy,onCurve:o.onCurve,lastPointOfContour:o.lastPointOfContour},r.push(o)}return r}function Mt(e){var t=new C;if(e)for(var r=function(e){for(var t=[],r=[],n=0;n<e.length;n+=1){var o=e[n];r.push(o),o.lastPointOfContour&&(t.push(r),r=[])}return A.argument(0===r.length,"There are still points left in the current contour."),t}(e),n=0;n<r.length;++n){var o,s=r[n],a=s[s.length-1],i=s[0];a.onCurve?t.moveTo(a.x,a.y):i.onCurve?t.moveTo(i.x,i.y):(o={x:.5*(a.x+i.x),y:.5*(a.y+i.y)},t.moveTo(o.x,o.y));for(var l=0;l<s.length;++l){var u,c=a;a=i,i=s[(l+1)%s.length],a.onCurve?t.lineTo(a.x,a.y):(u=i,c.onCurve||(a.x,c.x,a.y,c.y),i.onCurve||(u={x:.5*(a.x+i.x),y:.5*(a.y+i.y)}),t.quadraticCurveTo(a.x,a.y,u.x,u.y))}t.closePath()}return t}function Pt(e,t){if(t.isComposite)for(var r=0;r<t.components.length;r+=1){var n=t.components[r],o=e.get(n.glyphIndex);if(o.getPath(),o.points){var s=void 0;if(void 0===n.matchedPoints)s=Nt(o.points,n);else{if(n.matchedPoints[0]>t.points.length-1||n.matchedPoints[1]>o.points.length-1)throw Error("Matched points out of range in "+t.name);var a=t.points[n.matchedPoints[0]],i=Nt([i=o.points[n.matchedPoints[1]]],n={xScale:n.xScale,scale01:n.scale01,scale10:n.scale10,yScale:n.yScale,dx:0,dy:0})[0];n.dx=a.x-i.x,n.dy=a.y-i.y,s=Nt(o.points,n)}t.points=t.points.concat(s)}}return Mt(t.points)}(Et.prototype=Tt.prototype={searchTag:_t,binSearch:St,getTable:function(e){var t=this.font.tables[this.tableName];return!t&&e?this.font.tables[this.tableName]=this.createDefaultTable():t},getScriptNames:function(){var e=this.getTable();return e?e.scripts.map((function(e){return e.tag})):[]},getDefaultScriptName:function(){var e=this.getTable();if(e){for(var t=!1,r=0;r<e.scripts.length;r++){var n=e.scripts[r].tag;if("DFLT"===n)return n;"latn"===n&&(t=!0)}return t?"latn":void 0}},getScriptTable:function(e,t){var r,n=this.getTable(t);if(n)return r=n.scripts,0<=(n=_t(n.scripts,e=e||"DFLT"))?r[n].script:t?(r.splice(-1-n,0,t={tag:e,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}),t.script):void 0},getLangSysTable:function(e,t,r){var n;if(e=this.getScriptTable(e,r))return t&&"dflt"!==t&&"DFLT"!==t?0<=(n=_t(e.langSysRecords,t))?e.langSysRecords[n].langSys:r?(e.langSysRecords.splice(-1-n,0,r={tag:t,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}}),r.langSys):void 0:e.defaultLangSys},getFeatureTable:function(e,t,r,n){if(e=this.getLangSysTable(e,t,n)){for(var o,s=e.featureIndexes,a=this.font.tables[this.tableName].features,i=0;i<s.length;i++)if((o=a[s[i]]).tag===r)return o.feature;if(n)return t=a.length,A.assert(0===t||r>=a[t-1].tag,"Features must be added in alphabetical order."),a.push(o={tag:r,feature:{params:0,lookupListIndexes:[]}}),s.push(t),o.feature}},getLookupTables:function(e,t,r,n,o){var s=[];if(e=this.getFeatureTable(e,t,r,o)){for(var a,i=e.lookupListIndexes,l=this.font.tables[this.tableName].lookups,u=0;u<i.length;u++)(a=l[i[u]]).lookupType===n&&s.push(a);if(0===s.length&&o)return t=l.length,l.push(a={lookupType:n,lookupFlag:0,subtables:[],markFilteringSet:void 0}),i.push(t),[a]}return s},getGlyphClass:function(e,t){switch(e.format){case 1:return e.startGlyph<=t&&t<e.startGlyph+e.classes.length?e.classes[t-e.startGlyph]:0;case 2:var r=kt(e.ranges,t);return r?r.classId:0}},getCoverageIndex:function(e,t){switch(e.format){case 1:var r=St(e.glyphs,t);return 0<=r?r:-1;case 2:return(r=kt(e.ranges,t))?r.index+t-r.start:-1}},expandCoverage:function(e){if(1===e.format)return e.glyphs;for(var t=[],r=e.ranges,n=0;n<r.length;n++)for(var o=r[n],s=o.start,a=o.end,i=s;i<=a;i++)t.push(i);return t}}).init=function(){var e=this.getDefaultScriptName();this.defaultKerningTables=this.getKerningTables(e)},Et.prototype.getKerningValue=function(e,t,r){for(var n=0;n<e.length;n++)for(var o=e[n].subtables,s=0;s<o.length;s++){var a=o[s],i=this.getCoverageIndex(a.coverage,t);if(!(i<0))switch(a.posFormat){case 1:for(var l=a.pairSets[i],u=0;u<l.length;u++){var c=l[u];if(c.secondGlyph===r)return c.value1&&c.value1.xAdvance||0}break;case 2:var d=this.getGlyphClass(a.classDef1,t),h=this.getGlyphClass(a.classDef2,r);return(d=a.classRecords[d][h]).value1&&d.value1.xAdvance||0}}return 0},Et.prototype.getKerningTables=function(e,t){if(this.font.tables.gpos)return this.getLookupTables(e,t,"kern",2)},(jt.prototype=Tt.prototype).createDefaultTable=function(){return{version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}},jt.prototype.getSingle=function(e,t,r){for(var n=[],o=this.getLookupTables(t,r,e,1),s=0;s<o.length;s++)for(var a=o[s].subtables,i=0;i<a.length;i++){var l=a[i],u=this.expandCoverage(l.coverage),c=void 0;if(1===l.substFormat){var d=l.deltaGlyphId;for(c=0;c<u.length;c++){var h=u[c];n.push({sub:h,by:h+d})}}else{var p=l.substitute;for(c=0;c<u.length;c++)n.push({sub:u[c],by:p[c]})}}return n},jt.prototype.getAlternates=function(e,t,r){for(var n=[],o=this.getLookupTables(t,r,e,3),s=0;s<o.length;s++)for(var a=o[s].subtables,i=0;i<a.length;i++)for(var l=a[i],u=this.expandCoverage(l.coverage),c=l.alternateSets,d=0;d<u.length;d++)n.push({sub:u[d],by:c[d]});return n},jt.prototype.getLigatures=function(e,t,r){for(var n=[],o=this.getLookupTables(t,r,e,4),s=0;s<o.length;s++)for(var a=o[s].subtables,i=0;i<a.length;i++)for(var l=a[i],u=this.expandCoverage(l.coverage),c=l.ligatureSets,d=0;d<u.length;d++)for(var h=u[d],p=c[d],f=0;f<p.length;f++){var m=p[f];n.push({sub:[h].concat(m.components),by:m.ligGlyph})}return n},jt.prototype.addSingle=function(e,t,r,n){r=Ct(this.getLookupTables(r,n,e,1,!0)[0],2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]}),A.assert(1===r.coverage.format,"Ligature: unable to modify coverage table format "+r.coverage.format),n=t.sub,(e=this.binSearch(r.coverage.glyphs,n))<0&&(r.coverage.glyphs.splice(e=-1-e,0,n),r.substitute.splice(e,0,0)),r.substitute[e]=t.by},jt.prototype.addAlternate=function(e,t,r,n){r=Ct(this.getLookupTables(r,n,e,3,!0)[0],1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]}),A.assert(1===r.coverage.format,"Ligature: unable to modify coverage table format "+r.coverage.format),n=t.sub,(e=this.binSearch(r.coverage.glyphs,n))<0&&(r.coverage.glyphs.splice(e=-1-e,0,n),r.alternateSets.splice(e,0,0)),r.alternateSets[e]=t.by},jt.prototype.addLigature=function(e,t,r,n){(n=(r=this.getLookupTables(r,n,e,4,!0)[0]).subtables[0])||(r.subtables[0]=n={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),A.assert(1===n.coverage.format,"Ligature: unable to modify coverage table format "+n.coverage.format),e=t.sub[0];var o=t.sub.slice(1);if(r={ligGlyph:t.by,components:o},0<=(t=this.binSearch(n.coverage.glyphs,e))){for(var s=n.ligatureSets[t],a=0;a<s.length;a++)if(function(e,t){var r=e.length;if(r===t.length){for(var n=0;n<r;n++)if(e[n]!==t[n])return;return 1}}(s[a].components,o))return;s.push(r)}else n.coverage.glyphs.splice(t=-1-t,0,e),n.ligatureSets.splice(t,0,[r])},jt.prototype.getFeature=function(e,t,r){if(/ss\d\d/.test(e))return this.getSingle(e,t,r);switch(e){case"aalt":case"salt":return this.getSingle(e,t,r).concat(this.getAlternates(e,t,r));case"dlig":case"liga":case"rlig":return this.getLigatures(e,t,r)}},jt.prototype.add=function(e,t,r,n){if(/ss\d\d/.test(e))return this.addSingle(e,t,r,n);switch(e){case"aalt":case"salt":return"number"==typeof t.by?this.addSingle(e,t,r,n):this.addAlternate(e,t,r,n);case"dlig":case"liga":case"rlig":return this.addLigature(e,t,r,n)}};var Lt={getPath:Mt,parse:function(e,t,r,n){for(var o=new ve.GlyphSet(n),s=0;s<r.length-1;s+=1){var a=r[s];a!==r[s+1]?o.push(s,ve.ttfGlyphLoader(n,s,Rt,e,t+a,Pt)):o.push(s,ve.glyphLoader(n,s))}return o}};function Dt(e){this.font=e,this.getCommands=function(e){return Lt.getPath(e).commands},this._fpgmState=this._prepState=void 0,this._errorState=0}function Ft(e){return e}function $t(e){return Math.sign(e)*Math.round(Math.abs(e))}function Bt(e){return Math.sign(e)*Math.round(Math.abs(2*e))/2}function Ut(e){return Math.sign(e)*(Math.round(Math.abs(e)+.5)-.5)}function Vt(e){return Math.sign(e)*Math.ceil(Math.abs(e))}function Gt(e){return Math.sign(e)*Math.floor(Math.abs(e))}function zt(e){var t=this.srPeriod,r=this.srPhase,n=1;return e<0&&(e=-e,n=-1),e+=this.srThreshold-r,e=Math.trunc(e/t)*t,(e+=r)<0?r*n:e*n}var Wt={x:1,y:0,axis:"x",distance:function(e,t,r,n){return(r?e.xo:e.x)-(n?t.xo:t.x)},interpolate:function(e,t,r,n){var o,s,a,i,l,u,c;if(!n||n===this)return o=e.xo-t.xo,s=e.xo-r.xo,l=t.x-t.xo,u=r.x-r.xo,0===(c=(a=Math.abs(o))+(i=Math.abs(s)))?void(e.x=e.xo+(l+u)/2):void(e.x=e.xo+(l*i+u*a)/c);o=n.distance(e,t,!0,!0),s=n.distance(e,r,!0,!0),l=n.distance(t,t,!1,!0),u=n.distance(r,r,!1,!0),0===(c=(a=Math.abs(o))+(i=Math.abs(s)))?Wt.setRelative(e,e,(l+u)/2,n,!0):Wt.setRelative(e,e,(l*i+u*a)/c,n,!0)},normalSlope:Number.NEGATIVE_INFINITY,setRelative:function(e,t,r,n,o){var s,a;n&&n!==this?(s=o?t.xo:t.x,a=o?t.yo:t.y,s+=r*n.x,a+=r*n.y,e.x=s+(e.y-a)/n.normalSlope):e.x=(o?t.xo:t.x)+r},slope:0,touch:function(e){e.xTouched=!0},touched:function(e){return e.xTouched},untouch:function(e){e.xTouched=!1}},Ht={x:0,y:1,axis:"y",distance:function(e,t,r,n){return(r?e.yo:e.y)-(n?t.yo:t.y)},interpolate:function(e,t,r,n){var o,s,a,i,l,u,c;if(!n||n===this)return o=e.yo-t.yo,s=e.yo-r.yo,l=t.y-t.yo,u=r.y-r.yo,0===(c=(a=Math.abs(o))+(i=Math.abs(s)))?void(e.y=e.yo+(l+u)/2):void(e.y=e.yo+(l*i+u*a)/c);o=n.distance(e,t,!0,!0),s=n.distance(e,r,!0,!0),l=n.distance(t,t,!1,!0),u=n.distance(r,r,!1,!0),0===(c=(a=Math.abs(o))+(i=Math.abs(s)))?Ht.setRelative(e,e,(l+u)/2,n,!0):Ht.setRelative(e,e,(l*i+u*a)/c,n,!0)},normalSlope:0,setRelative:function(e,t,r,n,o){var s,a;n&&n!==this?(s=o?t.xo:t.x,a=o?t.yo:t.y,s+=r*n.x,a+=r*n.y,e.y=a+n.normalSlope*(e.x-s)):e.y=(o?t.yo:t.y)+r},slope:Number.POSITIVE_INFINITY,touch:function(e){e.yTouched=!0},touched:function(e){return e.yTouched},untouch:function(e){e.yTouched=!1}};function qt(e,t){this.x=e,this.y=t,this.axis=void 0,this.slope=t/e,this.normalSlope=-e/t,Object.freeze(this)}function Xt(e,t){var r=Math.sqrt(e*e+t*t);return t/=r,1==(e/=r)&&0===t?Wt:0===e&&1===t?Ht:new qt(e,t)}function Yt(e,t,r,n){this.x=this.xo=Math.round(64*e)/64,this.y=this.yo=Math.round(64*t)/64,this.lastPointOfContour=r,this.onCurve=n,this.prevPointOnContour=void 0,this.nextPointOnContour=void 0,this.xTouched=!1,this.yTouched=!1,Object.preventExtensions(this)}Object.freeze(Wt),Object.freeze(Ht),qt.prototype.distance=function(e,t,r,n){return this.x*Wt.distance(e,t,r,n)+this.y*Ht.distance(e,t,r,n)},qt.prototype.interpolate=function(e,t,r,n){var o=n.distance(e,t,!0,!0),s=n.distance(e,r,!0,!0),a=(t=n.distance(t,t,!1,!0),r=n.distance(r,r,!1,!0),(o=Math.abs(o))+(s=Math.abs(s)));0===a?this.setRelative(e,e,(t+r)/2,n,!0):this.setRelative(e,e,(t*s+r*o)/a,n,!0)},qt.prototype.setRelative=function(e,t,r,n,o){var s=o?t.xo:t.x,a=(o=o?t.yo:t.y,t=s+r*(n=n||this).x,s=o+r*n.y,o=n.normalSlope,r=this.slope,n=e.x,e.y);e.x=(r*n-o*t+s-a)/(r-o),e.y=r*(e.x-n)+a},qt.prototype.touch=function(e){e.xTouched=!0,e.yTouched=!0},Yt.prototype.nextTouched=function(e){for(var t=this.nextPointOnContour;!e.touched(t)&&t!==this;)t=t.nextPointOnContour;return t},Yt.prototype.prevTouched=function(e){for(var t=this.prevPointOnContour;!e.touched(t)&&t!==this;)t=t.prevPointOnContour;return t};var Kt=Object.freeze(new Yt(0,0)),Zt={cvCutIn:17/16,deltaBase:9,deltaShift:.125,loop:1,minDis:1,autoFlip:!0};function Qt(e,t){switch(this.env=e,this.stack=[],this.prog=t,e){case"glyf":this.zp0=this.zp1=this.zp2=1,this.rp0=this.rp1=this.rp2=0;case"prep":this.fv=this.pv=this.dpv=Wt,this.round=$t}}function Jt(e){for(var t=e.tZone=new Array(e.gZone.length),r=0;r<t.length;r++)t[r]=new Yt(0,0)}function er(e,t){var r,n=e.prog,o=e.ip,s=1;do{if(88===(r=n[++o]))s++;else if(89===r)s--;else if(64===r)o+=n[o+1]+1;else if(65===r)o+=2*n[o+1]+1;else if(176<=r&&r<=183)o+=r-176+1;else if(184<=r&&r<=191)o+=2*(r-184+1);else if(t&&1===s&&27===r)break}while(0<s);e.ip=o}function tr(e,r){t.DEBUG&&console.log(r.step,"SVTCA["+e.axis+"]"),r.fv=r.pv=r.dpv=e}function rr(e,r){t.DEBUG&&console.log(r.step,"SPVTCA["+e.axis+"]"),r.pv=r.dpv=e}function nr(e,r){t.DEBUG&&console.log(r.step,"SFVTCA["+e.axis+"]"),r.fv=e}function or(e,r){var n,o=(s=r.stack).pop(),s=s.pop(),a=r.z2[o],i=r.z1[s];t.DEBUG&&console.log("SPVTL["+e+"]",o,s),o=e?(n=a.y-i.y,i.x-a.x):(n=i.x-a.x,i.y-a.y),r.pv=r.dpv=Xt(n,o)}function sr(e,r){var n,o=(s=r.stack).pop(),s=s.pop(),a=r.z2[o],i=r.z1[s];t.DEBUG&&console.log("SFVTL["+e+"]",o,s),o=e?(n=a.y-i.y,i.x-a.x):(n=i.x-a.x,i.y-a.y),r.fv=Xt(n,o)}function ar(e){t.DEBUG&&console.log(e.step,"POP[]"),e.stack.pop()}function ir(e,r){var n=r.stack.pop(),o=r.z0[n],s=r.fv,a=r.pv,i=(t.DEBUG&&console.log(r.step,"MDAP["+e+"]",n),a.distance(o,Kt));e&&(i=r.round(i)),s.setRelative(o,Kt,i,a),s.touch(o),r.rp0=r.rp1=n}function lr(e,r){var n,o,s,a=r.z2,i=a.length-2;t.DEBUG&&console.log(r.step,"IUP["+e.axis+"]");for(var l=0;l<i;l++)n=a[l],e.touched(n)||(o=n.prevTouched(e))!==n&&(o===(s=n.nextTouched(e))&&e.setRelative(n,n,e.distance(o,o,!1,!0),e,!0),e.interpolate(n,o,s,e))}function ur(e,r){for(var n=r.stack,o=e?r.rp1:r.rp2,s=(e?r.z0:r.z1)[o],a=r.fv,i=r.pv,l=r.loop,u=r.z2;l--;){var c=n.pop(),d=u[c],h=i.distance(s,s,!1,!0);a.setRelative(d,d,h,i),a.touch(d),t.DEBUG&&console.log(r.step,(1<r.loop?"loop "+(r.loop-l)+": ":"")+"SHP["+(e?"rp1":"rp2")+"]",c)}r.loop=1}function cr(e,r){for(var n=r.stack,o=e?r.rp1:r.rp2,s=(e?r.z0:r.z1)[o],a=r.fv,i=r.pv,l=(o=n.pop(),r.z2[r.contours[o]]),u=l,c=(t.DEBUG&&console.log(r.step,"SHC["+e+"]",o),i.distance(s,s,!1,!0));u!==s&&a.setRelative(u,u,c,i),(u=u.nextPointOnContour)!==l;);}function dr(e,r){var n,o,s=r.stack,a=e?r.rp1:r.rp2,i=(a=(e?r.z0:r.z1)[a],r.fv),l=r.pv;switch(s=s.pop(),t.DEBUG&&console.log(r.step,"SHZ["+e+"]",s),s){case 0:n=r.tZone;break;case 1:n=r.gZone;break;default:throw new Error("Invalid zone")}for(var u=l.distance(a,a,!1,!0),c=n.length-2,d=0;d<c;d++)o=n[d],i.setRelative(o,o,u,l)}function hr(e,r){var n=(o=r.stack).pop()/64,o=o.pop(),s=r.z1[o],a=r.z0[r.rp0],i=r.fv,l=r.pv;i.setRelative(s,a,n,l),i.touch(s),t.DEBUG&&console.log(r.step,"MSIRP["+e+"]",n,o),r.rp1=r.rp0,r.rp2=o,e&&(r.rp0=o)}function pr(e,r){var n=(o=r.stack).pop(),o=o.pop(),s=r.z0[o],a=r.fv,i=r.pv,l=r.cvt[n];t.DEBUG&&console.log(r.step,"MIAP["+e+"]",n,"(",l,")",o),n=i.distance(s,Kt),e&&(Math.abs(n-l)<r.cvCutIn&&(n=l),n=r.round(n)),a.setRelative(s,Kt,n,i),0===r.zp0&&(s.xo=s.x,s.yo=s.y),a.touch(s),r.rp0=r.rp1=o}function fr(e,r){var n=r.stack,o=n.pop(),s=r.z2[o];t.DEBUG&&console.log(r.step,"GC["+e+"]",o),n.push(64*r.dpv.distance(s,Kt,e,!1))}function mr(e,r){var n=(o=r.stack).pop(),o=o.pop(),s=r.z1[n],a=r.z0[o];a=r.dpv.distance(a,s,e,e),t.DEBUG&&console.log(r.step,"MD["+e+"]",n,o,"->",a),r.stack.push(Math.round(64*a))}function yr(e,r){var n=r.stack,o=n.pop(),s=r.fv,a=r.pv,i=r.ppem,l=r.deltaBase+16*(e-1),u=r.deltaShift,c=r.z0;t.DEBUG&&console.log(r.step,"DELTAP["+e+"]",o,n);for(var d=0;d<o;d++){var h=n.pop(),p=n.pop();l+((240&p)>>4)===i&&(0<=(p=(15&p)-8)&&p++,t.DEBUG&&console.log(r.step,"DELTAPFIX",h,"by",p*u),h=c[h],s.setRelative(h,h,p*u,a))}}function gr(e,r){var n=r.stack,o=n.pop();t.DEBUG&&console.log(r.step,"ROUND[]"),n.push(64*r.round(o/64))}function vr(e,r){var n=r.stack,o=n.pop(),s=r.ppem,a=r.deltaBase+16*(e-1),i=r.deltaShift;t.DEBUG&&console.log(r.step,"DELTAC["+e+"]",o,n);for(var l=0;l<o;l++){var u=n.pop(),c=n.pop();a+((240&c)>>4)===s&&(0<=(c=(15&c)-8)&&c++,c*=i,t.DEBUG&&console.log(r.step,"DELTACFIX",u,"by",c),r.cvt[u]+=c)}}function br(e,r){var n,o=(s=r.stack).pop(),s=s.pop(),a=r.z2[o],i=r.z1[s];t.DEBUG&&console.log(r.step,"SDPVTL["+e+"]",o,s),o=e?(n=a.y-i.y,i.x-a.x):(n=i.x-a.x,i.y-a.y),r.dpv=Xt(n,o)}function xr(e,r){var n=r.stack,o=r.prog,s=r.ip;t.DEBUG&&console.log(r.step,"PUSHB["+e+"]");for(var a=0;a<e;a++)n.push(o[++s]);r.ip=s}function wr(e,r){var n=r.ip,o=r.prog,s=r.stack;t.DEBUG&&console.log(r.ip,"PUSHW["+e+"]");for(var a=0;a<e;a++){var i=o[++n]<<8|o[++n];32768&i&&(i=-(1+(65535^i))),s.push(i)}r.ip=n}function _r(e,r,n,o,s,a){var i,l,u=a.stack,c=e&&u.pop(),d=(u=u.pop(),a.rp0),h=(d=a.z0[d],a.z1[u]),p=a.minDis,f=a.fv,m=a.dpv,y=i=m.distance(h,d,!0,!0),g=0<=y?1:-1;y=Math.abs(y),e&&(l=a.cvt[c],o&&Math.abs(y-l)<a.cvCutIn&&(y=l)),n&&y<p&&(y=p),o&&(y=a.round(y)),f.setRelative(h,d,g*y,m),f.touch(h),t.DEBUG&&console.log(a.step,(e?"MIRP[":"MDRP[")+(r?"M":"m")+(n?">":"_")+(o?"R":"_")+(0===s?"Gr":1===s?"Bl":2===s?"Wh":"")+"]",e?c+"("+a.cvt[c]+","+l+")":"",u,"(d =",i,"->",g*y,")"),a.rp1=a.rp0,a.rp2=u,r&&(a.rp0=u)}Dt.prototype.exec=function(e,r){if("number"!=typeof r)throw new Error("Point size is not a number!");if(!(2<this._errorState)){var n=this.font,o=this._prepState;if(!o||o.ppem!==r){var s=this._fpgmState;if(!s){Qt.prototype=Zt,(s=this._fpgmState=new Qt("fpgm",n.tables.fpgm)).funcs=[],s.font=n,t.DEBUG&&(console.log("---EXEC FPGM---"),s.step=-1);try{Tr(s)}catch(e){return console.log("Hinting error in FPGM:"+e),void(this._errorState=3)}}Qt.prototype=s,(o=this._prepState=new Qt("prep",n.tables.prep)).ppem=r;var a=n.tables.cvt;if(a)for(var i=o.cvt=new Array(a.length),l=r/n.unitsPerEm,u=0;u<a.length;u++)i[u]=a[u]*l;else o.cvt=[];t.DEBUG&&(console.log("---EXEC PREP---"),o.step=-1);try{Tr(o)}catch(e){this._errorState<2&&console.log("Hinting error in PREP:"+e),this._errorState=2}}if(!(1<this._errorState))try{return Sr(e,o)}catch(e){this._errorState<1&&(console.log("Hinting error:"+e),console.log("Note: further hinting errors are silenced")),this._errorState=1}}};var Sr=function(e,r){var n=r.ppem/r.font.unitsPerEm,o=n,s=e.components;if(Qt.prototype=r,s){for(var a=r.font,i=[],l=[],u=0;u<s.length;u++){var c=s[u],d=a.glyphs.get(c.glyphIndex),h=new Qt("glyf",d.instructions);t.DEBUG&&(console.log("---EXEC COMP "+u+"---"),h.step=-1),kr(d,h,n,o);for(var p=Math.round(c.dx*n),f=Math.round(c.dy*o),m=h.gZone,y=h.contours,g=0;g<m.length;g++){var v=m[g];v.xTouched=v.yTouched=!1,v.xo=v.x=v.x+p,v.yo=v.y=v.y+f}var b=i.length;i.push.apply(i,m);for(var x=0;x<y.length;x++)l.push(y[x]+b)}e.instructions&&!h.inhibitGridFit&&((h=new Qt("glyf",e.instructions)).gZone=h.z0=h.z1=h.z2=i,h.contours=l,i.push(new Yt(0,0),new Yt(Math.round(e.advanceWidth*n),0)),t.DEBUG&&(console.log("---EXEC COMPOSITE---"),h.step=-1),Tr(h),i.length-=2)}else h=new Qt("glyf",e.instructions),t.DEBUG&&(console.log("---EXEC GLYPH---"),h.step=-1),kr(e,h,n,o),i=h.gZone;return i},kr=function(e,r,n,o){for(var s,a,i,l=e.points||[],u=l.length,c=r.gZone=r.z0=r.z1=r.z2=[],d=r.contours=[],h=0;h<u;h++)s=l[h],c[h]=new Yt(s.x*n,s.y*o,s.lastPointOfContour,s.onCurve);for(var p=0;p<u;p++)s=c[p],a||(a=s,d.push(p)),s.lastPointOfContour?((s.nextPointOnContour=a).prevPointOnContour=s,a=void 0):(i=c[p+1],(s.nextPointOnContour=i).prevPointOnContour=s);if(!r.inhibitGridFit){if(t.DEBUG){console.log("PROCESSING GLYPH",r.stack);for(var f=0;f<u;f++)console.log(f,c[f].x,c[f].y)}if(c.push(new Yt(0,0),new Yt(Math.round(e.advanceWidth*n),0)),Tr(r),c.length-=2,t.DEBUG){console.log("FINISHED GLYPH",r.stack);for(var m=0;m<u;m++)console.log(m,c[m].x,c[m].y)}}},Tr=function(e){var r=e.prog;if(r){var n,o=r.length;for(e.ip=0;e.ip<o;e.ip++){if(t.DEBUG&&e.step++,!(n=Er[r[e.ip]]))throw new Error("unknown instruction: 0x"+Number(r[e.ip]).toString(16));n(e)}}},Er=[tr.bind(void 0,Ht),tr.bind(void 0,Wt),rr.bind(void 0,Ht),rr.bind(void 0,Wt),nr.bind(void 0,Ht),nr.bind(void 0,Wt),or.bind(void 0,0),or.bind(void 0,1),sr.bind(void 0,0),sr.bind(void 0,1),function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG&&console.log(e.step,"SPVFS[]",r,n),e.pv=e.dpv=Xt(n,r)},function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG&&console.log(e.step,"SPVFS[]",r,n),e.fv=Xt(n,r)},function(e){var r=e.stack,n=e.pv;t.DEBUG&&console.log(e.step,"GPV[]"),r.push(16384*n.x),r.push(16384*n.y)},function(e){var r=e.stack,n=e.fv;t.DEBUG&&console.log(e.step,"GFV[]"),r.push(16384*n.x),r.push(16384*n.y)},function(e){e.fv=e.pv,t.DEBUG&&console.log(e.step,"SFVTPV[]")},function(e){var r=(a=e.stack).pop(),n=a.pop(),o=a.pop(),s=a.pop(),a=a.pop(),i=e.z0,l=e.z1,u=i[r],c=(i=i[n],l[o]),d=(l=l[s],e=e.z2[a],t.DEBUG&&console.log("ISECT[], ",r,n,o,s,a),r=u.x,n=u.y,o=i.x,s=i.y,a=c.x,u=c.y,i=l.x,l=(r-o)*(u-(c=l.y))-(n-s)*(a-i),r*s-n*o),h=a*c-u*i;e.x=(d*(a-i)-h*(r-o))/l,e.y=(d*(u-c)-h*(n-s))/l},function(e){e.rp0=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP0[]",e.rp0)},function(e){e.rp1=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP1[]",e.rp1)},function(e){e.rp2=e.stack.pop(),t.DEBUG&&console.log(e.step,"SRP2[]",e.rp2)},function(e){var r=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP0[]",r),e.zp0=r){case 0:e.tZone||Jt(e),e.z0=e.tZone;break;case 1:e.z0=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var r=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP1[]",r),e.zp1=r){case 0:e.tZone||Jt(e),e.z1=e.tZone;break;case 1:e.z1=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var r=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZP2[]",r),e.zp2=r){case 0:e.tZone||Jt(e),e.z2=e.tZone;break;case 1:e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){var r=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SZPS[]",r),e.zp0=e.zp1=e.zp2=r){case 0:e.tZone||Jt(e),e.z0=e.z1=e.z2=e.tZone;break;case 1:e.z0=e.z1=e.z2=e.gZone;break;default:throw new Error("Invalid zone pointer")}},function(e){e.loop=e.stack.pop(),t.DEBUG&&console.log(e.step,"SLOOP[]",e.loop)},function(e){t.DEBUG&&console.log(e.step,"RTG[]"),e.round=$t},function(e){t.DEBUG&&console.log(e.step,"RTHG[]"),e.round=Ut},function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"SMD[]",r),e.minDis=r/64},function(e){t.DEBUG&&console.log(e.step,"ELSE[]"),er(e,!1)},function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"JMPR[]",r),e.ip+=r-1},function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"SCVTCI[]",r),e.cvCutIn=r/64},void 0,void 0,function(e){var r=e.stack;t.DEBUG&&console.log(e.step,"DUP[]"),r.push(r[r.length-1])},ar,function(e){t.DEBUG&&console.log(e.step,"CLEAR[]"),e.stack.length=0},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"SWAP[]"),r.push(n),r.push(o)},function(e){var r=e.stack;t.DEBUG&&console.log(e.step,"DEPTH[]"),r.push(r.length)},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"CINDEX[]",n),r.push(r[r.length-n])},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"MINDEX[]",n),r.push(r.splice(r.length-n,1)[0])},void 0,void 0,void 0,function(e){var r=(o=e.stack).pop(),n=o.pop(),o=(t.DEBUG&&console.log(e.step,"LOOPCALL[]",r,n),e.ip),s=e.prog;e.prog=e.funcs[r];for(var a=0;a<n;a++)Tr(e),t.DEBUG&&console.log(++e.step,a+1<n?"next loopcall":"done loopcall",a);e.ip=o,e.prog=s},function(e){var r=e.stack.pop(),n=(t.DEBUG&&console.log(e.step,"CALL[]",r),e.ip),o=e.prog;e.prog=e.funcs[r],Tr(e),e.ip=n,e.prog=o,t.DEBUG&&console.log(++e.step,"returning from",r)},function(e){if("fpgm"!==e.env)throw new Error("FDEF not allowed here");var r=e.stack,n=e.prog,o=e.ip,s=(r=r.pop(),o);for(t.DEBUG&&console.log(e.step,"FDEF[]",r);45!==n[++o];);e.ip=o,e.funcs[r]=n.slice(s+1,o)},void 0,ir.bind(void 0,0),ir.bind(void 0,1),lr.bind(void 0,Ht),lr.bind(void 0,Wt),ur.bind(void 0,0),ur.bind(void 0,1),cr.bind(void 0,0),cr.bind(void 0,1),dr.bind(void 0,0),dr.bind(void 0,1),function(e){for(var r=e.stack,n=e.loop,o=e.fv,s=r.pop()/64,a=e.z2;n--;){var i=r.pop(),l=a[i];t.DEBUG&&console.log(e.step,(1<e.loop?"loop "+(e.loop-n)+": ":"")+"SHPIX[]",i,s),o.setRelative(l,l,s),o.touch(l)}e.loop=1},function(e){for(var r=e.stack,n=e.rp1,o=e.rp2,s=e.loop,a=e.z0[n],i=e.z1[o],l=e.fv,u=e.dpv,c=e.z2;s--;){var d=r.pop(),h=c[d];t.DEBUG&&console.log(e.step,(1<e.loop?"loop "+(e.loop-s)+": ":"")+"IP[]",d,n,"<->",o),l.interpolate(h,a,i,u),l.touch(h)}e.loop=1},hr.bind(void 0,0),hr.bind(void 0,1),function(e){for(var r=e.stack,n=e.rp0,o=e.z0[n],s=e.loop,a=e.fv,i=e.pv,l=e.z1;s--;){var u=r.pop(),c=l[u];t.DEBUG&&console.log(e.step,(1<e.loop?"loop "+(e.loop-s)+": ":"")+"ALIGNRP[]",u),a.setRelative(c,o,0,i),a.touch(c)}e.loop=1},function(e){t.DEBUG&&console.log(e.step,"RTDG[]"),e.round=Bt},pr.bind(void 0,0),pr.bind(void 0,1),function(e){var r=e.prog,n=e.ip,o=e.stack,s=r[++n];t.DEBUG&&console.log(e.step,"NPUSHB[]",s);for(var a=0;a<s;a++)o.push(r[++n]);e.ip=n},function(e){var r=e.ip,n=e.prog,o=e.stack,s=n[++r];t.DEBUG&&console.log(e.step,"NPUSHW[]",s);for(var a=0;a<s;a++){var i=n[++r]<<8|n[++r];32768&i&&(i=-(1+(65535^i))),o.push(i)}e.ip=r},function(e){var r=e.stack,n=(n=e.store)||(e.store=[]),o=r.pop();r=r.pop(),t.DEBUG&&console.log(e.step,"WS",o,r),n[r]=o},function(e){var r=e.stack,n=e.store,o=r.pop();t.DEBUG&&console.log(e.step,"RS",o),e=n&&n[o]||0,r.push(e)},function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG&&console.log(e.step,"WCVTP",r,n),e.cvt[n]=r/64},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"RCVT",n),r.push(64*e.cvt[n])},fr.bind(void 0,0),fr.bind(void 0,1),void 0,mr.bind(void 0,0),mr.bind(void 0,1),function(e){t.DEBUG&&console.log(e.step,"MPPEM[]"),e.stack.push(e.ppem)},void 0,function(e){t.DEBUG&&console.log(e.step,"FLIPON[]"),e.autoFlip=!0},void 0,void 0,function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"LT[]",n,o),r.push(o<n?1:0)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"LTEQ[]",n,o),r.push(o<=n?1:0)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"GT[]",n,o),r.push(n<o?1:0)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"GTEQ[]",n,o),r.push(n<=o?1:0)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"EQ[]",n,o),r.push(n===o?1:0)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"NEQ[]",n,o),r.push(n!==o?1:0)},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"ODD[]",n),r.push(Math.trunc(n)%2?1:0)},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"EVEN[]",n),r.push(Math.trunc(n)%2?0:1)},function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"IF[]",r),r||(er(e,!0),t.DEBUG&&console.log(e.step,"EIF[]"))},function(e){t.DEBUG&&console.log(e.step,"EIF[]")},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"AND[]",n,o),r.push(n&&o?1:0)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"OR[]",n,o),r.push(n||o?1:0)},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"NOT[]",n),r.push(n?0:1)},yr.bind(void 0,1),function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"SDB[]",r),e.deltaBase=r},function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"SDS[]",r),e.deltaShift=Math.pow(.5,r)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"ADD[]",n,o),r.push(o+n)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"SUB[]",n,o),r.push(o-n)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"DIV[]",n,o),r.push(64*o/n)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"MUL[]",n,o),r.push(o*n/64)},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"ABS[]",n),r.push(Math.abs(n))},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"NEG[]",n),r.push(-n)},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"FLOOR[]",n),r.push(64*Math.floor(n/64))},function(e){var r=e.stack,n=r.pop();t.DEBUG&&console.log(e.step,"CEILING[]",n),r.push(64*Math.ceil(n/64))},gr.bind(void 0,0),gr.bind(void 0,1),gr.bind(void 0,2),gr.bind(void 0,3),void 0,void 0,void 0,void 0,function(e){var r=(n=e.stack).pop(),n=n.pop();t.DEBUG&&console.log(e.step,"WCVTF[]",r,n),e.cvt[n]=r*e.ppem/e.font.unitsPerEm},yr.bind(void 0,2),yr.bind(void 0,3),vr.bind(void 0,1),vr.bind(void 0,2),vr.bind(void 0,3),function(e){var r,n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"SROUND[]",n),e.round=zt,192&n){case 0:r=.5;break;case 64:r=1;break;case 128:r=2;break;default:throw new Error("invalid SROUND value")}switch(e.srPeriod=r,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid SROUND value")}e.srThreshold=0==(n&=15)?0:(n/8-.5)*r},function(e){var r,n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"S45ROUND[]",n),e.round=zt,192&n){case 0:r=Math.sqrt(2)/2;break;case 64:r=Math.sqrt(2);break;case 128:r=2*Math.sqrt(2);break;default:throw new Error("invalid S45ROUND value")}switch(e.srPeriod=r,48&n){case 0:e.srPhase=0;break;case 16:e.srPhase=.25*r;break;case 32:e.srPhase=.5*r;break;case 48:e.srPhase=.75*r;break;default:throw new Error("invalid S45ROUND value")}e.srThreshold=0==(n&=15)?0:(n/8-.5)*r},void 0,void 0,function(e){t.DEBUG&&console.log(e.step,"ROFF[]"),e.round=Ft},void 0,function(e){t.DEBUG&&console.log(e.step,"RUTG[]"),e.round=Vt},function(e){t.DEBUG&&console.log(e.step,"RDTG[]"),e.round=Gt},ar,ar,void 0,void 0,void 0,void 0,void 0,function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"SCANCTRL[]",r)},br.bind(void 0,0),br.bind(void 0,1),function(e){var r=e.stack,n=r.pop(),o=0;t.DEBUG&&console.log(e.step,"GETINFO[]",n),1&n&&(o=35),32&n&&(o|=4096),r.push(o)},void 0,function(e){var r=e.stack,n=r.pop(),o=r.pop(),s=r.pop();t.DEBUG&&console.log(e.step,"ROLL[]"),r.push(o),r.push(n),r.push(s)},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"MAX[]",n,o),r.push(Math.max(o,n))},function(e){var r=e.stack,n=r.pop(),o=r.pop();t.DEBUG&&console.log(e.step,"MIN[]",n,o),r.push(Math.min(o,n))},function(e){var r=e.stack.pop();t.DEBUG&&console.log(e.step,"SCANTYPE[]",r)},function(e){var r=e.stack.pop(),n=e.stack.pop();switch(t.DEBUG&&console.log(e.step,"INSTCTRL[]",r,n),r){case 1:return void(e.inhibitGridFit=!!n);case 2:return void(e.ignoreCvt=!!n);default:throw new Error("invalid INSTCTRL[] selector")}},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,xr.bind(void 0,1),xr.bind(void 0,2),xr.bind(void 0,3),xr.bind(void 0,4),xr.bind(void 0,5),xr.bind(void 0,6),xr.bind(void 0,7),xr.bind(void 0,8),wr.bind(void 0,1),wr.bind(void 0,2),wr.bind(void 0,3),wr.bind(void 0,4),wr.bind(void 0,5),wr.bind(void 0,6),wr.bind(void 0,7),wr.bind(void 0,8),_r.bind(void 0,0,0,0,0,0),_r.bind(void 0,0,0,0,0,1),_r.bind(void 0,0,0,0,0,2),_r.bind(void 0,0,0,0,0,3),_r.bind(void 0,0,0,0,1,0),_r.bind(void 0,0,0,0,1,1),_r.bind(void 0,0,0,0,1,2),_r.bind(void 0,0,0,0,1,3),_r.bind(void 0,0,0,1,0,0),_r.bind(void 0,0,0,1,0,1),_r.bind(void 0,0,0,1,0,2),_r.bind(void 0,0,0,1,0,3),_r.bind(void 0,0,0,1,1,0),_r.bind(void 0,0,0,1,1,1),_r.bind(void 0,0,0,1,1,2),_r.bind(void 0,0,0,1,1,3),_r.bind(void 0,0,1,0,0,0),_r.bind(void 0,0,1,0,0,1),_r.bind(void 0,0,1,0,0,2),_r.bind(void 0,0,1,0,0,3),_r.bind(void 0,0,1,0,1,0),_r.bind(void 0,0,1,0,1,1),_r.bind(void 0,0,1,0,1,2),_r.bind(void 0,0,1,0,1,3),_r.bind(void 0,0,1,1,0,0),_r.bind(void 0,0,1,1,0,1),_r.bind(void 0,0,1,1,0,2),_r.bind(void 0,0,1,1,0,3),_r.bind(void 0,0,1,1,1,0),_r.bind(void 0,0,1,1,1,1),_r.bind(void 0,0,1,1,1,2),_r.bind(void 0,0,1,1,1,3),_r.bind(void 0,1,0,0,0,0),_r.bind(void 0,1,0,0,0,1),_r.bind(void 0,1,0,0,0,2),_r.bind(void 0,1,0,0,0,3),_r.bind(void 0,1,0,0,1,0),_r.bind(void 0,1,0,0,1,1),_r.bind(void 0,1,0,0,1,2),_r.bind(void 0,1,0,0,1,3),_r.bind(void 0,1,0,1,0,0),_r.bind(void 0,1,0,1,0,1),_r.bind(void 0,1,0,1,0,2),_r.bind(void 0,1,0,1,0,3),_r.bind(void 0,1,0,1,1,0),_r.bind(void 0,1,0,1,1,1),_r.bind(void 0,1,0,1,1,2),_r.bind(void 0,1,0,1,1,3),_r.bind(void 0,1,1,0,0,0),_r.bind(void 0,1,1,0,0,1),_r.bind(void 0,1,1,0,0,2),_r.bind(void 0,1,1,0,0,3),_r.bind(void 0,1,1,0,1,0),_r.bind(void 0,1,1,0,1,1),_r.bind(void 0,1,1,0,1,2),_r.bind(void 0,1,1,0,1,3),_r.bind(void 0,1,1,1,0,0),_r.bind(void 0,1,1,1,0,1),_r.bind(void 0,1,1,1,0,2),_r.bind(void 0,1,1,1,0,3),_r.bind(void 0,1,1,1,1,0),_r.bind(void 0,1,1,1,1,1),_r.bind(void 0,1,1,1,1,2),_r.bind(void 0,1,1,1,1,3)],jr=Array.from||function(e){return e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]?|[^\uD800-\uDFFF]|./g)||[]};function Cr(e){(e=e||{}).empty||(Ot(e.familyName,"When creating a new Font object, familyName is required."),Ot(e.styleName,"When creating a new Font object, styleName is required."),Ot(e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),Ot(e.ascender,"When creating a new Font object, ascender is required."),Ot(e.descender,"When creating a new Font object, descender is required."),Ot(e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:e.familyName||" "},fontSubfamily:{en:e.styleName||" "},fullName:{en:e.fullName||e.familyName+" "+e.styleName},postScriptName:{en:e.postScriptName||(e.familyName+e.styleName).replace(/\s/g,"")},designer:{en:e.designer||" "},designerURL:{en:e.designerURL||" "},manufacturer:{en:e.manufacturer||" "},manufacturerURL:{en:e.manufacturerURL||" "},license:{en:e.license||" "},licenseURL:{en:e.licenseURL||" "},version:{en:e.version||"Version 0.1"},description:{en:e.description||" "},copyright:{en:e.copyright||" "},trademark:{en:e.trademark||" "}},this.unitsPerEm=e.unitsPerEm||1e3,this.ascender=e.ascender,this.descender=e.descender,this.createdTimestamp=e.createdTimestamp,this.tables={os2:{usWeightClass:e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new ve.GlyphSet(this,e.glyphs||[]),this.encoding=new ce(this),this.position=new Et(this),this.substitution=new jt(this),this.tables=this.tables||{},Object.defineProperty(this,"hinting",{get:function(){return this._hinting||("truetype"===this.outlinesFormat?this._hinting=new Dt(this):void 0)}})}Cr.prototype.hasChar=function(e){return null!==this.encoding.charToGlyphIndex(e)},Cr.prototype.charToGlyphIndex=function(e){return this.encoding.charToGlyphIndex(e)},Cr.prototype.charToGlyph=function(e){return e=this.charToGlyphIndex(e),this.glyphs.get(e)||this.glyphs.get(0)},Cr.prototype.stringToGlyphs=function(e,t){t=t||this.defaultRenderOptions;for(var r=jr(e),n=[],o=0;o<r.length;o+=1){var s=r[o];n.push(this.charToGlyphIndex(s))}var a=n.length;if(t.features){e=t.script||this.substitution.getDefaultScriptName();var i=[];t.features.liga&&(i=i.concat(this.substitution.getFeature("liga",e,t.language))),t.features.rlig&&(i=i.concat(this.substitution.getFeature("rlig",e,t.language)));for(var l=0;l<a;l+=1)for(var u=0;u<i.length;u++){for(var c=i[u],d=c.sub,h=d.length,p=0;p<h&&d[p]===n[l+p];)p++;p===h&&(n.splice(l,h,c.by),a=a-h+1)}}for(var f=new Array(a),m=this.glyphs.get(0),y=0;y<a;y+=1)f[y]=this.glyphs.get(n[y])||m;return f},Cr.prototype.nameToGlyphIndex=function(e){return this.glyphNames.nameToGlyphIndex(e)},Cr.prototype.nameToGlyph=function(e){return e=this.nameToGlyphIndex(e),this.glyphs.get(e)||this.glyphs.get(0)},Cr.prototype.glyphIndexToName=function(e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(e):""},Cr.prototype.getKerningValue=function(e,t){e=e.index||e,t=t.index||t;var r=this.position.defaultKerningTables;return r?this.position.getKerningValue(r,e,t):this.kerningPairs[e+","+t]||0},Cr.prototype.defaultRenderOptions={kerning:!0,features:{liga:!0,rlig:!0}},Cr.prototype.forEachGlyph=function(e,t,r,n,o,s){t=void 0!==t?t:0,r=void 0!==r?r:0,o=o||this.defaultRenderOptions;var a,i=1/this.unitsPerEm*(n=void 0!==n?n:72),l=this.stringToGlyphs(e,o);o.kerning&&(e=o.script||this.position.getDefaultScriptName(),a=this.position.getKerningTables(e,o.language));for(var u=0;u<l.length;u+=1){var c=l[u];s.call(this,c,t,r,n,o),c.advanceWidth&&(t+=c.advanceWidth*i),o.kerning&&u<l.length-1&&(t+=(a?this.position.getKerningValue(a,c.index,l[u+1].index):this.getKerningValue(c,l[u+1]))*i),o.letterSpacing?t+=o.letterSpacing*n:o.tracking&&(t+=o.tracking/1e3*n)}return t},Cr.prototype.getPath=function(e,t,r,n,o){var s=new C;return this.forEachGlyph(e,t,r,n,o,(function(e,t,r,n){e=e.getPath(t,r,n,o,this),s.extend(e)})),s},Cr.prototype.getPaths=function(e,t,r,n,o){var s=[];return this.forEachGlyph(e,t,r,n,o,(function(e,t,r,n){e=e.getPath(t,r,n,o,this),s.push(e)})),s},Cr.prototype.getAdvanceWidth=function(e,t,r){return this.forEachGlyph(e,0,0,t,r,(function(){}))},Cr.prototype.draw=function(e,t,r,n,o,s){this.getPath(t,r,n,o,s).draw(e)},Cr.prototype.drawPoints=function(e,t,r,n,o,s){this.forEachGlyph(t,r,n,o,s,(function(t,r,n,o){t.drawPoints(e,r,n,o)}))},Cr.prototype.drawMetrics=function(e,t,r,n,o,s){this.forEachGlyph(t,r,n,o,s,(function(t,r,n,o){t.drawMetrics(e,r,n,o)}))},Cr.prototype.getEnglishName=function(e){if(e=this.names[e])return e.en},Cr.prototype.validate=function(){var e=this;function t(t){(t=e.getEnglishName(t))&&t.trim().length}t("fontFamily"),t("weightName"),t("manufacturer"),t("copyright"),t("version"),this.unitsPerEm},Cr.prototype.toTables=function(){return function(e){for(var t,r=[],n=[],o=[],s=[],a=[],i=[],l=[],u=0,c=0,d=0,h=0,p=0,f=0;f<e.glyphs.length;f+=1){var m=e.glyphs.get(f),y=0|m.unicode;if(isNaN(m.advanceWidth))throw new Error("Glyph "+m.name+" ("+f+"): advanceWidth is not a number.");if((y<t||void 0===t)&&0<y&&(t=y),u<y&&(u=y),(y=it(y))<32)c|=1<<y;else if(y<64)d|=1<<y-32;else if(y<96)h|=1<<y-64;else{if(!(y<123))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");p|=1<<y-96}".notdef"!==m.name&&(y=m.getMetrics(),r.push(y.xMin),n.push(y.yMin),o.push(y.xMax),s.push(y.yMax),i.push(y.leftSideBearing),l.push(y.rightSideBearing),a.push(m.advanceWidth))}var g,v={xMin:Math.min.apply(null,r),yMin:Math.min.apply(null,n),xMax:Math.max.apply(null,o),yMax:Math.max.apply(null,s),advanceWidthMax:Math.max.apply(null,a),advanceWidthAvg:function(e){for(var t=0,r=0;r<e.length;r+=1)t+=e[r];return t/e.length}(a),minLeftSideBearing:Math.min.apply(null,i),maxLeftSideBearing:Math.max.apply(null,i),minRightSideBearing:Math.min.apply(null,l)},b=(v.ascender=e.ascender,v.descender=e.descender,De({flags:3,unitsPerEm:e.unitsPerEm,xMin:v.xMin,yMin:v.yMin,xMax:v.xMax,yMax:v.yMax,lowestRecPPEM:3,createdTimestamp:e.createdTimestamp})),x=$e({ascender:v.ascender,descender:v.descender,advanceWidthMax:v.advanceWidthMax,minLeftSideBearing:v.minLeftSideBearing,minRightSideBearing:v.minRightSideBearing,xMaxExtent:v.maxLeftSideBearing+(v.xMax-v.xMin),numberOfHMetrics:e.glyphs.length}),w=ze(e.glyphs.length),_=at({xAvgCharWidth:Math.round(v.advanceWidthAvg),usWeightClass:e.tables.os2.usWeightClass,usWidthClass:e.tables.os2.usWidthClass,usFirstCharIndex:t,usLastCharIndex:u,ulUnicodeRange1:c,ulUnicodeRange2:d,ulUnicodeRange3:h,ulUnicodeRange4:p,fsSelection:e.tables.os2.fsSelection,sTypoAscender:v.ascender,sTypoDescender:v.descender,sTypoLineGap:0,usWinAscent:v.yMax,usWinDescent:Math.abs(v.yMin),ulCodePageRange1:1,sxHeight:wt(e,"xyvw",{yMax:Math.round(v.ascender/2)}).yMax,sCapHeight:wt(e,"HIKLEFJMNTZBDPRAGOQSUVWXY",v).yMax,usDefaultChar:e.hasChar(" ")?32:0,usBreakChar:e.hasChar(" ")?32:0}),S=Be(e.glyphs),k=se(e.glyphs),T=(A=e.getEnglishName("fontFamily"))+" "+(R=e.getEnglishName("fontSubfamily")),E=(E=e.getEnglishName("postScriptName"))||A.replace(/\s/g,"")+"-"+R,j={};for(g in e.names)j[g]=e.names[g];j.uniqueID||(j.uniqueID={en:e.getEnglishName("manufacturer")+":"+T}),j.postScriptName||(j.postScriptName={en:E}),j.preferredFamily||(j.preferredFamily=e.names.fontFamily),j.preferredSubfamily||(j.preferredSubfamily=e.names.fontSubfamily);var C=nt(j,I=[]),I=0<I.length?Ue(I):void 0,O=ut(),A=(T=Pe(e.glyphs,{version:e.getEnglishName("version"),fullName:T,familyName:A,weightName:R,postScriptName:E,unitsPerEm:e.unitsPerEm,fontBBox:[0,v.yMin,v.ascender,v.advanceWidthMax]}),e.metas&&0<Object.keys(e.metas).length?yt(e.metas):void 0),R=[b,x,w,_,C,k,O,T,S];I&&R.push(I),e.tables.gsub&&R.push(ft(e.tables.gsub)),A&&R.push(A);for(var N=vt((E=xt(R)).encode()),M=E.fields,P=!1,L=0;L<M.length;L+=1)if("head table"===M[L].name){M[L].value.checkSumAdjustment=2981146554-N,P=!0;break}if(P)return E;throw new Error("Could not find head table with checkSum to adjust.")}(this)},Cr.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},Cr.prototype.toArrayBuffer=function(){for(var e=this.toTables().encode(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e[n];return t},Cr.prototype.download=function(t){var r=this.getEnglishName("fontFamily"),o=this.getEnglishName("fontSubfamily"),s=(t=t||r.replace(/\s/g,"")+"-"+o+".otf",this.toArrayBuffer());"undefined"!=typeof window?(window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,s.byteLength,(function(e){e.root.getFile(t,{create:!0},(function(e){e.createWriter((function(t){var r=new DataView(s);r=new Blob([r],{type:"font/opentype"}),t.write(r),t.addEventListener("writeend",(function(){location.href=e.toURL()}),!1)}))}))}),(function(e){throw new Error(e.name+": "+e.message)}))):(r=e("fs"),o=function(e){for(var t=new n(e.byteLength),r=new Uint8Array(e),o=0;o<t.length;++o)t[o]=r[o];return t}(s),r.writeFileSync(t,o))},Cr.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},Cr.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},Cr.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900};var Ir=new Array(10);Ir[1]=function(){var e=this.offset+this.relativeOffset,t=this.parseUShort();return 1===t?{posFormat:1,coverage:this.parsePointer(te.coverage),value:this.parseValueRecord()}:2===t?{posFormat:2,coverage:this.parsePointer(te.coverage),values:this.parseValueRecordList()}:void A.assert(!1,"0x"+e.toString(16)+": GPOS lookup type 1 format must be 1 or 2.")},Ir[2]=function(){var e,t,r,n,o=this.offset+this.relativeOffset,s=this.parseUShort(),a=(A.assert(1===s||2===s,"0x"+o.toString(16)+": GPOS lookup type 2 format must be 1 or 2."),o=this.parsePointer(te.coverage),this.parseUShort()),i=this.parseUShort();return 1===s?{posFormat:s,coverage:o,valueFormat1:a,valueFormat2:i,pairSets:this.parseList(te.pointer(te.list((function(){return{secondGlyph:this.parseUShort(),value1:this.parseValueRecord(a),value2:this.parseValueRecord(i)}}))))}:2===s?(e=this.parsePointer(te.classDef),t=this.parsePointer(te.classDef),r=this.parseUShort(),n=this.parseUShort(),{posFormat:s,coverage:o,valueFormat1:a,valueFormat2:i,classDef1:e,classDef2:t,class1Count:r,class2Count:n,classRecords:this.parseList(r,te.list(n,(function(){return{value1:this.parseValueRecord(a),value2:this.parseValueRecord(i)}})))}):void 0},Ir[3]=function(){return{error:"GPOS Lookup 3 not supported"}},Ir[4]=function(){return{error:"GPOS Lookup 4 not supported"}},Ir[5]=function(){return{error:"GPOS Lookup 5 not supported"}},Ir[6]=function(){return{error:"GPOS Lookup 6 not supported"}},Ir[7]=function(){return{error:"GPOS Lookup 7 not supported"}},Ir[8]=function(){return{error:"GPOS Lookup 8 not supported"}},Ir[9]=function(){return{error:"GPOS Lookup 9 not supported"}},new Array(10);var Or=function(e,t){return t=(e=new te(e,t=t||0)).parseVersion(1),A.argument(1===t||1.1===t,"Unsupported GPOS table version "+t),1===t?{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(Ir)}:{version:t,scripts:e.parseScriptList(),features:e.parseFeatureList(),lookups:e.parseLookupList(Ir),variations:e.parseFeatureVariationsList()}};function Ar(t,r){e("fs").readFile(t,(function(e,t){if(e)return r(e.message);r(null,It(t))}))}function Rr(e,t){var r=new XMLHttpRequest;r.open("get",e,!0),r.responseType="arraybuffer",r.onload=function(){return r.response?t(null,r.response):t("Font could not be loaded: "+r.statusText)},r.onerror=function(){t("Font could not be loaded")},r.send()}function Nr(e,t){for(var r=[],n=12,o=0;o<t;o+=1){var s=ne.getTag(e,n),a=ne.getULong(e,n+4),i=ne.getULong(e,n+8),l=ne.getULong(e,n+12);r.push({tag:s,checksum:a,offset:i,length:l,compression:!1}),n+=16}return r}function Mr(e,t){if("WOFF"!==t.compression)return{data:e,offset:t.offset};e=new Uint8Array(e.buffer,t.offset+2,t.compressedLength-2);var r=new Uint8Array(t.length);if(T(e,r),r.byteLength!==t.length)throw new Error("Decompression error: "+t.tag+" decompressed length doesn't match recorded length");return{data:new DataView(r.buffer,0),offset:0}}function Pr(e){var t,r,n,o,s,a,i,l,u,c,d,h,p,f,m=new Cr({empty:!0}),y=new DataView(e,0),g=[];if((e=ne.getTag(y,0))===String.fromCharCode(0,1,0,0)||"true"===e||"typ1"===e)m.outlinesFormat="truetype",g=Nr(y,n=ne.getUShort(y,4));else if("OTTO"===e)m.outlinesFormat="cff",g=Nr(y,n=ne.getUShort(y,4));else{if("wOFF"!==e)throw new Error("Unsupported OpenType signature "+e);if((w=ne.getTag(y,4))===String.fromCharCode(0,1,0,0))m.outlinesFormat="truetype";else{if("OTTO"!==w)throw new Error("Unsupported OpenType flavor "+e);m.outlinesFormat="cff"}g=function(e,t){for(var r=[],n=44,o=0;o<t;o+=1){var s=ne.getTag(e,n),a=ne.getULong(e,n+4),i=ne.getULong(e,n+8),l=ne.getULong(e,n+12),u=i<l&&"WOFF";r.push({tag:s,offset:a,compression:u,compressedLength:i,length:l}),n+=20}return r}(y,n=ne.getUShort(y,12))}for(var v=0;v<n;v+=1){var b=g[v],x=void 0;switch(b.tag){case"cmap":x=Mr(y,b),m.tables.cmap=oe(x.data,x.offset),m.encoding=new de(m.tables.cmap);break;case"cvt ":x=Mr(y,b),f=new ne.Parser(x.data,x.offset),m.tables.cvt=f.parseShortList(b.length/2);break;case"fvar":s=b;break;case"fpgm":x=Mr(y,b),f=new ne.Parser(x.data,x.offset),m.tables.fpgm=f.parseByteList(b.length);break;case"head":x=Mr(y,b),m.tables.head=Le(x.data,x.offset),m.unitsPerEm=m.tables.head.unitsPerEm,t=m.tables.head.indexToLocFormat;break;case"hhea":x=Mr(y,b),m.tables.hhea=Fe(x.data,x.offset),m.ascender=m.tables.hhea.ascender,m.descender=m.tables.hhea.descender,m.numberOfHMetrics=m.tables.hhea.numberOfHMetrics;break;case"hmtx":u=b;break;case"ltag":x=Mr(y,b),r=Ve(x.data,x.offset);break;case"maxp":x=Mr(y,b),m.tables.maxp=Ge(x.data,x.offset),m.numGlyphs=m.tables.maxp.numGlyphs;break;case"name":h=b;break;case"OS/2":x=Mr(y,b),m.tables.os2=st(x.data,x.offset);break;case"post":x=Mr(y,b),m.tables.post=lt(x.data,x.offset),m.glyphNames=new pe(m.tables.post);break;case"prep":x=Mr(y,b),f=new ne.Parser(x.data,x.offset),m.tables.prep=f.parseByteList(b.length);break;case"glyf":a=b;break;case"loca":d=b;break;case"CFF ":o=b;break;case"kern":c=b;break;case"GPOS":i=b;break;case"GSUB":l=b;break;case"meta":p=b}}if(w=Mr(y,h),m.tables.name=rt(w.data,w.offset,r),m.names=m.tables.name,a&&d)e=0===t,w=function(e,t,r,n){for(var o=new ne.Parser(e,t),s=n?o.parseUShort:o.parseULong,a=[],i=0;i<r+1;i+=1){var l=s.call(o);n&&(l*=2),a.push(l)}return a}((w=Mr(y,d)).data,w.offset,m.numGlyphs,e),e=Mr(y,a),m.glyphs=Lt.parse(e.data,e.offset,w,m);else{if(!o)throw new Error("Font doesn't contain TrueType or CFF outlines.");e=Mr(y,o),Me(e.data,e.offset,m)}for(var w=Mr(y,u),_=(function(e,t,r,n,o){for(var s,a,i=new ne.Parser(e,t),l=0;l<n;l+=1){l<r&&(s=i.parseUShort(),a=i.parseShort());var u=o.get(l);u.advanceWidth=s,u.leftSideBearing=a}}(w.data,w.offset,m.numberOfHMetrics,m.numGlyphs,m.glyphs),m),S=_.tables.cmap.glyphIndexMap,k=Object.keys(S),T=0;T<k.length;T+=1){var E,j=k[T],C=S[j];(E=_.glyphs.get(C)).addUnicode(parseInt(j))}for(var I=0;I<_.glyphs.length;I+=1)E=_.glyphs.get(I),_.cffEncoding?_.isCIDFont?E.name="gid"+I:E.name=_.cffEncoding.charset[I]:_.glyphNames.names&&(E.name=_.glyphNames.glyphIndexToName(I));return c?(e=Mr(y,c),m.kerningPairs=function(e,t){if(0===(t=(e=new ne.Parser(e,t)).parseUShort())){var r=e,n={},o=(r.skip("uShort"),r.parseUShort()),s=(A.argument(0===o,"Unsupported kern sub-table version."),r.skip("uShort",2),r.parseUShort());r.skip("uShort",3);for(var a=0;a<s;a+=1){var i=r.parseUShort(),l=r.parseUShort(),u=r.parseShort();n[i+","+l]=u}return n}if(1!==t)throw new Error("Unsupported kern table version ("+t+").");var c=e,d={};if(c.skip("uShort"),1<c.parseULong()&&console.warn("Only the first kern subtable is supported."),c.skip("uLong"),o=255&c.parseUShort(),c.skip("uShort"),0==o){var h=c.parseUShort();c.skip("uShort",3);for(var p=0;p<h;p+=1){var f=c.parseUShort(),m=c.parseUShort(),y=c.parseShort();d[f+","+m]=y}}return d}(e.data,e.offset)):m.kerningPairs={},i&&(w=Mr(y,i),m.tables.gpos=Or(w.data,w.offset),m.position.init()),l&&(e=Mr(y,l),m.tables.gsub=pt(e.data,e.offset)),s&&(w=Mr(y,s),m.tables.fvar=function(e,t,r){for(var n,o,s,a,i=new ne.Parser(e,t),l=i.parseULong(),u=(A.argument(65536===l,"Unsupported fvar table version."),i.parseOffset16()),c=(i.skip("uShort",1),i.parseUShort()),d=i.parseUShort(),h=i.parseUShort(),p=i.parseUShort(),f=[],m=0;m<c;m++)f.push((n=e,o=t+u+m*d,s=r,a={},n=new ne.Parser(n,o),a.tag=n.parseTag(),a.minValue=n.parseFixed(),a.defaultValue=n.parseFixed(),a.maxValue=n.parseFixed(),n.skip("uShort",1),a.name=s[n.parseUShort()]||{},a));for(var y=[],g=t+u+c*d,v=0;v<h;v++)y.push(function(e,t,r,n){var o={},s=new ne.Parser(e,t);o.name=n[s.parseUShort()]||{},s.skip("uShort",1),o.coordinates={};for(var a=0;a<r.length;++a)o.coordinates[r[a].tag]=s.parseFixed();return o}(e,g+v*p,f,r));return{axes:f,instances:y}}(w.data,w.offset,m.names)),p&&(e=Mr(y,p),m.tables.meta=mt(e.data,e.offset),m.metas=m.tables.meta),m}t.Font=Cr,t.Glyph=me,t.Path=C,t.BoundingBox=j,t._parse=ne,t.parse=Pr,t.load=function(e,t){("undefined"==typeof window?Ar:Rr)(e,(function(e,r){if(e)return t(e);var n;try{n=Pr(r)}catch(e){return t(e,null)}return t(null,n)}))},t.loadSync=function(t){return Pr(It(e("fs").readFileSync(t)))},Object.defineProperty(t,"__esModule",{value:!0})},o("object"==typeof r&&void 0!==t?r:this.opentype={})}).call(this,e("buffer").Buffer)},{buffer:4,fs:2}],248:[function(e,t,r){(function(e){function t(e,t){for(var r=0,n=e.length-1;0<=n;n--){var o=e[n];"."===o?e.splice(n,1):".."===o?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}r.resolve=function(){for(var r="",o=!1,s=arguments.length-1;-1<=s&&!o;s--){var a=0<=s?arguments[s]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(r=a+"/"+r,o="/"===a.charAt(0))}return(o?"/":"")+(r=t(n(r.split("/"),(function(e){return!!e})),!o).join("/"))||"."},r.normalize=function(e){var s=r.isAbsolute(e),a="/"===o(e,-1);return(e=(e=t(n(e.split("/"),(function(e){return!!e})),!s).join("/"))||s?e:".")&&a&&(e+="/"),(s?"/":"")+e},r.isAbsolute=function(e){return"/"===e.charAt(0)},r.join=function(){var e=Array.prototype.slice.call(arguments,0);return r.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},r.relative=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;0<=r&&""===e[r];r--);return r<t?[]:e.slice(t,r-t+1)}e=r.resolve(e).substr(1),t=r.resolve(t).substr(1);for(var o=n(e.split("/")),s=n(t.split("/")),a=Math.min(o.length,s.length),i=a,l=0;l<a;l++)if(o[l]!==s[l]){i=l;break}var u=[];for(l=i;l<o.length;l++)u.push("..");return(u=u.concat(s.slice(i))).join("/")},r.sep="/",r.delimiter=":",r.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=47===e.charCodeAt(0),r=-1,n=!0,o=e.length-1;1<=o;--o)if(47===e.charCodeAt(o)){if(!n){r=o;break}}else n=!1;return-1===r?t?"/":".":t&&1===r?"/":e.slice(0,r)},r.basename=function(e,t){return e=function(e){"string"!=typeof e&&(e+="");for(var t=0,r=-1,n=!0,o=e.length-1;0<=o;--o)if(47===e.charCodeAt(o)){if(!n){t=o+1;break}}else-1===r&&(n=!1,r=o+1);return-1===r?"":e.slice(t,r)}(e),t&&e.substr(-1*t.length)===t?e.substr(0,e.length-t.length):e},r.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,r=0,n=-1,o=!0,s=0,a=e.length-1;0<=a;--a){var i=e.charCodeAt(a);if(47===i){if(o)continue;r=a+1;break}-1===n&&(o=!1,n=a+1),46===i?-1===t?t=a:1!==s&&(s=1):-1!==t&&(s=-1)}return-1===t||-1===n||0===s||1===s&&t===n-1&&t===r+1?"":e.slice(t,n)};var o=function(e,t,r){return e.substr(t,r)}}).call(this,e("_process"))},{_process:249}],249:[function(e,t,r){var n,o;function s(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}t=t.exports={};try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}function i(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return(n=setTimeout)(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}var l,u=[],c=!1,d=-1;function h(){c&&l&&(c=!1,l.length?u=l.concat(u):d=-1,u.length&&p())}function p(){if(!c){for(var e=i(h),t=(c=!0,u.length);t;){for(l=u,u=[];++d<t;)l&&l[d].run();d=-1,t=u.length}l=null,c=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return(o=clearTimeout)(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new f(e,t)),1!==u.length||c||i(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=m,t.addListener=m,t.once=m,t.off=m,t.removeListener=m,t.removeAllListeners=m,t.emit=m,t.prependListener=m,t.prependOnceListener=m,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],250:[function(e,t,r){t=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o=(g="function"==typeof Symbol?Symbol:{}).iterator||"@@iterator",s=g.asyncIterator||"@@asyncIterator",a=g.toStringTag||"@@toStringTag";function i(e,r,n,o){var s,a,i,m;return r=r&&r.prototype instanceof f?r:f,r=Object.create(r.prototype),o=new k(o||[]),r._invoke=(s=e,a=n,i=o,m=u,function(e,r){if(m===d)throw new Error("Generator is already running");if(m===h){if("throw"===e)throw r;return E()}for(i.method=e,i.arg=r;;){var n=i.delegate;if(n&&(n=function e(r,n){var o=r.iterator[n.method];if(o===t){if(n.delegate=null,"throw"===n.method){if(r.iterator.return&&(n.method="return",n.arg=t,e(r,n),"throw"===n.method))return p;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}return"throw"===(o=l(o,r.iterator,n.arg)).type?(n.method="throw",n.arg=o.arg,n.delegate=null,p):(o=o.arg)?o.done?(n[r.resultName]=o.value,n.next=r.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}(n,i),n)){if(n===p)continue;return n}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(m===u)throw m=h,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);if(m=d,"normal"===(n=l(s,a,i)).type){if(m=i.done?h:c,n.arg!==p)return{value:n.arg,done:i.done}}else"throw"===n.type&&(m=h,i.method="throw",i.arg=n.arg)}}),r}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=i;var u="suspendedStart",c="suspendedYield",d="executing",h="completed",p={};function f(){}function m(){}function y(){}var g,v,b=((g={})[o]=function(){return this},(v=(v=Object.getPrototypeOf)&&v(v(T([]))))&&v!==r&&n.call(v,o)&&(g=v),y.prototype=f.prototype=Object.create(g));function x(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function w(e){var t;this._invoke=function(r,o){function s(){return new Promise((function(t,s){!function t(r,o,s,a){var i;if("throw"!==(r=l(e[r],e,o)).type)return(o=(i=r.arg).value)&&"object"==typeof o&&n.call(o,"__await")?Promise.resolve(o.__await).then((function(e){t("next",e,s,a)}),(function(e){t("throw",e,s,a)})):Promise.resolve(o).then((function(e){i.value=e,s(i)}),(function(e){return t("throw",e,s,a)}));a(r.arg)}(r,o,t,s)}))}return t=t?t.then(s,s):s()}}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function T(e){if(e){var r,s=e[o];if(s)return s.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(s=function o(){for(;++r<e.length;)if(n.call(e,r))return o.value=e[r],o.done=!1,o;return o.value=t,o.done=!0,o}).next=s}return{next:E}}function E(){return{value:t,done:!0}}return(m.prototype=b.constructor=y).constructor=m,y[a]=m.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){return!!(e="function"==typeof e&&e.constructor)&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},x(w.prototype),w.prototype[s]=function(){return this},e.AsyncIterator=w,e.async=function(t,r,n,o){var s=new w(i(t,r,n,o));return e.isGeneratorFunction(r)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},x(b),b[a]="Generator",b[o]=function(){return this},b.toString=function(){return"[object Generator]"},e.keys=function(e){var t,r=[];for(t in e)r.push(t);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,k.prototype={constructor:k,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(S),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return i.type="throw",i.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var s=this.tryEntries.length-1;0<=s;--s){var a=this.tryEntries[s],i=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var s=o;break}}var a=(s=s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc?null:s)?s.completion:{};return a.type=e,a.arg=t,s?(this.method="next",this.next=s.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,S(o)),n}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}("object"==typeof t?t.exports:{});try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},{}],251:[function(e,t,r){!function(e){"use strict";var t,r,n,o,s,a,i,l,u,c;function d(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function h(e){return"string"!=typeof e?String(e):e}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function m(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function y(e){return new Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function g(e){var t=new FileReader,r=y(t);return t.readAsArrayBuffer(e),r}function v(e){var t;return e.slice?e.slice(0):((t=new Uint8Array(e.byteLength)).set(new Uint8Array(e)),t.buffer)}function b(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e)if("string"==typeof e)this._bodyText=e;else if(n&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(o&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(s&&n&&i(e))this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(e)&&!l(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=v(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n&&(this.blob=function(){var e=m(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?m(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var e,t,r=m(this);if(r)return r;if(this._bodyBlob)return r=this._bodyBlob,t=y(e=new FileReader),e.readAsText(r),t;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}function x(e,t){var r,n=(t=t||{}).body;if(e instanceof x){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=(r=(e=t.method||this.method||"GET").toUpperCase(),-1<u.indexOf(r)?r:e),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){var r;e&&(r=(e=e.split("=")).shift().replace(/\+/g," "),e=e.join("=").replace(/\+/g," "),t.append(decodeURIComponent(r),decodeURIComponent(e)))})),t}function _(e,t){t=t||{},this.type="default",this.status=void 0===t.status?200:t.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}e.fetch||(t="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,n="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in e,(s="ArrayBuffer"in e)&&(a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],i=function(e){return e&&DataView.prototype.isPrototypeOf(e)},l=ArrayBuffer.isView||function(e){return e&&-1<a.indexOf(Object.prototype.toString.call(e))}),f.prototype.append=function(e,t){e=d(e),t=h(t);var r=this.map[e];this.map[e]=r?r+","+t:t},f.prototype.delete=function(e){delete this.map[d(e)]},f.prototype.get=function(e){return e=d(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(d(e))},f.prototype.set=function(e,t){this.map[d(e)]=h(t)},f.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),p(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),p(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),p(e)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries),u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"],x.prototype.clone=function(){return new x(this,{body:this._bodyInit})},b.call(x.prototype),b.call(_.prototype),_.prototype.clone=function(){return new _(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},_.error=function(){var e=new _(null,{status:0,statusText:""});return e.type="error",e},c=[301,302,303,307,308],_.redirect=function(e,t){if(-1===c.indexOf(t))throw new RangeError("Invalid status code");return new _(null,{status:t,headers:{location:e}})},e.Headers=f,e.Request=x,e.Response=_,e.fetch=function(e,t){return new Promise((function(r,o){var s=new x(e,t),a=new XMLHttpRequest;a.onload=function(){var e,t={status:a.status,statusText:a.statusText,headers:(t=a.getAllResponseHeaders()||"",e=new f,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(t){var r=(t=t.split(":")).shift().trim();r&&(t=t.join(":").trim(),e.append(r,t))})),e)},n=(t.url="responseURL"in a?a.responseURL:t.headers.get("X-Request-URL"),"response"in a?a.response:a.responseText);r(new _(n,t))},a.onerror=function(){o(new TypeError("Network request failed"))},a.ontimeout=function(){o(new TypeError("Network request failed"))},a.open(s.method,s.url,!0),"include"===s.credentials?a.withCredentials=!0:"omit"===s.credentials&&(a.withCredentials=!1),"responseType"in a&&n&&(a.responseType="blob"),s.headers.forEach((function(e,t){a.setRequestHeader(t,e)})),a.send(void 0===s._bodyInit?null:s._bodyInit)}))},e.fetch.polyfill=!0)}("undefined"!=typeof self?self:this)},{}],252:[function(e,t,r){"use strict";e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o=a(e("../core/main")),s=a(e("../color/color_conversion"));function a(e){return e&&e.__esModule?e:{default:e}}var i=[{h:0,s:0,b:.8275,name:"gray"},{h:0,s:0,b:.8627,name:"gray"},{h:0,s:0,b:.7529,name:"gray"},{h:.0167,s:.1176,b:1,name:"light pink"}],l=[{h:0,s:0,b:0,name:"black"},{h:0,s:0,b:.5,name:"gray"},{h:0,s:0,b:1,name:"white"},{h:0,s:.5,b:.5,name:"dark maroon"},{h:0,s:.5,b:1,name:"salmon pink"},{h:0,s:1,b:0,name:"black"},{h:0,s:1,b:.5,name:"dark red"},{h:0,s:1,b:1,name:"red"},{h:5,s:0,b:1,name:"very light peach"},{h:5,s:.5,b:.5,name:"brown"},{h:5,s:.5,b:1,name:"peach"},{h:5,s:1,b:.5,name:"brick red"},{h:5,s:1,b:1,name:"crimson"},{h:10,s:0,b:1,name:"light peach"},{h:10,s:.5,b:.5,name:"brown"},{h:10,s:.5,b:1,name:"light orange"},{h:10,s:1,b:.5,name:"brown"},{h:10,s:1,b:1,name:"orange"},{h:15,s:0,b:1,name:"very light yellow"},{h:15,s:.5,b:.5,name:"olive green"},{h:15,s:.5,b:1,name:"light yellow"},{h:15,s:1,b:0,name:"dark olive green"},{h:15,s:1,b:.5,name:"olive green"},{h:15,s:1,b:1,name:"yellow"},{h:20,s:0,b:1,name:"very light yellow"},{h:20,s:.5,b:.5,name:"olive green"},{h:20,s:.5,b:1,name:"light yellow green"},{h:20,s:1,b:0,name:"dark olive green"},{h:20,s:1,b:.5,name:"dark yellow green"},{h:20,s:1,b:1,name:"yellow green"},{h:25,s:.5,b:.5,name:"dark yellow green"},{h:25,s:.5,b:1,name:"light green"},{h:25,s:1,b:.5,name:"dark green"},{h:25,s:1,b:1,name:"green"},{h:30,s:.5,b:1,name:"light green"},{h:30,s:1,b:.5,name:"dark green"},{h:30,s:1,b:1,name:"green"},{h:35,s:0,b:.5,name:"light green"},{h:35,s:0,b:1,name:"very light green"},{h:35,s:.5,b:.5,name:"dark green"},{h:35,s:.5,b:1,name:"light green"},{h:35,s:1,b:0,name:"very dark green"},{h:35,s:1,b:.5,name:"dark green"},{h:35,s:1,b:1,name:"green"},{h:40,s:0,b:1,name:"very light green"},{h:40,s:.5,b:.5,name:"dark green"},{h:40,s:.5,b:1,name:"light green"},{h:40,s:1,b:.5,name:"dark green"},{h:40,s:1,b:1,name:"green"},{h:45,s:.5,b:1,name:"light turquoise"},{h:45,s:1,b:.5,name:"dark turquoise"},{h:45,s:1,b:1,name:"turquoise"},{h:50,s:0,b:1,name:"light sky blue"},{h:50,s:.5,b:.5,name:"dark cyan"},{h:50,s:.5,b:1,name:"light cyan"},{h:50,s:1,b:.5,name:"dark cyan"},{h:50,s:1,b:1,name:"cyan"},{h:55,s:0,b:1,name:"light sky blue"},{h:55,s:.5,b:1,name:"light sky blue"},{h:55,s:1,b:.5,name:"dark blue"},{h:55,s:1,b:1,name:"sky blue"},{h:60,s:0,b:.5,name:"gray"},{h:60,s:0,b:1,name:"very light blue"},{h:60,s:.5,b:.5,name:"blue"},{h:60,s:.5,b:1,name:"light blue"},{h:60,s:1,b:.5,name:"navy blue"},{h:60,s:1,b:1,name:"blue"},{h:65,s:0,b:1,name:"lavender"},{h:65,s:.5,b:.5,name:"navy blue"},{h:65,s:.5,b:1,name:"light purple"},{h:65,s:1,b:.5,name:"dark navy blue"},{h:65,s:1,b:1,name:"blue"},{h:70,s:0,b:1,name:"lavender"},{h:70,s:.5,b:.5,name:"navy blue"},{h:70,s:.5,b:1,name:"lavender blue"},{h:70,s:1,b:.5,name:"dark navy blue"},{h:70,s:1,b:1,name:"blue"},{h:75,s:.5,b:1,name:"lavender"},{h:75,s:1,b:.5,name:"dark purple"},{h:75,s:1,b:1,name:"purple"},{h:80,s:.5,b:1,name:"pinkish purple"},{h:80,s:1,b:.5,name:"dark purple"},{h:80,s:1,b:1,name:"purple"},{h:85,s:0,b:1,name:"light pink"},{h:85,s:.5,b:.5,name:"purple"},{h:85,s:.5,b:1,name:"light fuchsia"},{h:85,s:1,b:.5,name:"dark fuchsia"},{h:85,s:1,b:1,name:"fuchsia"},{h:90,s:.5,b:.5,name:"dark fuchsia"},{h:90,s:.5,b:1,name:"hot pink"},{h:90,s:1,b:.5,name:"dark fuchsia"},{h:90,s:1,b:1,name:"fuchsia"},{h:95,s:0,b:1,name:"pink"},{h:95,s:.5,b:1,name:"light pink"},{h:95,s:1,b:.5,name:"dark magenta"},{h:95,s:1,b:1,name:"magenta"}];o.default.prototype._rgbColorName=function(e){e=s.default._rgbaToHSBA(e);var t,r,o=[(n=e)[0],e[1],e[2]];0!==o[0]&&(o[0]=Math.round(100*o[0]),(e=o[0].toString().split(""))[r=e.length-1]=parseInt(e[r]),e[r]<2.5?e[r]=0:2.5<=e[r]&&e[r]<7.5&&(e[r]=5),2===e.length?(e[0]=parseInt(e[0]),7.5<=e[r]&&(e[r]=0,e[0]=e[0]+1),o[0]=10*e[0]+e[1]):7.5<=e[r]?o[0]=10:o[0]=e[r]),o[2]=o[2]/255;for(var a=o.length-1;1<=a;a--)o[a]<=.25?o[a]=0:.25<o[a]&&o[a]<.75?o[a]=.5:o[a]=1;if(0===o[0]&&0===o[1]&&1===o[2]){for(var u=2;0<=u;u--)n[u]=Math.round(1e4*n[u])/1e4;for(var c=0;c<i.length;c++){if(i[c].h===n[0]&&i[c].s===n[1]&&i[c].b===n[2]){t=i[c].name;break}t="white"}}else for(var d=0;d<l.length;d++)if(l[d].h===o[0]&&l[d].s===o[1]&&l[d].b===o[2]){t=l[d].name;break}return t},e=o.default,r.default=e},{"../color/color_conversion":258,"../core/main":273,"core-js/modules/es.function.name":167,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.split":196}],253:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.replace"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e},o="_Description",s="_fallbackDesc",a="_fallbackTable",i="_Label",l="_labelDesc",u="_labelTable";function c(e){if("label"===e||"fallback"===e)throw new Error("description should not be LABEL or FALLBACK");return e.endsWith(".")||e.endsWith(";")||e.endsWith(",")||e.endsWith("?")||e.endsWith("!")||(e+="."),e}n.default.prototype.describe=function(e,t){var r;n.default._validateParameters("describe",arguments),"string"==typeof e&&(r=this.canvas.id,e=c(e),this.dummyDOM||(this.dummyDOM=document.getElementById(r).parentNode),this.descriptions||(this.descriptions={}),this.descriptions.fallback?this.descriptions.fallback.innerHTML!==e&&(this.descriptions.fallback.innerHTML=e):this._describeHTML("fallback",e),t===this.LABEL&&(this.descriptions.label?this.descriptions.label.innerHTML!==e&&(this.descriptions.label.innerHTML=e):this._describeHTML("label",e)))},n.default.prototype.describeElement=function(e,t,r){var o,s;n.default._validateParameters("describeElement",arguments),"string"==typeof t&&"string"==typeof e&&(o=this.canvas.id,t=c(t),s=function(e){if("label"===e||"fallback"===e)throw new Error("element name should not be LABEL or FALLBACK");return e.endsWith(".")||e.endsWith(";")||e.endsWith(",")?e=e.replace(/.$/,":"):e.endsWith(":")||(e+=":"),e}(e),e=e.replace(/[^a-zA-Z0-9]/g,""),s='<th scope="row">'.concat(s,"</th><td>").concat(t,"</td>"),this.dummyDOM||(this.dummyDOM=document.getElementById(o).parentNode),this.descriptions?this.descriptions.fallbackElements||(this.descriptions.fallbackElements={}):this.descriptions={fallbackElements:{}},this.descriptions.fallbackElements[e]?this.descriptions.fallbackElements[e].innerHTML!==s&&(this.descriptions.fallbackElements[e].innerHTML=s):this._describeElementHTML("fallback",e,s),r===this.LABEL&&(this.descriptions.labelElements||(this.descriptions.labelElements={}),this.descriptions.labelElements[e]?this.descriptions.labelElements[e].innerHTML!==s&&(this.descriptions.labelElements[e].innerHTML=s):this._describeElementHTML("label",e,s)))},n.default.prototype._describeHTML=function(e,t){var r,n=this.canvas.id;"fallback"===e?(this.dummyDOM.querySelector("#".concat(n+o))?this.dummyDOM.querySelector("#"+n+a).insertAdjacentHTML("beforebegin",'<p id="'.concat(n+s,'"></p>')):(r='<div id="'.concat(n).concat(o,'" role="region" aria-label="Canvas Description"><p id="').concat(n).concat(s,'"></p></div>'),this.dummyDOM.querySelector("#".concat(n,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(n,"accessibleOutput")).insertAdjacentHTML("beforebegin",r):this.dummyDOM.querySelector("#".concat(n)).innerHTML=r),this.descriptions.fallback=this.dummyDOM.querySelector("#".concat(n).concat(s)),this.descriptions.fallback.innerHTML=t):"label"===e&&(this.dummyDOM.querySelector("#".concat(n+i))?this.dummyDOM.querySelector("#".concat(n+u))&&this.dummyDOM.querySelector("#".concat(n+u)).insertAdjacentHTML("beforebegin",'<p id="'.concat(n).concat(l,'"></p>')):(r='<div id="'.concat(n).concat(i,'" class="p5Label"><p id="').concat(n).concat(l,'"></p></div>'),this.dummyDOM.querySelector("#".concat(n,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(n,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",r):this.dummyDOM.querySelector("#"+n).insertAdjacentHTML("afterend",r)),this.descriptions.label=this.dummyDOM.querySelector("#"+n+l),this.descriptions.label.innerHTML=t)},n.default.prototype._describeElementHTML=function(e,t,r){var n,c=this.canvas.id;"fallback"===e?(this.dummyDOM.querySelector("#".concat(c+o))?this.dummyDOM.querySelector("#"+c+a)||this.dummyDOM.querySelector("#"+c+s).insertAdjacentHTML("afterend",'<table id="'.concat(c).concat(a,'"><caption>Canvas elements and their descriptions</caption></table>')):(n='<div id="'.concat(c).concat(o,'" role="region" aria-label="Canvas Description"><table id="').concat(c).concat(a,'"><caption>Canvas elements and their descriptions</caption></table></div>'),this.dummyDOM.querySelector("#".concat(c,"accessibleOutput"))?this.dummyDOM.querySelector("#".concat(c,"accessibleOutput")).insertAdjacentHTML("beforebegin",n):this.dummyDOM.querySelector("#"+c).innerHTML=n),(n=document.createElement("tr")).id=c+"_fte_"+t,this.dummyDOM.querySelector("#"+c+a).appendChild(n),this.descriptions.fallbackElements[t]=this.dummyDOM.querySelector("#".concat(c).concat("_fte_").concat(t)),this.descriptions.fallbackElements[t].innerHTML=r):"label"===e&&(this.dummyDOM.querySelector("#".concat(c+i))?this.dummyDOM.querySelector("#".concat(c+u))||this.dummyDOM.querySelector("#"+c+l).insertAdjacentHTML("afterend",'<table id="'.concat(c+u,'"></table>')):(n='<div id="'.concat(c).concat(i,'" class="p5Label"><table id="').concat(c).concat(u,'"></table></div>'),this.dummyDOM.querySelector("#".concat(c,"accessibleOutputLabel"))?this.dummyDOM.querySelector("#".concat(c,"accessibleOutputLabel")).insertAdjacentHTML("beforebegin",n):this.dummyDOM.querySelector("#"+c).insertAdjacentHTML("afterend",n)),(e=document.createElement("tr")).id=c+"_lte_"+t,this.dummyDOM.querySelector("#"+c+u).appendChild(e),this.descriptions.labelElements[t]=this.dummyDOM.querySelector("#".concat(c).concat("_lte_").concat(t)),this.descriptions.labelElements[t].innerHTML=r)},e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.ends-with":188,"core-js/modules/es.string.replace":194}],254:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.map"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.map"),e("core-js/modules/es.string.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype._updateGridOutput=function(e){var t,r,n,o;this.dummyDOM.querySelector("#".concat(e,"_summary"))&&(t=this._accessibleOutputs[e],n=function(e,t,r,n){return t="".concat(t," canvas, ").concat(r," by ").concat(n," pixels, contains ").concat(e[0]),(1===e[0]?"".concat(t," shape: "):"".concat(t," shapes: ")).concat(e[1])}((r=function(e,t){var r,n="",o="",s=0;for(r in t){var a,i=0;for(a in t[r]){var l='<li id="'.concat(e,"shape").concat(s,'">').concat(t[r][a].color," ").concat(r,",");"line"===r?l+=" location = ".concat(t[r][a].pos,", length = ").concat(t[r][a].length," pixels"):(l+=" location = ".concat(t[r][a].pos),"point"!==r&&(l+=", area = ".concat(t[r][a].area," %")),l+="</li>"),n+=l,i++,s++}o=1<i?"".concat(o," ").concat(i," ").concat(r,"s"):"".concat(o," ").concat(i," ").concat(r)}return{numShapes:[s,o],details:n}}(e,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),o=function(e,t){var r,n,o=0,s="",a=Array.from(Array(10),(function(){return Array(10)}));for(r in t)for(var i in t[r]){var l;l="line"!==r?'<a href="#'.concat(e,"shape").concat(o,'">').concat(t[r][i].color," ").concat(r,"</a>"):'<a href="#'.concat(e,"shape").concat(o,'">').concat(t[r][i].color," ").concat(r," midpoint</a>"),a[t[r][i].loc.locY][t[r][i].loc.locX]?a[t[r][i].loc.locY][t[r][i].loc.locX]=a[t[r][i].loc.locY][t[r][i].loc.locX]+"  "+l:a[t[r][i].loc.locY][t[r][i].loc.locX]=l,o++}for(n in a){var u,c="<tr>";for(u in a[n])c+="<td>",void 0!==a[n][u]&&(c+=a[n][u]),c+="</td>";s=s+c+"</tr>"}return s}(e,this.ingredients.shapes),n!==t.summary.innerHTML&&(t.summary.innerHTML=n),o!==t.map.innerHTML&&(t.map.innerHTML=o),r.details!==t.shapeDetails.innerHTML&&(t.shapeDetails.innerHTML=r.details),this._accessibleOutputs[e]=t)},e=e.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.from":157,"core-js/modules/es.array.map":163,"core-js/modules/es.string.iterator":190}],255:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};function o(e,t,r){return 10===(t=Math.floor(e[0]/t*10))&&(t-=1),10===(e=Math.floor(e[1]/r*10))&&(e-=1),{locX:t,locY:e}}n.default.prototype.textOutput=function(e){n.default._validateParameters("textOutput",arguments),this._accessibleOutputs.text||(this._accessibleOutputs.text=!0,this._createOutput("textOutput","Fallback"),e===this.LABEL&&(this._accessibleOutputs.textLabel=!0,this._createOutput("textOutput","Label")))},n.default.prototype.gridOutput=function(e){n.default._validateParameters("gridOutput",arguments),this._accessibleOutputs.grid||(this._accessibleOutputs.grid=!0,this._createOutput("gridOutput","Fallback"),e===this.LABEL&&(this._accessibleOutputs.gridLabel=!0,this._createOutput("gridOutput","Label")))},n.default.prototype._addAccsOutput=function(){return this._accessibleOutputs||(this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1}),this._accessibleOutputs.grid||this._accessibleOutputs.text},n.default.prototype._createOutput=function(e,t){var r,n,o,s=this.canvas.id,a=(this.ingredients||(this.ingredients={shapes:{},colors:{background:"white",fill:"white",stroke:"black"},pShapes:""}),this.dummyDOM||(this.dummyDOM=document.getElementById(s).parentNode),"");"Fallback"===t?(r=s+e,this.dummyDOM.querySelector("#".concat(n=s+"accessibleOutput"))||(this.dummyDOM.querySelector("#".concat(s,"_Description"))?this.dummyDOM.querySelector("#".concat(s,"_Description")).insertAdjacentHTML("afterend",'<div id="'.concat(n,'" role="region" aria-label="Canvas Outputs"></div>')):this.dummyDOM.querySelector("#".concat(s)).innerHTML='<div id="'.concat(n,'" role="region" aria-label="Canvas Outputs"></div>'))):"Label"===t&&(r=s+e+(a=t),this.dummyDOM.querySelector("#".concat(n=s+"accessibleOutput"+t))||(this.dummyDOM.querySelector("#".concat(s,"_Label"))?this.dummyDOM.querySelector("#".concat(s,"_Label")):this.dummyDOM.querySelector("#".concat(s))).insertAdjacentHTML("afterend",'<div id="'.concat(n,'"></div>'))),this._accessibleOutputs[r]={},"textOutput"===e?(a="#".concat(s,"gridOutput").concat(a),o='<div id="'.concat(r,'">Text Output<div id="').concat(r,'Summary" aria-label="text output summary"><p id="').concat(r,'_summary"></p><ul id="').concat(r,'_list"></ul></div><table id="').concat(r,'_shapeDetails" summary="text output shape details"></table></div>'),this.dummyDOM.querySelector(a)?this.dummyDOM.querySelector(a).insertAdjacentHTML("beforebegin",o):this.dummyDOM.querySelector("#".concat(n)).innerHTML=o,this._accessibleOutputs[r].list=this.dummyDOM.querySelector("#".concat(r,"_list"))):"gridOutput"===e&&(a="#".concat(s,"textOutput").concat(a),o='<div id="'.concat(r,'">Grid Output<p id="').concat(r,'_summary" aria-label="grid output summary"><table id="').concat(r,'_map" summary="grid output content"></table><ul id="').concat(r,'_shapeDetails" aria-label="grid output shape details"></ul></div>'),this.dummyDOM.querySelector(a)?this.dummyDOM.querySelector(a).insertAdjacentHTML("afterend",o):this.dummyDOM.querySelector("#".concat(n)).innerHTML=o,this._accessibleOutputs[r].map=this.dummyDOM.querySelector("#".concat(r,"_map"))),this._accessibleOutputs[r].shapeDetails=this.dummyDOM.querySelector("#".concat(r,"_shapeDetails")),this._accessibleOutputs[r].summary=this.dummyDOM.querySelector("#".concat(r,"_summary"))},n.default.prototype._updateAccsOutput=function(){var e=this.canvas.id;JSON.stringify(this.ingredients.shapes)!==this.ingredients.pShapes&&(this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this._accessibleOutputs.text&&this._updateTextOutput(e+"textOutput"),this._accessibleOutputs.grid&&this._updateGridOutput(e+"gridOutput"),this._accessibleOutputs.textLabel&&this._updateTextOutput(e+"textOutputLabel"),this._accessibleOutputs.gridLabel&&this._updateGridOutput(e+"gridOutputLabel"))},n.default.prototype._accsBackground=function(e){this.ingredients.pShapes=JSON.stringify(this.ingredients.shapes),this.ingredients.shapes={},this.ingredients.colors.backgroundRGBA!==e&&(this.ingredients.colors.backgroundRGBA=e,this.ingredients.colors.background=this._rgbColorName(e))},n.default.prototype._accsCanvasColors=function(e,t){"fill"===e?this.ingredients.colors.fillRGBA!==t&&(this.ingredients.colors.fillRGBA=t,this.ingredients.colors.fill=this._rgbColorName(t)):"stroke"===e&&this.ingredients.colors.strokeRGBA!==t&&(this.ingredients.colors.strokeRGBA=t,this.ingredients.colors.stroke=this._rgbColorName(t))},n.default.prototype._accsOutput=function(e,t){"ellipse"===e&&t[2]===t[3]?e="circle":"rectangle"===e&&t[2]===t[3]&&(e="square");var r,n,s={},a=!0,i=function(e,t){var r;return e="rectangle"===e||"ellipse"===e||"arc"===e||"circle"===e||"square"===e?(r=Math.round(t[0]+t[2]/2),Math.round(t[1]+t[3]/2)):"triangle"===e?(r=(t[0]+t[2]+t[4])/3,(t[1]+t[3]+t[5])/3):"quadrilateral"===e?(r=(t[0]+t[2]+t[4]+t[6])/4,(t[1]+t[3]+t[5]+t[7])/4):"line"===e?(r=(t[0]+t[2])/2,(t[1]+t[3])/2):(r=t[0],t[1]),[r,e]}(e,t);if("line"===e?(s.color=this.ingredients.colors.stroke,s.length=Math.round(this.dist(t[0],t[1],t[2],t[3])),r=this._getPos(t[0],[1]),n=this._getPos(t[2],[3]),s.loc=o(i,this.width,this.height),s.pos=r===n?"at ".concat(r):"from ".concat(r," to ").concat(n)):("point"===e?s.color=this.ingredients.colors.stroke:(s.color=this.ingredients.colors.fill,s.area=this._getArea(e,t)),s.pos=this._getPos.apply(this,function(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(i)),s.loc=o(i,this.width,this.height)),this.ingredients.shapes[e]){if(this.ingredients.shapes[e]!==[s]){for(var l in this.ingredients.shapes[e])JSON.stringify(this.ingredients.shapes[e][l])===JSON.stringify(s)&&(a=!1);!0===a&&this.ingredients.shapes[e].push(s)}}else this.ingredients.shapes[e]=[s]},n.default.prototype._getPos=function(e,t){e=new DOMPointReadOnly(e,t),t=this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform(),t=(e=e.matrixTransform(t)).x,e=e.y;var r=this.width,n=this.height;return t<.4*r?e<.4*n?"top left":.6*n<e?"bottom left":"mid left":.6*r<t?e<.4*n?"top right":.6*n<e?"bottom right":"mid right":e<.4*n?"top middle":.6*n<e?"bottom middle":"middle"},n.default.prototype._getArea=function(e,t){var r,n,o=0,s=("arc"===e?(o=(r=((t[5]-t[4])%(2*Math.PI)+2*Math.PI)%(2*Math.PI))*t[2]*t[3]/8,"open"!==t[6]&&"chord"!==t[6]||(n=t[0],u=t[1],s=t[0]+t[2]/2*Math.cos(t[4]).toFixed(2),c=t[1]+t[3]/2*Math.sin(t[4]).toFixed(2),i=t[0]+t[2]/2*Math.cos(t[5]).toFixed(2),a=t[1]+t[3]/2*Math.sin(t[5]).toFixed(2),n=Math.abs(n*(c-a)+s*(a-u)+i*(u-c))/2,r>Math.PI?o+=n:o-=n)):"ellipse"===e||"circle"===e?o=3.14*t[2]/2*t[3]/2:"line"===e||"point"===e?o=0:"quadrilateral"===e?o=Math.abs((t[6]+t[0])*(t[7]-t[1])+(t[0]+t[2])*(t[1]-t[3])+(t[2]+t[4])*(t[3]-t[5])+(t[4]+t[6])*(t[5]-t[7]))/2:"rectangle"===e||"square"===e?o=t[2]*t[3]:"triangle"===e&&(o=Math.abs(t[0]*(t[3]-t[5])+t[2]*(t[5]-t[1])+t[4]*(t[1]-t[3]))/2),this.width*this._pixelDensity),a=this.height*this._pixelDensity,i=[new DOMPoint(0,0),new DOMPoint(s,0),new DOMPoint(s,a),new DOMPoint(0,a)],l=(this._renderer.isP3D?new DOMMatrix(this._renderer.uMVMatrix.mat4):this.drawingContext.getTransform()).inverse(),u=i.map((function(e){return e.matrixTransform(l)})),c=Math.abs((u[3].x+u[0].x)*(u[3].y-u[0].y)+(u[0].x+u[1].x)*(u[0].y-u[1].y)+(u[1].x+u[2].x)*(u[1].y-u[2].y)+(u[2].x+u[3].x)*(u[2].y-u[3].y))/2;return Math.round(100*o/c)},e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.from":157,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.map":163,"core-js/modules/es.number.to-fixed":173,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],256:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.concat"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype._updateTextOutput=function(e){var t,r,n,o;this.dummyDOM.querySelector("#".concat(e,"_summary"))&&(t=this._accessibleOutputs[e],n=function(e,t,r,n){return r="Your output is a, ".concat(r," by ").concat(n," pixels, ").concat(t," canvas containing the following"),1===e?"".concat(r," shape:"):"".concat(r," ").concat(e," shapes:")}((r=function(e,t){var r,n="",o=0;for(r in t)for(var s in t[r]){var a='<li><a href="#'.concat(e,"shape").concat(o,'">').concat(t[r][s].color," ").concat(r,"</a>");"line"===r?a+=", ".concat(t[r][s].pos,", ").concat(t[r][s].length," pixels long.</li>"):(a+=", at ".concat(t[r][s].pos),"point"!==r&&(a+=", covering ".concat(t[r][s].area,"% of the canvas")),a+=".</li>"),n+=a,o++}return{numShapes:o,listShapes:n}}(e,this.ingredients.shapes)).numShapes,this.ingredients.colors.background,this.width,this.height),o=function(e,t){var r,n="",o=0;for(r in t)for(var s in t[r]){var a='<tr id="'.concat(e,"shape").concat(o,'"><th>').concat(t[r][s].color," ").concat(r,"</th>");"line"===r?a+="<td>location = ".concat(t[r][s].pos,"</td><td>length = ").concat(t[r][s].length," pixels</td></tr>"):(a+="<td>location = ".concat(t[r][s].pos,"</td>"),"point"!==r&&(a+="<td> area = ".concat(t[r][s].area,"%</td>")),a+="</tr>"),n+=a,o++}return n}(e,this.ingredients.shapes),n!==t.summary.innerHTML&&(t.summary.innerHTML=n),r.listShapes!==t.list.innerHTML&&(t.list.innerHTML=r.listShapes),o!==t.shapeDetails.innerHTML&&(t.shapeDetails.innerHTML=o),this._accessibleOutputs[e]=t)},e=e.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151}],257:[function(e,t,r){"use strict";var n=(n=e("./core/main"))&&n.__esModule?n:{default:n};e("./core/constants"),e("./core/environment"),e("./core/friendly_errors/stacktrace"),e("./core/friendly_errors/validate_params"),e("./core/friendly_errors/file_errors"),e("./core/friendly_errors/fes_core"),e("./core/friendly_errors/sketch_reader"),e("./core/helpers"),e("./core/legacy"),e("./core/preload"),e("./core/p5.Element"),e("./core/p5.Graphics"),e("./core/p5.Renderer"),e("./core/p5.Renderer2D"),e("./core/rendering"),e("./core/shim"),e("./core/structure"),e("./core/transform"),e("./core/shape/2d_primitives"),e("./core/shape/attributes"),e("./core/shape/curves"),e("./core/shape/vertex"),e("./accessibility/outputs"),e("./accessibility/textOutput"),e("./accessibility/gridOutput"),e("./accessibility/color_namer"),e("./color/color_conversion"),e("./color/creating_reading"),e("./color/p5.Color"),e("./color/setting"),e("./data/p5.TypedDict"),e("./data/local_storage.js"),e("./dom/dom"),e("./accessibility/describe"),e("./events/acceleration"),e("./events/keyboard"),e("./events/mouse"),e("./events/touch"),e("./image/filters"),e("./image/image"),e("./image/loading_displaying"),e("./image/p5.Image"),e("./image/pixels"),e("./io/files"),e("./io/p5.Table"),e("./io/p5.TableRow"),e("./io/p5.XML"),e("./math/calculation"),e("./math/math"),e("./math/noise"),e("./math/p5.Vector"),e("./math/random"),e("./math/trigonometry"),e("./typography/attributes"),e("./typography/loading_displaying"),e("./typography/p5.Font"),e("./utilities/array_functions"),e("./utilities/conversion"),e("./utilities/string_functions"),e("./utilities/time_date"),e("./webgl/3d_primitives"),e("./webgl/interaction"),e("./webgl/light"),e("./webgl/loading"),e("./webgl/material"),e("./webgl/p5.Camera"),e("./webgl/p5.Geometry"),e("./webgl/p5.Matrix"),e("./webgl/p5.RendererGL.Immediate"),e("./webgl/p5.RendererGL"),e("./webgl/p5.RendererGL.Retained"),e("./webgl/p5.Framebuffer"),e("./webgl/p5.Shader"),e("./webgl/p5.RenderBuffer"),e("./webgl/p5.Texture"),e("./webgl/text"),e("./core/init"),t.exports=n.default},{"./accessibility/color_namer":252,"./accessibility/describe":253,"./accessibility/gridOutput":254,"./accessibility/outputs":255,"./accessibility/textOutput":256,"./color/color_conversion":258,"./color/creating_reading":259,"./color/p5.Color":260,"./color/setting":261,"./core/constants":262,"./core/environment":263,"./core/friendly_errors/fes_core":264,"./core/friendly_errors/file_errors":265,"./core/friendly_errors/sketch_reader":266,"./core/friendly_errors/stacktrace":267,"./core/friendly_errors/validate_params":268,"./core/helpers":269,"./core/init":270,"./core/legacy":272,"./core/main":273,"./core/p5.Element":274,"./core/p5.Graphics":275,"./core/p5.Renderer":276,"./core/p5.Renderer2D":277,"./core/preload":278,"./core/rendering":279,"./core/shape/2d_primitives":280,"./core/shape/attributes":281,"./core/shape/curves":282,"./core/shape/vertex":283,"./core/shim":284,"./core/structure":285,"./core/transform":286,"./data/local_storage.js":287,"./data/p5.TypedDict":288,"./dom/dom":289,"./events/acceleration":290,"./events/keyboard":291,"./events/mouse":292,"./events/touch":293,"./image/filters":294,"./image/image":295,"./image/loading_displaying":296,"./image/p5.Image":297,"./image/pixels":298,"./io/files":299,"./io/p5.Table":300,"./io/p5.TableRow":301,"./io/p5.XML":302,"./math/calculation":303,"./math/math":304,"./math/noise":305,"./math/p5.Vector":306,"./math/random":307,"./math/trigonometry":308,"./typography/attributes":309,"./typography/loading_displaying":310,"./typography/p5.Font":311,"./utilities/array_functions":312,"./utilities/conversion":313,"./utilities/string_functions":314,"./utilities/time_date":315,"./webgl/3d_primitives":316,"./webgl/interaction":317,"./webgl/light":318,"./webgl/loading":319,"./webgl/material":320,"./webgl/p5.Camera":321,"./webgl/p5.Framebuffer":322,"./webgl/p5.Geometry":323,"./webgl/p5.Matrix":324,"./webgl/p5.RenderBuffer":325,"./webgl/p5.RendererGL":328,"./webgl/p5.RendererGL.Immediate":326,"./webgl/p5.RendererGL.Retained":327,"./webgl/p5.Shader":329,"./webgl/p5.Texture":330,"./webgl/text":331}],258:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.ColorConversion={_hsbaToHSLA:function(e){var t=e[0],r=e[1],n=e[2],o=(2-r)*n/2;return 0!=o&&(1==o?r=0:o<.5?r/=2-r:r=r*n/(2-2*o)),[t,r,o,e[3]]},_hsbaToRGBA:function(e){var t,r,n,o,s,a=6*e[0],i=e[1],l=e[2];return 0===i?[l,l,l,e[3]]:(r=l*(1-i),n=l*(1-i*(a-(t=Math.floor(a)))),i=l*(1-i*(1+t-a)),a=1===t?(o=n,s=l,r):2===t?(o=r,s=l,i):3===t?(o=r,s=n,l):4===t?(o=i,s=r,l):5===t?(o=l,s=r,n):(o=l,s=i,r),[o,s,a,e[3]])},_hslaToHSBA:function(e){var t=e[0],r=e[1],n=e[2],o=n<.5?(1+r)*n:n+r-n*r;return[t,r=2*(o-n)/o,o,e[3]]},_hslaToRGBA:function(e){var t,r=6*e[0],n=e[1],o=e[2];return 0===n?[o,o,o,e[3]]:[(t=function(e,t,r){return e<0?e+=6:6<=e&&(e-=6),e<1?t+(r-t)*e:e<3?r:e<4?t+(r-t)*(4-e):t})(2+r,n=2*o-(o=o<.5?(1+n)*o:o+n-o*n),o),t(r,n,o),t(r-2,n,o),e[3]]},_rgbaToHSBA:function(e){var t,r,n=e[0],o=e[1],s=e[2],a=Math.max(n,o,s),i=a-Math.min(n,o,s);return 0==i?r=t=0:(r=i/a,n===a?t=(o-s)/i:o===a?t=2+(s-n)/i:s===a&&(t=4+(n-o)/i),t<0?t+=6:6<=t&&(t-=6)),[t/6,r,a,e[3]]},_rgbaToHSLA:function(e){var t,r,n,o=e[0],s=e[1],a=e[2],i=Math.max(o,s,a),l=i+(n=Math.min(o,s,a));return 0==(n=i-n)?r=t=0:(r=l<1?n/l:n/(2-l),o===i?t=(s-a)/n:s===i?t=2+(a-o)/n:a===i&&(t=4+(o-s)/n),t<0?t+=6:6<=t&&(t-=6)),[t/6,r,l/2,e[3]]}},e=e.default.ColorConversion,r.default=e},{"../core/main":273}],259:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.map"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}e("./p5.Color"),e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),s.default.prototype.alpha=function(e){return s.default._validateParameters("alpha",arguments),this.color(e)._getAlpha()},s.default.prototype.blue=function(e){return s.default._validateParameters("blue",arguments),this.color(e)._getBlue()},s.default.prototype.brightness=function(e){return s.default._validateParameters("brightness",arguments),this.color(e)._getBrightness()},s.default.prototype.color=function(){var e;return s.default._validateParameters("color",arguments),arguments[0]instanceof s.default.Color?arguments[0]:(e=arguments[0]instanceof Array?arguments[0]:arguments,new s.default.Color(this,e))},s.default.prototype.green=function(e){return s.default._validateParameters("green",arguments),this.color(e)._getGreen()},s.default.prototype.hue=function(e){return s.default._validateParameters("hue",arguments),this.color(e)._getHue()},s.default.prototype.lerpColor=function(e,t,r){s.default._validateParameters("lerpColor",arguments);var n,o,i,l=this._colorMode,u=this._colorMaxes;if(l===a.RGB)o=e.levels.map((function(e){return e/255})),i=t.levels.map((function(e){return e/255}));else if(l===a.HSB)e._getBrightness(),t._getBrightness(),o=e.hsba,i=t.hsba;else{if(l!==a.HSL)throw new Error("".concat(l,"cannot be used for interpolation."));e._getLightness(),t._getLightness(),o=e.hsla,i=t.hsla}return r=Math.max(Math.min(r,1),0),void 0===this.lerp&&(this.lerp=function(e,t,r){return r*(t-e)+e}),e=this.lerp(o[0],i[0],r),t=this.lerp(o[1],i[1],r),n=this.lerp(o[2],i[2],r),o=this.lerp(o[3],i[3],r),e*=u[l][0],t*=u[l][1],n*=u[l][2],o*=u[l][3],this.color(e,t,n,o)},s.default.prototype.lightness=function(e){return s.default._validateParameters("lightness",arguments),this.color(e)._getLightness()},s.default.prototype.red=function(e){return s.default._validateParameters("red",arguments),this.color(e)._getRed()},s.default.prototype.saturation=function(e){return s.default._validateParameters("saturation",arguments),this.color(e)._getSaturation()};var l=s.default;r.default=l},{"../core/constants":262,"../core/friendly_errors/fes_core":264,"../core/friendly_errors/file_errors":265,"../core/friendly_errors/validate_params":268,"../core/main":273,"./p5.Color":260,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.map":163,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],260:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.trim"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=u(e("../core/main")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")),i=u(e("./color_conversion"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var d={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},h=(e=/\s*/,/(\d{1,3})/),p=/((?:\d+(?:\.\d+)?)|(?:\.\d+))/,f=new RegExp("".concat(p.source,"%")),m={HEX3:/^#([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX4:/^#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])$/i,HEX6:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,HEX8:/^#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i,RGB:new RegExp(["^rgb\\(",h.source,",",h.source,",",h.source,"\\)$"].join(e.source),"i"),RGB_PERCENT:new RegExp(["^rgb\\(",f.source,",",f.source,",",f.source,"\\)$"].join(e.source),"i"),RGBA:new RegExp(["^rgba\\(",h.source,",",h.source,",",h.source,",",p.source,"\\)$"].join(e.source),"i"),RGBA_PERCENT:new RegExp(["^rgba\\(",f.source,",",f.source,",",f.source,",",p.source,"\\)$"].join(e.source),"i"),HSL:new RegExp(["^hsl\\(",h.source,",",f.source,",",f.source,"\\)$"].join(e.source),"i"),HSLA:new RegExp(["^hsla\\(",h.source,",",f.source,",",f.source,",",p.source,"\\)$"].join(e.source),"i"),HSB:new RegExp(["^hsb\\(",h.source,",",f.source,",",f.source,"\\)$"].join(e.source),"i"),HSBA:new RegExp(["^hsba\\(",h.source,",",f.source,",",f.source,",",p.source,"\\)$"].join(e.source),"i")};s.default.Color=function(){function e(t,r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");if(this._storeModeAndMaxes(t._colorMode,t._colorMaxes),![a.RGB,a.HSL,a.HSB].includes(this.mode))throw new Error("".concat(this.mode," is an invalid colorMode."));this._array=e._parseInputs.apply(this,r),this._calculateLevels()}var t,r,n;return t=e,n=[{key:"_parseInputs",value:function(t,r,n,o){var s,l=arguments.length,u=this.mode,c=this.maxes[u],h=[];if(3<=l){for(h[0]=t/c[0],h[1]=r/c[1],h[2]=n/c[2],h[3]="number"==typeof o?o/c[3]:1,s=h.length-1;0<=s;--s){var p=h[s];p<0?h[s]=0:1<p&&(h[s]=1)}return u===a.HSL?i.default._hslaToRGBA(h):u===a.HSB?i.default._hsbaToRGBA(h):h}if(1===l&&"string"==typeof t){if(n=t.trim().toLowerCase(),d[n])return e._parseInputs.call(this,d[n]);if(m.HEX3.test(n))return(h=m.HEX3.exec(n).slice(1).map((function(e){return parseInt(e+e,16)/255})))[3]=1,h;if(m.HEX6.test(n))return(h=m.HEX6.exec(n).slice(1).map((function(e){return parseInt(e,16)/255})))[3]=1,h;if(m.HEX4.test(n))return m.HEX4.exec(n).slice(1).map((function(e){return parseInt(e+e,16)/255}));if(m.HEX8.test(n))return m.HEX8.exec(n).slice(1).map((function(e){return parseInt(e,16)/255}));if(m.RGB.test(n))return(h=m.RGB.exec(n).slice(1).map((function(e){return e/255})))[3]=1,h;if(m.RGB_PERCENT.test(n))return(h=m.RGB_PERCENT.exec(n).slice(1).map((function(e){return parseFloat(e)/100})))[3]=1,h;if(m.RGBA.test(n))return m.RGBA.exec(n).slice(1).map((function(e,t){return 3===t?parseFloat(e):e/255}));if(m.RGBA_PERCENT.test(n))return m.RGBA_PERCENT.exec(n).slice(1).map((function(e,t){return 3===t?parseFloat(e):parseFloat(e)/100}));if(m.HSL.test(n)?(h=m.HSL.exec(n).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:parseInt(e,10)/100})))[3]=1:m.HSLA.test(n)&&(h=m.HSLA.exec(n).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:3===t?parseFloat(e):parseInt(e,10)/100}))),(h=h.map((function(e){return Math.max(Math.min(e,1),0)}))).length)return i.default._hslaToRGBA(h);if(m.HSB.test(n)?(h=m.HSB.exec(n).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:parseInt(e,10)/100})))[3]=1:m.HSBA.test(n)&&(h=m.HSBA.exec(n).slice(1).map((function(e,t){return 0===t?parseInt(e,10)/360:3===t?parseFloat(e):parseInt(e,10)/100}))),h.length){for(s=h.length-1;0<=s;--s)h[s]=Math.max(Math.min(h[s],1),0);return i.default._hsbaToRGBA(h)}h=[1,1,1,1]}else{if(1!==l&&2!==l||"number"!=typeof t)throw new Error("".concat(arguments,"is not a valid color representation."));h[0]=t/c[2],h[1]=t/c[2],h[2]=t/c[2],h[3]="number"==typeof r?r/c[3]:1,h=h.map((function(e){return Math.max(Math.min(e,1),0)}))}return h}}],(r=[{key:"toString",value:function(e){var t=this.levels,r=this._array,n=r[3];switch(e){case"#rrggbb":return"#".concat(t[0]<16?"0".concat(t[0].toString(16)):t[0].toString(16),t[1]<16?"0".concat(t[1].toString(16)):t[1].toString(16),t[2]<16?"0".concat(t[2].toString(16)):t[2].toString(16));case"#rrggbbaa":return"#".concat(t[0]<16?"0".concat(t[0].toString(16)):t[0].toString(16),t[1]<16?"0".concat(t[1].toString(16)):t[1].toString(16),t[2]<16?"0".concat(t[2].toString(16)):t[2].toString(16),t[3]<16?"0".concat(t[3].toString(16)):t[3].toString(16));case"#rgb":return"#".concat(Math.round(15*r[0]).toString(16),Math.round(15*r[1]).toString(16),Math.round(15*r[2]).toString(16));case"#rgba":return"#".concat(Math.round(15*r[0]).toString(16),Math.round(15*r[1]).toString(16),Math.round(15*r[2]).toString(16),Math.round(15*r[3]).toString(16));case"rgb":return"rgb(".concat(t[0],", ",t[1],", ",t[2],")");case"rgb%":return"rgb(".concat((100*r[0]).toPrecision(3),"%, ",(100*r[1]).toPrecision(3),"%, ",(100*r[2]).toPrecision(3),"%)");case"rgba%":return"rgba(".concat((100*r[0]).toPrecision(3),"%, ",(100*r[1]).toPrecision(3),"%, ",(100*r[2]).toPrecision(3),"%, ",(100*r[3]).toPrecision(3),"%)");case"hsb":case"hsv":return this.hsba||(this.hsba=i.default._rgbaToHSBA(this._array)),"hsb(".concat(this.hsba[0]*this.maxes[a.HSB][0],", ",this.hsba[1]*this.maxes[a.HSB][1],", ",this.hsba[2]*this.maxes[a.HSB][2],")");case"hsb%":case"hsv%":return this.hsba||(this.hsba=i.default._rgbaToHSBA(this._array)),"hsb(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%)");case"hsba":case"hsva":return this.hsba||(this.hsba=i.default._rgbaToHSBA(this._array)),"hsba(".concat(this.hsba[0]*this.maxes[a.HSB][0],", ",this.hsba[1]*this.maxes[a.HSB][1],", ",this.hsba[2]*this.maxes[a.HSB][2],", ",n,")");case"hsba%":case"hsva%":return this.hsba||(this.hsba=i.default._rgbaToHSBA(this._array)),"hsba(".concat((100*this.hsba[0]).toPrecision(3),"%, ",(100*this.hsba[1]).toPrecision(3),"%, ",(100*this.hsba[2]).toPrecision(3),"%, ",(100*n).toPrecision(3),"%)");case"hsl":return this.hsla||(this.hsla=i.default._rgbaToHSLA(this._array)),"hsl(".concat(this.hsla[0]*this.maxes[a.HSL][0],", ",this.hsla[1]*this.maxes[a.HSL][1],", ",this.hsla[2]*this.maxes[a.HSL][2],")");case"hsl%":return this.hsla||(this.hsla=i.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%)");case"hsla":return this.hsla||(this.hsla=i.default._rgbaToHSLA(this._array)),"hsla(".concat(this.hsla[0]*this.maxes[a.HSL][0],", ",this.hsla[1]*this.maxes[a.HSL][1],", ",this.hsla[2]*this.maxes[a.HSL][2],", ",n,")");case"hsla%":return this.hsla||(this.hsla=i.default._rgbaToHSLA(this._array)),"hsl(".concat((100*this.hsla[0]).toPrecision(3),"%, ",(100*this.hsla[1]).toPrecision(3),"%, ",(100*this.hsla[2]).toPrecision(3),"%, ",(100*n).toPrecision(3),"%)");default:return"rgba(".concat(t[0],",",t[1],",",t[2],",",n,")")}}},{key:"setRed",value:function(e){this._array[0]=e/this.maxes[a.RGB][0],this._calculateLevels()}},{key:"setGreen",value:function(e){this._array[1]=e/this.maxes[a.RGB][1],this._calculateLevels()}},{key:"setBlue",value:function(e){this._array[2]=e/this.maxes[a.RGB][2],this._calculateLevels()}},{key:"setAlpha",value:function(e){this._array[3]=e/this.maxes[this.mode][3],this._calculateLevels()}},{key:"_calculateLevels",value:function(){for(var e=this._array,t=this.levels=new Array(e.length),r=e.length-1;0<=r;--r)t[r]=Math.round(255*e[r]);this.hsla=null,this.hsba=null}},{key:"_getAlpha",value:function(){return this._array[3]*this.maxes[this.mode][3]}},{key:"_storeModeAndMaxes",value:function(e,t){this.mode=e,this.maxes=t}},{key:"_getMode",value:function(){return this.mode}},{key:"_getMaxes",value:function(){return this.maxes}},{key:"_getBlue",value:function(){return this._array[2]*this.maxes[a.RGB][2]}},{key:"_getBrightness",value:function(){return this.hsba||(this.hsba=i.default._rgbaToHSBA(this._array)),this.hsba[2]*this.maxes[a.HSB][2]}},{key:"_getGreen",value:function(){return this._array[1]*this.maxes[a.RGB][1]}},{key:"_getHue",value:function(){return this.mode===a.HSB?(this.hsba||(this.hsba=i.default._rgbaToHSBA(this._array)),this.hsba[0]*this.maxes[a.HSB][0]):(this.hsla||(this.hsla=i.default._rgbaToHSLA(this._array)),this.hsla[0]*this.maxes[a.HSL][0])}},{key:"_getLightness",value:function(){return this.hsla||(this.hsla=i.default._rgbaToHSLA(this._array)),this.hsla[2]*this.maxes[a.HSL][2]}},{key:"_getRed",value:function(){return this._array[0]*this.maxes[a.RGB][0]}},{key:"_getSaturation",value:function(){return this.mode===a.HSB?(this.hsba||(this.hsba=i.default._rgbaToHSBA(this._array)),this.hsba[1]*this.maxes[a.HSB][1]):(this.hsla||(this.hsla=i.default._rgbaToHSLA(this._array)),this.hsla[1]*this.maxes[a.HSL][1])}}])&&c(t.prototype,r),n&&c(t,n),e}(),h=s.default.Color,r.default=h},{"../core/constants":262,"../core/main":273,"./color_conversion":258,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.constructor":184,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.trim":199,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],261:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.fill"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}e("./p5.Color"),s.default.prototype.background=function(){var e;return(e=this._renderer).background.apply(e,arguments),this},s.default.prototype.clear=function(){return this._renderer.clear((arguments.length<=0?void 0:arguments[0])||0,(arguments.length<=1?void 0:arguments[1])||0,(arguments.length<=2?void 0:arguments[2])||0,(arguments.length<=3?void 0:arguments[3])||0),this},s.default.prototype.colorMode=function(e,t,r,n,o){return s.default._validateParameters("colorMode",arguments),e!==a.RGB&&e!==a.HSB&&e!==a.HSL||(this._colorMode=e,e=this._colorMaxes[e],2===arguments.length?(e[0]=t,e[1]=t,e[2]=t,e[3]=t):4===arguments.length?(e[0]=t,e[1]=r,e[2]=n):5===arguments.length&&(e[0]=t,e[1]=r,e[2]=n,e[3]=o)),this},s.default.prototype.fill=function(){var e;return this._renderer._setProperty("_fillSet",!0),this._renderer._setProperty("_doFill",!0),(e=this._renderer).fill.apply(e,arguments),this},s.default.prototype.noFill=function(){return this._renderer._setProperty("_doFill",!1),this},s.default.prototype.noStroke=function(){return this._renderer._setProperty("_doStroke",!1),this},s.default.prototype.stroke=function(){var e;return this._renderer._setProperty("_strokeSet",!0),this._renderer._setProperty("_doStroke",!0),(e=this._renderer).stroke.apply(e,arguments),this},s.default.prototype.erase=function(){return this._renderer.erase(0<arguments.length&&void 0!==arguments[0]?arguments[0]:255,1<arguments.length&&void 0!==arguments[1]?arguments[1]:255),this},s.default.prototype.noErase=function(){return this._renderer.noErase(),this};var l=s.default;r.default=l},{"../core/constants":262,"../core/main":273,"./p5.Color":260,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],262:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.QUADRATIC=r.LINEAR=r._CTX_MIDDLE=r._DEFAULT_LEADMULT=r._DEFAULT_TEXT_FILL=r.WORD=r.CHAR=r.BOLDITALIC=r.BOLD=r.ITALIC=r.NORMAL=r.BLUR=r.ERODE=r.DILATE=r.POSTERIZE=r.INVERT=r.OPAQUE=r.GRAY=r.THRESHOLD=r.BURN=r.DODGE=r.SOFT_LIGHT=r.HARD_LIGHT=r.OVERLAY=r.REPLACE=r.SCREEN=r.MULTIPLY=r.EXCLUSION=r.SUBTRACT=r.DIFFERENCE=r.LIGHTEST=r.DARKEST=r.ADD=r.REMOVE=r.BLEND=r.UP_ARROW=r.TAB=r.SHIFT=r.RIGHT_ARROW=r.RETURN=r.OPTION=r.LEFT_ARROW=r.ESCAPE=r.ENTER=r.DOWN_ARROW=r.DELETE=r.CONTROL=r.BACKSPACE=r.ALT=r.AUTO=r.HSL=r.HSB=r.RGB=r.MITER=r.BEVEL=r.ROUND=r.SQUARE=r.PROJECT=r.PIE=r.CHORD=r.OPEN=r.CLOSE=r.TESS=r.QUAD_STRIP=r.QUADS=r.TRIANGLE_STRIP=r.TRIANGLE_FAN=r.TRIANGLES=r.LINE_LOOP=r.LINE_STRIP=r.LINES=r.POINTS=r.BASELINE=r.BOTTOM=r.TOP=r.CENTER=r.LEFT=r.RIGHT=r.RADIUS=r.CORNERS=r.CORNER=r.RAD_TO_DEG=r.DEG_TO_RAD=r.RADIANS=r.DEGREES=r.TWO_PI=r.TAU=r.QUARTER_PI=r.PI=r.HALF_PI=r.WAIT=r.TEXT=r.MOVE=r.HAND=r.CROSS=r.ARROW=r.WEBGL2=r.WEBGL=r.P2D=r.VERSION=void 0,r.RGBA=r.HALF_FLOAT=r.FLOAT=r.UNSIGNED_INT=r.UNSIGNED_BYTE=r.COVER=r.CONTAIN=r.FALLBACK=r.LABEL=r.AXES=r.GRID=r._DEFAULT_FILL=r._DEFAULT_STROKE=r.PORTRAIT=r.LANDSCAPE=r.MIRROR=r.CLAMP=r.REPEAT=r.NEAREST=r.IMAGE=r.IMMEDIATE=r.TEXTURE=r.FILL=r.STROKE=r.CURVE=r.BEZIER=void 0;var n=Math.PI,o=(r.VERSION="1.7.0",r.P2D="p2d",r.WEBGL="webgl",r.WEBGL2="webgl2",r.ARROW="default",r.CROSS="crosshair",r.HAND="pointer",r.MOVE="move",r.TEXT="text",r.WAIT="wait",n/2);r.HALF_PI=o,o=n,r.PI=o,o=n/4,r.QUARTER_PI=o,o=2*n,r.TAU=o,o=2*n,r.TWO_PI=o,r.DEGREES="degrees",r.RADIANS="radians",o=n/180,r.DEG_TO_RAD=o,o=180/n,r.RAD_TO_DEG=o,r.CORNER="corner",r.CORNERS="corners",r.RADIUS="radius",r.RIGHT="right",r.LEFT="left",r.CENTER="center",r.TOP="top",r.BOTTOM="bottom",r.BASELINE="alphabetic",r.POINTS=0,r.LINES=1,r.LINE_STRIP=3,r.LINE_LOOP=2,r.TRIANGLES=4,r.TRIANGLE_FAN=6,r.TRIANGLE_STRIP=5,r.QUADS="quads",r.QUAD_STRIP="quad_strip",r.TESS="tess",r.CLOSE="close",r.OPEN="open",r.CHORD="chord",r.PIE="pie",r.PROJECT="square",r.SQUARE="butt",r.ROUND="round",r.BEVEL="bevel",r.MITER="miter",r.RGB="rgb",r.HSB="hsb",r.HSL="hsl",r.AUTO="auto",r.ALT=18,r.BACKSPACE=8,r.CONTROL=17,r.DELETE=46,r.DOWN_ARROW=40,r.ENTER=13,r.ESCAPE=27,r.LEFT_ARROW=37,r.OPTION=18,r.RETURN=13,r.RIGHT_ARROW=39,r.SHIFT=16,r.TAB=9,r.UP_ARROW=38,r.BLEND="source-over",r.REMOVE="destination-out",r.ADD="lighter",r.DARKEST="darken",r.LIGHTEST="lighten",r.DIFFERENCE="difference",r.SUBTRACT="subtract",r.EXCLUSION="exclusion",r.MULTIPLY="multiply",r.SCREEN="screen",r.REPLACE="copy",r.OVERLAY="overlay",r.HARD_LIGHT="hard-light",r.SOFT_LIGHT="soft-light",r.DODGE="color-dodge",r.BURN="color-burn",r.THRESHOLD="threshold",r.GRAY="gray",r.OPAQUE="opaque",r.INVERT="invert",r.POSTERIZE="posterize",r.DILATE="dilate",r.ERODE="erode",r.BLUR="blur",r.NORMAL="normal",r.ITALIC="italic",r.BOLD="bold",r.BOLDITALIC="bold italic",r.CHAR="CHAR",r.WORD="WORD",r._DEFAULT_TEXT_FILL="#000000",r._DEFAULT_LEADMULT=1.25,r._CTX_MIDDLE="middle",r.LINEAR="linear",r.QUADRATIC="quadratic",r.BEZIER="bezier",r.CURVE="curve",r.STROKE="stroke",r.FILL="fill",r.TEXTURE="texture",r.IMMEDIATE="immediate",r.IMAGE="image",r.NEAREST="nearest",r.REPEAT="repeat",r.CLAMP="clamp",r.MIRROR="mirror",r.LANDSCAPE="landscape",r.PORTRAIT="portrait",r._DEFAULT_STROKE="#000000",r._DEFAULT_FILL="#FFFFFF",r.GRID="grid",r.AXES="axes",r.LABEL="label",r.FALLBACK="fallback",r.CONTAIN="contain",r.COVER="cover",r.UNSIGNED_BYTE="unsigned-byte",r.UNSIGNED_INT="unsigned-int",r.FLOAT="float",r.HALF_FLOAT="half-float",r.RGBA="rgba"},{}],263:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.search"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.search"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(a=e("./main"))&&a.__esModule?a:{default:a},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}var l=[a.ARROW,a.CROSS,a.HAND,a.MOVE,a.TEXT,a.WAIT],u=(s.default.prototype._frameRate=0,s.default.prototype._lastFrameTime=window.performance.now(),s.default.prototype._targetFrameRate=60,window.print);function c(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth||0}function d(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight||0}s.default.prototype.print=function(){var e;arguments.length?(e=console).log.apply(e,arguments):u()},s.default.prototype.frameCount=0,s.default.prototype.deltaTime=0,s.default.prototype.focused=document.hasFocus(),s.default.prototype.cursor=function(e,t,r){var n,o="auto",s=this._curElement.elt;l.includes(e)?o=e:"string"==typeof e&&(n="",t&&r&&"number"==typeof t&&"number"==typeof r&&(n="".concat(t," ").concat(r)),o="http://"===e.substring(0,7)||"https://"===e.substring(0,8)||/\.(cur|jpg|jpeg|gif|png|CUR|JPG|JPEG|GIF|PNG)$/.test(e)?"url(".concat(e,") ").concat(n,", auto"):e),s.style.cursor=o},s.default.prototype.frameRate=function(e){return s.default._validateParameters("frameRate",arguments),"number"!=typeof e||e<0?this._frameRate:(this._setProperty("_targetFrameRate",e),0===e&&this._setProperty("_frameRate",e),this)},s.default.prototype.getFrameRate=function(){return this.frameRate()},s.default.prototype.setFrameRate=function(e){return this.frameRate(e)},s.default.prototype.getTargetFrameRate=function(){return this._targetFrameRate},s.default.prototype.noCursor=function(){this._curElement.elt.style.cursor="none"},s.default.prototype.webglVersion=a.P2D,s.default.prototype.displayWidth=screen.width,s.default.prototype.displayHeight=screen.height,s.default.prototype.windowWidth=c(),s.default.prototype.windowHeight=d(),s.default.prototype._onresize=function(e){this._setProperty("windowWidth",c()),this._setProperty("windowHeight",d());var t=this._isGlobal?window:this;"function"!=typeof t.windowResized||void 0===(t=t.windowResized(e))||t||e.preventDefault()},s.default.prototype.width=0,s.default.prototype.height=0,s.default.prototype.fullscreen=function(e){if(s.default._validateParameters("fullscreen",arguments),void 0===e)return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;if(e){if(e=document.documentElement,!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled))throw new Error("Fullscreen not enabled in this browser.");e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen()}else document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},s.default.prototype.pixelDensity=function(e){var t;return s.default._validateParameters("pixelDensity",arguments),"number"==typeof e?(e!==this._pixelDensity&&(this._pixelDensity=e),(t=this).resizeCanvas(this.width,this.height,!0)):t=this._pixelDensity,t},s.default.prototype.displayDensity=function(){return window.devicePixelRatio},s.default.prototype.getURL=function(){return location.href},s.default.prototype.getURLPath=function(){return location.pathname.split("/").filter((function(e){return""!==e}))},s.default.prototype.getURLParams=function(){for(var e,t=/[?&]([^&=]+)(?:[&=])([^&=]+)/gim,r={};null!=(e=t.exec(location.search));)e.index===t.lastIndex&&t.lastIndex++,r[e[1]]=e[2];return r},e=s.default,r.default=e},{"./constants":262,"./main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.search":195,"core-js/modules/es.string.split":196,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],264:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.starts-with"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.starts-with"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(l=e("../main"))&&l.__esModule?l:{default:l};function o(e,t){t=t||console.log.bind(console),s||a(),s.some((function(r){var n;if(e.message&&null!==e.message.match("\\W?".concat(r.name,"\\W")))return n="function"===r.type?"".concat(r.name,"()"):r.name,t("Did you just try to use p5.js's ".concat(n," ").concat(r.type,"? If so, you may want to move it into your sketch's setup() function.\n\nFor more details, see: ").concat(i)),!0}))}e("../internationalization");var s=null,a=null,i=(n.default._friendlyError=n.default._checkForUserDefinedFunctions=n.default._fesErrorMonitor=function(){},s=null,"https://github.com/processing/p5.js/wiki/p5.js-overview#why-cant-i-assign-variables-using-p5-functions-and-variables-before-setup"),l=(a=function(){function t(e){return Object.getOwnPropertyNames(e).filter((function(e){return"_"!==e[0]&&!(e in r)&&(r[e]=!0)})).map((function(t){var r="function"==typeof e[t]?"function":t===t.toUpperCase()?"constant":"variable";return{name:t,type:r}}))}var r={};(s=[].concat(t(n.default.prototype),t(e("../constants")))).sort((function(e,t){return t.name.length-e.name.length}))},n.default.prototype._helpForMisusedAtTopLevelCode=o,"complete"!==document.readyState&&(window.addEventListener("error",o,!1),window.addEventListener("load",(function(){window.removeEventListener("error",o,!1)}))),n.default);r.default=l},{"../constants":262,"../internationalization":271,"../main":273,"./browser_errors":void 0,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.some":165,"core-js/modules/es.function.name":167,"core-js/modules/es.object.assign":174,"core-js/modules/es.object.get-own-property-names":177,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.constructor":184,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.match":191,"core-js/modules/es.string.replace":194,"core-js/modules/es.string.split":196,"core-js/modules/es.string.starts-with":197,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.for-each":235,"core-js/modules/web.dom-collections.iterator":236}],265:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(n=e("../main"))&&n.__esModule?n:{default:n};e("../internationalization"),n.default._friendlyFileLoadError=function(){},e=n.default,r.default=e},{"../internationalization":271,"../main":273}],266:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(e){return e&&e.__esModule?e:{default:e}}(e("../main"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}e("../internationalization"),function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n,s={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&((n=i?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(s,r,n):s[r]=e[r]);s.default=e,t&&t.set(e,s)}(e("../constants")),s.default._fesCodeReader=function(){};var i=s.default;r.default=i},{"../constants":262,"../internationalization":271,"../main":273,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.from":157,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.constructor":184,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.match":191,"core-js/modules/es.string.split":196,"core-js/modules/es.string.trim":199,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.for-each":235,"core-js/modules/web.dom-collections.iterator":236}],267:[function(e,t,r){"use strict";function n(){var e=/(^|@)\S+:\d+/,t=/^\s*at .*(\S+:\d+|\(native\))/m,r=/^(eval@)?(\[native code])?$/;return{parse:function(e){return void 0!==e.stacktrace||void 0!==e["opera#sourceloc"]?this.parseOpera(e):e.stack&&e.stack.match(t)?this.parseV8OrIE(e):e.stack?this.parseFFOrSafari(e):void 0},extractLocation:function(e){return-1===e.indexOf(":")?[e]:[(e=/(.+?)(?::(\d+))?(?::(\d+))?$/.exec(e.replace(/[()]/g,"")))[1],e[2]||void 0,e[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter((function(e){return!!e.match(t)}),this).map((function(e){var t=(r=(e=-1<e.indexOf("(eval ")?e.replace(/eval code/g,"eval").replace(/(\(eval at [^()]*)|(\),.*$)/g,""):e).replace(/^\s+/,"").replace(/\(eval code/g,"(")).match(/ (\((.+):(\d+):(\d+)\)$)/),r=(r=t?r.replace(t[0],""):r).split(/\s+/).slice(1);return t=this.extractLocation(t?t[1]:r.pop()),{functionName:r.join(" ")||void 0,fileName:-1<["eval","<anonymous>"].indexOf(t[0])?void 0:t[0],lineNumber:t[1],columnNumber:t[2],source:e}}),this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter((function(e){return!e.match(r)}),this).map((function(e){var t,r;return-1===(e=-1<e.indexOf(" > eval")?e.replace(/ line (\d+)(?: > eval line \d+)* > eval:\d+:\d+/g,":$1"):e).indexOf("@")&&-1===e.indexOf(":")?{functionName:e}:{functionName:(r=e.match(t=/((.*".+"[^@]*)?[^@]*)(?:@)/))&&r[1]?r[1]:void 0,fileName:(r=this.extractLocation(e.replace(t,"")))[0],lineNumber:r[1],columnNumber:r[2],source:e}}),this)},parseOpera:function(e){return!e.stacktrace||-1<e.message.indexOf("\n")&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)/i,r=e.message.split("\n"),n=[],o=2,s=r.length;o<s;o+=2){var a=t.exec(r[o]);a&&n.push({fileName:a[2],lineNumber:a[1],source:r[o]})}return n},parseOpera10:function(e){for(var t=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,r=e.stacktrace.split("\n"),n=[],o=0,s=r.length;o<s;o+=2){var a=t.exec(r[o]);a&&n.push({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:r[o]})}return n},parseOpera11:function(t){return t.stack.split("\n").filter((function(t){return!!t.match(e)&&!t.match(/^Error created at/)}),this).map((function(e){var t,r=e.split("@"),n=this.extractLocation(r.pop());return{functionName:(r=r.shift()||"").replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^)]*\)/g,"")||void 0,args:void 0===(t=r.match(/\(([^)]*)\)/)?r.replace(/^[^(]+\(([^)]*)\)$/,"$1"):t)||"[arguments not available]"===t?void 0:t.split(","),fileName:n[0],lineNumber:n[1],columnNumber:n[2],source:e}}),this)}}}e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../main"))&&e.__esModule?e:{default:e}).default._getErrorStackParser=function(){return new n},e=e.default,r.default=e},{"../main":273,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.join":161,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.match":191,"core-js/modules/es.string.replace":194,"core-js/modules/es.string.split":196}],268:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(o=e("../main"))&&o.__esModule?o:{default:o};function s(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,s=function(){return e},e)}function a(e){return(a="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}(function(e){if(!(e&&e.__esModule||null===e||"object"!==a(e)&&"function"!=typeof e)){var t=s();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var i;Object.prototype.hasOwnProperty.call(e,r)&&((i=o?Object.getOwnPropertyDescriptor(e,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r])}n.default=e,t&&t.set(e,n)}})(e("../constants")),e("../internationalization"),o.default._validateParameters=o.default._clearValidateParamsCache=function(){},e=o.default,r.default=e},{"../../../docs/parameterData.json":void 0,"../constants":262,"../internationalization":271,"../main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.last-index-of":162,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.function.name":167,"core-js/modules/es.map":168,"core-js/modules/es.number.constructor":171,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.set":187,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.split":196,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.for-each":235,"core-js/modules/web.dom-collections.iterator":236}],269:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var i;Object.prototype.hasOwnProperty.call(e,r)&&((i=s?Object.getOwnPropertyDescriptor(e,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}r.default={modeAdjust:function(e,t,r,n,o){return o===s.CORNER?{x:e,y:t,w:r,h:n}:o===s.CORNERS?{x:e,y:t,w:r-e,h:n-t}:o===s.RADIUS?{x:e-r,y:t-n,w:2*r,h:2*n}:o===s.CENTER?{x:e-.5*r,y:t-.5*n,w:r,h:n}:void 0}}},{"./constants":262,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],270:[function(e,t,r){"use strict";e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator");var n=(o=e("../core/main"))&&o.__esModule?o:{default:o};e("./internationalization");var o=Promise.resolve();Promise.all([new Promise((function(e,t){"complete"===document.readyState?e():window.addEventListener("load",e,!1)})),o]).then((function(){void 0!==window._setupDone?console.warn("p5.js seems to have been imported multiple times. Please remove the duplicate import"):window.mocha||(window.setup&&"function"==typeof window.setup||window.draw&&"function"==typeof window.draw)&&!n.default.instance&&new n.default}))},{"../core/main":273,"./internationalization":271,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.to-string":180,"core-js/modules/es.promise":181,"core-js/modules/es.string.iterator":190,"core-js/modules/web.dom-collections.iterator":236}],271:[function(e,t,r){"use strict";e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.setTranslatorLanguage=r.currentTranslatorLanguage=r.availableTranslatorLanguages=r.initialize=r.translator=void 0;var n,o=a(e("i18next")),s=a(e("i18next-browser-languagedetector"));function a(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(t,r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.init(t,r)}var t;return(t=[{key:"fetchWithTimeout",value:function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:2e3;return Promise.race([fetch(e,t),new Promise((function(e,t){return setTimeout((function(){return t(new Error("timeout"))}),r)}))])}},{key:"init",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.services=e,this.options=t}},{key:"read",value:function(e,t,r){var o=this.options.loadPath;e===this.options.fallback?r(null,n[e][t]):(void 0).includes(e)?(o=this.services.interpolator.interpolate(o,{lng:e,ns:t}),this.loadUrl(o,r)):r("Not found",!1)}},{key:"loadUrl",value:function(e,t){this.fetchWithTimeout(e).then((function(t){if(t.ok)return t.json();throw new Error("failed loading ".concat(e))}),(function(){throw new Error("failed loading ".concat(e))})).then((function(e){return t(null,e)})).catch(t)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();i.type="backend",r.translator=function(e,t){console.debug("p5.js translator called before translations were loaded"),o.default.t(e,t)},r.initialize=function(){return o.default.use(s.default).use(i).init({fallbackLng:"en",nestingPrefix:"$tr(",nestingSuffix:")",defaultNS:"translation",returnEmptyString:!1,interpolation:{escapeValue:!1},detection:{checkWhitelist:!1,order:["querystring","navigator","htmlTag","path","subdomain"],caches:[]},backend:{fallback:"en",loadPath:"https://cdn.jsdelivr.net/npm/p5/translations/{{lng}}/{{ns}}.json"},partialBundledLanguages:!0,resources:n}).then((function(e){r.translator=e}),(function(e){return console.debug("Translations failed to load (".concat(e,")"))}))},r.availableTranslatorLanguages=function(){return o.default.languages},r.currentTranslatorLanguage=function(e){return o.default.language},r.setTranslatorLanguage=function(e){return o.default.changeLanguage(e||void 0,(function(e){return console.debug("Translations failed to load (".concat(e,")"))}))}},{"../../translations":void 0,"../../translations/dev":void 0,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.promise":181,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.split":196,"core-js/modules/web.dom-collections.iterator":236,i18next:3,"i18next-browser-languagedetector":3}],272:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("./main"))&&e.__esModule?e:{default:e}).default.prototype.pushStyle=function(){throw new Error("pushStyle() not used, see push()")},e.default.prototype.popStyle=function(){throw new Error("popStyle() not used, see pop()")},e.default.prototype.popMatrix=function(){throw new Error("popMatrix() not used, see pop()")},e.default.prototype.pushMatrix=function(){throw new Error("pushMatrix() not used, see push()")},e=e.default,r.default=e},{"./main":273}],273:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-names"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("./shim");var s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var i;Object.prototype.hasOwnProperty.call(e,r)&&((i=s?Object.getOwnPropertyDescriptor(e,r):null)&&(i.get||i.set)?Object.defineProperty(n,r,i):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}var i,l=function(){function e(t,r,n){var o=this;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._setupDone=!1,this._preloadDone=!1,this._pixelDensity=Math.ceil(window.devicePixelRatio)||1,this._userNode=r,this._curElement=null,this._elements=[],this._glAttributes=null,this._requestAnimId=0,this._preloadCount=0,this._isGlobal=!1,this._loop=!0,this._initializeInstanceVariables(),this._defaultCanvasSize={width:100,height:100},this._events={mousemove:null,mousedown:null,mouseup:null,dragend:null,dragover:null,click:null,dblclick:null,mouseover:null,mouseout:null,keydown:null,keyup:null,keypress:null,touchstart:null,touchmove:null,touchend:null,resize:null,blur:null},this._millisStart=-1,this._recording=!1,this._lcg_random_state=null,this._gaussian_previous=!1,this._events.wheel=null,this._loadingScreenId="p5_loading",this._registeredMethods={},r=Object.getOwnPropertyNames(e.prototype._registeredMethods);var s=!0,a=!1,i=void 0;try{for(var l,u=r[Symbol.iterator]();!(s=(l=u.next()).done);s=!0){var c=l.value;this._registeredMethods[c]=e.prototype._registeredMethods[c].slice()}}catch(t){a=!0,i=t}finally{try{s||null==u.return||u.return()}finally{if(a)throw i}}window.DeviceOrientationEvent&&(this._events.deviceorientation=null),window.DeviceMotionEvent&&!window._isNodeWebkit&&(this._events.devicemotion=null),this._start=function(){o._userNode&&"string"==typeof o._userNode&&(o._userNode=document.getElementById(o._userNode));var t=o._isGlobal?window:o;if(t.preload){var r,n=document.getElementById(o._loadingScreenId),s=(n||((n=document.createElement("div")).innerHTML="Loading...",n.style.position="absolute",n.id=o._loadingScreenId,(o._userNode||document.body).appendChild(n)),o._preloadMethods);for(r in s){s[r]=s[r]||e;var a=s[r];a!==e.prototype&&a!==e||(o._isGlobal&&(window[r]=o._wrapPreload(o,r)),a=o),o._registeredPreloadMethods[r]=a[r],a[r]=o._wrapPreload(a,r)}t.preload(),o._runIfPreloadsAreDone()}else o._setup(),o._recording||o._draw()},this._runIfPreloadsAreDone=function(){var e,t=this._isGlobal?window:this;0===t._preloadCount&&((e=document.getElementById(t._loadingScreenId))&&e.parentNode.removeChild(e),this._setupDone||(this._lastTargetFrameTime=window.performance.now(),this._lastRealFrameTime=window.performance.now(),t._setup(),this._recording||t._draw()))},this._decrementPreload=function(){var e=this._isGlobal?window:this;e._preloadDone||"function"!=typeof e.preload||(e._setProperty("_preloadCount",e._preloadCount-1),e._runIfPreloadsAreDone())},this._wrapPreload=function(e,t){var r=this;return function(){r._incrementPreload();for(var n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return r._registeredPreloadMethods[t].apply(e,o)}},this._incrementPreload=function(){var e=this._isGlobal?window:this;e._preloadDone||e._setProperty("_preloadCount",e._preloadCount+1)},this._setup=function(){o.createCanvas(o._defaultCanvasSize.width,o._defaultCanvasSize.height,"p2d");var e=o._isGlobal?window:o;if("function"==typeof e.preload)for(var t in o._preloadMethods)e[t]=o._preloadMethods[t][t],e[t]&&o&&(e[t]=e[t].bind(o));o._millisStart=window.performance.now(),e._preloadDone=!0,"function"==typeof e.setup&&e.setup();var r=document.getElementsByTagName("canvas"),n=!0,s=!1,a=void 0;try{for(var i,l=r[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var u=i.value;"true"===u.dataset.hidden&&(u.style.visibility="",delete u.dataset.hidden)}}catch(e){s=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(s)throw a}}o._lastTargetFrameTime=window.performance.now(),o._lastRealFrameTime=window.performance.now(),o._setupDone=!0,(o._accessibleOutputs.grid||o._accessibleOutputs.text)&&o._updateAccsOutput()},this._draw=function(){var e=window.performance.now(),t=e-o._lastTargetFrameTime,r=1e3/o._targetFrameRate;(!o._loop||r-5<=t)&&(o.deltaTime=e-o._lastRealFrameTime,o._setProperty("deltaTime",o.deltaTime),o._frameRate=1e3/o.deltaTime,o.redraw(),o._lastTargetFrameTime=Math.max(o._lastTargetFrameTime+r,e),o._lastRealFrameTime=e,void 0!==o._updateMouseCoords&&(o._updateMouseCoords(),o._setProperty("movedX",0),o._setProperty("movedY",0))),o._loop&&(o._requestAnimId=window.requestAnimationFrame(o._draw))},this._setProperty=function(e,t){o[e]=t,o._isGlobal&&(window[e]=t)},this.remove=function(){if((n=document.getElementById(o._loadingScreenId))&&(n.parentNode.removeChild(n),o._incrementPreload()),o._curElement){for(var t in o._loop=!1,o._requestAnimId&&window.cancelAnimationFrame(o._requestAnimId),o._events)window.removeEventListener(t,o._events[t]);var r=!0,n=!1,s=void 0;try{for(var a,i=o._elements[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var l,u=a.value;for(l in u.elt&&u.elt.parentNode&&u.elt.parentNode.removeChild(u.elt),u._events)u.elt.removeEventListener(l,u._events[l])}}catch(t){n=!0,s=t}finally{try{r||null==i.return||i.return()}finally{if(n)throw s}}var c=o;o._registeredMethods.remove.forEach((function(e){void 0!==e&&e.call(c)}))}if(o._isGlobal){for(var d in e.prototype)try{delete window[d]}catch(t){window[d]=void 0}for(var h in o)if(o.hasOwnProperty(h))try{delete window[h]}catch(t){window[h]=void 0}e.instance=null}},this._registeredMethods.init.forEach((function(e){void 0!==e&&e.call(this)}),this),this._setupPromisePreloads();var d,h,p=this._createFriendlyGlobalFunctionBinder();if(t)t(this),e._checkForUserDefinedFunctions(this);else{for(var f in this._isGlobal=!0,e.instance=this,e.prototype)"function"==typeof e.prototype[f]?(d=f.substring(2),this._events.hasOwnProperty(d)||(Math.hasOwnProperty(f)&&Math[f]===e.prototype[f]?p(f,e.prototype[f]):p(f,e.prototype[f].bind(this)))):p(f,e.prototype[f]);for(var m in this)this.hasOwnProperty(m)&&p(m,this[m])}for(h in this._events){var y=this["_on".concat(h)];y&&(y=y.bind(this),window.addEventListener(h,y,{passive:!1}),this._events[h]=y)}function g(){o._setProperty("focused",!0)}function v(){o._setProperty("focused",!1)}window.addEventListener("focus",g),window.addEventListener("blur",v),this.registerMethod("remove",(function(){window.removeEventListener("focus",g),window.removeEventListener("blur",v)})),"complete"===document.readyState?this._start():window.addEventListener("load",this._start.bind(this),!1)}var t;return(t=[{key:"_initializeInstanceVariables",value:function(){this._accessibleOutputs={text:!1,grid:!1,textLabel:!1,gridLabel:!1},this._styles=[],this._bezierDetail=20,this._curveDetail=20,this._colorMode=s.RGB,this._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},this._downKeys={}}},{key:"registerPreloadMethod",value:function(t,r){e.prototype._preloadMethods.hasOwnProperty(t)||(e.prototype._preloadMethods[t]=r)}},{key:"registerMethod",value:function(t,r){var n=this||e.prototype;n._registeredMethods.hasOwnProperty(t)||(n._registeredMethods[t]=[]),n._registeredMethods[t].push(r)}},{key:"_createFriendlyGlobalFunctionBinder",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},r=t.globalObject||window;return t.log||console.log.bind(console),function(t,n){e.disableFriendlyErrors,r[t]=n}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();for(i in l.instance=null,l.disableFriendlyErrors=!1,s)l.prototype[i]=s[i];l.VERSION=s.VERSION,l.prototype._preloadMethods={loadJSON:l.prototype,loadImage:l.prototype,loadStrings:l.prototype,loadXML:l.prototype,loadBytes:l.prototype,loadTable:l.prototype,loadFont:l.prototype,loadModel:l.prototype,loadShader:l.prototype},l.prototype._registeredMethods={init:[],pre:[],post:[],remove:[]},l.prototype._registeredPreloadMethods={},r.default=l},{"./constants":262,"./shim":284,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.get-own-property-names":177,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.for-each":235,"core-js/modules/web.dom-collections.iterator":236}],274:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("./main"))&&e.__esModule?e:{default:e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}n.default.Element=function(){function e(t,r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.elt=t,this._pInst=this._pixelsState=r,this._events={},this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight}var t,r,s;return t=e,s=[{key:"_adjustListener",value:function(e,t,r){return!1===t?n.default.Element._detachListener(e,r):n.default.Element._attachListener(e,t,r),this}},{key:"_attachListener",value:function(e,t,r){r._events[e]&&n.default.Element._detachListener(e,r),t=t.bind(r),r.elt.addEventListener(e,t,!1),r._events[e]=t}},{key:"_detachListener",value:function(e,t){var r=t._events[e];t.elt.removeEventListener(e,r,!1),t._events[e]=null}}],(r=[{key:"parent",value:function(e){return void 0===e?this.elt.parentNode:("string"==typeof e?("#"===e[0]&&(e=e.substring(1)),e=document.getElementById(e)):e instanceof n.default.Element&&(e=e.elt),e.appendChild(this.elt),this)}},{key:"id",value:function(e){return void 0===e?this.elt.id:(this.elt.id=e,this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this)}},{key:"class",value:function(e){return void 0===e?this.elt.className:(this.elt.className=e,this)}},{key:"mousePressed",value:function(e){return n.default.Element._adjustListener("mousedown",(function(t){return this._pInst._setProperty("mouseIsPressed",!0),this._pInst._setMouseButton(t),e.call(this,t)}),this),this}},{key:"doubleClicked",value:function(e){return n.default.Element._adjustListener("dblclick",e,this),this}},{key:"mouseWheel",value:function(e){return n.default.Element._adjustListener("wheel",e,this),this}},{key:"mouseReleased",value:function(e){return n.default.Element._adjustListener("mouseup",e,this),this}},{key:"mouseClicked",value:function(e){return n.default.Element._adjustListener("click",e,this),this}},{key:"mouseMoved",value:function(e){return n.default.Element._adjustListener("mousemove",e,this),this}},{key:"mouseOver",value:function(e){return n.default.Element._adjustListener("mouseover",e,this),this}},{key:"mouseOut",value:function(e){return n.default.Element._adjustListener("mouseout",e,this),this}},{key:"touchStarted",value:function(e){return n.default.Element._adjustListener("touchstart",e,this),this}},{key:"touchMoved",value:function(e){return n.default.Element._adjustListener("touchmove",e,this),this}},{key:"touchEnded",value:function(e){return n.default.Element._adjustListener("touchend",e,this),this}},{key:"dragOver",value:function(e){return n.default.Element._adjustListener("dragover",e,this),this}},{key:"dragLeave",value:function(e){return n.default.Element._adjustListener("dragleave",e,this),this}},{key:"_setProperty",value:function(e,t){this[e]=t}}])&&o(t.prototype,r),s&&o(t,s),e}(),e=n.default.Element,r.default=e},{"./main":273}],275:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(p=e("./main"))&&p.__esModule?p:{default:p},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return function(){var t,r=h(e);return c(this,function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?(t=h(this).constructor,Reflect.construct(r,arguments,t)):r.apply(this,arguments))}}function c(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?d(e):t}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}o.default.Graphics=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e);var r=u(n);function n(e,t,a,i,l){var u;if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");p=l||document.createElement("canvas"),(u=r.call(this,p,i)).canvas=p;var h,p=a||s.P2D;for(h in a=i._userNode||document.body,l||a.appendChild(u.canvas),o.default.prototype)u[h]||("function"==typeof o.default.prototype[h]?u[h]=o.default.prototype[h].bind(d(u)):u[h]=o.default.prototype[h]);return o.default.prototype._initializeInstanceVariables.apply(d(u)),u.width=e,u.height=t,u._pixelDensity=i._pixelDensity,p===s.WEBGL?u._renderer=new o.default.RendererGL(u.canvas,d(u),!1):u._renderer=new o.default.Renderer2D(u.canvas,d(u),!1),i._elements.push(d(u)),Object.defineProperty(d(u),"deltaTime",{get:function(){return this._pInst.deltaTime}}),u._renderer.resize(e,t),u._renderer._applyDefaults(),c(u,d(u))}return t=n,(e=[{key:"reset",value:function(){this._renderer.resetMatrix(),this._renderer.isP3D&&this._renderer._update()}},{key:"remove",value:function(){this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt);var e,t=this._pInst._elements.indexOf(this);for(e in-1!==t&&this._pInst._elements.splice(t,1),this._events)this.elt.removeEventListener(e,this._events[e])}},{key:"createFramebuffer",value:function(e){return new o.default.Framebuffer(this,e)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),n}(o.default.Element);var p=o.default.Graphics;r.default=p},{"./constants":262,"./main":273,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.splice":166,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],276:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(h=e("./main"))&&h.__esModule?h:{default:h},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return function(){var t,r,n=d(e);return t=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?(t=d(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),n=this,!(r=t)||"object"!==i(r)&&"function"!=typeof r?c(n):r}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e);var r=u(n);function n(e,t,o){var a;if(this instanceof n)return(a=r.call(this,e,t)).canvas=e,a._pixelsState=t,o?(a._isMainCanvas=!0,a._pInst._setProperty("_curElement",c(a)),a._pInst._setProperty("canvas",a.canvas),a._pInst._setProperty("width",a.width),a._pInst._setProperty("height",a.height)):(a.canvas.style.display="none",a._styles=[]),a._textSize=12,a._textLeading=15,a._textFont="sans-serif",a._textStyle=s.NORMAL,a._textAscent=null,a._textDescent=null,a._textAlign=s.LEFT,a._textBaseline=s.BASELINE,a._textWrap=s.WORD,a._rectMode=s.CORNER,a._ellipseMode=s.CENTER,a._curveTightness=0,a._imageMode=s.CORNER,a._tint=null,a._doStroke=!0,a._doFill=!0,a._strokeSet=!1,a._fillSet=!1,a._leadingSet=!1,a;throw new TypeError("Cannot call a class as a function")}return t=n,(e=[{key:"push",value:function(){return{properties:{_doStroke:this._doStroke,_strokeSet:this._strokeSet,_doFill:this._doFill,_fillSet:this._fillSet,_tint:this._tint,_imageMode:this._imageMode,_rectMode:this._rectMode,_ellipseMode:this._ellipseMode,_textFont:this._textFont,_textLeading:this._textLeading,_leadingSet:this._leadingSet,_textSize:this._textSize,_textAlign:this._textAlign,_textBaseline:this._textBaseline,_textStyle:this._textStyle,_textWrap:this._textWrap}}}},{key:"pop",value:function(e){e.properties&&Object.assign(this,e.properties)}},{key:"resize",value:function(e,t){this.width=e,this.height=t,this.elt.width=e*this._pInst._pixelDensity,this.elt.height=t*this._pInst._pixelDensity,this.elt.style.width="".concat(e,"px"),this.elt.style.height="".concat(t,"px"),this._isMainCanvas&&(this._pInst._setProperty("width",this.width),this._pInst._setProperty("height",this.height))}},{key:"get",value:function(e,t,r,n){var s=this._pixelsState,a=s._pixelDensity,i=this.canvas;if(void 0===e&&void 0===t)e=t=0,r=s.width,n=s.height;else if(e*=a,t*=a,void 0===r&&void 0===n)return e<0||t<0||e>=i.width||t>=i.height?[0,0,0,0]:this._getPixel(e,t);return(s=new o.default.Image(r,n)).canvas.getContext("2d").drawImage(i,e,t,r*a,n*a,0,0,r,n),s}},{key:"textLeading",value:function(e){return"number"==typeof e?(this._setProperty("_leadingSet",!0),this._setProperty("_textLeading",e),this._pInst):this._textLeading}},{key:"textStyle",value:function(e){return e?(e!==s.NORMAL&&e!==s.ITALIC&&e!==s.BOLD&&e!==s.BOLDITALIC||this._setProperty("_textStyle",e),this._applyTextProperties()):this._textStyle}},{key:"textAscent",value:function(){return null===this._textAscent&&this._updateTextMetrics(),this._textAscent}},{key:"textDescent",value:function(){return null===this._textDescent&&this._updateTextMetrics(),this._textDescent}},{key:"textAlign",value:function(e,t){return void 0!==e?(this._setProperty("_textAlign",e),void 0!==t&&this._setProperty("_textBaseline",t),this._applyTextProperties()):{horizontal:this._textAlign,vertical:this._textBaseline}}},{key:"textWrap",value:function(e){return this._setProperty("_textWrap",e),this._textWrap}},{key:"text",value:function(e,t,r,n,o){var a,i,l,u,c=this._pInst,d=this._textWrap,h=Number.MAX_VALUE,p=r;if((this._doFill||this._doStroke)&&void 0!==e){if(a=(e=(e="string"!=typeof e?e.toString():e).replace(/(\t)/g,"  ")).split("\n"),void 0!==n){switch(this._rectMode===s.CENTER&&(t-=n/2),this._textAlign){case s.CENTER:t+=n/2;break;case s.RIGHT:t+=n}if(void 0!==o){this._rectMode===s.CENTER&&(r-=o/2,p-=o/2),e=r;var f=c.textAscent();switch(this._textBaseline){case s.BOTTOM:u=r+o,r=Math.max(u,r),p+=f;break;case s.CENTER:u=r+o/2,r=Math.max(u,r),p+=f/2}h=r+o-f,this._textBaseline===s.CENTER&&(h=e+o-f/2)}else this._textBaseline!==s.BOTTOM&&this._textBaseline!==s.CENTER||(p=r-(e=c.textSize()*this._textLeading)/2,h=r+e/2);if(d===s.WORD){for(var m=[],y=0;y<a.length;y++){for(var g="",v=a[y].split(" "),b=0;b<v.length;b++)i="".concat(g+v[b])+" ",g=n<(l=this.textWidth(i))&&0<g.length?(m.push(g),"".concat(v[b])+" "):i;m.push(g)}var x=0;this._textBaseline===s.CENTER?x=(m.length-1)*c.textLeading()/2:this._textBaseline===s.BOTTOM&&(x=(m.length-1)*c.textLeading());for(var w=0;w<a.length;w++){g="",v=a[w].split(" ");for(var _=0;_<v.length;_++)i="".concat(g+v[_])+" ",n<(l=this.textWidth(i))&&0<g.length?(this._renderText(c,g.trim(),t,r-x,h,p),g="".concat(v[_])+" ",r+=c.textLeading()):g=i;this._renderText(c,g.trim(),t,r-x,h,p),r+=c.textLeading()}}else{for(var S=[],k=0;k<a.length;k++)for(var T=a[k].split(g=""),E=0;E<T.length;E++)i="".concat(g+T[E]),(l=this.textWidth(i))<=n?g+=T[E]:n<l&&0<g.length&&(S.push(g),g="".concat(T[E]));S.push(g);var j=0;this._textBaseline===s.CENTER?j=(S.length-1)*c.textLeading()/2:this._textBaseline===s.BOTTOM&&(j=(S.length-1)*c.textLeading());for(var C=0;C<a.length;C++){T=a[C].split(g="");for(var I=0;I<T.length;I++)i="".concat(g+T[I]),(l=this.textWidth(i))<=n?g+=T[I]:n<l&&0<g.length&&(this._renderText(c,g.trim(),t,r-j,h,p),r+=c.textLeading(),g="".concat(T[I]))}this._renderText(c,g.trim(),t,r-j,h,p),r+=c.textLeading()}}else{var O=0;this._textBaseline===s.CENTER?O=(a.length-1)*c.textLeading()/2:this._textBaseline===s.BOTTOM&&(O=(a.length-1)*c.textLeading());for(var A=0;A<a.length;A++)this._renderText(c,a[A],t,r-O,h,p-O),r+=c.textLeading()}return c}}},{key:"_applyDefaults",value:function(){return this}},{key:"_isOpenType",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._textFont;return"object"===i(e)&&e.font&&e.font.supported}},{key:"_updateTextMetrics",value:function(){var e,t,r,n,o,s;return this._isOpenType()?(this._setProperty("_textAscent",this._textFont._textAscent()),this._setProperty("_textDescent",this._textFont._textDescent())):((e=document.createElement("span")).style.fontFamily=this._textFont,e.style.fontSize="".concat(this._textSize,"px"),e.innerHTML="ABCjgq|",(s=document.createElement("div")).style.display="inline-block",s.style.width="1px",s.style.height="0px",(t=document.createElement("div")).appendChild(e),t.appendChild(s),t.style.height="0px",t.style.overflow="hidden",document.body.appendChild(t),s.style.verticalAlign="baseline",n=p(s),o=p(e),r=n[1]-o[1],s.style.verticalAlign="bottom",n=p(s),o=p(e),s=n[1]-o[1]-r,document.body.removeChild(t),this._setProperty("_textAscent",r),this._setProperty("_textDescent",s)),this}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),n}(o.default.Element);function p(e){var t=0,r=0;if(e.offsetParent)for(;t+=e.offsetLeft,r+=e.offsetTop,e=e.offsetParent;);else t+=e.offsetLeft,r+=e.offsetTop;return[t,r]}h.prototype.textSize=function(e){return"number"==typeof e?(this._setProperty("_textSize",e),this._leadingSet||this._setProperty("_textLeading",e*s._DEFAULT_LEADMULT),this._applyTextProperties()):this._textSize},o.default.Renderer=h,e=o.default.Renderer,r.default=e},{"../core/constants":262,"./main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.number.constructor":171,"core-js/modules/es.object.assign":174,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.replace":194,"core-js/modules/es.string.split":196,"core-js/modules/es.string.trim":199,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],277:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.reflect.get"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.reflect.get"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(h=e("./main"))&&h.__esModule?h:{default:h},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function l(e,t,r){return(l="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){if(e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t),e)return(e=Object.getOwnPropertyDescriptor(e,t)).get?e.get.call(r):e.value})(e,t,r||e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}e("./p5.Renderer");var d="rgba(0,0,0,0)",h=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e);var r=function(e){return function(){var t,r=c(e);if(t=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?(t=c(this).constructor,Reflect.construct(r,arguments,t)):r.apply(this,arguments),r=this,!t||"object"!==i(t)&&"function"!=typeof t){if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}}(n);function n(e,t,o){if(this instanceof n)return(e=r.call(this,e,t,o)).drawingContext=e.canvas.getContext("2d"),e._pInst._setProperty("drawingContext",e.drawingContext),e;throw new TypeError("Cannot call a class as a function")}return t=n,(e=[{key:"_applyDefaults",value:function(){this._cachedFillStyle=this._cachedStrokeStyle=void 0,this._cachedBlendMode=s.BLEND,this._setFill(s._DEFAULT_FILL),this._setStroke(s._DEFAULT_STROKE),this.drawingContext.lineCap=s.ROUND,this.drawingContext.font="normal 12px sans-serif"}},{key:"resize",value:function(e,t){l(c(n.prototype),"resize",this).call(this,e,t),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity)}},{key:"background",value:function(){var e,t;this.drawingContext.save(),this.resetMatrix(),(arguments.length<=0?void 0:arguments[0])instanceof o.default.Image?0<=(arguments.length<=1?void 0:arguments[1])?(e=arguments.length<=0?void 0:arguments[0],this.drawingContext.globalAlpha=(arguments.length<=1?void 0:arguments[1])/255,this._pInst.image(e,0,0,this.width,this.height)):this._pInst.image(arguments.length<=0?void 0:arguments[0],0,0,this.width,this.height):(e=this._getFill(),t=(t=this._pInst).color.apply(t,arguments),this._pInst._addAccsOutput()&&this._pInst._accsBackground(t.levels),t=t.toString(),this._setFill(t),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.fillRect(0,0,this.width,this.height),this._setFill(e),this._isErasing&&this._pInst.erase()),this.drawingContext.restore()}},{key:"clear",value:function(){this.drawingContext.save(),this.resetMatrix(),this.drawingContext.clearRect(0,0,this.width,this.height),this.drawingContext.restore()}},{key:"fill",value:function(){var e=(e=this._pInst).color.apply(e,arguments);this._setFill(e.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("fill",e.levels)}},{key:"stroke",value:function(){var e=(e=this._pInst).color.apply(e,arguments);this._setStroke(e.toString()),this._pInst._addAccsOutput()&&this._pInst._accsCanvasColors("stroke",e.levels)}},{key:"erase",value:function(e,t){this._isErasing||(this._cachedFillStyle=this.drawingContext.fillStyle,e=this._pInst.color(255,e).toString(),this.drawingContext.fillStyle=e,this._cachedStrokeStyle=this.drawingContext.strokeStyle,e=this._pInst.color(255,t).toString(),this.drawingContext.strokeStyle=e,t=this._cachedBlendMode,this.blendMode(s.REMOVE),this._cachedBlendMode=t,this._isErasing=!0)}},{key:"noErase",value:function(){this._isErasing&&(this.drawingContext.fillStyle=this._cachedFillStyle,this.drawingContext.strokeStyle=this._cachedStrokeStyle,this.blendMode(this._cachedBlendMode),this._isErasing=!1)}},{key:"image",value:function(e,t,r,n,s,a,i,l,u){e.gifProperties&&e._animateGif(this._pInst);try{o.default.MediaElement&&e instanceof o.default.MediaElement&&e._ensureCanvas();var c=(c=this._tint&&e.canvas?this._getTintedImageCanvas(e):c)||e.canvas||e.elt,d=1;e.width&&0<e.width&&(d=c.width/e.width),this._isErasing&&this.blendMode(this._cachedBlendMode),this.drawingContext.drawImage(c,d*t,d*r,d*n,d*s,a,i,l,u),this._isErasing&&this._pInst.erase()}catch(e){if("NS_ERROR_NOT_AVAILABLE"!==e.name)throw e}}},{key:"_getTintedImageCanvas",value:function(e){if(!e.canvas)return e;e.tintCanvas||(e.tintCanvas=document.createElement("canvas")),e.tintCanvas.width!==e.canvas.width&&(e.tintCanvas.width=e.canvas.width),e.tintCanvas.height!==e.canvas.height&&(e.tintCanvas.height=e.canvas.height);var t=e.tintCanvas.getContext("2d");return t.save(),t.clearRect(0,0,e.canvas.width,e.canvas.height),(this._tint[0]<255||this._tint[1]<255||this._tint[2]<255)&&(t.drawImage(e.canvas,0,0),t.globalCompositeOperation="luminosity",t.drawImage(e.canvas,0,0),t.globalCompositeOperation="color",t.drawImage(e.canvas,0,0),t.globalCompositeOperation="multiply",t.fillStyle="rgb(".concat(this._tint.slice(0,3).join(", "),")"),t.fillRect(0,0,e.canvas.width,e.canvas.height),t.globalCompositeOperation="destination-in"),t.globalAlpha=this._tint[3]/255,t.drawImage(e.canvas,0,0),t.restore(),e.tintCanvas}},{key:"blendMode",value:function(e){if(e===s.SUBTRACT)console.warn("blendMode(SUBTRACT) only works in WEBGL mode.");else{if(e!==s.BLEND&&e!==s.REMOVE&&e!==s.DARKEST&&e!==s.LIGHTEST&&e!==s.DIFFERENCE&&e!==s.MULTIPLY&&e!==s.EXCLUSION&&e!==s.SCREEN&&e!==s.REPLACE&&e!==s.OVERLAY&&e!==s.HARD_LIGHT&&e!==s.SOFT_LIGHT&&e!==s.DODGE&&e!==s.BURN&&e!==s.ADD)throw new Error("Mode ".concat(e," not recognized."));this._cachedBlendMode=e,this.drawingContext.globalCompositeOperation=e}}},{key:"blend",value:function(){for(var e=this.drawingContext.globalCompositeOperation,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r[r.length-1],a=Array.prototype.slice.call(r,0,r.length-1);this.drawingContext.globalCompositeOperation=s,o.default.prototype.copy.apply(this,a),this.drawingContext.globalCompositeOperation=e}},{key:"_getPixel",value:function(e,t){return[(e=this.drawingContext.getImageData(e,t,1,1).data)[0],e[1],e[2],e[3]]}},{key:"loadPixels",value:function(){var e=this._pixelsState,t=e._pixelDensity,r=this.width*t;t=this.height*t,r=this.drawingContext.getImageData(0,0,r,t),e._setProperty("imageData",r),e._setProperty("pixels",r.data)}},{key:"set",value:function(e,t,r){e=Math.floor(e),t=Math.floor(t);var n=this._pixelsState;if(r instanceof o.default.Image)this.drawingContext.save(),this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(n._pixelDensity,n._pixelDensity),this.drawingContext.clearRect(e,t,r.width,r.height),this.drawingContext.drawImage(r.canvas,e,t),this.drawingContext.restore();else{var s=0,a=0,i=0,l=0,u=4*(t*n._pixelDensity*(this.width*n._pixelDensity)+e*n._pixelDensity);if(n.imageData||n.loadPixels.call(n),"number"==typeof r)u<n.pixels.length&&(i=a=s=r,l=255);else if(r instanceof Array){if(r.length<4)throw new Error("pixel array must be of the form [R, G, B, A]");u<n.pixels.length&&(s=r[0],a=r[1],i=r[2],l=r[3])}else r instanceof o.default.Color&&u<n.pixels.length&&(s=r.levels[0],a=r.levels[1],i=r.levels[2],l=r.levels[3]);for(var c=0;c<n._pixelDensity;c++)for(var d=0;d<n._pixelDensity;d++)u=4*((t*n._pixelDensity+d)*this.width*n._pixelDensity+(e*n._pixelDensity+c)),n.pixels[u]=s,n.pixels[u+1]=a,n.pixels[u+2]=i,n.pixels[u+3]=l}}},{key:"updatePixels",value:function(e,t,r,n){var o=this._pixelsState,s=o._pixelDensity;void 0===e&&void 0===t&&void 0===r&&void 0===n&&(t=e=0,r=this.width,n=this.height),e*=s,t*=s,r*=s,n*=s,this.gifProperties&&(this.gifProperties.frames[this.gifProperties.displayIndex].image=o.imageData),this.drawingContext.putImageData(o.imageData,e,t,0,0,r,n)}},{key:"_acuteArcToBezier",value:function(e,t){var r=t/2,n=Math.cos(r),o=Math.sin(r),s=1/Math.tan(r),a=(r=e+r,Math.cos(r)),i=(r=Math.sin(r),(4-n)/3);return o+=(n-i)*s,{ax:Math.cos(e).toFixed(7),ay:Math.sin(e).toFixed(7),bx:(i*a+o*r).toFixed(7),by:(i*r-o*a).toFixed(7),cx:(i*a-o*r).toFixed(7),cy:(i*r+o*a).toFixed(7),dx:Math.cos(e+t).toFixed(7),dy:Math.sin(e+t).toFixed(7)}}},{key:"arc",value:function(e,t,r,n,o,a,i){var l,u=this.drawingContext,c=r/2,d=n/2,h=[];for(e+=c,t+=d;1e-5<=a-o;)l=Math.min(a-o,s.HALF_PI),h.push(this._acuteArcToBezier(o,l)),o+=l;return this._doFill&&(u.beginPath(),h.forEach((function(r,n){0===n&&u.moveTo(e+r.ax*c,t+r.ay*d),u.bezierCurveTo(e+r.bx*c,t+r.by*d,e+r.cx*c,t+r.cy*d,e+r.dx*c,t+r.dy*d)})),i!==s.PIE&&null!=i||u.lineTo(e,t),u.closePath(),u.fill()),this._doStroke&&(u.beginPath(),h.forEach((function(r,n){0===n&&u.moveTo(e+r.ax*c,t+r.ay*d),u.bezierCurveTo(e+r.bx*c,t+r.by*d,e+r.cx*c,t+r.cy*d,e+r.dx*c,t+r.dy*d)})),i===s.PIE?(u.lineTo(e,t),u.closePath()):i===s.CHORD&&u.closePath(),u.stroke()),this}},{key:"ellipse",value:function(e){var t=this.drawingContext,r=this._doFill,n=this._doStroke,o=parseFloat(e[0]),s=parseFloat(e[1]),a=parseFloat(e[2]);if(e=parseFloat(e[3]),r&&!n){if(this._getFill()===d)return this}else if(!r&&n&&this._getStroke()===d)return this;var i=a/2*.5522847498,l=e/2*.5522847498,u=o+a,c=s+e;a=o+a/2,e=s+e/2,t.beginPath(),t.moveTo(o,e),t.bezierCurveTo(o,e-l,a-i,s,a,s),t.bezierCurveTo(a+i,s,u,e-l,u,e),t.bezierCurveTo(u,e+l,a+i,c,a,c),t.bezierCurveTo(a-i,c,o,e+l,o,e),r&&t.fill(),n&&t.stroke()}},{key:"line",value:function(e,t,r,n){var o=this.drawingContext;return this._doStroke&&this._getStroke()!==d&&(o.beginPath(),o.moveTo(e,t),o.lineTo(r,n),o.stroke()),this}},{key:"point",value:function(e,t){var r,n,o=this.drawingContext;return this._doStroke&&this._getStroke()!==d?(r=this._getStroke(),n=this._getFill(),this._setFill(r),o.beginPath(),o.arc(e,t,o.lineWidth/2,0,s.TWO_PI,!1),o.fill(),void this._setFill(n)):this}},{key:"quad",value:function(e,t,r,n,o,s,a,i){var l=this.drawingContext,u=this._doFill,c=this._doStroke;if(u&&!c){if(this._getFill()===d)return this}else if(!u&&c&&this._getStroke()===d)return this;return l.beginPath(),l.moveTo(e,t),l.lineTo(r,n),l.lineTo(o,s),l.lineTo(a,i),l.closePath(),u&&l.fill(),c&&l.stroke(),this}},{key:"rect",value:function(e){var t,r,n=e[0],o=e[1],s=e[2],a=e[3],i=e[4],l=e[5],u=e[6],c=(e=e[7],this.drawingContext),h=this._doFill,p=this._doStroke;if(h&&!p){if(this._getFill()===d)return this}else if(!h&&p&&this._getStroke()===d)return this;return c.beginPath(),void 0===i?c.rect(n,o,s,a):(void 0===l&&(l=i),void 0===u&&(u=l),void 0===e&&(e=u),p=(h=Math.abs(s))/2,r=(t=Math.abs(a))/2,t<2*(i=h<2*i?p:i)&&(i=r),t<2*(l=h<2*l?p:l)&&(l=r),t<2*(u=h<2*u?p:u)&&(u=r),t<2*(e=h<2*e?p:e)&&(e=r),c.beginPath(),c.moveTo(n+i,o),c.arcTo(n+s,o,n+s,o+a,l),c.arcTo(n+s,o+a,n,o+a,u),c.arcTo(n,o+a,n,o,e),c.arcTo(n,o,n+s,o,i),c.closePath()),this._doFill&&c.fill(),this._doStroke&&c.stroke(),this}},{key:"triangle",value:function(e){var t=this.drawingContext,r=this._doFill,n=this._doStroke,o=e[0],s=e[1],a=e[2],i=e[3],l=e[4];if(e=e[5],r&&!n){if(this._getFill()===d)return this}else if(!r&&n&&this._getStroke()===d)return this;t.beginPath(),t.moveTo(o,s),t.lineTo(a,i),t.lineTo(l,e),t.closePath(),r&&t.fill(),n&&t.stroke()}},{key:"endShape",value:function(e,t,r,n,o,a,i){if(0!==t.length&&(this._doStroke||this._doFill)){var l,u,c,d=e===s.CLOSE,h=(d&&!a&&t.push(t[0]),t.length);if(!r||i!==s.POLYGON&&null!==i)if(!n||i!==s.POLYGON&&null!==i)if(!o||i!==s.POLYGON&&null!==i)if(i===s.POINTS)for(u=0;u<h;u++)l=t[u],this._doStroke&&this._pInst.stroke(l[6]),this._pInst.point(l[0],l[1]);else if(i===s.LINES)for(u=0;u+1<h;u+=2)l=t[u],this._doStroke&&this._pInst.stroke(t[u+1][6]),this._pInst.line(l[0],l[1],t[u+1][0],t[u+1][1]);else if(i===s.TRIANGLES)for(u=0;u+2<h;u+=3)l=t[u],this.drawingContext.beginPath(),this.drawingContext.moveTo(l[0],l[1]),this.drawingContext.lineTo(t[u+1][0],t[u+1][1]),this.drawingContext.lineTo(t[u+2][0],t[u+2][1]),this.drawingContext.closePath(),this._doFill&&(this._pInst.fill(t[u+2][5]),this.drawingContext.fill()),this._doStroke&&(this._pInst.stroke(t[u+2][6]),this.drawingContext.stroke());else if(i===s.TRIANGLE_STRIP)for(u=0;u+1<h;u++)l=t[u],this.drawingContext.beginPath(),this.drawingContext.moveTo(t[u+1][0],t[u+1][1]),this.drawingContext.lineTo(l[0],l[1]),this._doStroke&&this._pInst.stroke(t[u+1][6]),this._doFill&&this._pInst.fill(t[u+1][5]),u+2<h&&(this.drawingContext.lineTo(t[u+2][0],t[u+2][1]),this._doStroke&&this._pInst.stroke(t[u+2][6]),this._doFill&&this._pInst.fill(t[u+2][5])),this._doFillStrokeClose(d);else if(i===s.TRIANGLE_FAN){if(2<h){for(this.drawingContext.beginPath(),u=2;u<h;u++)l=t[u],this.drawingContext.moveTo(t[0][0],t[0][1]),this.drawingContext.lineTo(t[u-1][0],t[u-1][1]),this.drawingContext.lineTo(l[0],l[1]),this.drawingContext.lineTo(t[0][0],t[0][1]),u<h-1&&(this._doFill&&l[5]!==t[u+1][5]||this._doStroke&&l[6]!==t[u+1][6])&&(this._doFill&&(this._pInst.fill(l[5]),this.drawingContext.fill(),this._pInst.fill(t[u+1][5])),this._doStroke&&(this._pInst.stroke(l[6]),this.drawingContext.stroke(),this._pInst.stroke(t[u+1][6])),this.drawingContext.closePath(),this.drawingContext.beginPath());this._doFillStrokeClose(d)}}else if(i===s.QUADS)for(u=0;u+3<h;u+=4){for(l=t[u],this.drawingContext.beginPath(),this.drawingContext.moveTo(l[0],l[1]),c=1;c<4;c++)this.drawingContext.lineTo(t[u+c][0],t[u+c][1]);this.drawingContext.lineTo(l[0],l[1]),this._doFill&&this._pInst.fill(t[u+3][5]),this._doStroke&&this._pInst.stroke(t[u+3][6]),this._doFillStrokeClose(d)}else if(i===s.QUAD_STRIP){if(3<h)for(u=0;u+1<h;u+=2)l=t[u],this.drawingContext.beginPath(),u+3<h?(this.drawingContext.moveTo(t[u+2][0],t[u+2][1]),this.drawingContext.lineTo(l[0],l[1]),this.drawingContext.lineTo(t[u+1][0],t[u+1][1]),this.drawingContext.lineTo(t[u+3][0],t[u+3][1]),this._doFill&&this._pInst.fill(t[u+3][5]),this._doStroke&&this._pInst.stroke(t[u+3][6])):(this.drawingContext.moveTo(l[0],l[1]),this.drawingContext.lineTo(t[u+1][0],t[u+1][1])),this._doFillStrokeClose(d)}else{for(this.drawingContext.beginPath(),this.drawingContext.moveTo(t[0][0],t[0][1]),u=1;u<h;u++)(l=t[u]).isVert&&(l.moveTo?this.drawingContext.moveTo(l[0],l[1]):this.drawingContext.lineTo(l[0],l[1]));this._doFillStrokeClose(d)}else{for(this.drawingContext.beginPath(),u=0;u<h;u++)t[u].isVert?t[u].moveTo?this.drawingContext.moveTo(t[u][0],t[u][1]):this.drawingContext.lineTo(t[u][0],t[u][1]):this.drawingContext.quadraticCurveTo(t[u][0],t[u][1],t[u][2],t[u][3]);this._doFillStrokeClose(d)}else{for(this.drawingContext.beginPath(),u=0;u<h;u++)t[u].isVert?t[u].moveTo?this.drawingContext.moveTo(t[u][0],t[u][1]):this.drawingContext.lineTo(t[u][0],t[u][1]):this.drawingContext.bezierCurveTo(t[u][0],t[u][1],t[u][2],t[u][3],t[u][4],t[u][5]);this._doFillStrokeClose(d)}else if(3<h){var p=[],f=1-this._curveTightness;for(this.drawingContext.beginPath(),this.drawingContext.moveTo(t[1][0],t[1][1]),u=1;u+2<h;u++)l=t[u],p[0]=[l[0],l[1]],p[1]=[l[0]+(f*t[u+1][0]-f*t[u-1][0])/6,l[1]+(f*t[u+1][1]-f*t[u-1][1])/6],p[2]=[t[u+1][0]+(f*t[u][0]-f*t[u+2][0])/6,t[u+1][1]+(f*t[u][1]-f*t[u+2][1])/6],p[3]=[t[u+1][0],t[u+1][1]],this.drawingContext.bezierCurveTo(p[1][0],p[1][1],p[2][0],p[2][1],p[3][0],p[3][1]);d&&this.drawingContext.lineTo(t[u+1][0],t[u+1][1]),this._doFillStrokeClose(d)}a=o=n=r=!1,d&&t.pop()}return this}},{key:"strokeCap",value:function(e){return e!==s.ROUND&&e!==s.SQUARE&&e!==s.PROJECT||(this.drawingContext.lineCap=e),this}},{key:"strokeJoin",value:function(e){return e!==s.ROUND&&e!==s.BEVEL&&e!==s.MITER||(this.drawingContext.lineJoin=e),this}},{key:"strokeWeight",value:function(e){return this.drawingContext.lineWidth=void 0===e||0===e?1e-4:e,this}},{key:"_getFill",value:function(){return this._cachedFillStyle||(this._cachedFillStyle=this.drawingContext.fillStyle),this._cachedFillStyle}},{key:"_setFill",value:function(e){e!==this._cachedFillStyle&&(this.drawingContext.fillStyle=e,this._cachedFillStyle=e)}},{key:"_getStroke",value:function(){return this._cachedStrokeStyle||(this._cachedStrokeStyle=this.drawingContext.strokeStyle),this._cachedStrokeStyle}},{key:"_setStroke",value:function(e){e!==this._cachedStrokeStyle&&(this.drawingContext.strokeStyle=e,this._cachedStrokeStyle=e)}},{key:"bezier",value:function(e,t,r,n,o,s,a,i){return this._pInst.beginShape(),this._pInst.vertex(e,t),this._pInst.bezierVertex(r,n,o,s,a,i),this._pInst.endShape(),this}},{key:"curve",value:function(e,t,r,n,o,s,a,i){return this._pInst.beginShape(),this._pInst.curveVertex(e,t),this._pInst.curveVertex(r,n),this._pInst.curveVertex(o,s),this._pInst.curveVertex(a,i),this._pInst.endShape(),this}},{key:"_doFillStrokeClose",value:function(e){e&&this.drawingContext.closePath(),this._doFill&&this.drawingContext.fill(),this._doStroke&&this.drawingContext.stroke()}},{key:"applyMatrix",value:function(e,t,r,n,o,s){this.drawingContext.transform(e,t,r,n,o,s)}},{key:"resetMatrix",value:function(){return this.drawingContext.setTransform(1,0,0,1,0,0),this.drawingContext.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),this}},{key:"rotate",value:function(e){this.drawingContext.rotate(e)}},{key:"scale",value:function(e,t){return this.drawingContext.scale(e,t),this}},{key:"translate",value:function(e,t){return e instanceof o.default.Vector&&(t=e.y,e=e.x),this.drawingContext.translate(e,t),this}},{key:"_renderText",value:function(e,t,r,n,o,a){if(!(n<a||o<=n))return e.push(),this._isOpenType()?this._textFont._renderPath(t,r,n,{renderer:this}):(this._doStroke&&this._strokeSet&&this.drawingContext.strokeText(t,r,n),this._doFill&&(this._fillSet||this._setFill(s._DEFAULT_TEXT_FILL),this.drawingContext.fillText(t,r,n))),e.pop(),e}},{key:"textWidth",value:function(e){return this._isOpenType()?this._textFont._textWidth(e,this._textSize):this.drawingContext.measureText(e).width}},{key:"_applyTextProperties",value:function(){var e,t=this._pInst;return this._setProperty("_textAscent",null),this._setProperty("_textDescent",null),e=this._textFont,this._isOpenType()&&(e=this._textFont.font.familyName,this._setProperty("_textStyle",this._textFont.font.styleName)),this.drawingContext.font="".concat(this._textStyle||"normal"," ").concat(this._textSize||12,"px ").concat(e||"sans-serif"),this.drawingContext.textAlign=this._textAlign,this._textBaseline===s.CENTER?this.drawingContext.textBaseline=s._CTX_MIDDLE:this.drawingContext.textBaseline=this._textBaseline,t}},{key:"push",value:function(){return this.drawingContext.save(),l(c(n.prototype),"push",this).call(this)}},{key:"pop",value:function(e){this.drawingContext.restore(),this._cachedFillStyle=this.drawingContext.fillStyle,this._cachedStrokeStyle=this.drawingContext.strokeStyle,l(c(n.prototype),"pop",this).call(this,e)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),n}(o.default.Renderer);h.prototype.text=function(e,t,r,n,a){var i;return void 0!==n&&this.drawingContext.textBaseline===s.BASELINE&&(i=!0,this.drawingContext.textBaseline=s.TOP),n=o.default.Renderer.prototype.text.apply(this,arguments),i&&(this.drawingContext.textBaseline=s.BASELINE),n},o.default.Renderer2D=h,e=o.default.Renderer2D,r.default=e},{"./constants":262,"./main":273,"./p5.Renderer":276,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.slice":164,"core-js/modules/es.function.name":167,"core-js/modules/es.number.to-fixed":173,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.reflect.get":183,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],278:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator");var n=(e=e("./main"))&&e.__esModule?e:{default:e};function o(){return{}}n.default.prototype._promisePreloads=[];var s=!(n.default.prototype.registerPromisePreload=function(e){n.default.prototype._promisePreloads.push(e)});n.default.prototype._setupPromisePreloads=function(){var e=!0,t=!1,r=void 0;try{for(var o,a=this._promisePreloads[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var i=o.value,l=this,u=i.method,c=i.addCallbacks,d=i.legacyPreloadSetup,h=i.target||this,p=h[u].bind(h);if(h===n.default.prototype){if(s)continue;l=null,p=h[u]}h[u]=this._wrapPromisePreload(l,p,c),d&&(h[d.method]=this._legacyPreloadGenerator(l,d,h[u]))}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}s=!0},n.default.prototype._wrapPromisePreload=function(e,t,r){var n=function(){for(var e=this,n=(this._incrementPreload(),null),o=null,s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];if(r)for(var l=a.length-1;0<=l&&!o&&"function"==typeof a[l];l--)o=n,n=a.pop();var u=Promise.resolve(t.apply(this,a));return n&&u.then(n),o&&u.catch(o),u.then((function(){return e._decrementPreload()})),u};return e?n.bind(e):n},n.default.prototype._legacyPreloadGenerator=function(e,t,r){var n=t.createBaseObject||o;return t=function(){var e=this;this._incrementPreload();for(var t=arguments.length,o=new Array(t),s=0;s<t;s++)o[s]=arguments[s];var a=n.apply(this,o);return r.apply(this,o).then((function(t){Object.assign(a,t),e._decrementPreload()})),a},e?t.bind(e):t}},{"./main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.assign":174,"core-js/modules/es.object.to-string":180,"core-js/modules/es.promise":181,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],279:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(u=e("./main"))&&u.__esModule?u:{default:u},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("./constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("./p5.Graphics"),e("./p5.Renderer2D"),e("../webgl/p5.RendererGL");var l="defaultCanvas0",u=(o.default.prototype.createCanvas=function(e,t,r,n){var a,i,u;if(o.default._validateParameters("createCanvas",arguments),arguments[2]instanceof HTMLCanvasElement?(r=s.P2D,n=arguments[2]):a=r||s.P2D,n)(u=document.getElementById(l))&&u.parentNode.removeChild(u),u=n,this._defaultGraphicsCreated=!1;else{if(a===s.WEBGL)(u=document.getElementById(l))&&(u.parentNode.removeChild(u),i=this._renderer,this._elements=this._elements.filter((function(e){return e!==i}))),(u=document.createElement("canvas")).id=l,u.classList.add("p5Canvas");else if(this._defaultGraphicsCreated)u=this.canvas;else{u=n||document.createElement("canvas");for(var c=0;document.getElementById("defaultCanvas".concat(c));)c++;l="defaultCanvas".concat(c),u.id=l,u.classList.add("p5Canvas")}this._setupDone||(u.dataset.hidden=!0,u.style.visibility="hidden"),(this._userNode||(0===document.getElementsByTagName("main").length&&(r=document.createElement("main"),document.body.appendChild(r)),document.getElementsByTagName("main")[0])).appendChild(u)}return a===s.WEBGL?(this._setProperty("_renderer",new o.default.RendererGL(u,this,!0)),this._elements.push(this._renderer)):this._defaultGraphicsCreated||(this._setProperty("_renderer",new o.default.Renderer2D(u,this,!0)),this._defaultGraphicsCreated=!0,this._elements.push(this._renderer)),this._renderer.resize(e,t),this._renderer._applyDefaults(),this._renderer},o.default.prototype.resizeCanvas=function(e,t,r){if(o.default._validateParameters("resizeCanvas",arguments),this._renderer){var n,s,a={};for(n in this.drawingContext){var l=this.drawingContext[n];"object"!==i(l)&&"function"!=typeof l&&(a[n]=l)}for(s in this.width=e,this.height=t,this._renderer.resize(e,t),a)try{this.drawingContext[s]=a[s]}catch(e){}r||this.redraw()}this._addAccsOutput()&&this._updateAccsOutput()},o.default.prototype.noCanvas=function(){this.canvas&&this.canvas.parentNode.removeChild(this.canvas)},o.default.prototype.createGraphics=function(e,t,r,n){return arguments[2]instanceof HTMLCanvasElement&&(r=s.P2D,n=arguments[2]),o.default._validateParameters("createGraphics",arguments),new o.default.Graphics(e,t,r,this,n)},o.default.prototype.createFramebuffer=function(e){return new o.default.Framebuffer(this,e)},o.default.prototype.blendMode=function(e){o.default._validateParameters("blendMode",arguments),e===s.NORMAL&&(console.warn("NORMAL has been deprecated for use in blendMode. defaulting to BLEND instead."),e=s.BLEND),this._renderer.blendMode(e)},o.default);r.default=u},{"../webgl/p5.RendererGL":328,"./constants":262,"./main":273,"./p5.Graphics":275,"./p5.Renderer2D":277,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],280:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=u(e("../main")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../constants")),i=u(e("../helpers"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function u(e){return e&&e.__esModule?e:{default:e}}e("../friendly_errors/fes_core"),e("../friendly_errors/file_errors"),e("../friendly_errors/validate_params"),s.default.prototype._normalizeArcAngles=function(e,t,r,n,o){var s;return e-=a.TWO_PI*Math.floor(e/a.TWO_PI),t-=a.TWO_PI*Math.floor(t/a.TWO_PI),s=Math.min(Math.abs(e-t),a.TWO_PI-Math.abs(e-t)),o&&(e=e<=a.HALF_PI?Math.atan(r/n*Math.tan(e)):e>a.HALF_PI&&e<=3*a.HALF_PI?Math.atan(r/n*Math.tan(e))+a.PI:Math.atan(r/n*Math.tan(e))+a.TWO_PI,t=t<=a.HALF_PI?Math.atan(r/n*Math.tan(t)):t>a.HALF_PI&&t<=3*a.HALF_PI?Math.atan(r/n*Math.tan(t))+a.PI:Math.atan(r/n*Math.tan(t))+a.TWO_PI),t<e&&(t+=a.TWO_PI),{start:e,stop:t,correspondToSamePoint:s<1e-5}},s.default.prototype.arc=function(e,t,r,n,o,a,l,u){return s.default._validateParameters("arc",arguments),(this._renderer._doStroke||this._renderer._doFill)&&o!==a&&(o=this._toRadians(o),a=this._toRadians(a),r=Math.abs(r),n=Math.abs(n),e=i.default.modeAdjust(e,t,r,n,this._renderer._ellipseMode),(t=this._normalizeArcAngles(o,a,e.w,e.h,!0)).correspondToSamePoint?this._renderer.ellipse([e.x,e.y,e.w,e.h,u]):(this._renderer.arc(e.x,e.y,e.w,e.h,t.start,t.stop,l,u),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("arc",[e.x,e.y,e.w,e.h,t.start,t.stop,l]))),this},s.default.prototype.ellipse=function(e,t,r,n,o){return s.default._validateParameters("ellipse",arguments),this._renderEllipse.apply(this,arguments)},s.default.prototype.circle=function(){s.default._validateParameters("circle",arguments);var e=Array.prototype.slice.call(arguments,0,2);return e.push(arguments[2]),e.push(arguments[2]),this._renderEllipse.apply(this,function(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(e))},s.default.prototype._renderEllipse=function(e,t,r,n,o){return(this._renderer._doStroke||this._renderer._doFill)&&(r<0&&(r=Math.abs(r)),void 0===n?n=r:n<0&&(n=Math.abs(n)),e=i.default.modeAdjust(e,t,r,n,this._renderer._ellipseMode),this._renderer.ellipse([e.x,e.y,e.w,e.h,o]),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("ellipse",[e.x,e.y,e.w,e.h])),this},s.default.prototype.line=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("line",r),this._renderer._doStroke&&(e=this._renderer).line.apply(e,r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("line",r),this},s.default.prototype.point=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("point",r),this._renderer._doStroke&&(1===r.length&&r[0]instanceof s.default.Vector?this._renderer.point.call(this._renderer,r[0].x,r[0].y,r[0].z):((e=this._renderer).point.apply(e,r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("point",r))),this},s.default.prototype.quad=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("quad",r),(this._renderer._doStroke||this._renderer._doFill)&&(this._renderer.isP3D&&r.length<12?this._renderer.quad.call(this._renderer,r[0],r[1],0,r[2],r[3],0,r[4],r[5],0,r[6],r[7],0,r[8],r[9]):((e=this._renderer).quad.apply(e,r),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("quadrilateral",r))),this},s.default.prototype.rect=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default._validateParameters("rect",t),this._renderRect.apply(this,t)},s.default.prototype.square=function(e,t,r,n,o,a,i){return s.default._validateParameters("square",arguments),this._renderRect.call(this,e,t,r,r,n,o,a,i)},s.default.prototype._renderRect=function(){if(this._renderer._doStroke||this._renderer._doFill){3===arguments.length&&(arguments[3]=arguments[2]);for(var e=i.default.modeAdjust(arguments[0],arguments[1],arguments[2],arguments[3],this._renderer._rectMode),t=[e.x,e.y,e.w,e.h],r=4;r<arguments.length;r++)t[r]=arguments[r];this._renderer.rect(t),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("rectangle",[e.x,e.y,e.w,e.h])}return this},s.default.prototype.triangle=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default._validateParameters("triangle",t),(this._renderer._doStroke||this._renderer._doFill)&&this._renderer.triangle(t),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._accsOutput("triangle",t),this},e=s.default,r.default=e},{"../constants":262,"../friendly_errors/fes_core":264,"../friendly_errors/file_errors":265,"../friendly_errors/validate_params":268,"../helpers":269,"../main":273,"core-js/modules/es.array.from":157,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],281:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../main"))&&l.__esModule?l:{default:l},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}s.default.prototype.ellipseMode=function(e){return s.default._validateParameters("ellipseMode",arguments),e!==a.CORNER&&e!==a.CORNERS&&e!==a.RADIUS&&e!==a.CENTER||(this._renderer._ellipseMode=e),this},s.default.prototype.noSmooth=function(){return this._renderer.isP3D?this.setAttributes("antialias",!1):"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!1),this},s.default.prototype.rectMode=function(e){return s.default._validateParameters("rectMode",arguments),e!==a.CORNER&&e!==a.CORNERS&&e!==a.RADIUS&&e!==a.CENTER||(this._renderer._rectMode=e),this},s.default.prototype.smooth=function(){return this.setAttributes("antialias",!0),this._renderer.isP3D||"imageSmoothingEnabled"in this.drawingContext&&(this.drawingContext.imageSmoothingEnabled=!0),this},s.default.prototype.strokeCap=function(e){return s.default._validateParameters("strokeCap",arguments),e!==a.ROUND&&e!==a.SQUARE&&e!==a.PROJECT||this._renderer.strokeCap(e),this},s.default.prototype.strokeJoin=function(e){return s.default._validateParameters("strokeJoin",arguments),e!==a.ROUND&&e!==a.BEVEL&&e!==a.MITER||this._renderer.strokeJoin(e),this},s.default.prototype.strokeWeight=function(e){return s.default._validateParameters("strokeWeight",arguments),this._renderer.strokeWeight(e),this};var l=s.default;r.default=l},{"../constants":262,"../main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],282:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(o=e("../main"))&&o.__esModule?o:{default:o};e("../friendly_errors/fes_core"),e("../friendly_errors/file_errors"),e("../friendly_errors/validate_params"),n.default.prototype.bezier=function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.default._validateParameters("bezier",r),(this._renderer._doStroke||this._renderer._doFill)&&(e=this._renderer).bezier.apply(e,r),this},n.default.prototype.bezierDetail=function(e){return n.default._validateParameters("bezierDetail",arguments),this._bezierDetail=e,this},n.default.prototype.bezierPoint=function(e,t,r,o,s){n.default._validateParameters("bezierPoint",arguments);var a=1-s;return Math.pow(a,3)*e+3*Math.pow(a,2)*s*t+3*a*Math.pow(s,2)*r+Math.pow(s,3)*o},n.default.prototype.bezierTangent=function(e,t,r,o,s){n.default._validateParameters("bezierTangent",arguments);var a=1-s;return 3*o*Math.pow(s,2)-3*r*Math.pow(s,2)+6*r*a*s-6*t*a*s+3*t*Math.pow(a,2)-3*e*Math.pow(a,2)},n.default.prototype.curve=function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.default._validateParameters("curve",r),this._renderer._doStroke&&(e=this._renderer).curve.apply(e,r),this},n.default.prototype.curveDetail=function(e){return n.default._validateParameters("curveDetail",arguments),this._curveDetail=e<3?3:e,this},n.default.prototype.curveTightness=function(e){return n.default._validateParameters("curveTightness",arguments),this._renderer._curveTightness=e,this},n.default.prototype.curvePoint=function(e,t,r,o,s){n.default._validateParameters("curvePoint",arguments);var a=this._renderer._curveTightness,i=s*s*s,l=s*s;return e*((a-1)/2*i+(1-a)*l+(a-1)/2*s)+t*((a+3)/2*i+(-5-a)/2*l+1)+r*((-3-a)/2*i+(a+2)*l+(1-a)/2*s)+o*((1-a)/2*i+(a-1)/2*l)},n.default.prototype.curveTangent=function(e,t,r,o,s){n.default._validateParameters("curveTangent",arguments);var a=this._renderer._curveTightness,i=s*s*3;return e*((a-1)/2*i+(1-a)*(s*=2)+(a-1)/2)+t*((a+3)/2*i+(-5-a)/2*s)+r*((-3-a)/2*i+(a+2)*s+(1-a)/2)+o*((1-a)/2*i+(a-1)/2*s)};var o=n.default;r.default=o},{"../friendly_errors/fes_core":264,"../friendly_errors/file_errors":265,"../friendly_errors/validate_params":268,"../main":273}],283:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.slice"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(y=e("../main"))&&y.__esModule?y:{default:y},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}var l=null,u=[],c=[],d=!1,h=!1,p=!1,f=!1,m=!0,y=(s.default.prototype.beginContour=function(){return c=[],f=!0,this},s.default.prototype.beginShape=function(e){var t;return s.default._validateParameters("beginShape",arguments),this._renderer.isP3D?(t=this._renderer).beginShape.apply(t,arguments):(l=e===a.POINTS||e===a.LINES||e===a.TRIANGLES||e===a.TRIANGLE_FAN||e===a.TRIANGLE_STRIP||e===a.QUADS||e===a.QUAD_STRIP?e:null,u=[],c=[]),this},s.default.prototype.bezierVertex=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(s.default._validateParameters("bezierVertex",r),this._renderer.isP3D)(e=this._renderer).bezierVertex.apply(e,r);else if(0===u.length)s.default._friendlyError("vertex() must be used once before calling bezierVertex()","bezierVertex");else{d=!0;for(var o=[],a=0;a<r.length;a++)o[a]=r[a];o.isVert=!1,(f?c:u).push(o)}return this},s.default.prototype.curveVertex=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s.default._validateParameters("curveVertex",r),this._renderer.isP3D?(e=this._renderer).curveVertex.apply(e,r):(h=!0,this.vertex(r[0],r[1])),this},s.default.prototype.endContour=function(){var e=c[0].slice();e.isVert=c[0].isVert,e.moveTo=!1,c.push(e),m&&(u.push(u[0]),m=!1);for(var t=0;t<c.length;t++)u.push(c[t]);return this},s.default.prototype.endShape=function(e){if(s.default._validateParameters("endShape",arguments),this._renderer.isP3D)this._renderer.endShape(e,h,d,p,f,l);else{if(0===u.length)return this;if(!this._renderer._doStroke&&!this._renderer._doFill)return this;var t=e===a.CLOSE;t&&!f&&u.push(u[0]),this._renderer.endShape(e,u,h,d,p,f,l),m=!(f=p=d=h=!1),t&&u.pop()}return this},s.default.prototype.quadraticVertex=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(s.default._validateParameters("quadraticVertex",r),this._renderer.isP3D)(e=this._renderer).quadraticVertex.apply(e,r);else{if(this._contourInited)return(e={}).x=r[0],e.y=r[1],e.x3=r[2],e.y3=r[3],e.type=a.QUADRATIC,this._contourVertices.push(e),this;if(0<u.length){p=!0;for(var o=[],i=0;i<r.length;i++)o[i]=r[i];o.isVert=!1,(f?c:u).push(o)}else s.default._friendlyError("vertex() must be used once before calling quadraticVertex()","quadraticVertex")}return this},s.default.prototype.vertex=function(e,t,r,n,o){var s;return this._renderer.isP3D?(s=this._renderer).vertex.apply(s,arguments):((s=[]).isVert=!0,s[0]=e,s[1]=t,s[2]=0,s[3]=0,s[4]=0,s[5]=this._renderer._getFill(),s[6]=this._renderer._getStroke(),r&&(s.moveTo=r),(f?(0===c.length&&(s.moveTo=!0),c):u).push(s)),this},s.default.prototype.normal=function(e,t,r){var n;return this._assert3d("normal"),s.default._validateParameters("normal",arguments),(n=this._renderer).normal.apply(n,arguments),this},s.default);r.default=y},{"../constants":262,"../main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],284:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function s(e){return(s="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}var a,i,l;e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){window.setTimeout(e,1e3/60)},"undefined"==typeof Uint8ClampedArray||Uint8ClampedArray.prototype.slice||Object.defineProperty(Uint8ClampedArray.prototype,"slice",{value:Array.prototype.slice,writable:!0,configurable:!0,enumerable:!1}),Object.assign||(a=Object.keys,e=Object.defineProperty,i="function"==typeof Symbol&&"symbol"===s(Symbol()),l=Object.prototype.propertyIsEnumerable,e(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("target must be an object");for(var r,n=Object(e),s=1;s<arguments.length;++s){var u=Object(arguments[s]),c=a(u);for(i&&Object.getOwnPropertySymbols&&c.push.apply(c,o(Object.getOwnPropertySymbols(u).filter(function(e){return function(t){return l.call(e,t)}}(u)))),r=0;r<c.length;++r)n[c[r]]=u[c[r]]}return n},configurable:!0,enumerable:!1,writable:!0}))},{"core-js/modules/es.array.filter":155,"core-js/modules/es.array.from":157,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.assign":174,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint8-clamped-array":233,"core-js/modules/web.dom-collections.iterator":236}],285:[function(e,t,r){"use strict";e("core-js/modules/es.array.for-each"),e("core-js/modules/es.object.assign"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.object.assign"),e("core-js/modules/web.dom-collections.for-each"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("./main"))&&e.__esModule?e:{default:e}).default.prototype.noLoop=function(){this._loop=!1},e.default.prototype.loop=function(){this._loop||(this._loop=!0,this._setupDone&&this._draw())},e.default.prototype.isLooping=function(){return this._loop},e.default.prototype.push=function(){this._styles.push({props:{_colorMode:this._colorMode},renderer:this._renderer.push()})},e.default.prototype.pop=function(){var e=this._styles.pop();e?(this._renderer.pop(e.renderer),Object.assign(this,e.props)):console.warn("pop() was called without matching push()")},e.default.prototype.redraw=function(e){if(!this._inUserDraw&&this._setupDone){var t=parseInt(e),r=((isNaN(t)||t<1)&&(t=1),this._isGlobal?window:this);if("function"==typeof r.draw){void 0===r.setup&&r.scale(r._pixelDensity,r._pixelDensity);for(var n=function(e){e.call(r)},o=0;o<t;o++){r.resetMatrix(),(this._accessibleOutputs.grid||this._accessibleOutputs.text)&&this._updateAccsOutput(),r._renderer.isP3D&&r._renderer._update(),r._setProperty("frameCount",r.frameCount+1),r._registeredMethods.pre.forEach(n),this._inUserDraw=!0;try{r.draw()}finally{this._inUserDraw=!1}r._registeredMethods.post.forEach(n)}}}},e=e.default,r.default=e},{"./main":273,"core-js/modules/es.array.for-each":156,"core-js/modules/es.object.assign":174,"core-js/modules/web.dom-collections.for-each":235}],286:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("./main"))&&e.__esModule?e:{default:e};n.default.prototype.applyMatrix=function(){var e=(arguments.length<=0?void 0:arguments[0])instanceof Object.getPrototypeOf(Uint8Array);return Array.isArray(arguments.length<=0?void 0:arguments[0])||e?(e=this._renderer).applyMatrix.apply(e,function(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(arguments.length<=0?void 0:arguments[0])):(e=this._renderer).applyMatrix.apply(e,arguments),this},n.default.prototype.resetMatrix=function(){return this._renderer.resetMatrix(),this},n.default.prototype.rotate=function(e,t){return n.default._validateParameters("rotate",arguments),this._renderer.rotate(this._toRadians(e),t),this},n.default.prototype.rotateX=function(e){return this._assert3d("rotateX"),n.default._validateParameters("rotateX",arguments),this._renderer.rotateX(this._toRadians(e)),this},n.default.prototype.rotateY=function(e){return this._assert3d("rotateY"),n.default._validateParameters("rotateY",arguments),this._renderer.rotateY(this._toRadians(e)),this},n.default.prototype.rotateZ=function(e){return this._assert3d("rotateZ"),n.default._validateParameters("rotateZ",arguments),this._renderer.rotateZ(this._toRadians(e)),this},n.default.prototype.scale=function(e,t,r){var o;return n.default._validateParameters("scale",arguments),e instanceof n.default.Vector?(e=(o=e).x,t=o.y,r=o.z):e instanceof Array&&(e=(o=e)[0],t=o[1],r=o[2]||1),isNaN(t)?t=r=e:isNaN(r)&&(r=1),this._renderer.scale.call(this._renderer,e,t,r),this},n.default.prototype.shearX=function(e){return n.default._validateParameters("shearX",arguments),e=this._toRadians(e),this._renderer.applyMatrix(1,0,Math.tan(e),1,0,0),this},n.default.prototype.shearY=function(e){return n.default._validateParameters("shearY",arguments),e=this._toRadians(e),this._renderer.applyMatrix(1,Math.tan(e),0,1,0,0),this},n.default.prototype.translate=function(e,t,r){return n.default._validateParameters("translate",arguments),this._renderer.isP3D?this._renderer.translate(e,t,r):this._renderer.translate(e,t),this},e=n.default,r.default=e},{"./main":273,"core-js/modules/es.array.from":157,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint8-array":232,"core-js/modules/web.dom-collections.iterator":236}],287:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.ends-with"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator");var o=(e=e("../core/main"))&&e.__esModule?e:{default:e};function s(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(e){return(a="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}o.default.prototype.storeItem=function(e,t){"string"!=typeof e&&console.log("The argument that you passed to storeItem() - ".concat(e," is not a string.")),e.endsWith("p5TypeID")&&console.log("The argument that you passed to storeItem() - ".concat(e," must not end with 'p5TypeID'.")),void 0===t&&console.log("You cannot store undefined variables using storeItem().");var r=a(t);switch(r){case"number":case"boolean":t=t.toString();break;case"object":t instanceof o.default.Color?r="p5.Color":t instanceof o.default.Vector&&(r="p5.Vector",t=[t.x,t.y,t.z]),t=JSON.stringify(t)}localStorage.setItem(e,t),e="".concat(e,"p5TypeID"),localStorage.setItem(e,r)},o.default.prototype.getItem=function(e){var t=localStorage.getItem(e),r=localStorage.getItem("".concat(e,"p5TypeID"));if(void 0===r)console.log("Unable to determine type of item stored under ".concat(e,"in local storage. Did you save the item with something other than setItem()?"));else if(null!==t)switch(r){case"number":t=parseFloat(t);break;case"boolean":t="true"===t;break;case"object":t=JSON.parse(t);break;case"p5.Color":t=JSON.parse(t),t=this.color.apply(this,s(t.levels));break;case"p5.Vector":t=JSON.parse(t),t=this.createVector.apply(this,s(t))}return t},o.default.prototype.clearStorage=function(){localStorage.clear()},o.default.prototype.removeItem=function(e){"string"!=typeof e&&console.log("The argument that you passed to removeItem() - ".concat(e," is not a string.")),localStorage.removeItem(e),localStorage.removeItem("".concat(e,"p5TypeID"))}},{"../core/main":273,"core-js/modules/es.array.from":157,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.ends-with":188,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],288:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(e=e("../core/main"))&&e.__esModule?e:{default:e};function s(e){return(s="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){return function(){var t,r=u(e);if(t=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?(t=u(this).constructor,Reflect.construct(r,arguments,t)):r.apply(this,arguments),r=this,!t||"object"!==s(t)&&"function"!=typeof t){if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function h(e,t,r){t&&d(e.prototype,t),r&&d(e,r)}o.default.prototype.createStringDict=function(e,t){return o.default._validateParameters("createStringDict",arguments),new o.default.StringDict(e,t)},o.default.prototype.createNumberDict=function(e,t){return o.default._validateParameters("createNumberDict",arguments),new o.default.NumberDict(e,t)},o.default.TypedDict=function(){function e(t,r){return c(this,e),t instanceof Object?this.data=t:(this.data={},this.data[t]=r),this}return h(e,[{key:"size",value:function(){return Object.keys(this.data).length}},{key:"hasKey",value:function(e){return this.data.hasOwnProperty(e)}},{key:"get",value:function(e){if(this.data.hasOwnProperty(e))return this.data[e];console.log("".concat(e," does not exist in this Dictionary"))}},{key:"set",value:function(e,t){this._validate(t)?this.data[e]=t:console.log("Those values dont work for this dictionary type.")}},{key:"_addObj",value:function(e){for(var t in e)this.set(t,e[t])}},{key:"create",value:function(e,t){e instanceof Object&&void 0===t?this._addObj(e):void 0!==e?this.set(e,t):console.log("In order to create a new Dictionary entry you must pass an object or a key, value pair")}},{key:"clear",value:function(){this.data={}}},{key:"remove",value:function(e){if(!this.data.hasOwnProperty(e))throw new Error("".concat(e," does not exist in this Dictionary"));delete this.data[e]}},{key:"print",value:function(){for(var e in this.data)console.log("key:".concat(e," value:").concat(this.data[e]))}},{key:"saveTable",value:function(e){var t,r="";for(t in this.data)r+="".concat(t,",").concat(this.data[t],"\n");var n=new Blob([r],{type:"text/csv"});o.default.prototype.downloadFile(n,e||"mycsv","csv")}},{key:"saveJSON",value:function(e,t){o.default.prototype.saveJSON(this.data,e,t)}},{key:"_validate",value:function(e){return!0}}]),e}(),o.default.StringDict=function(){a(t,o.default.TypedDict);var e=l(t);function t(){c(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return e.call.apply(e,[this].concat(n))}return h(t,[{key:"_validate",value:function(e){return"string"==typeof e}}]),t}(),o.default.NumberDict=function(){a(t,o.default.TypedDict);var e=l(t);function t(){c(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return e.call.apply(e,[this].concat(n))}return h(t,[{key:"_validate",value:function(e){return"number"==typeof e}},{key:"add",value:function(e,t){this.data.hasOwnProperty(e)?this.data[e]+=t:console.log("The key - ".concat(e," does not exist in this dictionary."))}},{key:"sub",value:function(e,t){this.add(e,-t)}},{key:"mult",value:function(e,t){this.data.hasOwnProperty(e)?this.data[e]*=t:console.log("The key - ".concat(e," does not exist in this dictionary."))}},{key:"div",value:function(e,t){this.data.hasOwnProperty(e)?this.data[e]/=t:console.log("The key - ".concat(e," does not exist in this dictionary."))}},{key:"_valueTest",value:function(e){if(0===Object.keys(this.data).length)throw new Error("Unable to search for a minimum or maximum value on an empty NumberDict");if(1===Object.keys(this.data).length)return this.data[Object.keys(this.data)[0]];var t,r=this.data[Object.keys(this.data)[0]];for(t in this.data)this.data[t]*e<r*e&&(r=this.data[t]);return r}},{key:"minValue",value:function(){return this._valueTest(1)}},{key:"maxValue",value:function(){return this._valueTest(-1)}},{key:"_keyTest",value:function(e){if(0===Object.keys(this.data).length)throw new Error("Unable to use minValue on an empty NumberDict");if(1===Object.keys(this.data).length)return Object.keys(this.data)[0];for(var t=Object.keys(this.data)[0],r=1;r<Object.keys(this.data).length;r++)Object.keys(this.data)[r]*e<t*e&&(t=Object.keys(this.data)[r]);return t}},{key:"minKey",value:function(){return this._keyTest(1)}},{key:"maxKey",value:function(){return this._keyTest(-1)}}]),t}(),e=o.default.TypedDict,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],289:[function(t,r,n){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t("core-js/modules/es.symbol"),t("core-js/modules/es.symbol.description"),t("core-js/modules/es.symbol.iterator"),t("core-js/modules/es.array.every"),t("core-js/modules/es.array.filter"),t("core-js/modules/es.array.for-each"),t("core-js/modules/es.array.from"),t("core-js/modules/es.array.index-of"),t("core-js/modules/es.array.iterator"),t("core-js/modules/es.array.map"),t("core-js/modules/es.array.slice"),t("core-js/modules/es.array.splice"),t("core-js/modules/es.function.name"),t("core-js/modules/es.object.get-prototype-of"),t("core-js/modules/es.object.to-string"),t("core-js/modules/es.promise"),t("core-js/modules/es.reflect.construct"),t("core-js/modules/es.regexp.exec"),t("core-js/modules/es.regexp.to-string"),t("core-js/modules/es.string.iterator"),t("core-js/modules/es.string.replace"),t("core-js/modules/es.string.split"),t("core-js/modules/es.string.trim"),t("core-js/modules/web.dom-collections.for-each"),t("core-js/modules/web.dom-collections.iterator"),t("core-js/modules/web.url"),t("core-js/modules/es.symbol"),t("core-js/modules/es.symbol.description"),t("core-js/modules/es.symbol.iterator"),t("core-js/modules/es.array.every"),t("core-js/modules/es.array.filter"),t("core-js/modules/es.array.for-each"),t("core-js/modules/es.array.from"),t("core-js/modules/es.array.index-of"),t("core-js/modules/es.array.iterator"),t("core-js/modules/es.array.map"),t("core-js/modules/es.array.slice"),t("core-js/modules/es.array.splice"),t("core-js/modules/es.function.name"),t("core-js/modules/es.object.to-string"),t("core-js/modules/es.promise"),t("core-js/modules/es.reflect.construct"),t("core-js/modules/es.regexp.exec"),t("core-js/modules/es.regexp.to-string"),t("core-js/modules/es.string.iterator"),t("core-js/modules/es.string.replace"),t("core-js/modules/es.string.split"),t("core-js/modules/es.string.trim"),t("core-js/modules/web.dom-collections.for-each"),t("core-js/modules/web.dom-collections.iterator"),t("core-js/modules/web.url"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var s=(t=t("../core/main"))&&t.__esModule?t:{default:t};function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){t&&a(e.prototype,t),r&&a(e,r)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){return function(){var t,r,n=d(e);return t=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?(t=d(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),n=this,!(r=t)||"object"!==p(r)&&"function"!=typeof r?c(n):r}}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e){return(p="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":o(e)})(e)}function f(e,t,r){return(t._userNode||document.body).appendChild(e),r=new(r?s.default.MediaElement:s.default.Element)(e,t),t._elements.push(r),r}function m(e,t,r,n){var o=document.createElement(t),s=("string"==typeof(r=r||"")&&(r=[r]),!0),a=void(t=!1);try{for(var i,l=r[Symbol.iterator]();!(s=(i=l.next()).done);s=!0){var u=i.value,c=document.createElement("source");c.setAttribute("src",u),o.appendChild(c)}}catch(e){t=!0,a=e}finally{try{s||null==l.return||l.return()}finally{if(t)throw a}}"function"==typeof n&&o.addEventListener("canplaythrough",(function e(){n(),o.removeEventListener("canplaythrough",e)}));var d=f(o,e,!0);return d.loadedmetadata=!1,o.addEventListener("loadedmetadata",(function(){d.width=o.videoWidth,d.height=o.videoHeight,0===d.elt.width&&(d.elt.width=o.videoWidth),0===d.elt.height&&(d.elt.height=o.videoHeight),d.presetPlaybackRate&&(d.elt.playbackRate=d.presetPlaybackRate,delete d.presetPlaybackRate),d.loadedmetadata=!0})),d}function y(e,t,r,n){h(this,y),this.callback=e,this.time=t,this.id=r,this.val=n}s.default.prototype.select=function(e,t){return s.default._validateParameters("select",arguments),(t=this._getContainer(t).querySelector(e))?this._wrapElement(t):null},s.default.prototype.selectAll=function(e,t){s.default._validateParameters("selectAll",arguments);var r=[],n=this._getContainer(t).querySelectorAll(e);if(n)for(var o=0;o<n.length;o++){var a=this._wrapElement(n[o]);r.push(a)}return r},s.default.prototype._getContainer=function(e){var t=document;return"string"==typeof e?t=document.querySelector(e)||document:e instanceof s.default.Element?t=e.elt:e instanceof HTMLElement&&(t=e),t},s.default.prototype._wrapElement=function(e){var t,r=Array.prototype.slice.call(e.children);return"INPUT"===e.tagName&&"checkbox"===e.type?((t=new s.default.Element(e,this)).checked=function(){return 0===arguments.length?this.elt.checked:(this.elt.checked=!(arguments.length<=0||!arguments[0]),this)},t):"VIDEO"===e.tagName||"AUDIO"===e.tagName?new s.default.MediaElement(e,this):"SELECT"===e.tagName?this.createSelect(new s.default.Element(e,this)):0<r.length&&r.every((function(e){return"INPUT"===e.tagName||"LABEL"===e.tagName}))?this.createRadio(new s.default.Element(e,this)):new s.default.Element(e,this)},s.default.prototype.removeElements=function(e){s.default._validateParameters("removeElements",arguments),this._elements.filter((function(e){return!(e.elt instanceof HTMLCanvasElement)})).map((function(e){return e.remove()}))},s.default.Element.prototype.changed=function(e){return s.default.Element._adjustListener("change",e,this),this},s.default.Element.prototype.input=function(e){return s.default.Element._adjustListener("input",e,this),this},s.default.prototype.createDiv=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");return t.innerHTML=e,f(t,this)},s.default.prototype.createP=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("p");return t.innerHTML=e,f(t,this)},s.default.prototype.createSpan=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("span");return t.innerHTML=e,f(t,this)},s.default.prototype.createImg=function(){s.default._validateParameters("createImg",arguments);var e,t=document.createElement("img"),r=arguments;return 1<r.length&&"string"==typeof r[1]&&(t.alt=r[1]),2<r.length&&"string"==typeof r[2]&&(t.crossOrigin=r[2]),t.src=r[0],e=f(t,this),t.addEventListener("load",(function(){e.width=t.offsetWidth||t.width,e.height=t.offsetHeight||t.height;var n=r[r.length-1];"function"==typeof n&&n(e)})),e},s.default.prototype.createA=function(e,t,r){s.default._validateParameters("createA",arguments);var n=document.createElement("a");return n.href=e,n.innerHTML=t,r&&(n.target=r),f(n,this)},s.default.prototype.createSlider=function(e,t,r,n){s.default._validateParameters("createSlider",arguments);var o=document.createElement("input");return o.type="range",o.min=e,o.max=t,0===n?o.step=1e-18:n&&(o.step=n),"number"==typeof r&&(o.value=r),f(o,this)},s.default.prototype.createButton=function(e,t){s.default._validateParameters("createButton",arguments);var r=document.createElement("button");return r.innerHTML=e,t&&(r.value=t),f(r,this)},s.default.prototype.createCheckbox=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];s.default._validateParameters("createCheckbox",t);var n=document.createElement("div"),o=document.createElement("input"),a=(o.type="checkbox",document.createElement("label")),i=(a.appendChild(o),n.appendChild(a),f(n,this));return i.checked=function(){var e=i.elt.firstElementChild.getElementsByTagName("input")[0];if(e){if(0===arguments.length)return e.checked;e.checked=!(arguments.length<=0||!arguments[0])}return i},this.value=function(e){return i.value=e,this},t[0]&&(i.value(t[0]),(n=document.createElement("span")).innerHTML=t[0],a.appendChild(n)),t[1]&&(o.checked=!0),i},s.default.prototype.createSelect=function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];s.default._validateParameters("createSelect",r);var o,a=r[0];return a instanceof s.default.Element&&a.elt instanceof HTMLSelectElement?this.elt=(e=a).elt:a instanceof HTMLSelectElement?(e=f(a,this),this.elt=a):(o=document.createElement("select"),a&&"boolean"==typeof a&&o.setAttribute("multiple","true"),e=f(o,this),this.elt=o),e.option=function(e,t){var r;if(void 0!==e){for(var n,o=0;o<this.elt.length;o+=1)if(this.elt[o].textContent===e){r=o;break}void 0!==r?!1===t?this.elt.remove(r):this.elt[r].value=t:((n=document.createElement("option")).textContent=e,n.value=void 0===t?e:t,this.elt.appendChild(n),this._pInst._elements.push(n))}},e.selected=function(e){if(void 0!==e){for(var t=0;t<this.elt.length;t+=1)this.elt[t].value.toString()===e.toString()&&(this.elt.selectedIndex=t);return this}if(this.elt.getAttribute("multiple")){var r=[],n=!0,o=!1,s=void 0;try{for(var a,i=this.elt.selectedOptions[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;r.push(l.value)}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}return r}return this.elt.value},e.disable=function(e){if("string"==typeof e)for(var t=0;t<this.elt.length;t++)this.elt[t].value.toString()===e&&(this.elt[t].disabled=!0,this.elt[t].selected=!1);else this.elt.disabled=!0;return this},e.enable=function(e){if("string"==typeof e)for(var t=0;t<this.elt.length;t++)this.elt[t].value.toString()===e&&(this.elt[t].disabled=!1,this.elt[t].selected=!1);else{this.elt.disabled=!1;for(var r=0;r<this.elt.length;r++)this.elt[r].disabled=!1,this.elt[r].selected=!1}return this},e},s.default.prototype.createRadio=function(){function e(e){return e instanceof HTMLInputElement&&"radio"===e.type}function t(e){return e instanceof HTMLLabelElement}var r,n,o,a=arguments.length<=0?void 0:arguments[0];return a instanceof s.default.Element&&(a.elt instanceof HTMLDivElement||a.elt instanceof HTMLSpanElement)?(r=a,this.elt=a.elt):a instanceof HTMLDivElement||a instanceof HTMLSpanElement?(r=f(a,this),n=this.elt=a,"string"==typeof(arguments.length<=1?void 0:arguments[1])&&(o=arguments.length<=1?void 0:arguments[1])):("string"==typeof a&&(o=a),n=document.createElement("div"),r=f(n,this),this.elt=n),r._name=o||"radioOption",r._getOptionsArray=function(){return Array.from(this.elt.children).filter((function(r){return e(r)||t(r)&&e(r.firstElementChild)})).map((function(t){return e(t)?t:t.firstElementChild}))},r.option=function(e,n){var o,s,a,i=!0,l=!1,u=void 0;try{for(var c,d=r._getOptionsArray()[Symbol.iterator]();!(i=(c=d.next()).done);i=!0){var h=c.value;if(h.value===e){o=h;break}}}catch(e){l=!0,u=e}finally{try{i||null==d.return||d.return()}finally{if(l)throw u}}return void 0===o&&((o=document.createElement("input")).setAttribute("type","radio"),o.setAttribute("value",e)),o.setAttribute("name",r._name),t(o.parentElement)?s=o.parentElement:(s=document.createElement("label")).insertAdjacentElement("afterbegin",o),s.lastElementChild instanceof HTMLSpanElement?a=s.lastElementChild:(a=document.createElement("span"),o.insertAdjacentElement("afterend",a)),a.innerHTML=void 0===n?e:n,this.elt.appendChild(s),o},r.remove=function(e){var n=!0,o=!1,s=void 0;try{for(var a,i=r._getOptionsArray()[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;if(l.value===e)return void(t(l.parentElement)?l.parentElement:l).remove()}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}},r.value=function(){var e="",t=!0,n=!1,o=void 0;try{for(var s,a=r._getOptionsArray()[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var i=s.value;if(i.checked){e=i.value;break}}}catch(e){n=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}return e},r.selected=function(e){var t=null;if(void 0===e){var n=!0,o=!1,s=void 0;try{for(var a,i=r._getOptionsArray()[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;if(l.checked){t=l;break}}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}}else{r._getOptionsArray().forEach((function(e){e.checked=!1,e.removeAttribute("checked")}));var u=!0;o=!1,s=void 0;try{for(var c,d=r._getOptionsArray()[Symbol.iterator]();!(u=(c=d.next()).done);u=!0){var h=c.value;h.value===e&&(h.setAttribute("checked",!0),h.checked=!0,t=h)}}catch(e){o=!0,s=e}finally{try{u||null==d.return||d.return()}finally{if(o)throw s}}}return t},r.disable=function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!0,n=!1,o=void 0;try{for(var s,a=r._getOptionsArray()[Symbol.iterator]();!(t=(s=a.next()).done);t=!0)s.value.setAttribute("disabled",e)}catch(e){n=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}},r},s.default.prototype.createColorPicker=function(e){s.default._validateParameters("createColorPicker",arguments);var t=document.createElement("input");return t.type="color",e?e instanceof s.default.Color?t.value=e.toString("#rrggbb"):(s.default.prototype._colorMode="rgb",s.default.prototype._colorMaxes={rgb:[255,255,255,255],hsb:[360,100,100,1],hsl:[360,100,100,1]},t.value=s.default.prototype.color(e).toString("#rrggbb")):t.value="#000000",(t=f(t,this)).color=function(){return e&&(e.mode&&(s.default.prototype._colorMode=e.mode),e.maxes&&(s.default.prototype._colorMaxes=e.maxes)),s.default.prototype.color(this.elt.value)},t},s.default.prototype.createInput=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"text",r=(s.default._validateParameters("createInput",arguments),document.createElement("input"));return r.setAttribute("value",e),r.setAttribute("type",t),f(r,this)},s.default.prototype.createFileInput=function(e){var t,r=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(s.default._validateParameters("createFileInput",arguments),window.File&&window.FileReader&&window.FileList&&window.Blob)return(t=document.createElement("input")).setAttribute("type","file"),r&&t.setAttribute("multiple",!0),t.addEventListener("change",(function(t){var r=!0,n=!1,o=void 0;try{for(var a,i=t.target.files[Symbol.iterator]();!(r=(a=i.next()).done);r=!0){var l=a.value;s.default.File._load(l,e)}}catch(t){n=!0,o=t}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}}),!1),f(t,this);console.log("The File APIs are not fully supported in this browser. Cannot create element.")},s.default.prototype.createVideo=function(e,t){return s.default._validateParameters("createVideo",arguments),m(this,"video",e,t)},s.default.prototype.createAudio=function(e,t){return s.default._validateParameters("createAudio",arguments),m(this,"audio",e,t)},s.default.prototype.VIDEO="video",s.default.prototype.AUDIO="audio",void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.webkitGetUserMedia||navigator.mozGetUserMedia;return t?new Promise((function(r,n){t.call(navigator,e,r,n)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}),s.default.prototype.createCapture=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(s.default._validateParameters("createCapture",t),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new DOMException("getUserMedia not supported in this browser");for(var n,o=!0,a=!0,i=0,l=t;i<l.length;i++){var u=l[i];u===s.default.prototype.VIDEO?a=!1:u===s.default.prototype.AUDIO?o=!1:"object"===p(u)?c=u:"function"==typeof u&&(n=u)}var c=c||{video:o,audio:a},d=document.createElement("video"),h=(d.setAttribute("playsinline",""),navigator.mediaDevices.getUserMedia(c).then((function(e){try{"srcObject"in d?d.srcObject=e:d.src=window.URL.createObjectURL(e)}catch(t){d.src=e}}),console.log),f(d,this,!0));return h.loadedmetadata=!1,d.addEventListener("loadedmetadata",(function(){d.play(),d.width?(h.width=d.width,h.height=d.height):(h.width=h.elt.width=d.videoWidth,h.height=h.elt.height=d.videoHeight),h.loadedmetadata=!0,n&&n(d.srcObject)})),h},s.default.prototype.createElement=function(e,t){return s.default._validateParameters("createElement",arguments),e=document.createElement(e),void 0!==t&&(e.innerHTML=t),f(e,this)},s.default.Element.prototype.addClass=function(e){return this.elt.className?this.hasClass(e)||(this.elt.className=this.elt.className+" "+e):this.elt.className=e,this},s.default.Element.prototype.removeClass=function(e){return this.elt.classList.remove(e),this},s.default.Element.prototype.hasClass=function(e){return this.elt.classList.contains(e)},s.default.Element.prototype.toggleClass=function(e){return this.elt.classList.contains(e)?this.elt.classList.remove(e):this.elt.classList.add(e),this},s.default.Element.prototype.child=function(e){return void 0===e?this.elt.childNodes:("string"==typeof e?("#"===e[0]&&(e=e.substring(1)),e=document.getElementById(e)):e instanceof s.default.Element&&(e=e.elt),e instanceof HTMLElement&&this.elt.appendChild(e),this)},s.default.Element.prototype.center=function(e){var t=this.elt.style.display,r="none"===this.elt.style.display,n="none"===this.parent().style.display,o={x:this.elt.offsetLeft,y:this.elt.offsetTop},s=(r&&this.show(),n&&this.parent().show(),this.elt.style.display="block",this.position(0,0),Math.abs(this.parent().offsetWidth-this.elt.offsetWidth)),a=Math.abs(this.parent().offsetHeight-this.elt.offsetHeight);return"both"===e||void 0===e?this.position(s/2+this.parent().offsetLeft,a/2+this.parent().offsetTop):"horizontal"===e?this.position(s/2+this.parent().offsetLeft,o.y):"vertical"===e&&this.position(o.x,a/2+this.parent().offsetTop),this.style("display",t),r&&this.hide(),n&&this.parent().hide(),this},s.default.Element.prototype.html=function(){return 0===arguments.length?this.elt.innerHTML:(arguments.length<=1||!arguments[1]?this.elt.innerHTML=arguments.length<=0?void 0:arguments[0]:this.elt.insertAdjacentHTML("beforeend",arguments.length<=0?void 0:arguments[0]),this)},s.default.Element.prototype.position=function(){return 0===arguments.length?{x:this.elt.offsetLeft,y:this.elt.offsetTop}:(this.elt.style.position="static"!==(arguments.length<=2?void 0:arguments[2])&&"fixed"!==(arguments.length<=2?void 0:arguments[2])&&"relative"!==(arguments.length<=2?void 0:arguments[2])&&"sticky"!==(arguments.length<=2?void 0:arguments[2])&&"initial"!==(arguments.length<=2?void 0:arguments[2])&&"inherit"!==(arguments.length<=2?void 0:arguments[2])?"absolute":arguments.length<=2?void 0:arguments[2],this.elt.style.left=(arguments.length<=0?void 0:arguments[0])+"px",this.elt.style.top=(arguments.length<=1?void 0:arguments[1])+"px",this.x=arguments.length<=0?void 0:arguments[0],this.y=arguments.length<=1?void 0:arguments[1],this)},s.default.Element.prototype._translate=function(){this.elt.style.position="absolute";var e="";return this.elt.style.transform&&(e=(e=this.elt.style.transform.replace(/translate3d\(.*\)/g,"")).replace(/translate[X-Z]?\(.*\)/g,"")),2===arguments.length?this.elt.style.transform="translate("+(arguments.length<=0?void 0:arguments[0])+"px, "+(arguments.length<=1?void 0:arguments[1])+"px)":2<arguments.length&&(this.elt.style.transform="translate3d("+(arguments.length<=0?void 0:arguments[0])+"px,"+(arguments.length<=1?void 0:arguments[1])+"px,"+(arguments.length<=2?void 0:arguments[2])+"px)",this.elt.parentElement.style.perspective=3===arguments.length?"1000px":(arguments.length<=3?void 0:arguments[3])+"px"),this.elt.style.transform+=e,this},s.default.Element.prototype._rotate=function(){var e="";return this.elt.style.transform&&(e=(e=this.elt.style.transform.replace(/rotate3d\(.*\)/g,"")).replace(/rotate[X-Z]?\(.*\)/g,"")),1===arguments.length?this.elt.style.transform="rotate("+(arguments.length<=0?void 0:arguments[0])+"deg)":2===arguments.length?this.elt.style.transform="rotate("+(arguments.length<=0?void 0:arguments[0])+"deg, "+(arguments.length<=1?void 0:arguments[1])+"deg)":3===arguments.length&&(this.elt.style.transform="rotateX("+(arguments.length<=0?void 0:arguments[0])+"deg)",this.elt.style.transform+="rotateY("+(arguments.length<=1?void 0:arguments[1])+"deg)",this.elt.style.transform+="rotateZ("+(arguments.length<=2?void 0:arguments[2])+"deg)"),this.elt.style.transform+=e,this},s.default.Element.prototype.style=function(e,t){if(void 0===(t=t instanceof s.default.Color?"rgba("+t.levels[0]+","+t.levels[1]+","+t.levels[2]+","+t.levels[3]/255+")":t)){if(-1===e.indexOf(":"))return window.getComputedStyle(this.elt).getPropertyValue(e);for(var r=e.split(";"),n=0;n<r.length;n++){var o=r[n].split(":");o[0]&&o[1]&&(this.elt.style[o[0].trim()]=o[1].trim())}}else this.elt.style[e]=t,"width"!==e&&"height"!==e&&"left"!==e&&"top"!==e||(t=window.getComputedStyle(this.elt).getPropertyValue(e).replace(/[^\d.]/g,""),this[e]=Math.round(parseFloat(t,10)));return this},s.default.Element.prototype.attribute=function(e,t){if(null==this.elt.firstChild||"checkbox"!==this.elt.firstChild.type&&"radio"!==this.elt.firstChild.type)return void 0===t?this.elt.getAttribute(e):(this.elt.setAttribute(e,t),this);if(void 0===t)return this.elt.firstChild.getAttribute(e);for(var r=0;r<this.elt.childNodes.length;r++)this.elt.childNodes[r].setAttribute(e,t)},s.default.Element.prototype.removeAttribute=function(e){if(null!=this.elt.firstChild&&("checkbox"===this.elt.firstChild.type||"radio"===this.elt.firstChild.type))for(var t=0;t<this.elt.childNodes.length;t++)this.elt.childNodes[t].removeAttribute(e);return this.elt.removeAttribute(e),this},s.default.Element.prototype.value=function(){return 0<arguments.length?(this.elt.value=arguments.length<=0?void 0:arguments[0],this):"range"===this.elt.type?parseFloat(this.elt.value):this.elt.value},s.default.Element.prototype.show=function(){return this.elt.style.display="block",this},s.default.Element.prototype.hide=function(){return this.elt.style.display="none",this},s.default.Element.prototype.size=function(e,t){if(0===arguments.length)return{width:this.elt.offsetWidth,height:this.elt.offsetHeight};var r=e,n=t,o=s.default.prototype.AUTO;if(r!==o||n!==o){if(r===o?r=t*this.width/this.height:n===o&&(n=e*this.height/this.width),this.elt instanceof HTMLCanvasElement){var a,i={},l=this.elt.getContext("2d");for(a in l)i[a]=l[a];for(a in this.elt.setAttribute("width",r*this._pInst._pixelDensity),this.elt.setAttribute("height",n*this._pInst._pixelDensity),this.elt.style.width=r+"px",this.elt.style.height=n+"px",this._pInst.scale(this._pInst._pixelDensity,this._pInst._pixelDensity),i)this.elt.getContext("2d")[a]=i[a]}else this.elt.style.width=r+"px",this.elt.style.height=n+"px",this.elt.width=r,this.elt.height=n;this.width=this.elt.offsetWidth,this.height=this.elt.offsetHeight,this._pInst&&this._pInst._curElement&&this._pInst._curElement.elt===this.elt&&(this._pInst._setProperty("width",this.elt.offsetWidth),this._pInst._setProperty("height",this.elt.offsetHeight))}return this},s.default.Element.prototype.remove=function(){this instanceof s.default.MediaElement&&(this.stop(),null!==(t=this.elt.srcObject)&&t.getTracks().forEach((function(e){e.stop()})));var e,t=this._pInst._elements.indexOf(this);for(e in-1!==t&&this._pInst._elements.splice(t,1),this._events)this.elt.removeEventListener(e,this._events[e]);this.elt&&this.elt.parentNode&&this.elt.parentNode.removeChild(this.elt)},s.default.Element.prototype.drop=function(e,t){var r;return window.File&&window.FileReader&&window.FileList&&window.Blob?(this._dragDisabled||(this._dragDisabled=!0,this.elt.addEventListener("dragover",r=function(e){e.preventDefault()}),this.elt.addEventListener("dragleave",r)),s.default.Element._attachListener("drop",(function(r){r.preventDefault(),"function"==typeof t&&t.call(this,r),r=r.dataTransfer.files;var n=!0,o=!1,a=void 0;try{for(var i,l=r[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var u=i.value;s.default.File._load(u,e)}}catch(r){o=!0,a=r}finally{try{n||null==l.return||l.return()}finally{if(o)throw a}}}),this)):console.log("The File APIs are not fully supported in this browser."),this},t=function(t){var r=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&l(r,t);var n=u(o);function o(e,t){h(this,o);var r=c(t=n.call(this,e,t));return t.elt.crossOrigin="anonymous",t._prevTime=0,t._cueIDCounter=0,t._cues=[],t.pixels=[],t._pixelsState=c(t),t._pixelDensity=1,t._modified=!1,t._frameOnCanvas=-1,Object.defineProperty(r,"src",{get:function(){var e=r.elt.children[0].src,t=r.elt.src===window.location.href?"":r.elt.src;return e===window.location.href?t:e},set:function(t){for(var n=0;n<r.elt.children.length;n++)r.elt.removeChild(r.elt.children[n]);var o=document.createElement("source");o.src=t,e.appendChild(o),r.elt.src=t,r.modified=!0}}),r._onended=function(){},r.elt.onended=function(){r._onended(r)},t}return i(o,[{key:"play",value:function(){var e;return this.elt.currentTime===this.elt.duration&&(this.elt.currentTime=0),1<this.elt.readyState||this.elt.load(),(e=this.elt.play())&&e.catch&&e.catch((function(e){"NotAllowedError"===e.name?console.error(e):console.error("Media play method encountered an unexpected error",e)})),this}},{key:"stop",value:function(){return this.elt.pause(),this.elt.currentTime=0,this}},{key:"pause",value:function(){return this.elt.pause(),this}},{key:"loop",value:function(){return this.elt.setAttribute("loop",!0),this.play(),this}},{key:"noLoop",value:function(){return this.elt.removeAttribute("loop"),this}},{key:"_setupAutoplayFailDetection",value:function(){var t=setTimeout((function(){console.error(e)}),500);this.elt.addEventListener("play",(function(){return clearTimeout(t)}),{passive:!0,once:!0})}},{key:"autoplay",value:function(e){var t=this,r=this.elt.getAttribute("autoplay");return this.elt.setAttribute("autoplay",e),e&&!r&&(e=function(){return t._setupAutoplayFailDetection()},4===this.elt.readyState?e():this.elt.addEventListener("canplay",e,{passive:!0,once:!0})),this}},{key:"volume",value:function(e){if(void 0===e)return this.elt.volume;this.elt.volume=e}},{key:"speed",value:function(e){if(void 0===e)return this.presetPlaybackRate||this.elt.playbackRate;this.loadedmetadata?this.elt.playbackRate=e:this.presetPlaybackRate=e}},{key:"time",value:function(e){return void 0===e?this.elt.currentTime:(this.elt.currentTime=e,this)}},{key:"duration",value:function(){return this.elt.duration}},{key:"_ensureCanvas",value:function(){this.canvas||(this.canvas=document.createElement("canvas"),this.drawingContext=this.canvas.getContext("2d"),this.setModified(!0));var e=this._frameOnCanvas!==this._pInst.frameCount;this.loadedmetadata&&e&&(this.canvas.width!==this.elt.width&&(this.canvas.width=this.elt.width,this.canvas.height=this.elt.height,this.width=this.canvas.width,this.height=this.canvas.height),this.drawingContext.drawImage(this.elt,0,0,this.canvas.width,this.canvas.height),this.setModified(!0),this._frameOnCanvas=this._pInst.frameCount)}},{key:"loadPixels",value:function(){this._ensureCanvas();for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default.Renderer2D.prototype.loadPixels.apply(this,t)}},{key:"updatePixels",value:function(e,t,r,n){return this.loadedmetadata&&(this._ensureCanvas(),s.default.Renderer2D.prototype.updatePixels.call(this,e,t,r,n)),this.setModified(!0),this}},{key:"get",value:function(){this._ensureCanvas();for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default.Renderer2D.prototype.get.apply(this,t)}},{key:"_getPixel",value:function(){this.loadPixels();for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default.Renderer2D.prototype._getPixel.apply(this,t)}},{key:"set",value:function(e,t,r){this.loadedmetadata&&(this._ensureCanvas(),s.default.Renderer2D.prototype.set.call(this,e,t,r),this.setModified(!0))}},{key:"copy",value:function(){this._ensureCanvas();for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];s.default.prototype.copy.apply(this,t)}},{key:"mask",value:function(){this.loadPixels(),this.setModified(!0);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];s.default.Image.prototype.mask.apply(this,t)}},{key:"isModified",value:function(){return this._modified}},{key:"setModified",value:function(e){this._modified=e}},{key:"onended",value:function(e){return this._onended=e,this}},{key:"connect",value:function(e){var t,r;if("function"==typeof s.default.prototype.getAudioContext)t=s.default.prototype.getAudioContext(),r=s.default.soundOut.input;else try{r=(t=e.context).destination}catch(e){throw"connect() is meant to be used with Web Audio API or p5.sound.js"}this.audioSourceNode||(this.audioSourceNode=t.createMediaElementSource(this.elt),this.audioSourceNode.connect(r)),e?e.input?this.audioSourceNode.connect(e.input):this.audioSourceNode.connect(e):this.audioSourceNode.connect(r)}},{key:"disconnect",value:function(){if(!this.audioSourceNode)throw"nothing to disconnect";this.audioSourceNode.disconnect()}},{key:"showControls",value:function(){this.elt.style["text-align"]="inherit",this.elt.controls=!0}},{key:"hideControls",value:function(){this.elt.controls=!1}},{key:"addCue",value:function(e,t,r){var n=this._cueIDCounter++;return t=new y(t,e,n,r),this._cues.push(t),this.elt.ontimeupdate||(this.elt.ontimeupdate=this._onTimeUpdate.bind(this)),n}},{key:"removeCue",value:function(e){for(var t=0;t<this._cues.length;t++)this._cues[t].id===e&&(console.log(e),this._cues.splice(t,1));0===this._cues.length&&(this.elt.ontimeupdate=null)}},{key:"clearCues",value:function(){this._cues=[],this.elt.ontimeupdate=null}},{key:"_onTimeUpdate",value:function(){for(var e=this.time(),t=0;t<this._cues.length;t++){var r=this._cues[t].time,n=this._cues[t].val;this._prevTime<r&&r<=e&&this._cues[t].callback(n)}this._prevTime=e}}]),o}(s.default.Element),s.default.MediaElement=t,t=function(){function e(t,r){h(this,e),this.file=t,this._pInst=r,r=t.type.split("/"),this.type=r[0],this.subtype=r[1],this.name=t.name,this.size=t.size,this.data=void 0}return i(e,null,[{key:"_createLoader",value:function(e,t){var r=new FileReader;return r.onload=function(r){var n,o=new s.default.File(e);"application/json"===o.file.type?o.data=JSON.parse(r.target.result):"text/xml"===o.file.type?(n=(new DOMParser).parseFromString(r.target.result,"text/xml"),o.data=new s.default.XML(n.documentElement)):o.data=r.target.result,t(o)},r}},{key:"_load",value:function(e,t){var r;/^text\//.test(e.type)||"application/json"===e.type?s.default.File._createLoader(e,t).readAsText(e):/^(video|audio)\//.test(e.type)?((r=new s.default.File(e)).data=URL.createObjectURL(e),t(r)):s.default.File._createLoader(e,t).readAsDataURL(e)}}]),e}(),s.default.File=t,t=s.default,n.default=t},{"../core/main":273,"core-js/modules/es.array.every":153,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.from":157,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.splice":166,"core-js/modules/es.function.name":167,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.to-string":180,"core-js/modules/es.promise":181,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.replace":194,"core-js/modules/es.string.split":196,"core-js/modules/es.string.trim":199,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.for-each":235,"core-js/modules/web.dom-collections.iterator":236,"core-js/modules/web.url":238}],290:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(y=e("../core/main"))&&y.__esModule?y:{default:y},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}s.default.prototype.deviceOrientation=1<window.innerWidth/window.innerHeight?"landscape":"portrait",s.default.prototype.accelerationX=0,s.default.prototype.accelerationY=0,s.default.prototype.accelerationZ=0,s.default.prototype.pAccelerationX=0,s.default.prototype.pAccelerationY=0,s.default.prototype.pAccelerationZ=0,s.default.prototype._updatePAccelerations=function(){this._setProperty("pAccelerationX",this.accelerationX),this._setProperty("pAccelerationY",this.accelerationY),this._setProperty("pAccelerationZ",this.accelerationZ)},s.default.prototype.rotationX=0,s.default.prototype.rotationY=0,s.default.prototype.rotationZ=0,s.default.prototype.pRotationX=0,s.default.prototype.pRotationY=0;var l=s.default.prototype.pRotationZ=0,u=0,c=0,d="clockwise",h="clockwise",p="clockwise",f=(s.default.prototype.pRotateDirectionX=void 0,s.default.prototype.pRotateDirectionY=void 0,s.default.prototype.pRotateDirectionZ=void 0,s.default.prototype._updatePRotations=function(){this._setProperty("pRotationX",this.rotationX),this._setProperty("pRotationY",this.rotationY),this._setProperty("pRotationZ",this.rotationZ)},s.default.prototype.turnAxis=void 0,.5),m=30,y=(s.default.prototype.setMoveThreshold=function(e){s.default._validateParameters("setMoveThreshold",arguments),f=e},s.default.prototype.setShakeThreshold=function(e){s.default._validateParameters("setShakeThreshold",arguments),m=e},s.default.prototype._ondeviceorientation=function(e){this._updatePRotations(),this._angleMode===a.radians&&(e.beta=e.beta*(_PI/180),e.gamma=e.gamma*(_PI/180),e.alpha=e.alpha*(_PI/180)),this._setProperty("rotationX",e.beta),this._setProperty("rotationY",e.gamma),this._setProperty("rotationZ",e.alpha),this._handleMotion()},s.default.prototype._ondevicemotion=function(e){this._updatePAccelerations(),this._setProperty("accelerationX",2*e.acceleration.x),this._setProperty("accelerationY",2*e.acceleration.y),this._setProperty("accelerationZ",2*e.acceleration.z),this._handleMotion()},s.default.prototype._handleMotion=function(){90===window.orientation||-90===window.orientation?this._setProperty("deviceOrientation","landscape"):0===window.orientation?this._setProperty("deviceOrientation","portrait"):void 0===window.orientation&&this._setProperty("deviceOrientation","undefined");var e,t,r,n,o,s=this._isGlobal?window:this;"function"==typeof s.deviceMoved&&(Math.abs(this.accelerationX-this.pAccelerationX)>f||Math.abs(this.accelerationY-this.pAccelerationY)>f||Math.abs(this.accelerationZ-this.pAccelerationZ)>f)&&s.deviceMoved(),"function"==typeof s.deviceTurned&&(t=this.rotationX+180,e=this.pRotationX+180,r=l+180,0<t-e&&t-e<270||t-e<-270?d="clockwise":(t-e<0||270<t-e)&&(d="counter-clockwise"),d!==this.pRotateDirectionX&&(r=t),90<Math.abs(t-r)&&Math.abs(t-r)<270&&(r=t,this._setProperty("turnAxis","X"),s.deviceTurned()),this.pRotateDirectionX=d,l=r-180,e=this.rotationY+180,t=this.pRotationY+180,r=u+180,0<e-t&&e-t<270||e-t<-270?h="clockwise":(e-t<0||270<e-this.pRotationY)&&(h="counter-clockwise"),h!==this.pRotateDirectionY&&(r=e),90<Math.abs(e-r)&&Math.abs(e-r)<270&&(r=e,this._setProperty("turnAxis","Y"),s.deviceTurned()),this.pRotateDirectionY=h,u=r-180,0<this.rotationZ-this.pRotationZ&&this.rotationZ-this.pRotationZ<270||this.rotationZ-this.pRotationZ<-270?p="clockwise":(this.rotationZ-this.pRotationZ<0||270<this.rotationZ-this.pRotationZ)&&(p="counter-clockwise"),p!==this.pRotateDirectionZ&&(c=this.rotationZ),90<Math.abs(this.rotationZ-c)&&Math.abs(this.rotationZ-c)<270&&(c=this.rotationZ,this._setProperty("turnAxis","Z"),s.deviceTurned()),this.pRotateDirectionZ=p,this._setProperty("turnAxis",void 0)),"function"==typeof s.deviceShaken&&(null!==this.pAccelerationX&&(n=Math.abs(this.accelerationX-this.pAccelerationX),o=Math.abs(this.accelerationY-this.pAccelerationY)),m<n+o&&s.deviceShaken())},s.default);r.default=y},{"../core/constants":262,"../core/main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],291:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.isKeyPressed=!1,n.default.prototype.keyIsPressed=!1,n.default.prototype.key="",n.default.prototype.keyCode=0,n.default.prototype._onkeydown=function(e){var t;this._downKeys[e.which]||(this._setProperty("isKeyPressed",!0),this._setProperty("keyIsPressed",!0),this._setProperty("keyCode",e.which),this._downKeys[e.which]=!0,this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which),"function"!=typeof(t=this._isGlobal?window:this).keyPressed||e.charCode||!1===t.keyPressed(e)&&e.preventDefault())},n.default.prototype._onkeyup=function(e){this._downKeys[e.which]=!1,this._areDownKeys()||(this._setProperty("isKeyPressed",!1),this._setProperty("keyIsPressed",!1)),this._setProperty("_lastKeyCodeTyped",null),this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which),this._setProperty("keyCode",e.which);var t=this._isGlobal?window:this;"function"==typeof t.keyReleased&&!1===t.keyReleased(e)&&e.preventDefault()},n.default.prototype._onkeypress=function(e){var t;e.which!==this._lastKeyCodeTyped&&(this._setProperty("_lastKeyCodeTyped",e.which),this._setProperty("key",e.key||String.fromCharCode(e.which)||e.which),"function"==typeof(t=this._isGlobal?window:this).keyTyped&&!1===t.keyTyped(e)&&e.preventDefault())},n.default.prototype._onblur=function(e){this._downKeys={}},n.default.prototype.keyIsDown=function(e){return n.default._validateParameters("keyIsDown",arguments),this._downKeys[e]||!1},n.default.prototype._areDownKeys=function(){for(var e in this._downKeys)if(this._downKeys.hasOwnProperty(e)&&!0===this._downKeys[e])return!0;return!1},e=n.default,r.default=e},{"../core/main":273}],292:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.string.includes"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(s=e("../core/main"))&&s.__esModule?s:{default:s},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}s.default.prototype.movedX=0,s.default.prototype.movedY=0,s.default.prototype._hasMouseInteracted=!1,s.default.prototype.mouseX=0,s.default.prototype.mouseY=0,s.default.prototype.pmouseX=0,s.default.prototype.pmouseY=0,s.default.prototype.winMouseX=0,s.default.prototype.winMouseY=0,s.default.prototype.pwinMouseX=0,s.default.prototype.pwinMouseY=0,s.default.prototype.mouseButton=0,s.default.prototype.mouseIsPressed=!1,s.default.prototype._updateNextMouseCoords=function(e){var t,r,n,o,s;null!==this._curElement&&(!e.touches||0<e.touches.length)&&(t=this._curElement.elt,r=this.width,n=this.height,(o=e)&&!o.clientX&&(o.touches?o=o.touches[0]:o.changedTouches&&(o=o.changedTouches[0])),s=t.getBoundingClientRect(),r=t.scrollWidth/r||1,t=t.scrollHeight/n||1,n={x:(o.clientX-s.left)/r,y:(o.clientY-s.top)/t,winX:o.clientX,winY:o.clientY,id:o.identifier},this._setProperty("movedX",e.movementX),this._setProperty("movedY",e.movementY),this._setProperty("mouseX",n.x),this._setProperty("mouseY",n.y),this._setProperty("winMouseX",n.winX),this._setProperty("winMouseY",n.winY)),this._hasMouseInteracted||(this._updateMouseCoords(),this._setProperty("_hasMouseInteracted",!0))},s.default.prototype._updateMouseCoords=function(){this._setProperty("pmouseX",this.mouseX),this._setProperty("pmouseY",this.mouseY),this._setProperty("pwinMouseX",this.winMouseX),this._setProperty("pwinMouseY",this.winMouseY),this._setProperty("_pmouseWheelDeltaY",this._mouseWheelDeltaY)},s.default.prototype._setMouseButton=function(e){1===e.button?this._setProperty("mouseButton",a.CENTER):2===e.button?this._setProperty("mouseButton",a.RIGHT):this._setProperty("mouseButton",a.LEFT)},s.default.prototype._onmousemove=function(e){var t=this._isGlobal?window:this;this._updateNextMouseCoords(e),this.mouseIsPressed?"function"==typeof t.mouseDragged?!1===t.mouseDragged(e)&&e.preventDefault():"function"==typeof t.touchMoved&&!1===t.touchMoved(e)&&e.preventDefault():"function"==typeof t.mouseMoved&&!1===t.mouseMoved(e)&&e.preventDefault()},s.default.prototype._onmousedown=function(e){var t=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._setMouseButton(e),this._updateNextMouseCoords(e),"function"==typeof t.mousePressed?!1===t.mousePressed(e)&&e.preventDefault():navigator.userAgent.toLowerCase().includes("safari")&&"function"==typeof t.touchStarted&&!1===t.touchStarted(e)&&e.preventDefault()},s.default.prototype._onmouseup=function(e){var t=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!1),"function"==typeof t.mouseReleased?!1===t.mouseReleased(e)&&e.preventDefault():"function"==typeof t.touchEnded&&!1===t.touchEnded(e)&&e.preventDefault()},s.default.prototype._ondragend=s.default.prototype._onmouseup,s.default.prototype._ondragover=s.default.prototype._onmousemove,s.default.prototype._onclick=function(e){var t=this._isGlobal?window:this;"function"==typeof t.mouseClicked&&!1===t.mouseClicked(e)&&e.preventDefault()},s.default.prototype._ondblclick=function(e){var t=this._isGlobal?window:this;"function"==typeof t.doubleClicked&&!1===t.doubleClicked(e)&&e.preventDefault()},s.default.prototype._mouseWheelDeltaY=0,s.default.prototype._pmouseWheelDeltaY=0,s.default.prototype._onwheel=function(e){var t=this._isGlobal?window:this;this._setProperty("_mouseWheelDeltaY",e.deltaY),"function"==typeof t.mouseWheel&&(e.delta=e.deltaY,!1===t.mouseWheel(e)&&e.preventDefault())},s.default.prototype.requestPointerLock=function(){var e=this._curElement.elt;return e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock,e.requestPointerLock?(e.requestPointerLock(),!0):(console.log("requestPointerLock is not implemented in this browser"),!1)},s.default.prototype.exitPointerLock=function(){document.exitPointerLock()},e=s.default,r.default=e},{"../core/constants":262,"../core/main":273,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],293:[function(e,t,r){"use strict";e("core-js/modules/es.array.includes"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.string.includes"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype.touches=[],e.default.prototype._updateTouchCoords=function(e){if(null!==this._curElement){for(var t=[],r=0;r<e.touches.length;r++)t[r]=function(e,t,r,n){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=e.getBoundingClientRect();return t=e.scrollWidth/t||1,e=e.scrollHeight/r||1,{x:((r=n.touches[o]||n.changedTouches[o]).clientX-s.left)/t,y:(r.clientY-s.top)/e,winX:r.clientX,winY:r.clientY,id:r.identifier}}(this._curElement.elt,this.width,this.height,e,r);this._setProperty("touches",t)}},e.default.prototype._ontouchstart=function(e){var t=this._isGlobal?window:this;this._setProperty("mouseIsPressed",!0),this._updateTouchCoords(e),this._updateNextMouseCoords(e),this._updateMouseCoords(),"function"==typeof t.touchStarted?!1===t.touchStarted(e)&&e.preventDefault():navigator.userAgent.toLowerCase().includes("safari")&&"function"==typeof t.mousePressed&&!1===t.mousePressed(e)&&e.preventDefault()},e.default.prototype._ontouchmove=function(e){var t=this._isGlobal?window:this;this._updateTouchCoords(e),this._updateNextMouseCoords(e),"function"==typeof t.touchMoved?!1===t.touchMoved(e)&&e.preventDefault():"function"==typeof t.mouseDragged&&!1===t.mouseDragged(e)&&e.preventDefault()},e.default.prototype._ontouchend=function(e){this._setProperty("mouseIsPressed",!1),this._updateTouchCoords(e),this._updateNextMouseCoords(e);var t=this._isGlobal?window:this;"function"==typeof t.touchEnded?!1===t.touchEnded(e)&&e.preventDefault():"function"==typeof t.mouseReleased&&!1===t.mouseReleased(e)&&e.preventDefault()},e=e.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.includes":158,"core-js/modules/es.string.includes":189}],294:[function(e,t,r){"use strict";e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.int32-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.int32-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n,o,s,a,i={_toPixels:function(e){var t,r;return e instanceof ImageData?e.data:e.getContext("2d")?e.getContext("2d").getImageData(0,0,e.width,e.height).data:e.getContext("webgl")?(r=(t=e.getContext("webgl")).drawingBufferWidth*t.drawingBufferHeight*4,r=new Uint8Array(r),t.readPixels(0,0,e.width,e.height,t.RGBA,t.UNSIGNED_BYTE,r),r):void 0},_getARGB:function(e,t){return e[3+(t*=4)]<<24&4278190080|e[t]<<16&16711680|e[1+t]<<8&65280|255&e[2+t]},_setPixels:function(e,t){for(var r,n=0,o=e.length;n<o;n++)e[0+(r=4*n)]=(16711680&t[n])>>>16,e[1+r]=(65280&t[n])>>>8,e[2+r]=255&t[n],e[3+r]=(4278190080&t[n])>>>24},_toImageData:function(e){return e instanceof ImageData?e:e.getContext("2d").getImageData(0,0,e.width,e.height)},_createImageData:function(e,t){return i._tmpCanvas=document.createElement("canvas"),i._tmpCtx=i._tmpCanvas.getContext("2d"),this._tmpCtx.createImageData(e,t)},apply:function(e,t,r){var n=e.getContext("2d"),o=n.getImageData(0,0,e.width,e.height);(t=t(o,r))instanceof ImageData?n.putImageData(t,0,0,0,0,e.width,e.height):n.putImageData(o,0,0,0,0,e.width,e.height)},threshold:function(e,t){for(var r=i._toPixels(e),n=(void 0===t&&(t=.5),Math.floor(255*t)),o=0;o<r.length;o+=4){var s=n<=.2126*r[o]+.7152*r[o+1]+.0722*r[o+2]?255:0;r[o]=r[o+1]=r[o+2]=s}},gray:function(e){for(var t=i._toPixels(e),r=0;r<t.length;r+=4){var n=t[r],o=t[r+1],s=t[r+2];t[r]=t[r+1]=t[r+2]=.2126*n+.7152*o+.0722*s}},opaque:function(e){for(var t=i._toPixels(e),r=0;r<t.length;r+=4)t[r+3]=255;return t},invert:function(e){for(var t=i._toPixels(e),r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2]},posterize:function(e,t){var r=i._toPixels(e);if(t<2||255<t)throw new Error("Level must be greater than 2 and less than 255 for posterize");for(var n=t-1,o=0;o<r.length;o+=4){var s=r[o],a=r[o+1],l=r[o+2];r[o]=255*(s*t>>8)/n,r[o+1]=255*(a*t>>8)/n,r[o+2]=255*(l*t>>8)/n}},dilate:function(e){for(var t,r,n,o,s,a,l,u,c,d=i._toPixels(e),h=0,p=d.length?d.length/4:0,f=new Int32Array(p);h<p;)for(r=(t=h)+e.width;h<r;)o=n=i._getARGB(d,h),(c=h-1)<t&&(c=h),r<=(u=h+1)&&(u=h),(s=h-e.width)<0&&(s=0),p<=(a=h+e.width)&&(a=h),s=i._getARGB(d,s),c=i._getARGB(d,c),a=i._getARGB(d,a),(o=77*(o>>16&255)+151*(o>>8&255)+28*(255&o))<(l=77*(c>>16&255)+151*(c>>8&255)+28*(255&c))&&(n=c,o=l),o<(l=77*((c=i._getARGB(d,u))>>16&255)+151*(c>>8&255)+28*(255&c))&&(n=c,o=l),o<(u=77*(s>>16&255)+151*(s>>8&255)+28*(255&s))&&(n=s,o=u),o<(c=77*(a>>16&255)+151*(a>>8&255)+28*(255&a))&&(n=a,o=c),f[h++]=n;i._setPixels(d,f)},erode:function(e){for(var t,r,n,o,s,a,l,u,c,d=i._toPixels(e),h=0,p=d.length?d.length/4:0,f=new Int32Array(p);h<p;)for(r=(t=h)+e.width;h<r;)o=n=i._getARGB(d,h),(c=h-1)<t&&(c=h),r<=(u=h+1)&&(u=h),(s=h-e.width)<0&&(s=0),p<=(a=h+e.width)&&(a=h),s=i._getARGB(d,s),c=i._getARGB(d,c),a=i._getARGB(d,a),(l=77*(c>>16&255)+151*(c>>8&255)+28*(255&c))<(o=77*(o>>16&255)+151*(o>>8&255)+28*(255&o))&&(n=c,o=l),(l=77*((c=i._getARGB(d,u))>>16&255)+151*(c>>8&255)+28*(255&c))<o&&(n=c,o=l),(u=77*(s>>16&255)+151*(s>>8&255)+28*(255&s))<o&&(n=s,o=u),(c=77*(a>>16&255)+151*(a>>8&255)+28*(255&a))<o&&(n=a,o=c),f[h++]=n;i._setPixels(d,f)},blur:function(e,t){for(var r,l,u,c,d,h,p,f,m,y,g=i._toPixels(e),v=e.width,b=e.height,x=v*b,w=new Int32Array(x),_=0;_<x;_++)w[_]=i._getARGB(g,_);var S,k,T,E,j,C,I,O,A=new Int32Array(x),R=new Int32Array(x),N=new Int32Array(x),M=new Int32Array(x),P=0,L=3.5*t|0;if(n!==(L=L<1?1:L<248?L:248)){o=1+(n=L)<<1,s=new Int32Array(o),a=new Array(o);for(var D=0;D<o;D++)a[D]=new Int32Array(256);for(var F=1,$=L-1;F<L;F++){s[L+F]=s[$]=C=$*$,I=a[L+F],O=a[$--];for(var B=0;B<256;B++)I[B]=O[B]=C*B}j=s[L]=L*L,I=a[L];for(var U=0;U<256;U++)I[U]=j*U}for(k=0;k<b;k++){for(S=0;S<v;S++){if(c=u=l=d=r=0,(h=S-n)<0)y=-h,h=0;else{if(v<=h)break;y=0}for(T=y;T<o&&!(v<=h);T++){var V=w[h+P];d+=(E=a[T])[(-16777216&V)>>>24],l+=E[(16711680&V)>>16],u+=E[(65280&V)>>8],c+=E[255&V],r+=s[T],h++}A[p=P+S]=d/r,R[p]=l/r,N[p]=u/r,M[p]=c/r}P+=v}for(m=(f=-n)*v,k=P=0;k<b;k++){for(S=0;S<v;S++){if(c=u=l=d=r=0,f<0)y=p=-f,h=S;else{if(b<=f)break;y=0,p=f,h=S+m}for(T=y;T<o&&!(b<=p);T++)d+=(E=a[T])[A[h]],l+=E[R[h]],u+=E[N[h]],c+=E[M[h]],r+=s[T],p++,h+=v;w[S+P]=d/r<<24|l/r<<16|u/r<<8|c/r}P+=v,m+=v,f++}i._setPixels(g,w)}};r.default=i},{"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.to-string":180,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.int32-array":215,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint8-array":232}],295:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("../core/main")),o=s(e("omggif"));function s(e){return e&&e.__esModule?e:{default:e}}function a(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.default.prototype.createImage=function(e,t){return n.default._validateParameters("createImage",arguments),new n.default.Image(e,t)},n.default.prototype.saveCanvas=function(){n.default._validateParameters("saveCanvas",arguments);var e,t,r,o,s=[].slice.call(arguments);switch(arguments[0]instanceof HTMLCanvasElement?(e=arguments[0],s.shift()):arguments[0]instanceof n.default.Element?(e=arguments[0].elt,s.shift()):e=this._curElement&&this._curElement.elt,1<=s.length&&(t=s[0]),r=(r=2<=s.length?s[1]:r)||n.default.prototype._checkFileExtension(t,r)[1]||"png"){default:o="image/png";break;case"jpeg":case"jpg":o="image/jpeg"}e.toBlob((function(e){n.default.prototype.downloadFile(e,t,r)}),o)},n.default.prototype.encodeAndDownloadGif=function(e,t){for(var r=e.gifProperties,s=(1===(C=r.loopLimit)?C=null:null===C&&(C=0),new Uint8Array(e.width*e.height*r.numFrames)),i=[],l={},u=0;u<r.numFrames;u++){for(var c=new Set,d=r.frames[u].image.data,h=d.length,p=new Uint32Array(e.width*e.height),f=0,m=0;f<h;f+=4,m++){var y=d[f+0]<<16|d[f+1]<<8|d[f+2]<<0;c.add(y),p[m]=y}var g=a(c).sort().toString();void 0===l[g]?l[g]={freq:1,frames:[u]}:(l[g].freq+=1,l[g].frames.push(u)),i.push(p)}for(var v=[],b=Object.keys(l).sort((function(e,t){return l[t].freq-l[e].freq})),x=b[0].split(",").map((function(e){return parseInt(e)})),w=(v=v.concat(l[x].frames),new Set(x)),_=1;_<b.length;_++){var S=b[_].split(",").map((function(e){return parseInt(e)})).filter((function(e){return!w.has(e)}));if(x.length+S.length<=256){for(var k=0;k<S.length;k++)x.push(S[k]),w.add(S[k]);v=v.concat(l[b[_]].frames)}}v=new Set(v);for(var T={},E=0;E<x.length;E++)T[x[E]]||(T[x[E]]=E);for(var j=1;j<x.length;)j<<=1;x.length=j;for(var C={loop:C,palette:new Uint32Array(x)},I=new o.default.GifWriter(s,e.width,e.height,C),O={},A=0;A<r.numFrames;A++)!function(t){var n=!v.has(t),o=n?[]:x,s=new Uint8Array(e.width*e.height),a={},l=new Set,u=(i[t].forEach((function(e,r){n?(void 0===a[e]&&(a[e]=o.length,o.push(e)),s[r]=a[e]):s[r]=T[e],0<t&&i[t-1][r]!==e&&l.add(e)})),{}),c=o.filter((function(e){return!l.has(e)}));if(0<c.length){c=c[0];var d=(n?a:T)[c];if(0<t){for(var h=0;h<i[t].length;h++)i[t-1][h]===i[t][h]&&(s[h]=d);u.transparent=d,O.frameOpts.disposal=1}}if(u.delay=r.frames[t].delay/10,n){for(var p=1;p<o.length;)p<<=1;o.length=p,u.palette=new Uint32Array(o)}0<t&&I.addFrame(0,0,e.width,e.height,O.pixelPaletteIndex,O.frameOpts),O={pixelPaletteIndex:s,frameOpts:u}}(A);O.frameOpts.disposal=1,I.addFrame(0,0,e.width,e.height,O.pixelPaletteIndex,O.frameOpts),C=new Blob([s.slice(0,I.end())],{type:"image/gif"}),n.default.prototype.downloadFile(C,t,"gif")},n.default.prototype.saveFrames=function(e,t,r,o,s){n.default._validateParameters("saveFrames",arguments),r=n.default.prototype.constrain(r=r||3,0,15),r*=1e3,o=n.default.prototype.constrain(o||15,0,22);var a=0,i=n.default.prototype._makeFrame,l=this._curElement.elt,u=[],c=setInterval((function(){u.push(i(e+a,t,l)),a++}),1e3/o);setTimeout((function(){if(clearInterval(c),s)s(u);else{var e=!0,t=!1,r=void 0;try{for(var o,a=u[Symbol.iterator]();!(e=(o=a.next()).done);e=!0){var i=o.value;n.default.prototype.downloadFile(i.imageData,i.filename,i.ext)}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}}u=[]}),.01+r)},n.default.prototype._makeFrame=function(e,t,r){var n;if(r=this?this._curElement.elt:r,t)switch(t.toLowerCase()){case"png":default:n="image/png";break;case"jpeg":case"jpg":n="image/jpeg"}else t="png",n="image/png";r=(r=r.toDataURL(n)).replace(n,"image/octet-stream");var o={};return o.imageData=r,o.filename=e,o.ext=t,o},e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.from":157,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.set":187,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.replace":194,"core-js/modules/es.string.split":196,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint32-array":231,"core-js/modules/es.typed-array.uint8-array":232,"core-js/modules/web.dom-collections.for-each":235,"core-js/modules/web.dom-collections.iterator":236,omggif:246}],296:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.copy-within"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.copy-within"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e("regenerator-runtime/runtime");var s=d(e("../core/main")),a=d(e("../core/helpers")),i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")),l=d(e("omggif")),u=e("gifenc");function c(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,c=function(){return e},e)}function d(e){return e&&e.__esModule?e:{default:e}}function h(e,t,r,n,o,s,a){try{var i=e[s](a),l=i.value}catch(e){return void r(e)}i.done?t(l):Promise.resolve(l).then(n,o)}function p(e,t){return 0<e&&e<t?e:t}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),s.default.prototype.loadImage=function(e,t,r){s.default._validateParameters("loadImage",arguments);var n=new s.default.Image(1,1,this),o=this,a=new Request(e,{method:"GET",mode:"cors"});return fetch(e,a).then((function(a){var i,u=a.headers.get("content-type");null===u&&console.warn("The image you loaded does not have a Content-Type header. If you are using the online editor consider reuploading the asset."),u&&u.includes("image/gif")?a.arrayBuffer().then((function(e){if(e){e=new Uint8Array(e);for(var a=n,i=t,u=r,c=function(e){o._decrementPreload()}.bind(o),d=new l.default.GifReader(e),h=(a.width=a.canvas.width=d.width,a.height=a.canvas.height=d.height,[]),p=d.numFrames(),f=new Uint8ClampedArray(a.width*a.height*4),m=0;m<p;m++){var y=d.frameInfo(m),g=a.drawingContext.getImageData(0,0,a.width,a.height),v=(f=g.data.slice(),function(e,t){try{t.decodeAndBlitFrameRGBA(e,f)}catch(e){s.default._friendlyFileLoadError(8,a.src),"function"==typeof u?u(e):console.error(e)}}(m,d),new ImageData(f,a.width,a.height));0===(a.drawingContext.putImageData(v,0,0),v=y.delay)&&(v=10),h.push({image:a.drawingContext.getImageData(0,0,a.width,a.height),delay:10*v}),2===y.disposal?a.drawingContext.clearRect(y.x,y.y,y.width,y.height):3===y.disposal&&a.drawingContext.putImageData(g,0,0,y.x,y.y,y.width,y.height)}null===(e=d.loopCount())?e=1:0===e&&(e=null),a.drawingContext.putImageData(h[0].image,0,0),1<h.length&&(a.gifProperties={displayIndex:0,loopLimit:e,loopCount:0,frames:h,numFrames:p,playing:!0,timeDisplayed:0,lastChangeTime:0}),"function"==typeof i&&i(a),c()}}),(function(e){"function"==typeof r?(r(e),o._decrementPreload()):console.error(e)})):((i=new Image).onload=function(){n.width=n.canvas.width=i.width,n.height=n.canvas.height=i.height,n.drawingContext.drawImage(i,0,0),n.modified=!0,"function"==typeof t&&t(n),o._decrementPreload()},i.onerror=function(e){s.default._friendlyFileLoadError(0,i.src),"function"==typeof r?(r(e),o._decrementPreload()):console.error(e)},0!==e.indexOf("data:image/")&&(i.crossOrigin="Anonymous"),i.src=e),n.modified=!0})).catch((function(t){s.default._friendlyFileLoadError(0,e),"function"==typeof r?(r(t),o._decrementPreload()):console.error(t)})),n},s.default.prototype.saveGif=function(){e=regeneratorRuntime.mark((function e(t,r){var n,o,a,i,l,c,d,h,p,f,m,y,g,v,b,x,w,_,S,k,T,E,j,C,I,O,A=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=2<A.length&&void 0!==A[2]?A[2]:{delay:0,units:"seconds",silent:!1,notificationDuration:0,notificationID:"progressBar"},"string"!=typeof t)throw TypeError("fileName parameter must be a string");e.next=3;break;case 3:if("number"!=typeof r)throw TypeError("Duration parameter must be a number");e.next=5;break;case 5:if(o=n&&n.delay||0,a=n&&n.units||"seconds",i=n&&n.silent||!1,l=n&&n.notificationDuration||0,c=n&&n.notificationID||"progressBar","number"!=typeof o)throw TypeError("Delay parameter must be a number");e.next=12;break;case 12:if("seconds"!==a&&"frames"!==a)throw TypeError('Units parameter must be either "frames" or "seconds"');e.next=14;break;case 14:if("boolean"!=typeof i)throw TypeError("Silent parameter must be a boolean");e.next=16;break;case 16:if("number"!=typeof l)throw TypeError("Notification duration parameter must be a number");e.next=18;break;case 18:if("string"!=typeof c)throw TypeError("Notification ID parameter must be a string");e.next=20;break;case 20:return this._recording=!0,f=this._targetFrameRate,d=(d=1/(f=f!==1/0&&void 0!==f&&0!==f?f:60)*1e3)<20?20:d,p=(h="seconds"===a?r*f:r)+(f="seconds"===a?o*f:o),this.frameCount=f,m=this._pixelDensity,this.pixelDensity(1),y=[],null!==document.getElementById(c)&&document.getElementById(c).remove(),i||((g=this.createP("")).id(c),g.style("font-size","16px"),g.style("font-family","Montserrat"),g.style("background-color","#ffffffa0"),g.style("padding","8px"),g.style("border-radius","10px"),g.position(0,0)),this._renderer instanceof s.default.RendererGL&&(b=this.drawingContext,v=new Uint8Array(b.drawingBufferWidth*b.drawingBufferHeight*4)),this.noLoop(),e.next=39,Promise.resolve();case 39:if(f<p)return this.redraw(),C=void 0,C=this._renderer instanceof s.default.RendererGL?(v=new Uint8Array(b.drawingBufferWidth*b.drawingBufferHeight*4),b.readPixels(0,0,b.drawingBufferWidth,b.drawingBufferHeight,b.RGBA,b.UNSIGNED_BYTE,v),function(e){for(var t=parseInt(height/2),r=4*width,n=new Uint8Array(4*width),o=0;o<t;++o){var s=o*r,a=(height-o-1)*r;n.set(e.subarray(s,s+r)),e.copyWithin(s,a,a+r),e.set(n,a)}return e}(v)):this.drawingContext.getImageData(0,0,this.width,this.height).data,y.push(C),f++,i||g.html("Saved frame <b>"+y.length.toString()+"</b> out of "+h.toString()),e.next=48,new Promise((function(e){return setTimeout(e,0)}));e.next=50;break;case 48:e.next=39;break;case 50:i||g.html("Frames processed, generating color palette..."),this.loop(),this.pixelDensity(m),x=(0,u.GIFEncoder)(),w=function(e){for(var t=new Uint8Array(e.length*e[0].length),r=0;r<e.length;r++)t.set(e[r],r*e[0].length);var n=(0,u.quantize)(t,256,{format:"rgba4444",oneBitAlpha:!0});return 256===n.length?n[n.length-1]=[255*Math.random(),255*Math.random(),255*Math.random(),0]:n.push([255*Math.random(),255*Math.random(),255*Math.random(),0]),n}(y),_={},S=function(e){for(var t=e.length/4,r=new Uint8Array(t),n=0;n<t;n++){var o=e[4*n]<<24|e[4*n+1]<<16|e[4*n+2]<<8|e[4*n+3];void 0===_[o]&&(_[o]=(0,u.nearestColorIndex)(w,e.slice(4*n,4*(n+1)))),r[n]=_[o]}return r},k=w.length-1,T=[],E=0;case 60:if(!(E<y.length)){e.next=71;break}if(j=S(y[E]),C=j.slice(),0===E)x.writeFrame(j,this.width,this.height,{palette:w,delay:d,dispose:1});else{for(I=0;I<j.length;I++)j[I]===T[I]&&(j[I]=k);x.writeFrame(j,this.width,this.height,{delay:d,transparent:!0,transparentIndex:k,dispose:1})}return T=C,i||g.html("Rendered frame <b>"+E.toString()+"</b> out of "+h.toString()),e.next=68,new Promise((function(e){return setTimeout(e,0)}));case 68:E++,e.next=60;break;case 71:x.finish(),O=x.bytesView(),O=new Blob([O],{type:"image/gif"}),y=[],this._recording=!1,this.loop(),i||(g.html("Done. Downloading your gif!"),0<l&&setTimeout((function(){return g.remove()}),1e3*l)),s.default.prototype.downloadFile(O,t,"gif");case 80:case"end":return e.stop()}}),e,this)}));var e,t=function(){var t=this,r=arguments;return new Promise((function(n,o){var s=e.apply(t,r);function a(e){h(s,n,o,a,i,"next",e)}function i(e){h(s,n,o,a,i,"throw",e)}a(void 0)}))};return function(e,r){return t.apply(this,arguments)}}(),s.default.prototype.image=function(e,t,r,n,o,l,u,c,d,h,f,m){s.default._validateParameters("image",arguments);var y=e.width,g=e.height,v=(m=m||i.CENTER,f=f||i.CENTER,e.elt&&e.elt.videoWidth&&!e.canvas&&(y=e.elt.videoWidth,g=e.elt.videoHeight),n||y);o=o||g,l=l||0,u=u||0,c=p(c||y,y),y=p(d||g,g),d=1,e.elt&&!e.canvas&&e.elt.style.width&&(d=e.elt.videoWidth&&!n?e.elt.videoWidth:e.elt.width,d/=parseInt(e.elt.style.width,10)),l*=d,u*=d,y*=d,c*=d,g=function(e,t,r,n,o,s,a,l,u,c,d){var h,p,f,m,y,g,v,b,x;return e===i.COVER&&(h=t,f=r,v=s,b=a,g=l,x=u,p=c,m=d,v/=y=Math.max(v/p,b/m),b/=y,y=g,g=x,h===i.CENTER?y+=(p-v)/2:h===i.RIGHT&&(y+=p-v),f===i.CENTER?g+=(m-b)/2:f===i.BOTTOM&&(g+=m-b),l=(x={x:y,y:g,w:v,h:b}).x,u=x.y,c=x.w,d=x.h),e===i.CONTAIN&&(h=t,p=r,f=n,m=o,y=s,g=a,v=c,b=d,v/=x=Math.max(v/y,b/g),b/=x,x=f,f=m,h===i.CENTER?x+=(y-v)/2:h===i.RIGHT&&(x+=y-v),p===i.CENTER?f+=(g-b)/2:p===i.BOTTOM&&(f+=g-b),n=(e={x,y:f,w:v,h:b}).x,o=e.y,s=e.w,a=e.h),{sx:l,sy:u,sw:c,sh:d,dx:n,dy:o,dw:s,dh:a}}(h,f,m,(g=a.default.modeAdjust(t,r,v,o,this._renderer._imageMode)).x,g.y,g.w,g.h,l,u,c,y),this._renderer.image(e,g.sx,g.sy,g.sw,g.sh,g.dx,g.dy,g.dw,g.dh)},s.default.prototype.tint=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];s.default._validateParameters("tint",t);var n=this.color.apply(this,t);this._renderer._tint=n.levels},s.default.prototype.noTint=function(){this._renderer._tint=null},s.default.prototype._getTintedImageCanvas=s.default.Renderer2D.prototype._getTintedImageCanvas,s.default.prototype.imageMode=function(e){s.default._validateParameters("imageMode",arguments),e!==i.CORNER&&e!==i.CORNERS&&e!==i.CENTER||(this._renderer._imageMode=e)},e=s.default,r.default=e},{"../core/constants":262,"../core/friendly_errors/fes_core":264,"../core/friendly_errors/file_errors":265,"../core/friendly_errors/validate_params":268,"../core/helpers":269,"../core/main":273,"core-js/modules/es.array.copy-within":152,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.promise":181,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint8-array":232,"core-js/modules/es.typed-array.uint8-clamped-array":233,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236,gifenc:243,omggif:246,"regenerator-runtime/runtime":250}],297:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("../core/main")),o=s(e("./filters"));function s(e){return e&&e.__esModule?e:{default:e}}n.default.Image=function(){function e(t,r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.width=t,this.height=r,this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.drawingContext=this.canvas.getContext("2d"),(this._pixelsState=this)._pixelDensity=1,this.gifProperties=null,this._modified=!1,this.pixels=[]}var t;return(t=[{key:"_animateGif",value:function(e){var t,r=this.gifProperties;e=e._lastRealFrameTime,0===r.lastChangeTime&&(r.lastChangeTime=e),r.playing&&(r.timeDisplayed=e-r.lastChangeTime,t=r.frames[r.displayIndex].delay,r.timeDisplayed>=t&&(t=Math.floor(r.timeDisplayed/t),r.timeDisplayed=0,r.lastChangeTime=e,r.displayIndex+=t,r.loopCount=Math.floor(r.displayIndex/r.numFrames),null!==r.loopLimit&&r.loopCount>=r.loopLimit?r.playing=!1:(e=r.displayIndex%r.numFrames,this.drawingContext.putImageData(r.frames[e].image,0,0),r.displayIndex=e,this.setModified(!0))))}},{key:"_setProperty",value:function(e,t){this[e]=t,this.setModified(!0)}},{key:"loadPixels",value:function(){n.default.Renderer2D.prototype.loadPixels.call(this),this.setModified(!0)}},{key:"updatePixels",value:function(e,t,r,o){n.default.Renderer2D.prototype.updatePixels.call(this,e,t,r,o),this.setModified(!0)}},{key:"get",value:function(e,t,r,o){return n.default._validateParameters("p5.Image.get",arguments),n.default.Renderer2D.prototype.get.apply(this,arguments)}},{key:"_getPixel",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default.Renderer2D.prototype._getPixel.apply(this,t)}},{key:"set",value:function(e,t,r){n.default.Renderer2D.prototype.set.call(this,e,t,r),this.setModified(!0)}},{key:"resize",value:function(e,t){0===e&&0===t?(e=this.canvas.width,t=this.canvas.height):0===e?e=this.canvas.width*t/this.canvas.height:0===t&&(t=this.canvas.height*e/this.canvas.width),e=Math.floor(e),t=Math.floor(t);var r=document.createElement("canvas");if(r.width=e,r.height=t,this.gifProperties)for(var n=this.gifProperties,o=0;o<n.numFrames;o++){for(var s=this.drawingContext.createImageData(e,t),a=(d=d=c=u=l=void 0,n.frames[o].image),i=s,l=0,u=0;u<i.height;u++)for(var c=0;c<i.width;c++){var d=Math.floor(c*a.width/i.width);d=4*(Math.floor(u*a.height/i.height)*a.width+d),i.data[l++]=a.data[d++],i.data[l++]=a.data[d++],i.data[l++]=a.data[d++],i.data[l++]=a.data[+d]}n.frames[o].image=s}r.getContext("2d").drawImage(this.canvas,0,0,this.canvas.width,this.canvas.height,0,0,r.width,r.height),this.canvas.width=this.width=e,this.canvas.height=this.height=t,this.drawingContext.drawImage(r,0,0,e,t,0,0,e,t),0<this.pixels.length&&this.loadPixels(),this.setModified(!0)}},{key:"copy",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default.prototype.copy.apply(this,t)}},{key:"mask",value:function(e){var t=this.drawingContext.globalCompositeOperation,r=1,o=[e=void 0===e?this:e,0,0,(r=e instanceof n.default.Renderer?e._pInst._pixelDensity:r)*e.width,r*e.height,0,0,this.width,this.height];if(this.drawingContext.globalCompositeOperation="destination-in",this.gifProperties){for(var s=0;s<this.gifProperties.frames.length;s++)this.drawingContext.putImageData(this.gifProperties.frames[s].image,0,0),this.copy.apply(this,o),this.gifProperties.frames[s].image=this.drawingContext.getImageData(0,0,this.width,this.height);this.drawingContext.putImageData(this.gifProperties.frames[this.gifProperties.displayIndex].image,0,0)}else this.copy.apply(this,o);this.drawingContext.globalCompositeOperation=t,this.setModified(!0)}},{key:"filter",value:function(e,t){o.default.apply(this.canvas,o.default[e],t),this.setModified(!0)}},{key:"blend",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("p5.Image.blend",arguments),n.default.prototype.blend.apply(this,t),this.setModified(!0)}},{key:"setModified",value:function(e){this._modified=e}},{key:"isModified",value:function(){return this._modified}},{key:"save",value:function(e,t){this.gifProperties?n.default.prototype.encodeAndDownloadGif(this,e):n.default.prototype.saveCanvas(this.canvas,e,t)}},{key:"reset",value:function(){var e;this.gifProperties&&((e=this.gifProperties).playing=!0,e.timeSinceStart=0,e.timeDisplayed=0,e.lastChangeTime=0,e.loopCount=0,e.displayIndex=0,this.drawingContext.putImageData(e.frames[0].image,0,0))}},{key:"getCurrentFrame",value:function(){var e;if(this.gifProperties)return(e=this.gifProperties).displayIndex%e.numFrames}},{key:"setFrame",value:function(e){var t;this.gifProperties&&(e<(t=this.gifProperties).numFrames&&0<=e?(t.timeDisplayed=0,t.lastChangeTime=0,t.displayIndex=e,this.drawingContext.putImageData(t.frames[e].image,0,0)):console.log("Cannot set GIF to a frame number that is higher than total number of frames or below zero."))}},{key:"numFrames",value:function(){if(this.gifProperties)return this.gifProperties.numFrames}},{key:"play",value:function(){this.gifProperties&&(this.gifProperties.playing=!0)}},{key:"pause",value:function(){this.gifProperties&&(this.gifProperties.playing=!1)}},{key:"delay",value:function(e,t){if(this.gifProperties){var r=this.gifProperties;if(t<r.numFrames&&0<=t)r.frames[t].delay=e;else{var n=!0,o=void(t=!1);try{for(var s,a=r.frames[Symbol.iterator]();!(n=(s=a.next()).done);n=!0)s.value.delay=e}catch(e){t=!0,o=e}finally{try{n||null==a.return||a.return()}finally{if(t)throw o}}}}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=n.default.Image,r.default=e},{"../core/main":273,"./filters":294,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],298:[function(e,t,r){"use strict";e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.filter"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=s(e("../core/main")),o=s(e("./filters"));function s(e){return e&&e.__esModule?e:{default:e}}e("../color/p5.Color"),n.default.prototype.pixels=[],n.default.prototype.blend=function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];n.default._validateParameters("blend",r),this._renderer?(e=this._renderer).blend.apply(e,r):n.default.Renderer2D.prototype.blend.apply(this,r)},n.default.prototype.copy=function(){for(var e,t,r,o,s,a,i,l,u,c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];if(n.default._validateParameters("copy",d),9===d.length)e=d[0],t=d[1],r=d[2],o=d[3],s=d[4],a=d[5],i=d[6],l=d[7],u=d[8];else{if(8!==d.length)throw new Error("Signature not supported");e=this,t=d[0],r=d[1],o=d[2],s=d[3],a=d[4],i=d[5],l=d[6],u=d[7]}n.default.prototype._copyHelper(this,e,t,r,o,s,a,i,l,u)},n.default.prototype._copyHelper=function(e,t,r,o,s,a,i,l,u,c){t.loadPixels();var d=t.canvas.width/t.width,h=0,p=0;t._renderer&&t._renderer.isP3D&&(h=t.width/2,p=t.height/2),e._renderer&&e._renderer.isP3D?n.default.RendererGL.prototype.image.call(e._renderer,t,r+h,o+p,s,a,i,l,u,c):e.drawingContext.drawImage(t.canvas,d*(r+h),d*(o+p),d*s,d*a,i,l,u,c)},n.default.prototype.filter=function(e,t){n.default._validateParameters("filter",arguments),void 0!==this.canvas?o.default.apply(this.canvas,o.default[e],t):o.default.apply(this.elt,o.default[e],t)},n.default.prototype.get=function(e,t,r,o){var s;return n.default._validateParameters("get",arguments),(s=this._renderer).get.apply(s,arguments)},n.default.prototype.loadPixels=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("loadPixels",t),this._renderer.loadPixels()},n.default.prototype.set=function(e,t,r){this._renderer.set(e,t,r)},n.default.prototype.updatePixels=function(e,t,r,o){n.default._validateParameters("updatePixels",arguments),0!==this.pixels.length&&this._renderer.updatePixels(e,t,r,o)},e=n.default,r.default=e},{"../color/p5.Color":260,"../core/main":273,"./filters":294,"core-js/modules/es.array.filter":155}],299:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.from-entries"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/web.url"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.from-entries"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.promise"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/web.url"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=i(e("../core/main")),s=(e("whatwg-fetch"),e("es6-promise/auto"),i(e("fetch-jsonp"))),a=i(e("file-saver"));function i(e){return e&&e.__esModule?e:{default:e}}function l(e){return(l="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function u(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function c(e,t){t&&!0!==t&&"true"!==t||(t="");var r="";return(e=e||"untitled")&&e.includes(".")&&(r=e.split(".").pop()),t&&r!==t&&(r=t,e="".concat(e,".").concat(r)),[e,r]}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),o.default.prototype.loadJSON=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];o.default._validateParameters("loadJSON",t);for(var n,s,a,i=t[0],u={},c="json",d=1;d<t.length;d++){var h=t[d];"string"==typeof h?"jsonp"!==h&&"json"!==h||(c=h):"function"==typeof h?n?s=h:n=h:"object"===l(h)&&(h.hasOwnProperty("jsonpCallback")||h.hasOwnProperty("jsonpCallbackFunction"))&&(c="jsonp",a=h)}var p=this;return this.httpDo(i,"GET",a,c,(function(e){for(var t in e)u[t]=e[t];void 0!==n&&n(e),p._decrementPreload()}),(function(e){if(o.default._friendlyFileLoadError(5,i),!s)throw e;s(e)})),u},o.default.prototype.loadStrings=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];o.default._validateParameters("loadStrings",t);for(var n,s,a=[],i=1;i<t.length;i++){var l=t[i];"function"==typeof l&&(void 0===n?n=l:void 0===s&&(s=l))}var u=this;return o.default.prototype.httpDo.call(this,t[0],"GET","text",(function(e){for(var t=e.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/),r=0,o=t.length;r<o;r+=32768)Array.prototype.push.apply(a,t.slice(r,Math.min(r+32768,o)));void 0!==n&&n(a),u._decrementPreload()}),(function(e){if(o.default._friendlyFileLoadError(3,e),!s)throw e;s(e)})),a},o.default.prototype.loadTable=function(e){var t,r,n,s=[],a=!1,i=e.substring(e.lastIndexOf(".")+1,e.length);"csv"===i?n=",":"ssv"===i?n=";":"tsv"===i&&(n="\t");for(var l=1;l<arguments.length;l++)"function"==typeof arguments[l]?void 0===t?t=arguments[l]:void 0===r&&(r=arguments[l]):"string"==typeof arguments[l]&&(s.push(arguments[l]),"header"===arguments[l]&&(a=!0),"csv"===arguments[l]?n=",":"ssv"===arguments[l]?n=";":"tsv"===arguments[l]&&(n="\t"));var u=new o.default.Table,c=this;return this.httpDo(e,"GET","table",(function(e){for(var r,s,i={},l=[],d=0,h=null,p=function(){i.currentState=0,i.token=""},f=function(){h.push(i.token),p()},m=function(){i.currentState=4,l.push(h),h=null};;){if(null==(r=e[d++])){if(i.escaped)throw new Error("Unclosed quote in file.");if(h){f(),m();break}}if(null===h&&(i.escaped=!1,h=[],p()),0===i.currentState){if('"'===r){i.escaped=!0,i.currentState=1;continue}i.currentState=1}if(1===i.currentState&&i.escaped)if('"'===r)'"'===e[d]?(i.token+='"',d++):(i.escaped=!1,i.currentState=2);else{if("\r"===r)continue;i.token+=r}else"\r"===r?("\n"===e[d]&&d++,f(),m()):"\n"===r?(f(),m()):r===n?f():1===i.currentState&&(i.token+=r)}if(a)u.columns=l.shift();else for(var y=0;y<l[0].length;y++)u.columns[y]="null";for(var g=0;g<l.length;g++)(1!==l[g].length||"undefined"!==l[g][0]&&""!==l[g][0])&&((s=new o.default.TableRow).arr=l[g],s.obj=function(e,t){if(void 0===(t=t||[]))for(var r=0;r<e.length;r++)t[r.toString()]=r;return Object.fromEntries(t.map((function(t,r){return[t,e[r]]})))}(l[g],u.columns),u.addRow(s));"function"==typeof t&&t(u),c._decrementPreload()}),(function(t){o.default._friendlyFileLoadError(2,e),r?r(t):console.error(t)})),u},o.default.prototype.loadXML=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n,s,a=new o.default.XML,i=1;i<t.length;i++){var l=t[i];"function"==typeof l&&(void 0===n?n=l:void 0===s&&(s=l))}var u=this;return this.httpDo(t[0],"GET","xml",(function(e){for(var t in e)a[t]=e[t];void 0!==n&&n(a),u._decrementPreload()}),(function(e){if(o.default._friendlyFileLoadError(1,e),!s)throw e;s(e)})),a},o.default.prototype.loadBytes=function(e,t,r){var n={},s=this;return this.httpDo(e,"GET","arrayBuffer",(function(e){n.bytes=new Uint8Array(e),"function"==typeof t&&t(n),s._decrementPreload()}),(function(t){if(o.default._friendlyFileLoadError(6,e),!r)throw t;r(t)})),n},o.default.prototype.httpGet=function(){o.default._validateParameters("httpGet",arguments);var e=Array.prototype.slice.call(arguments);return e.splice(1,0,"GET"),o.default.prototype.httpDo.apply(this,e)},o.default.prototype.httpPost=function(){o.default._validateParameters("httpPost",arguments);var e=Array.prototype.slice.call(arguments);return e.splice(1,0,"POST"),o.default.prototype.httpDo.apply(this,e)},o.default.prototype.httpDo=function(){for(var e,t,r,n={},a=0,i="text/plain",u=arguments.length-1;0<u&&"function"==typeof(u<0||arguments.length<=u?void 0:arguments[u]);u--)a++;var c=arguments.length<=0?void 0:arguments[0];if(2==(y=arguments.length-a)&&"string"==typeof c&&"object"===l(arguments.length<=1?void 0:arguments[1]))g=new Request(c,arguments.length<=1?void 0:arguments[1]),t=arguments.length<=2?void 0:arguments[2],r=arguments.length<=3?void 0:arguments[3];else{for(var d,h="GET",p=1;p<arguments.length;p++){var f=p<0||arguments.length<=p?void 0:arguments[p];if("string"==typeof f)"GET"===f||"POST"===f||"PUT"===f||"DELETE"===f?h=f:"json"===f||"jsonp"===f||"binary"===f||"arrayBuffer"===f||"xml"===f||"text"===f||"table"===f?e=f:d=f;else if("number"==typeof f)d=f.toString();else if("object"===l(f))if(f.hasOwnProperty("jsonpCallback")||f.hasOwnProperty("jsonpCallbackFunction"))for(var m in f)n[m]=f[m];else i=f instanceof o.default.XML?(d=f.serialize(),"application/xml"):(d=JSON.stringify(f),"application/json");else"function"==typeof f&&(t?r=f:t=f)}var y="GET"===h?new Headers:new Headers({"Content-Type":i}),g=new Request(c,{method:h,mode:"cors",body:d,headers:y})}return(y=(y="jsonp"===(e=e||(c.includes("json")?"json":c.includes("xml")?"xml":"text"))?(0,s.default)(c,n):fetch(g)).then((function(t){if(!t.ok)throw(r=new Error(t.body)).status=t.status,r.ok=!1,r;var r=0;switch((r="jsonp"!==e?t.headers.get("content-length"):r)&&64e6<r&&o.default._friendlyFileLoadError(7,c),e){case"json":case"jsonp":return t.json();case"binary":return t.blob();case"arrayBuffer":return t.arrayBuffer();case"xml":return t.text().then((function(e){return e=(new DOMParser).parseFromString(e,"text/xml"),new o.default.XML(e.documentElement)}));default:return t.text()}}))).then(t||function(){}),y.catch(r||console.error),y},window.URL=window.URL||window.webkitURL,o.default.prototype._pWriters=[],o.default.prototype.createWriter=function(e,t){var r,n;for(n in o.default.prototype._pWriters)if(o.default.prototype._pWriters[n].name===e)return r=new o.default.PrintWriter(e+this.millis(),t),o.default.prototype._pWriters.push(r),r;return r=new o.default.PrintWriter(e,t),o.default.prototype._pWriters.push(r),r},o.default.PrintWriter=function(e,t){var r=this;this.name=e,this.content="",this.write=function(e){this.content+=e},this.print=function(e){this.content+="".concat(e,"\n")},this.clear=function(){this.content=""},this.close=function(){var n,s=[];for(n in s.push(this.content),o.default.prototype.writeFile(s,e,t),o.default.prototype._pWriters)o.default.prototype._pWriters[n].name===this.name&&o.default.prototype._pWriters.splice(n,1);r.clear(),r={}}},o.default.prototype.save=function(e,t,r){var n=arguments,s=(this._curElement||this).elt;if(0===n.length)o.default.prototype.saveCanvas(s);else if(n[0]instanceof o.default.Renderer||n[0]instanceof o.default.Graphics)o.default.prototype.saveCanvas(n[0].elt,n[1],n[2]);else if(1===n.length&&"string"==typeof n[0])o.default.prototype.saveCanvas(s,n[0]);else switch(c(n[1],n[2])[1]){case"json":return void o.default.prototype.saveJSON(n[0],n[1],n[2]);case"txt":return void o.default.prototype.saveStrings(n[0],n[1],n[2]);default:n[0]instanceof Array?o.default.prototype.saveStrings(n[0],n[1],n[2]):n[0]instanceof o.default.Table?o.default.prototype.saveTable(n[0],n[1],n[2]):n[0]instanceof o.default.Image?o.default.prototype.saveCanvas(n[0].canvas,n[1]):n[0]instanceof o.default.SoundFile&&o.default.prototype.saveSound(n[0],n[1],n[2],n[3])}},o.default.prototype.saveJSON=function(e,t,r){o.default._validateParameters("saveJSON",arguments),r=r?JSON.stringify(e):JSON.stringify(e,void 0,2),this.saveStrings(r.split("\n"),t,"json")},o.default.prototype.saveJSONObject=o.default.prototype.saveJSON,o.default.prototype.saveJSONArray=o.default.prototype.saveJSON,o.default.prototype.saveStrings=function(e,t,r,n){o.default._validateParameters("saveStrings",arguments);for(var s=this.createWriter(t,r||"txt"),a=0;a<e.length;a++)n?s.write(e[a]+"\r\n"):s.write(e[a]+"\n");s.close(),s.clear()},o.default.prototype.saveTable=function(e,t,r){o.default._validateParameters("saveTable",arguments),n=void 0===r?t.substring(t.lastIndexOf(".")+1,t.length):r;var n,s=this.createWriter(t,n),a=e.columns,i="tsv"===n?"\t":",";if("html"!==n){if("0"!==a[0]){for(var l=0;l<a.length;l++)l<a.length-1?s.write(a[l]+i):s.write(a[l]);s.write("\n")}for(var c=0;c<e.rows.length;c++){var d=void 0;for(d=0;d<e.rows[c].arr.length;d++)d<e.rows[c].arr.length-1?"csv"===n&&String(e.rows[c].arr[d]).includes(",")?s.write('"'+e.rows[c].arr[d]+'"'+i):s.write(e.rows[c].arr[d]+i):"csv"===n&&String(e.rows[c].arr[d]).includes(",")?s.write('"'+e.rows[c].arr[d]+'"'):s.write(e.rows[c].arr[d]);s.write("\n")}}else{if(s.print("<html>"),s.print("<head>"),s.print('  <meta http-equiv="content-type" content="text/html;charset=utf-8" />'),s.print("</head>"),s.print("<body>"),s.print("  <table>"),"0"!==a[0]){s.print("    <tr>");for(var h=0;h<a.length;h++){var p=u(a[h]);s.print("      <td>".concat(p)),s.print("      </td>")}s.print("    </tr>")}for(var f=0;f<e.rows.length;f++){s.print("    <tr>");for(var m=0;m<e.columns.length;m++){var y=u(e.rows[f].getString(m));s.print("      <td>".concat(y)),s.print("      </td>")}s.print("    </tr>")}s.print("  </table>"),s.print("</body>"),s.print("</html>")}s.close(),s.clear()},o.default.prototype.writeFile=function(e,t,r){var n="application/octet-stream";o.default.prototype._isSafari()&&(n="text/plain"),e=new Blob(e,{type:n}),o.default.prototype.downloadFile(e,t,r)},o.default.prototype.downloadFile=function(e,t,r){var n;r=(t=c(t,r))[0],e instanceof Blob?a.default.saveAs(e,r):((n=document.createElement("a")).href=e,n.download=r,n.onclick=function(e){document.body.removeChild(e.target),e.stopPropagation()},n.style.display="none",document.body.appendChild(n),o.default.prototype._isSafari()&&(e=(e='Hello, Safari user! To download this file...\n1. Go to File --\x3e Save As.\n2. Choose "Page Source" as the Format.\n')+'3. Name it with this extension: ."'.concat(t[1],'"'),alert(e)),n.click())},o.default.prototype._checkFileExtension=c,o.default.prototype._isSafari=function(){return 0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")},e=o.default,r.default=e},{"../core/friendly_errors/fes_core":264,"../core/friendly_errors/file_errors":265,"../core/friendly_errors/validate_params":268,"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.last-index-of":162,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.splice":166,"core-js/modules/es.function.name":167,"core-js/modules/es.object.from-entries":175,"core-js/modules/es.object.to-string":180,"core-js/modules/es.promise":181,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.replace":194,"core-js/modules/es.string.split":196,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint8-array":232,"core-js/modules/web.dom-collections.iterator":236,"core-js/modules/web.url":238,"es6-promise/auto":239,"fetch-jsonp":241,"file-saver":242,"whatwg-fetch":251}],300:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.replace"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.Table=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.columns=[],this.rows=[]}var t;return(t=[{key:"addRow",value:function(e){if(void 0===(e=e||new n.default.TableRow).arr||void 0===e.obj)throw new Error("invalid TableRow: ".concat(e));return(e.table=this).rows.push(e),e}},{key:"removeRow",value:function(e){this.rows[e].table=null,e=this.rows.splice(e+1,this.rows.length),this.rows.pop(),this.rows=this.rows.concat(e)}},{key:"getRow",value:function(e){return this.rows[e]}},{key:"getRows",value:function(){return this.rows}},{key:"findRow",value:function(e,t){if("string"==typeof t){for(var r=0;r<this.rows.length;r++)if(this.rows[r].obj[t]===e)return this.rows[r]}else for(var n=0;n<this.rows.length;n++)if(this.rows[n].arr[t]===e)return this.rows[n];return null}},{key:"findRows",value:function(e,t){var r=[];if("string"==typeof t)for(var n=0;n<this.rows.length;n++)this.rows[n].obj[t]===e&&r.push(this.rows[n]);else for(var o=0;o<this.rows.length;o++)this.rows[o].arr[t]===e&&r.push(this.rows[o]);return r}},{key:"matchRow",value:function(e,t){if("number"==typeof t){for(var r=0;r<this.rows.length;r++)if(this.rows[r].arr[t].match(e))return this.rows[r]}else for(var n=0;n<this.rows.length;n++)if(this.rows[n].obj[t].match(e))return this.rows[n];return null}},{key:"matchRows",value:function(e,t){var r=[];if("number"==typeof t)for(var n=0;n<this.rows.length;n++)this.rows[n].arr[t].match(e)&&r.push(this.rows[n]);else for(var o=0;o<this.rows.length;o++)this.rows[o].obj[t].match(e)&&r.push(this.rows[o]);return r}},{key:"getColumn",value:function(e){var t=[];if("string"==typeof e)for(var r=0;r<this.rows.length;r++)t.push(this.rows[r].obj[e]);else for(var n=0;n<this.rows.length;n++)t.push(this.rows[n].arr[e]);return t}},{key:"clearRows",value:function(){delete this.rows,this.rows=[]}},{key:"addColumn",value:function(e){this.columns.push(e||null)}},{key:"getColumnCount",value:function(){return this.columns.length}},{key:"getRowCount",value:function(){return this.rows.length}},{key:"removeTokens",value:function(e,t){for(var r=[],n=0;n<e.length;n++)r.push(e.charAt(n).replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"));var o=new RegExp(r.join("|"),"g");if(void 0===t)for(var s=0;s<this.columns.length;s++)for(var a=0;a<this.rows.length;a++){var i=(i=this.rows[a].arr[s]).replace(o,"");this.rows[a].arr[s]=i,this.rows[a].obj[this.columns[s]]=i}else if("string"==typeof t)for(var l=0;l<this.rows.length;l++){var u=(u=this.rows[l].obj[t]).replace(o,""),c=(this.rows[l].obj[t]=u,this.columns.indexOf(t));this.rows[l].arr[c]=u}else for(var d=0;d<this.rows.length;d++){var h=(h=this.rows[d].arr[t]).replace(o,"");this.rows[d].arr[t]=h,this.rows[d].obj[this.columns[t]]=h}}},{key:"trim",value:function(e){var t=new RegExp(" ","g");if(void 0===e)for(var r=0;r<this.columns.length;r++)for(var n=0;n<this.rows.length;n++){var o=(o=this.rows[n].arr[r]).replace(t,"");this.rows[n].arr[r]=o,this.rows[n].obj[this.columns[r]]=o}else if("string"==typeof e)for(var s=0;s<this.rows.length;s++){var a=(a=this.rows[s].obj[e]).replace(t,""),i=(this.rows[s].obj[e]=a,this.columns.indexOf(e));this.rows[s].arr[i]=a}else for(var l=0;l<this.rows.length;l++){var u=(u=this.rows[l].arr[e]).replace(t,"");this.rows[l].arr[e]=u,this.rows[l].obj[this.columns[e]]=u}}},{key:"removeColumn",value:function(e){var t,r;"string"==typeof e?r=this.columns.indexOf(t=e):t=this.columns[r=e],e=this.columns.splice(r+1,this.columns.length),this.columns.pop(),this.columns=this.columns.concat(e);for(var n=0;n<this.rows.length;n++){var o=this.rows[n].arr,s=o.splice(r+1,o.length);o.pop(),this.rows[n].arr=o.concat(s),delete this.rows[n].obj[t]}}},{key:"set",value:function(e,t,r){this.rows[e].set(t,r)}},{key:"setNum",value:function(e,t,r){this.rows[e].setNum(t,r)}},{key:"setString",value:function(e,t,r){this.rows[e].setString(t,r)}},{key:"get",value:function(e,t){return this.rows[e].get(t)}},{key:"getNum",value:function(e,t){return this.rows[e].getNum(t)}},{key:"getString",value:function(e,t){return this.rows[e].getString(t)}},{key:"getObject",value:function(e){for(var t,r={},n=0;n<this.rows.length;n++)if(t=this.rows[n].obj,"string"==typeof e){if(!(0<=this.columns.indexOf(e)))throw new Error('This table has no column named "'.concat(e,'"'));r[t[e]]=t}else r[n]=this.rows[n].obj;return r}},{key:"getArray",value:function(){for(var e=[],t=0;t<this.rows.length;t++)e.push(this.rows[t].arr);return e}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.join":161,"core-js/modules/es.array.splice":166,"core-js/modules/es.regexp.constructor":184,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.match":191,"core-js/modules/es.string.replace":194}],301:[function(e,t,r){"use strict";e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.from-entries"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.from-entries"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.TableRow=function(){function e(t,r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var n=[];t&&(n=t.split(r=r||",")),this.arr=n,this.obj=Object.fromEntries(n.entries()),this.table=null}var t;return(t=[{key:"set",value:function(e,t){if("string"==typeof e){var r=this.table.columns.indexOf(e);if(!(0<=r))throw new Error('This table has no column named "'.concat(e,'"'));this.obj[e]=t,this.arr[r]=t}else{if(!(e<this.table.columns.length))throw new Error("Column #".concat(e," is out of the range of this table"));this.arr[e]=t,r=this.table.columns[e],this.obj[r]=t}}},{key:"setNum",value:function(e,t){t=parseFloat(t),this.set(e,t)}},{key:"setString",value:function(e,t){t=t.toString(),this.set(e,t)}},{key:"get",value:function(e){return("string"==typeof e?this.obj:this.arr)[e]}},{key:"getNum",value:function(e){var t="string"==typeof e?parseFloat(this.obj[e]):parseFloat(this.arr[e]);if("NaN"===t.toString())throw"Error: ".concat(this.obj[e]," is NaN (Not a Number)");return t}},{key:"getString",value:function(e){return("string"==typeof e?this.obj:this.arr)[e].toString()}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=e.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.from-entries":175,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.split":196,"core-js/modules/web.dom-collections.iterator":236}],302:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.replace"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.XML=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");t?this.DOM=t:(t=document.implementation.createDocument(null,"doc"),this.DOM=t.createElement("root"))}var t;return(t=[{key:"getParent",value:function(){return new n.default.XML(this.DOM.parentElement)}},{key:"getName",value:function(){return this.DOM.tagName}},{key:"setName",value:function(e){var t=this.DOM.innerHTML,r=this.DOM.attributes,n=document.implementation.createDocument(null,"default").createElement(e);n.innerHTML=t;for(var o=0;o<r.length;o++)n.setAttribute(r[o].nodeName,r.nodeValue);this.DOM=n}},{key:"hasChildren",value:function(){return 0<this.DOM.children.length}},{key:"listChildren",value:function(){for(var e=[],t=0;t<this.DOM.childNodes.length;t++)e.push(this.DOM.childNodes[t].nodeName);return e}},{key:"getChildren",value:function(e){return function(e){for(var t=[],r=0;r<e.length;r++)t.push(new n.default.XML(e[r]));return t}(e?this.DOM.getElementsByTagName(e):this.DOM.children)}},{key:"getChild",value:function(e){if("string"!=typeof e)return new n.default.XML(this.DOM.children[e]);var t=!0,r=!1,o=void 0;try{for(var s,a=this.DOM.children[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var i=s.value;if(i.tagName===e)return new n.default.XML(i)}}catch(e){r=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(r)throw o}}}},{key:"addChild",value:function(e){e instanceof n.default.XML&&this.DOM.appendChild(e.DOM)}},{key:"removeChild",value:function(e){var t=-1;if("string"==typeof e){for(var r=0;r<this.DOM.children.length;r++)if(this.DOM.children[r].tagName===e){t=r;break}}else t=e;-1!==t&&this.DOM.removeChild(this.DOM.children[t])}},{key:"getAttributeCount",value:function(){return this.DOM.attributes.length}},{key:"listAttributes",value:function(){var e=[],t=!0,r=!1,n=void 0;try{for(var o,s=this.DOM.attributes[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value;e.push(a.nodeName)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}return e}},{key:"hasAttribute",value:function(e){var t={},r=!0,n=!1,o=void 0;try{for(var s,a=this.DOM.attributes[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var i=s.value;t[i.nodeName]=i.nodeValue}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return!!t[e]}},{key:"getNum",value:function(e,t){var r={},n=!0,o=!1,s=void 0;try{for(var a,i=this.DOM.attributes[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;r[l.nodeName]=l.nodeValue}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}return Number(r[e])||t||0}},{key:"getString",value:function(e,t){var r={},n=!0,o=!1,s=void 0;try{for(var a,i=this.DOM.attributes[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;r[l.nodeName]=l.nodeValue}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}return r[e]?String(r[e]):t||null}},{key:"setAttribute",value:function(e,t){this.DOM.setAttribute(e,t)}},{key:"getContent",value:function(e){var t=this.DOM.textContent;return(t=t.replace(/\s\s+/g,","))||e||null}},{key:"setContent",value:function(e){this.DOM.children.length||(this.DOM.textContent=e)}},{key:"serialize",value:function(){return(new XMLSerializer).serializeToString(this.DOM)}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.number.constructor":171,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.replace":194,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],303:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};function o(){if("function"==typeof Math.hypot)return Math.hypot.apply(null,arguments);for(var e=arguments.length,t=[],r=0,n=0;n<e;n++){var o=arguments[n];if((o=+o)==1/0||o===-1/0)return 1/0;r<(o=Math.abs(o))&&(r=o),t[n]=o}0===r&&(r=1);for(var s=0,a=0,i=0;i<e;i++){var l,u=s+(l=(l=t[i]/r)*l-a);a=u-s-l,s=u}return Math.sqrt(s)*r}n.default.prototype.abs=Math.abs,n.default.prototype.ceil=Math.ceil,n.default.prototype.constrain=function(e,t,r){return n.default._validateParameters("constrain",arguments),Math.max(Math.min(e,r),t)},n.default.prototype.dist=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default._validateParameters("dist",t),4===t.length?o(t[2]-t[0],t[3]-t[1]):6===t.length?o(t[3]-t[0],t[4]-t[1],t[5]-t[2]):void 0},n.default.prototype.exp=Math.exp,n.default.prototype.floor=Math.floor,n.default.prototype.lerp=function(e,t,r){return n.default._validateParameters("lerp",arguments),r*(t-e)+e},n.default.prototype.log=Math.log,n.default.prototype.mag=function(e,t){return n.default._validateParameters("mag",arguments),o(e,t)},n.default.prototype.map=function(e,t,r,o,s,a){return n.default._validateParameters("map",arguments),e=(e-t)/(r-t)*(s-o)+o,a?o<s?this.constrain(e,o,s):this.constrain(e,s,o):e},n.default.prototype.max=function(){for(var e=function(e){var t=-1/0,r=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var i=s.value;t=t<i?i:t}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return t},t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r[0]instanceof Array?e(r[0]):e(r)},n.default.prototype.min=function(){for(var e=function(e){var t=1/0,r=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var i=s.value;t=i<t?i:t}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return t},t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r[0]instanceof Array?e(r[0]):e(r)},n.default.prototype.norm=function(e,t,r){return n.default._validateParameters("norm",arguments),this.map(e,t,r,0,1)},n.default.prototype.pow=Math.pow,n.default.prototype.round=function(e,t){return t?(t=Math.pow(10,t),Math.round(e*t)/t):Math.round(e)},n.default.prototype.sq=function(e){return e*e},n.default.prototype.sqrt=Math.sqrt,n.default.prototype.fract=function(e){n.default._validateParameters("fract",arguments);var t,r=0;return e=Number(e),isNaN(e)||Math.abs(e)===1/0?e:(e<0&&(e=-e,r=1),String(e).includes(".")&&!String(e).includes("e")?(t=String(e),t=Number("0"+t.slice(t.indexOf("."))),Math.abs(r-t)):e<1?Math.abs(r-e):0)},e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.math.hypot":169,"core-js/modules/es.number.constructor":171,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],304:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};function o(e,t,r){return(o=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?Reflect.construct:function(e,t,r){var n=[null];return n.push.apply(n,t),t=new(Function.bind.apply(e,n)),r&&s(t,r.prototype),t}).apply(null,arguments)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}n.default.prototype.createVector=function(e,t,r){return this instanceof n.default?o(n.default.Vector,[this._fromRadians.bind(this),this._toRadians.bind(this)].concat(Array.prototype.slice.call(arguments))):new n.default.Vector(e,t,r)},e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.regexp.to-string":186}],305:[function(e,t,r){"use strict";function n(e){return.5*(1-Math.cos(e*Math.PI))}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,e=(e=e("../core/main"))&&e.__esModule?e:{default:e};var o,s=4095,a=4,i=.5;e.default.prototype.noise=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;if(null==o){o=new Array(4096);for(var l=0;l<4096;l++)o[l]=Math.random()}e<0&&(e=-e),t<0&&(t=-t),r<0&&(r=-r);for(var u,c,d=Math.floor(e),h=Math.floor(t),p=Math.floor(r),f=e-d,m=t-h,y=r-p,g=0,v=.5,b=0;b<a;b++){var x=d+(h<<4)+(p<<8),w=n(f),_=n(m),S=o[x&s];S+=w*(o[x+1&s]-S),u=o[x+16&s],S+=_*((u+=w*(o[x+16+1&s]-u))-S),u=o[(x+=256)&s],u+=w*(o[x+1&s]-u),c=o[x+16&s],u+=_*((c+=w*(o[x+16+1&s]-c))-u),g+=(S+=n(y)*(u-S))*v,v*=i,d<<=1,h<<=1,p<<=1,1<=(f*=2)&&(d++,f--),1<=(m*=2)&&(h++,m--),1<=(y*=2)&&(p++,y--)}return g},e.default.prototype.noiseDetail=function(e,t){0<e&&(a=e),0<t&&(i=t)},e.default.prototype.noiseSeed=function(e){r=4294967296;var t,r;(function(e){t=(null==e?Math.random()*r:e)>>>0})(e),o=new Array(4096);for(var n=0;n<4096;n++)o[n]=(t=(1664525*t+1013904223)%r)/r},e=e.default,r.default=e},{"../core/main":273}],306:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.number.is-finite"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.sub"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.number.is-finite"),e("core-js/modules/es.string.sub"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(d=e("../core/main"))&&d.__esModule?d:{default:d},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return 0!==e&&(this.x=this.x%e),0!==t&&(this.y=this.y%t),this}function c(e,t,r){return 0!==e&&(this.x=this.x%e),0!==t&&(this.y=this.y%t),0!==r&&(this.z=this.z%r),this}s.default.Vector=function(){function e(){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");var t,r,n="function"==typeof(arguments.length<=0?void 0:arguments[0])?(this.isPInst=!0,this._fromRadians=arguments.length<=0?void 0:arguments[0],this._toRadians=arguments.length<=1?void 0:arguments[1],t=(arguments.length<=2?void 0:arguments[2])||0,r=(arguments.length<=3?void 0:arguments[3])||0,(arguments.length<=4?void 0:arguments[4])||0):(t=(arguments.length<=0?void 0:arguments[0])||0,r=(arguments.length<=1?void 0:arguments[1])||0,(arguments.length<=2?void 0:arguments[2])||0);this.x=t,this.y=r,this.z=n}var t,r,n;return t=e,n=[{key:"fromAngle",value:function(e,t){return new s.default.Vector((t=void 0===t?1:t)*Math.cos(e),t*Math.sin(e),0)}},{key:"fromAngles",value:function(e,t,r){void 0===r&&(r=1);var n=Math.cos(t),o=(t=Math.sin(t),Math.cos(e));return e=Math.sin(e),new s.default.Vector(r*e*t,-r*o,r*e*n)}},{key:"random2D",value:function(){return this.fromAngle(Math.random()*a.TWO_PI)}},{key:"random3D",value:function(){var e=Math.random()*a.TWO_PI,t=2*Math.random()-1,r=(n=Math.sqrt(1-t*t))*Math.cos(e),n=n*Math.sin(e);return new s.default.Vector(r,n,t)}},{key:"copy",value:function(e){return e.copy(e)}},{key:"add",value:function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.add")),r.add(t),r}},{key:"rem",value:function(e,t){if(e instanceof s.default.Vector&&t instanceof s.default.Vector)return(e=e.copy()).rem(t),e}},{key:"sub",value:function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.sub")),r.sub(t),r}},{key:"mult",value:function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.mult")),r.mult(t),r}},{key:"rotate",value:function(e,t,r){return 2===arguments.length?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.rotate"),r.set(e)),r.rotate(t),r}},{key:"div",value:function(e,t,r){return r?r.set(e):(r=e.copy(),3===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.div")),r.div(t),r}},{key:"dot",value:function(e,t){return e.dot(t)}},{key:"cross",value:function(e,t){return e.cross(t)}},{key:"dist",value:function(e,t){return e.dist(t)}},{key:"lerp",value:function(e,t,r,n){return n?n.set(e):(n=e.copy(),4===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.lerp")),n.lerp(t,r),n}},{key:"slerp",value:function(e,t,r,n){return n?n.set(e):(n=e.copy(),4===arguments.length&&s.default._friendlyError("The target parameter is undefined, it should be of type p5.Vector","p5.Vector.slerp")),n.slerp(t,r),n}},{key:"mag",value:function(e){return e.mag()}},{key:"magSq",value:function(e){return e.magSq()}},{key:"normalize",value:function(e,t){return arguments.length<2?t=e.copy():(t instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.normalize"),t.set(e)),t.normalize()}},{key:"limit",value:function(e,t,r){return arguments.length<3?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.limit"),r.set(e)),r.limit(t)}},{key:"setMag",value:function(e,t,r){return arguments.length<3?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.setMag"),r.set(e)),r.setMag(t)}},{key:"heading",value:function(e){return e.heading()}},{key:"angleBetween",value:function(e,t){return e.angleBetween(t)}},{key:"reflect",value:function(e,t,r){return arguments.length<3?r=e.copy():(r instanceof s.default.Vector||s.default._friendlyError("The target parameter should be of type p5.Vector","p5.Vector.reflect"),r.set(e)),r.reflect(t)}},{key:"array",value:function(e){return e.array()}},{key:"equals",value:function(e,t){var r;return e instanceof s.default.Vector?r=e:e instanceof Array?r=(new s.default.Vector).set(e):s.default._friendlyError("The v1 parameter should be of type Array or p5.Vector","p5.Vector.equals"),r.equals(t)}}],(r=[{key:"toString",value:function(){return"p5.Vector Object : [".concat(this.x,", ").concat(this.y,", ").concat(this.z,"]")}},{key:"set",value:function(e,t,r){return e instanceof s.default.Vector?(this.x=e.x||0,this.y=e.y||0,this.z=e.z||0):Array.isArray(e)?(this.x=e[0]||0,this.y=e[1]||0,this.z=e[2]||0):(this.x=e||0,this.y=t||0,this.z=r||0),this}},{key:"copy",value:function(){return this.isPInst?new s.default.Vector(this._fromRadians,this._toRadians,this.x,this.y,this.z):new s.default.Vector(this.x,this.y,this.z)}},{key:"add",value:function(e,t,r){return e instanceof s.default.Vector?(this.x+=e.x||0,this.y+=e.y||0,this.z+=e.z||0):Array.isArray(e)?(this.x+=e[0]||0,this.y+=e[1]||0,this.z+=e[2]||0):(this.x+=e||0,this.y+=t||0,this.z+=r||0),this}},{key:"rem",value:function(e,t,r){var n;if(e instanceof s.default.Vector){if([e.x,e.y,e.z].every(Number.isFinite))return o=parseFloat(e.x),a=parseFloat(e.y),n=parseFloat(e.z),c.call(this,o,a,n)}else if(Array.isArray(e)){if(e.every((function(e){return Number.isFinite(e)})))return 2===e.length?u.call(this,e[0],e[1]):3===e.length?c.call(this,e[0],e[1],e[2]):void 0}else if(1===arguments.length){if(Number.isFinite(e)&&0!==e)return this.x=this.x%e,this.y=this.y%e,this.z=this.z%e,this}else if(2===arguments.length){var o=Array.prototype.slice.call(arguments);if(o.every((function(e){return Number.isFinite(e)}))&&2===o.length)return u.call(this,o[0],o[1])}else if(3===arguments.length){var a=Array.prototype.slice.call(arguments);if(a.every((function(e){return Number.isFinite(e)}))&&3===a.length)return c.call(this,a[0],a[1],a[2])}}},{key:"sub",value:function(e,t,r){return e instanceof s.default.Vector?(this.x-=e.x||0,this.y-=e.y||0,this.z-=e.z||0):Array.isArray(e)?(this.x-=e[0]||0,this.y-=e[1]||0,this.z-=e[2]||0):(this.x-=e||0,this.y-=t||0,this.z-=r||0),this}},{key:"mult",value:function(e,t,r){var n;return e instanceof s.default.Vector?Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z?(this.x*=e.x,this.y*=e.y,this.z*=e.z):console.warn("p5.Vector.prototype.mult:","x contains components that are either undefined or not finite numbers"):Array.isArray(e)?e.every((function(e){return Number.isFinite(e)}))&&e.every((function(e){return"number"==typeof e}))?1===e.length?(this.x*=e[0],this.y*=e[0],this.z*=e[0]):2===e.length?(this.x*=e[0],this.y*=e[1]):3===e.length&&(this.x*=e[0],this.y*=e[1],this.z*=e[2]):console.warn("p5.Vector.prototype.mult:","x contains elements that are either undefined or not finite numbers"):(n=Array.prototype.slice.call(arguments)).every((function(e){return Number.isFinite(e)}))&&n.every((function(e){return"number"==typeof e}))?(1===arguments.length&&(this.x*=e,this.y*=e,this.z*=e),2===arguments.length&&(this.x*=e,this.y*=t),3===arguments.length&&(this.x*=e,this.y*=t,this.z*=r)):console.warn("p5.Vector.prototype.mult:","x, y, or z arguments are either undefined or not a finite number"),this}},{key:"div",value:function(e,t,r){if(e instanceof s.default.Vector)if(Number.isFinite(e.x)&&Number.isFinite(e.y)&&Number.isFinite(e.z)&&"number"==typeof e.x&&"number"==typeof e.y&&"number"==typeof e.z){var n=0===e.z&&0===this.z;if(0===e.x||0===e.y||!n&&0===e.z)return console.warn("p5.Vector.prototype.div:","divide by 0"),this;this.x/=e.x,this.y/=e.y,n||(this.z/=e.z)}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");else if(Array.isArray(e))if(e.every((function(e){return Number.isFinite(e)}))&&e.every((function(e){return"number"==typeof e}))){if(e.some((function(e){return 0===e})))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;1===e.length?(this.x/=e[0],this.y/=e[0],this.z/=e[0]):2===e.length?(this.x/=e[0],this.y/=e[1]):3===e.length&&(this.x/=e[0],this.y/=e[1],this.z/=e[2])}else console.warn("p5.Vector.prototype.div:","x contains components that are either undefined or not finite numbers");else if((n=Array.prototype.slice.call(arguments)).every((function(e){return Number.isFinite(e)}))&&n.every((function(e){return"number"==typeof e}))){if(n.some((function(e){return 0===e})))return console.warn("p5.Vector.prototype.div:","divide by 0"),this;1===arguments.length&&(this.x/=e,this.y/=e,this.z/=e),2===arguments.length&&(this.x/=e,this.y/=t),3===arguments.length&&(this.x/=e,this.y/=t,this.z/=r)}else console.warn("p5.Vector.prototype.div:","x, y, or z arguments are either undefined or not a finite number");return this}},{key:"mag",value:function(){return Math.sqrt(this.magSq())}},{key:"magSq",value:function(){var e=this.x,t=this.y,r=this.z;return e*e+t*t+r*r}},{key:"dot",value:function(e,t,r){return e instanceof s.default.Vector?this.dot(e.x,e.y,e.z):this.x*(e||0)+this.y*(t||0)+this.z*(r||0)}},{key:"cross",value:function(e){var t=this.y*e.z-this.z*e.y,r=this.z*e.x-this.x*e.z;return e=this.x*e.y-this.y*e.x,this.isPInst?new s.default.Vector(this._fromRadians,this._toRadians,t,r,e):new s.default.Vector(t,r,e)}},{key:"dist",value:function(e){return e.copy().sub(this).mag()}},{key:"normalize",value:function(){var e=this.mag();return 0!==e&&this.mult(1/e),this}},{key:"limit",value:function(e){var t=this.magSq();return e*e<t&&this.div(Math.sqrt(t)).mult(e),this}},{key:"setMag",value:function(e){return this.normalize().mult(e)}},{key:"heading",value:function(){var e=Math.atan2(this.y,this.x);return this.isPInst?this._fromRadians(e):e}},{key:"setHeading",value:function(e){this.isPInst&&(e=this._toRadians(e));var t=this.mag();return this.x=t*Math.cos(e),this.y=t*Math.sin(e),this}},{key:"rotate",value:function(e){e=this.heading()+e;var t=(this.isPInst&&(e=this._toRadians(e)),this.mag());return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this}},{key:"angleBetween",value:function(e){var t;return 0==this.magSq()*e.magSq()?NaN:(t=this.cross(e),e=Math.atan2(t.mag(),this.dot(e))*Math.sign(t.z||1),this.isPInst?this._fromRadians(e):e)}},{key:"lerp",value:function(e,t,r,n){return e instanceof s.default.Vector?this.lerp(e.x,e.y,e.z,t):(this.x+=(e-this.x)*n||0,this.y+=(t-this.y)*n||0,this.z+=(r-this.z)*n||0,this)}},{key:"slerp",value:function(e,t){if(0!==t){if(1===t)return this.set(e);var r=this.mag(),n=e.mag();if(0==r*n)this.mult(1-t).add(e.x*t,e.y*t,e.z*t);else{var o=this.cross(e),s=o.mag(),a=Math.atan2(s,this.dot(e));if(0<s)o.x/=s,o.y/=s,o.z/=s;else{if(a<.5*Math.PI)return this.mult(1-t).add(e.x*t,e.y*t,e.z*t),this;0===this.z&&0===e.z?o.set(0,0,1):0!==this.x?o.set(this.y,-this.x,0).normalize():o.set(1,0,0)}s=o.cross(this),o=(e=1-t+t*n/r)*Math.cos(t*a),n=e*Math.sin(t*a),this.x=this.x*o+s.x*n,this.y=this.y*o+s.y*n,this.z=this.z*o+s.z*n}}return this}},{key:"reflect",value:function(e){return e.normalize(),this.sub(e.mult(2*this.dot(e)))}},{key:"array",value:function(){return[this.x||0,this.y||0,this.z||0]}},{key:"equals",value:function(e,t,r){var n,o;return e=e instanceof s.default.Vector?(n=e.x||0,o=e.y||0,e.z||0):Array.isArray(e)?(n=e[0]||0,o=e[1]||0,e[2]||0):(n=e||0,o=t||0,r||0),this.x===n&&this.y===o&&this.z===e}}])&&l(t.prototype,r),n&&l(t,n),e}();var d=s.default.Vector;r.default=d},{"../core/constants":262,"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.every":153,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.some":165,"core-js/modules/es.math.sign":170,"core-js/modules/es.number.constructor":171,"core-js/modules/es.number.is-finite":172,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.sub":198,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],307:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e},o="_lcg_random_state",s=4294967296,a=0;n.default.prototype._lcg=function(e){return this[e]=(1664525*this[e]+1013904223)%s,this[e]/s},n.default.prototype._lcgSetSeed=function(e,t){this[e]=(null==t?Math.random()*s:t)>>>0},n.default.prototype.randomSeed=function(e){this._lcgSetSeed(o,e),this._gaussian_previous=!1},n.default.prototype.random=function(e,t){var r,s;return n.default._validateParameters("random",arguments),r=null!=this[o]?this._lcg(o):Math.random(),void 0===e?r:void 0===t?e instanceof Array?e[Math.floor(r*e.length)]:r*e:(t<e&&(s=e,e=t,t=s),r*(t-e)+e)},n.default.prototype.randomGaussian=function(e){var t,r,n,o,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;if(this._gaussian_previous)t=a,this._gaussian_previous=!1;else{for(;1<=(o=(r=this.random(2)-1)*r+(n=this.random(2)-1)*n););t=r*(o=Math.sqrt(-2*Math.log(o)/o)),a=n*o,this._gaussian_previous=!0}return t*s+(e||0)},e=n.default,r.default=e},{"../core/main":273}],308:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}s.default.prototype._angleMode=a.RADIANS,s.default.prototype.acos=function(e){return this._fromRadians(Math.acos(e))},s.default.prototype.asin=function(e){return this._fromRadians(Math.asin(e))},s.default.prototype.atan=function(e){return this._fromRadians(Math.atan(e))},s.default.prototype.atan2=function(e,t){return this._fromRadians(Math.atan2(e,t))},s.default.prototype.cos=function(e){return Math.cos(this._toRadians(e))},s.default.prototype.sin=function(e){return Math.sin(this._toRadians(e))},s.default.prototype.tan=function(e){return Math.tan(this._toRadians(e))},s.default.prototype.degrees=function(e){return e*a.RAD_TO_DEG},s.default.prototype.radians=function(e){return e*a.DEG_TO_RAD},s.default.prototype.angleMode=function(e){if(s.default._validateParameters("angleMode",arguments),void 0===e)return this._angleMode;e!==a.DEGREES&&e!==a.RADIANS||(this._angleMode=e)},s.default.prototype._toRadians=function(e){return this._angleMode===a.DEGREES?e*a.DEG_TO_RAD:e},s.default.prototype._toDegrees=function(e){return this._angleMode===a.RADIANS?e*a.RAD_TO_DEG:e},s.default.prototype._fromRadians=function(e){return this._angleMode===a.DEGREES?e*a.RAD_TO_DEG:e};var l=s.default;r.default=l},{"../core/constants":262,"../core/main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],309:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.textAlign=function(e,t){var r;return n.default._validateParameters("textAlign",arguments),(r=this._renderer).textAlign.apply(r,arguments)},n.default.prototype.textLeading=function(e){var t;return n.default._validateParameters("textLeading",arguments),(t=this._renderer).textLeading.apply(t,arguments)},n.default.prototype.textSize=function(e){var t;return n.default._validateParameters("textSize",arguments),(t=this._renderer).textSize.apply(t,arguments)},n.default.prototype.textStyle=function(e){var t;return n.default._validateParameters("textStyle",arguments),(t=this._renderer).textStyle.apply(t,arguments)},n.default.prototype.textWidth=function(){for(var e,t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return r[0]+="",n.default._validateParameters("textWidth",r),0===r[0].length?0:(e=this._renderer).textWidth.apply(e,r)},n.default.prototype.textAscent=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default._validateParameters("textAscent",t),this._renderer.textAscent()},n.default.prototype.textDescent=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default._validateParameters("textDescent",t),this._renderer.textDescent()},n.default.prototype._updateTextMetrics=function(){return this._renderer._updateTextMetrics()},n.default.prototype.textWrap=function(e){if("WORD"!==e&&"CHAR"!==e)throw"Error: textWrap accepts only WORD or CHAR";return this._renderer.textWrap(e)},e=n.default,r.default=e},{"../core/main":273}],310:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.last-index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.split"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(c=e("../core/main"))&&c.__esModule?c:{default:c},a=u(e("../core/constants")),i=u(e("opentype.js"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function u(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n,s={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&((n=a?Object.getOwnPropertyDescriptor(e,r):null)&&(n.get||n.set)?Object.defineProperty(s,r,n):s[r]=e[r]);return s.default=e,t&&t.set(e,s),s}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),s.default.prototype.loadFont=function(e,t,r){s.default._validateParameters("loadFont",arguments);var n=new s.default.Font(this),o=this;return i.load(e,(function(a,i){if(a)return s.default._friendlyFileLoadError(4,e),void 0!==r?r(a):void console.error(a,e);n.font=i,void 0!==t&&t(n),o._decrementPreload();var l=(i=(a=e.split("\\").pop().split("/").pop()).lastIndexOf("."))<1?null:a.slice(i+1);["ttf","otf","woff","woff2"].includes(l)&&(l=a.slice(0,-1!==i?i:0),(a=document.createElement("style")).appendChild(document.createTextNode("\n@font-face {\nfont-family: ".concat(l,";\nsrc: url(").concat(e,");\n}\n"))),document.head.appendChild(a))})),n},s.default.prototype.text=function(e,t,r,n,o){var a;return s.default._validateParameters("text",arguments),this._renderer._doFill||this._renderer._doStroke?(a=this._renderer).text.apply(a,arguments):this},s.default.prototype.textFont=function(e,t){if(s.default._validateParameters("textFont",arguments),arguments.length){if(e)return this._renderer._setProperty("_textFont",e),t&&(this._renderer._setProperty("_textSize",t),this._renderer._leadingSet||this._renderer._setProperty("_textLeading",t*a._DEFAULT_LEADMULT)),this._renderer._applyTextProperties();throw new Error("null font passed to textFont")}return this._renderer._textFont};var c=s.default;r.default=c},{"../core/constants":262,"../core/friendly_errors/fes_core":264,"../core/friendly_errors/file_errors":265,"../core/friendly_errors/validate_params":268,"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.last-index-of":162,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.split":196,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236,"opentype.js":247}],311:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(o=e("../core/main"))&&o.__esModule?o:{default:o},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function l(e,t){var r=e.length;return e[t<0?t%r+r:t%r]}function u(e,t,r,n){var o,s,a;return n?(void 0===u.tmpPoint1&&(u.tmpPoint1=[],u.tmpPoint2=[]),s=u.tmpPoint1,a=u.tmpPoint2,s.x=t.x-e.x,s.y=t.y-e.y,a.x=r.x-t.x,a.y=r.y-t.y,o=s.x*a.x+s.y*a.y,s=Math.sqrt(s.x*s.x+s.y*s.y),a=Math.sqrt(a.x*a.x+a.y*a.y),Math.acos(o/(s*a))<n):0==(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1])}function c(e,t,r,n,o,s,a,i,l){var u=1-l,c=(d=Math.pow(u,3))*e+3*(h=Math.pow(u,2))*l*r+3*u*l*l*o+(p=(m=l*l)*l)*a,d=d*t+3*h*l*n+3*u*l*l*s+p*i,h=e+2*l*(r-e)+m*(o-2*r+e),p=t+2*l*(n-t)+m*(s-2*n+t),f=r+2*l*(o-r)+m*(a-2*o+r),m=n+2*l*(s-n)+m*(i-2*s+n);return e=u*e+l*r,r=u*t+l*n,t=u*o+l*a,n=u*s+l*i,o=90-180*Math.atan2(h-f,p-m)/Math.PI,(f<h||p<m)&&(o+=180),{x:c,y:d,m:{x:h,y:p},n:{x:f,y:m},start:{x:e,y:r},end:{x:t,y:n},alpha:o}}function d(e,t,r,n,o,s,a,i,l){return null==l?g(e,t,r,n,o,s,a,i):c(e,t,r,n,o,s,a,i,function(e,t,r,n,o,s,a,i,l){if(!(l<0||g(e,t,r,n,o,s,a,i)<l)){var u,c=.5,d=1-c;for(u=g(e,t,r,n,o,s,a,i,d);.01<Math.abs(u-l);)u=g(e,t,r,n,o,s,a,i,d+=(u<l?1:-1)*(c/=2));return d}}(e,t,r,n,o,s,a,i,l))}function h(e,t,r){for(var n,o,s,a,i,l=0,u=0,h=(e=function(e,t){function r(e,t,r){var n,o;if(!e)return["C",t.x,t.y,t.x,t.y,t.x,t.y];switch(e[0]in{T:1,Q:1}||(t.qx=t.qy=null),e[0]){case"M":t.X=e[1],t.Y=e[2];break;case"A":e=["C"].concat(p.apply(0,[t.x,t.y].concat(e.slice(1))));break;case"S":o="C"===r||"S"===r?(n=2*t.x-t.bx,2*t.y-t.by):(n=t.x,t.y),e=["C",n,o].concat(e.slice(1));break;case"T":"Q"===r||"T"===r?(t.qx=2*t.x-t.qx,t.qy=2*t.y-t.qy):(t.qx=t.x,t.qy=t.y),e=["C"].concat(y(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1],t.qy=e[2],e=["C"].concat(y(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"].concat(m(t.x,t.y,e[1],e[2]));break;case"H":e=["C"].concat(m(t.x,t.y,e[1],t.y));break;case"V":e=["C"].concat(m(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"].concat(m(t.x,t.y,t.X,t.Y))}return e}function n(e,t){if(7<e[t].length){e[t].shift();for(var r=e[t];r.length;)c[t]="A",i&&(d[t]="A"),e.splice(t++,0,["C"].concat(r.splice(0,6)));e.splice(t,1),s=Math.max(a.length,i&&i.length||0)}}function o(e,t,r,n,o){e&&t&&"M"===e[o][0]&&"M"!==t[o][0]&&(t.splice(o,0,["M",n.x,n.y]),r.bx=0,r.by=0,r.x=e[o][1],r.y=e[o][2],s=Math.max(a.length,i&&i.length||0))}var s,a=function(e){var t=[],r=0,n=0,o=0,s=0,a=0;if(e){"M"===e[0][0]&&(o=r=+e[0][1],s=n=+e[0][2],a++,t[0]=["M",r,n]);for(var i,l,u=3===e.length&&"M"===e[0][0]&&"R"===e[1][0].toUpperCase()&&"Z"===e[2][0].toUpperCase(),c=a,d=e.length;c<d;c++){if(t.push(i=[]),(l=e[c])[0]!==String.prototype.toUpperCase.call(l[0]))switch(i[0]=String.prototype.toUpperCase.call(l[0]),i[0]){case"A":i[1]=l[1],i[2]=l[2],i[3]=l[3],i[4]=l[4],i[5]=l[5],i[6]=+(l[6]+r),i[7]=+(l[7]+n);break;case"V":i[1]=+l[1]+n;break;case"H":i[1]=+l[1]+r;break;case"R":for(var h,p=2,m=(h=[r,n].concat(l.slice(1))).length;p<m;p++)h[p]=+h[p]+r,h[++p]=+h[p]+n;t.pop(),t=t.concat(f(h,u));break;case"M":o=+l[1]+r,s=+l[2]+n;break;default:for(var y=1,g=l.length;y<g;y++)i[y]=+l[y]+(y%2?r:n)}else if("R"===l[0])h=[r,n].concat(l.slice(1)),t.pop(),t=t.concat(f(h,u)),i=["R"].concat(l.slice(-2));else for(var v=0,b=l.length;v<b;v++)i[v]=l[v];switch(i[0]){case"Z":r=o,n=s;break;case"H":r=i[1];break;case"V":n=i[1];break;case"M":o=i[i.length-2],s=i[i.length-1];break;default:r=i[i.length-2],n=i[i.length-1]}}}return t}(e),i=void 0,l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},u={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c=[],d=[],h="",g="";s=Math.max(a.length,i&&i.length||0);for(var v=0;v<s;v++){"C"!==(h=a[v]?a[v][0]:h)&&(c[v]=h,v&&(g=c[v-1])),a[v]=r(a[v],l,g),"A"!==c[v]&&"C"===h&&(c[v]="C"),n(a,v),i&&("C"!==(h=i[v]?i[v][0]:h)&&(d[v]=h,v&&(g=d[v-1])),i[v]=r(i[v],u,g),"A"!==d[v]&&"C"===h&&(d[v]="C"),n(i,v)),o(a,i,l,u,v),o(i,a,u,l,v);var b=a[v],x=i&&i[v],w=b.length,_=i&&x.length;l.x=b[w-2],l.y=b[w-1],l.bx=parseFloat(b[w-4])||l.x,l.by=parseFloat(b[w-3])||l.y,u.bx=i&&(parseFloat(x[_-4])||u.x),u.by=i&&(parseFloat(x[_-3])||u.y),u.x=i&&x[_-2],u.y=i&&x[_-1]}return i?[a,i]:a}(e)).length;u<h;u++){if("M"===(s=e[u])[0])n=+s[1],o=+s[2];else{if(t<l+(a=d(n,o,s[1],s[2],s[3],s[4],s[5],s[6]))&&!r)return{x:(i=d(n,o,s[1],s[2],s[3],s[4],s[5],s[6],t-l)).x,y:i.y,alpha:i.alpha};l+=a,n=+s[5],o=+s[6]}s.shift()}return(i=r?l:c(n,o,s[0],s[1],s[2],s[3],s[4],s[5],1)).alpha?{x:i.x,y:i.y,alpha:i.alpha}:i}function p(e,t,r,n,o,s,a,i,l,u){function c(e,t,r){return{x:e*Math.cos(r)-t*Math.sin(r),y:e*Math.sin(r)+t*Math.cos(r)}}var d,h=120*(v=Math.PI)/180,f=v/180*(+o||0),m=[],y=(u?(S=u[0],d=u[1],w=u[2],_=u[3]):(e=(b=c(e,t,-f)).x,t=b.y,1<(y=(g=(e-(i=(b=c(i,l,-f)).x))/2)*g/(r*r)+(b=(t-(l=b.y))/2)*b/(n*n))&&(r*=y=Math.sqrt(y),n*=y),y=r*r,x=n*n,w=(s=(s===a?-1:1)*Math.sqrt(Math.abs((y*x-y*b*b-x*g*g)/(y*b*b+x*g*g))))*r*b/n+(e+i)/2,_=s*-n*g/r+(t+l)/2,S=Math.asin(((t-_)/n).toFixed(9)),d=Math.asin(((l-_)/n).toFixed(9)),(S=e<w?v-S:S)<0&&(S=2*v+S),(d=i<w?v-d:d)<0&&(d=2*v+d),a&&d<S&&(S-=2*v),!a&&S<d&&(d-=2*v)),d-S),g=(Math.abs(y)>h&&(x=d,b=i,s=l,d=S+h*(a&&S<d?1:-1),m=p(i=w+r*Math.cos(d),l=_+n*Math.sin(d),r,n,o,0,a,b,s,[d,x,w,_])),y=d-S,Math.cos(S)),v=Math.sin(S),b=(h=Math.cos(d),o=Math.sin(d),4/3*r*(a=Math.tan(y/4))),x=[e,t],w=[e+b*v,t-(s=4/3*n*a)*g],_=[i+b*o,l-s*h],S=[i,l];if(w[0]=2*x[0]-w[0],w[1]=2*x[1]-w[1],u)return[w,_,S].concat(m);for(var k=[],T=0,E=(m=[w,_,S].concat(m).join().split(",")).length;T<E;T++)k[T]=T%2?c(m[T-1],m[T],f).y:c(m[T],m[T+1],f).x;return k}function f(e,t){for(var r=[],n=0,o=e.length;n<o-2*!t;n+=2){var s=[{x:+e[n-2],y:+e[n-1]},{x:+e[n],y:+e[n+1]},{x:+e[n+2],y:+e[n+3]},{x:+e[n+4],y:+e[n+5]}];t?n?o-4===n?s[3]={x:+e[0],y:+e[1]}:o-2===n&&(s[2]={x:+e[0],y:+e[1]},s[3]={x:+e[2],y:+e[3]}):s[0]={x:+e[o-2],y:+e[o-1]}:o-4===n?s[3]=s[2]:n||(s[0]={x:+e[n],y:+e[n+1]}),r.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return r}function m(e,t,r,n){return[e,t,r,n,r,n]}function y(e,t,r,n,o,s){return[1/3*e+2/3*r,1/3*t+2/3*n,1/3*o+2/3*r,1/3*s+2/3*n,o,s]}function g(e,t,r,n,o,s,a,i,l){for(var u=(l=1<(l=null==l?1:l)?1:l<0?0:l)/2,c=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=0,h=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0;p<12;p++){var f=v(m=u*c[p]+u,e,r,o,a),m=v(m,t,n,s,i);d+=h[p]*Math.sqrt(f*f+m*m)}return u*d}function v(e,t,r,n,o){return e*(e*(-3*t+9*r-9*n+3*o)+6*t-12*r+6*n)-3*t+3*r}o.default.Font=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.parent=t,this.cache={},this.font=void 0}var t;return(t=[{key:"textBounds",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length?arguments[3]:void 0,o=4<arguments.length?arguments[4]:void 0,a=o&&o.renderer&&o.renderer._pInst||this.parent;if((g=a._renderer.drawingContext).textAlign||s.LEFT,g.textBaseline||s.BASELINE,n=n||a._renderer._textSize,!v){for(var i=[],l=[],u=[],c=(u[0]=[],[]),d=this._scale(n),h=a._renderer.textLeading(),p=0,f=(this.font.forEachGlyph(e,t,r,n,o,(function(e,t,r,n){var o=e.getMetrics();0===e.index||10===e.index?u[p+=1]=[]:(u[p].push(t+o.xMin*d),u[p].push(t+o.xMax*d),c.push(r+p*h+-o.yMin*d),c.push(r+p*h+-o.yMax*d))})),0<u[p].length&&(i[p]=Math.min.apply(null,u[p]),l[p]=Math.max.apply(null,u[p])),0),m=0;m<=p;m++){i[m]=Math.min.apply(null,u[m]),l[m]=Math.max.apply(null,u[m]);var y=l[m]-i[m];f<y&&(f=y)}var g,v={x:g=Math.min.apply(null,i),y:r=Math.min.apply(null,c),h:Math.max.apply(null,c)-r,w:f,advance:g-t};n=this._handleAlignment(a._renderer,e,v.x,v.y,v.w+v.advance),v.x=n.x,v.y=n.y}return v}},{key:"textToPoints",value:function(e,t,r,n,o){var s=0,a=[],c=this._getGlyphs(e);n=n||this.parent._renderer._textSize;for(var d,p=0;p<c.length;p++){if(!(c[d=p].name&&"space"===c[d].name||e.length===c.length&&" "===e[d]))for(var f=function(e){for(var t,r=[],n=0;n<e.length;n++)"M"===e[n].type&&(t&&r.push(t),t=[]),t.push(function(e){var t=[e.type];return"M"===e.type||"L"===e.type?t.push(e.x,e.y):"C"===e.type?t.push(e.x1,e.y1,e.x2,e.y2,e.x,e.y):"Q"===e.type&&t.push(e.x1,e.y1,e.x,e.y),t}(e[n]));return r.push(t),r}(c[p].getPath(t,r,n).commands),m=0;m<f.length;m++)for(var y=function(e,t){t=function(e,t){if("object"!==i(e))e=t;else for(var r in t)void 0===e[r]&&(e[r]=t[r]);return e}(t,{sampleFactor:.1,simplifyThreshold:0});for(var r=h(e,0,1),n=r/(r*t.sampleFactor),o=[],s=0;s<r;s+=n)o.push(h(e,s));return t.simplifyThreshold&&function(e){for(var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,r=e.length-1;3<e.length&&0<=r;--r)u(l(e,r-1),l(e,r),l(e,r+1),t)&&e.splice(r%e.length,1)}(o,t.simplifyThreshold),o}(f[m],o),g=0;g<y.length;g++)y[g].x+=s,a.push(y[g]);s+=c[p].advanceWidth*this._scale(n)}return a}},{key:"_getGlyphs",value:function(e){return this.font.stringToGlyphs(e)}},{key:"_getPath",value:function(e,t,r,n){var o=(n&&n.renderer&&n.renderer._pInst||this.parent)._renderer;return t=this._handleAlignment(o,e,t,r),this.font.getPath(e,t.x,t.y,o._textSize,n)}},{key:"_getPathData",value:function(e,t,r,n){var o=3;return"string"==typeof e&&2<arguments.length?e=this._getPath(e,t,r,n):"object"===i(t)&&(n=t),n&&"number"==typeof n.decimals&&(o=n.decimals),e.toPathData(o)}},{key:"_getSVG",value:function(e,t,r,n){var o=3;return"string"==typeof e&&2<arguments.length?e=this._getPath(e,t,r,n):"object"===i(t)&&(n=t),n&&("number"==typeof n.decimals&&(o=n.decimals),"number"==typeof n.strokeWidth&&(e.strokeWidth=n.strokeWidth),void 0!==n.fill&&(e.fill=n.fill),void 0!==n.stroke&&(e.stroke=n.stroke)),e.toSVG(o)}},{key:"_renderPath",value:function(e,t,r,n){var o=n&&n.renderer||this.parent._renderer,a=o.drawingContext,l=(e=("object"===i(e)&&e.commands?e:this._getPath(e,t,r,n)).commands,a.beginPath(),!0);t=!1,r=void 0;try{for(var u,c=e[Symbol.iterator]();!(l=(u=c.next()).done);l=!0){var d=u.value;"M"===d.type?a.moveTo(d.x,d.y):"L"===d.type?a.lineTo(d.x,d.y):"C"===d.type?a.bezierCurveTo(d.x1,d.y1,d.x2,d.y2,d.x,d.y):"Q"===d.type?a.quadraticCurveTo(d.x1,d.y1,d.x,d.y):"Z"===d.type&&a.closePath()}}catch(e){t=!0,r=e}finally{try{l||null==c.return||c.return()}finally{if(t)throw r}}return o._doStroke&&o._strokeSet&&a.stroke(),o._doFill&&(o._fillSet||o._setFill(s._DEFAULT_TEXT_FILL),a.fill()),this}},{key:"_textWidth",value:function(e,t){return this.font.getAdvanceWidth(e,t)}},{key:"_textAscent",value:function(e){return this.font.ascender*this._scale(e)}},{key:"_textDescent",value:function(e){return-this.font.descender*this._scale(e)}},{key:"_scale",value:function(e){return 1/this.font.unitsPerEm*(e||this.parent._renderer._textSize)}},{key:"_handleAlignment",value:function(e,t,r,n,o){var a=e._textSize;switch(void 0===o&&(o=this._textWidth(t,a)),e._textAlign){case s.CENTER:r-=o/2;break;case s.RIGHT:r-=o}switch(e._textBaseline){case s.TOP:n+=this._textAscent(a);break;case s.CENTER:n+=this._textAscent(a)/2;break;case s.BOTTOM:n-=this._textDescent(a)}return{x:r,y:n}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=o.default,r.default=e},{"../core/constants":262,"../core/main":273,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.splice":166,"core-js/modules/es.function.name":167,"core-js/modules/es.number.to-fixed":173,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.split":196,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],312:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.array-buffer.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.array-buffer.constructor"),e("core-js/modules/es.object.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype.append=function(e,t){return e.push(t),e},e.default.prototype.arrayCopy=function(e,t,r,n,o){var s,a;e=void 0!==o?(a=Math.min(o,e.length),s=n,e.slice(t,a+t)):(a=void 0!==r?(a=r,Math.min(a,e.length)):e.length,r=t,e.slice(s=0,a)),Array.prototype.splice.apply(r,[s,a].concat(e))},e.default.prototype.concat=function(e,t){return e.concat(t)},e.default.prototype.reverse=function(e){return e.reverse()},e.default.prototype.shorten=function(e){return e.pop(),e},e.default.prototype.shuffle=function(e,t){for(var r,n,o=ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(e),s=(e=t||o?e:e.slice()).length;1<s;)r=this.random(0,1)*s|0,n=e[--s],e[s]=e[r],e[r]=n;return e},e.default.prototype.sort=function(e,t){var r=t?e.slice(0,Math.min(t,e.length)):e;return t=t?e.slice(Math.min(t,e.length)):[],(r="string"==typeof r[0]?r.sort():r.sort((function(e,t){return e-t}))).concat(t)},e.default.prototype.splice=function(e,t,r){return Array.prototype.splice.apply(e,[r,0].concat(t)),e},e.default.prototype.subset=function(e,t,r){return void 0!==r?e.slice(t,t+r):e.slice(t,e.length)},e=e.default,r.default=e},{"../core/main":273,"core-js/modules/es.array-buffer.constructor":150,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.splice":166,"core-js/modules/es.object.to-string":180}],313:[function(e,t,r){"use strict";e("core-js/modules/es.array.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.repeat"),e("core-js/modules/es.array.map"),e("core-js/modules/es.number.constructor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.repeat"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.float=function(e){return e instanceof Array?e.map(parseFloat):parseFloat(e)},n.default.prototype.int=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:10;return e===1/0||"Infinity"===e?1/0:e===-1/0||"-Infinity"===e?-1/0:"string"==typeof e?parseInt(e,t):"number"==typeof e?0|e:"boolean"==typeof e?e?1:0:e instanceof Array?e.map((function(e){return n.default.prototype.int(e,t)})):void 0},n.default.prototype.str=function(e){return e instanceof Array?e.map(n.default.prototype.str):String(e)},n.default.prototype.boolean=function(e){return"number"==typeof e?0!==e:"string"==typeof e?"true"===e.toLowerCase():"boolean"==typeof e?e:e instanceof Array?e.map(n.default.prototype.boolean):void 0},n.default.prototype.byte=function(e){return"number"==typeof(e=n.default.prototype.int(e,10))?(e+128)%256-128:e instanceof Array?e.map(n.default.prototype.byte):void 0},n.default.prototype.char=function(e){return"number"!=typeof e||isNaN(e)?e instanceof Array?e.map(n.default.prototype.char):"string"==typeof e?n.default.prototype.char(parseInt(e,10)):void 0:String.fromCharCode(e)},n.default.prototype.unchar=function(e){return"string"==typeof e&&1===e.length?e.charCodeAt(0):e instanceof Array?e.map(n.default.prototype.unchar):void 0},n.default.prototype.hex=function(e,t){if(t=null==t?8:t,e instanceof Array)return e.map((function(e){return n.default.prototype.hex(e,t)}));if(e===1/0||e===-1/0)return(e===1/0?"F":"0").repeat(t);if("number"==typeof e){e<0&&(e=4294967295+e+1);for(var r=Number(e).toString(16).toUpperCase();r.length<t;)r="0".concat(r);return r.length>=t?r.substring(r.length-t,r.length):r}},n.default.prototype.unhex=function(e){return e instanceof Array?e.map(n.default.prototype.unhex):parseInt("0x".concat(e),16)},e=n.default,r.default=e},{"../core/main":273,"core-js/modules/es.array.map":163,"core-js/modules/es.number.constructor":171,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.repeat":193}],314:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.pad-start"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.filter"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.constructor"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.pad-start"),e("core-js/modules/es.string.replace"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(u=e("../core/main"))&&u.__esModule?u:{default:u};function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,o=!1,s=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(e,t,r){var n=(s=o(e.toString().split("."),2))[0],s=s[1];return void 0===r?(n=n.padStart(t,"0"),s?n+"."+s:n):(n=(e=o(e.toFixed(r).toString().split("."),2))[0],s=e[1],(n=n.padStart(t,"0"))+"."+s)}function a(e,t){var r=(e=e.toString()).indexOf("."),n=-1!==r?e.substring(r):"";if(e=(e=-1!==r?e.substring(0,r):e).toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),0===t)n="";else if(void 0!==t)if(t>n.length)for(var o=t-(n+=-1===r?".":"").length+1,s=0;s<o;s++)n+="0";else n=n.substring(0,t+1);return e+n}function i(e){return 0<parseFloat(e)?"+".concat(e.toString()):e.toString()}function l(e){return 0<=parseFloat(e)?" ".concat(e.toString()):e.toString()}e("../core/friendly_errors/validate_params"),e("../core/friendly_errors/file_errors"),e("../core/friendly_errors/fes_core"),n.default.prototype.join=function(e,t){return n.default._validateParameters("join",arguments),e.join(t)},n.default.prototype.match=function(e,t){return n.default._validateParameters("match",arguments),e.match(t)},n.default.prototype.matchAll=function(e,t){n.default._validateParameters("matchAll",arguments);for(var r=new RegExp(t,"g"),o=r.exec(e),s=[];null!==o;)s.push(o),o=r.exec(e);return s},n.default.prototype.nf=function(e,t,r){return n.default._validateParameters("nf",arguments),e instanceof Array?e.map((function(e){return s(e,t,r)})):"[object Arguments]"===Object.prototype.toString.call(e)?3===e.length?this.nf(e[0],e[1],e[2]):2===e.length?this.nf(e[0],e[1]):this.nf(e[0]):s(e,t,r)},n.default.prototype.nfc=function(e,t){return n.default._validateParameters("nfc",arguments),e instanceof Array?e.map((function(e){return a(e,t)})):a(e,t)},n.default.prototype.nfp=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("nfp",t);var o=n.default.prototype.nf.apply(this,t);return o instanceof Array?o.map(i):i(o)},n.default.prototype.nfs=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];n.default._validateParameters("nfs",t);var o=n.default.prototype.nf.apply(this,t);return o instanceof Array?o.map(l):l(o)},n.default.prototype.split=function(e,t){return n.default._validateParameters("split",arguments),e.split(t)},n.default.prototype.splitTokens=function(e,t){var r,o;return n.default._validateParameters("splitTokens",arguments),o=void 0!==t?(o=/\]/g.exec(t),(r=/\[/g.exec(t))&&o?(t=t.slice(0,o.index)+t.slice(o.index+1),r=/\[/g.exec(t),t=t.slice(0,r.index)+t.slice(r.index+1),new RegExp("[\\[".concat(t,"\\]]"),"g")):o?(t=t.slice(0,o.index)+t.slice(o.index+1),new RegExp("[".concat(t,"\\]]"),"g")):r?(t=t.slice(0,r.index)+t.slice(r.index+1),new RegExp("[".concat(t,"\\[]"),"g")):new RegExp("[".concat(t,"]"),"g")):/\s/g,e.split(o).filter((function(e){return e}))},n.default.prototype.trim=function(e){return n.default._validateParameters("trim",arguments),e instanceof Array?e.map(this.trim):e.trim()};var u=n.default;r.default=u},{"../core/friendly_errors/fes_core":264,"../core/friendly_errors/file_errors":265,"../core/friendly_errors/validate_params":268,"../core/main":273,"core-js/modules/es.array.filter":155,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.number.to-fixed":173,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.constructor":184,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.match":191,"core-js/modules/es.string.pad-start":192,"core-js/modules/es.string.replace":194,"core-js/modules/es.string.split":196,"core-js/modules/es.string.trim":199,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],315:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.prototype.day=function(){return(new Date).getDate()},e.default.prototype.hour=function(){return(new Date).getHours()},e.default.prototype.minute=function(){return(new Date).getMinutes()},e.default.prototype.millis=function(){return-1===this._millisStart?0:window.performance.now()-this._millisStart},e.default.prototype.month=function(){return(new Date).getMonth()+1},e.default.prototype.second=function(){return(new Date).getSeconds()},e.default.prototype.year=function(){return(new Date).getFullYear()},e=e.default,r.default=e},{"../core/main":273}],316:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.number.to-fixed"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(u=e("../core/main"))&&u.__esModule?u:{default:u},a=(e("./p5.Geometry"),function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}function l(e,t,r,n,o,a,i){e=e<=0?1:e,t=t<0?0:t,r=r<=0?e:r,n=n<3?3:n;for(var l,u,c=(a=void 0===a||a)?-2:0,d=(o=o<1?1:o)+((i=void 0===i?0!==t:i)?2:0),h=Math.atan2(e-t,r),p=Math.sin(h),f=Math.cos(h),m=c;m<=d;++m){var y=m/o,g=r*y,v=void 0;for(v=m<0?(y=g=0,e):o<m?(g=r,y=1,t):e+(t-e)*y,-2!==m&&m!==o+2||(v=0),g-=r/2,l=0;l<n;++l){var b=l/(n-1),x=2*Math.PI*b,w=Math.sin(x),_=(x=Math.cos(x),this.vertices.push(new s.default.Vector(w*v,g,x*v)));_=m<0?new s.default.Vector(0,-1,0):o<m&&t?new s.default.Vector(0,1,0):new s.default.Vector(w*f,p,x*f),this.vertexNormals.push(_),this.uvs.push(b,y)}}var S=0;if(a){for(u=0;u<n;++u)this.faces.push([S+u,S+n+(u+1)%n,S+n+u]);S+=2*n}for(m=0;m<o;++m){for(l=0;l<n;++l){var k=(l+1)%n;this.faces.push([S+l,S+k,S+n+k]),this.faces.push([S+l,S+n+k,S+n+l])}S+=n}if(i)for(S+=n,l=0;l<n;++l)this.faces.push([S+l,S+(l+1)%n,S+n])}s.default.prototype.plane=function(e,t,r,n){this._assert3d("plane"),s.default._validateParameters("plane",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===n&&(n=1);var o,a="plane|".concat(r=void 0===r?1:r,"|").concat(n);return this._renderer.geometryInHash(a)||((o=new s.default.Geometry(r,n,(function(){for(var e,t,r=0;r<=this.detailY;r++)for(var n=r/this.detailY,o=0;o<=this.detailX;o++)e=o/this.detailX,t=new s.default.Vector(e-.5,n-.5,0),this.vertices.push(t),this.uvs.push(e,n)}))).computeFaces().computeNormals(),r<=1&&n<=1?o._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on plane objects with more than 1 detailX or 1 detailY"),this._renderer.createBuffers(a,o)),this._renderer.drawBuffersScaled(a,e,t,1),this},s.default.prototype.box=function(e,t,r,n,o){this._assert3d("box"),s.default._validateParameters("box",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===r&&(r=t);var a,i=this._renderer.attributes&&this._renderer.attributes.perPixelLighting;return void 0===o&&(o=i?1:4),i="box|".concat(n=void 0===n?i?1:4:n,"|").concat(o),this._renderer.geometryInHash(i)||((a=new s.default.Geometry(n,o,(function(){var e=this;this.edges=[[0,1],[1,3],[3,2],[6,7],[8,9],[9,11],[14,15],[16,17],[17,19],[18,19],[20,21],[22,23]],[[0,4,2,6],[1,3,5,7],[0,1,4,5],[2,6,3,7],[0,2,1,3],[4,5,6,7]].forEach((function(t,r){r*=4;for(var n=0;n<4;n++){var o=t[n];o=new s.default.Vector((2*(1&o)-1)/2,((2&o)-1)/2,((4&o)/2-1)/2),e.vertices.push(o),e.uvs.push(1&n,(2&n)/2)}e.faces.push([r,1+r,2+r]),e.faces.push([2+r,1+r,3+r])}))}))).computeNormals(),n<=4&&o<=4?a._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on box objects with more than 4 detailX or 4 detailY"),this._renderer.createBuffers(i,a)),this._renderer.drawBuffersScaled(i,e,t,r),this},s.default.prototype.sphere=function(e,t,r){return this._assert3d("sphere"),s.default._validateParameters("sphere",arguments),this.ellipsoid(e=void 0===e?50:e,e,e,t=void 0===t?24:t,r=void 0===r?16:r),this},s.default.prototype.cylinder=function(e,t,r,n,o,a){this._assert3d("cylinder"),s.default._validateParameters("cylinder",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===n&&(n=1),void 0===a&&(a=!0),void 0===o&&(o=!0);var i,u="cylinder|".concat(r=void 0===r?24:r,"|").concat(n,"|").concat(o,"|").concat(a);return this._renderer.geometryInHash(u)||(i=new s.default.Geometry(r,n),l.call(i,1,1,1,r,n,o,a),r<=24&&n<=16?i._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cylinder objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(u,i)),this._renderer.drawBuffersScaled(u,e,t,e),this},s.default.prototype.cone=function(e,t,r,n,o){this._assert3d("cone"),s.default._validateParameters("cone",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===n&&(n=1),void 0===o&&(o=!0);var a,i="cone|".concat(r=void 0===r?24:r,"|").concat(n,"|").concat(o);return this._renderer.geometryInHash(i)||(a=new s.default.Geometry(r,n),l.call(a,1,0,1,r,n,o,!1),r<=24&&n<=16?a._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on cone objects with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(i,a)),this._renderer.drawBuffersScaled(i,e,t,e),this},s.default.prototype.ellipsoid=function(e,t,r,n,o){this._assert3d("ellipsoid"),s.default._validateParameters("ellipsoid",arguments),void 0===e&&(e=50),void 0===t&&(t=e),void 0===r&&(r=e),void 0===o&&(o=16);var a,i="ellipsoid|".concat(n=void 0===n?24:n,"|").concat(o);return this._renderer.geometryInHash(i)||((a=new s.default.Geometry(n,o,(function(){for(var e=0;e<=this.detailY;e++)for(var t=e/this.detailY,r=Math.PI*t-Math.PI/2,n=Math.cos(r),o=Math.sin(r),a=0;a<=this.detailX;a++){var i=a/this.detailX,l=2*Math.PI*i,u=Math.cos(l);l=Math.sin(l),l=new s.default.Vector(n*l,o,n*u),this.vertices.push(l),this.vertexNormals.push(l),this.uvs.push(i,t)}}))).computeFaces(),n<=24&&o<=24?a._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw stroke on ellipsoids with more than 24 detailX or 24 detailY"),this._renderer.createBuffers(i,a)),this._renderer.drawBuffersScaled(i,e,t,r),this},s.default.prototype.torus=function(e,t,r,n){if(this._assert3d("torus"),s.default._validateParameters("torus",arguments),void 0===e)e=50;else if(!e)return;if(void 0===t)t=10;else if(!t)return;void 0===r&&(r=24),void 0===n&&(n=16);var o,a=(t/e).toPrecision(4);return t="torus|".concat(a,"|").concat(r,"|").concat(n),this._renderer.geometryInHash(t)||((o=new s.default.Geometry(r,n,(function(){for(var e=0;e<=this.detailY;e++)for(var t=e/this.detailY,r=2*Math.PI*t,n=Math.cos(r),o=Math.sin(r),i=1+a*n,l=0;l<=this.detailX;l++){var u=l/this.detailX,c=2*Math.PI*u,d=Math.cos(c),h=(c=Math.sin(c),new s.default.Vector(i*d,i*c,a*o));d=new s.default.Vector(n*d,n*c,o),this.vertices.push(h),this.vertexNormals.push(d),this.uvs.push(u,t)}}))).computeFaces(),r<=24&&n<=16?o._makeTriangleEdges()._edgesToVertices():this._renderer._doStroke&&console.log("Cannot draw strokes on torus object with more than 24 detailX or 16 detailY"),this._renderer.createBuffers(t,o)),this._renderer.drawBuffersScaled(t,e,e,e),this},s.default.RendererGL.prototype.point=function(e,t,r){var n=[];return n.push(new s.default.Vector(e,t,r=void 0===r?0:r)),this._drawPoints(n,this.immediateMode.buffers.point),this},s.default.RendererGL.prototype.triangle=function(e){var t=e[0],r=e[1],n=e[2],o=e[3],a=e[4],i=(e=e[5],this.geometryInHash("tri")||((i=new s.default.Geometry(1,1,(function(){var e=[];e.push(new s.default.Vector(0,0,0)),e.push(new s.default.Vector(1,0,0)),e.push(new s.default.Vector(0,1,0)),this.edges=[[0,1],[1,2],[2,0]],this.vertices=e,this.faces=[[0,1,2]],this.uvs=[0,0,1,0,1,1]})))._edgesToVertices(),i.computeNormals(),this.createBuffers("tri",i)),this.uMVMatrix.copy());try{var l=Math.sign(t*o-n*r+n*e-a*o+a*r-t*e),u=new s.default.Matrix([n-t,o-r,0,0,a-t,e-r,0,0,0,0,l,0,t,r,0,1]).mult(this.uMVMatrix);this.uMVMatrix=u,this.drawBuffers("tri")}finally{this.uMVMatrix=i}return this},s.default.RendererGL.prototype.ellipse=function(e){this.arc(e[0],e[1],e[2],e[3],0,a.TWO_PI,a.OPEN,e[4])},s.default.RendererGL.prototype.arc=function(e){var t,r=arguments[1],n=arguments[2],o=arguments[3],i=arguments[4],l=arguments[5],u=arguments[6],c=arguments[7]||25,d=(Math.abs(l-i)>=a.TWO_PI?"".concat(h="ellipse","|"):"".concat(h="arc","|").concat(i,"|").concat(l,"|").concat(u,"|")).concat(c,"|"),h=(this.geometryInHash(d)||((t=new s.default.Geometry(c,1,(function(){if(i.toFixed(10)!==l.toFixed(10)){u!==a.PIE&&void 0!==u||(this.vertices.push(new s.default.Vector(.5,.5,0)),this.uvs.push([.5,.5]));for(var e=0;e<=c;e++){var t=e/c*(l-i)+i,r=.5+Math.cos(t)/2;t=.5+Math.sin(t)/2,this.vertices.push(new s.default.Vector(r,t,0)),this.uvs.push([r,t]),e<c-1&&(this.faces.push([0,e+1,e+2]),this.edges.push([e+1,e+2]))}switch(u){case a.PIE:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,1]),this.edges.push([this.vertices.length-2,this.vertices.length-1]),this.edges.push([0,this.vertices.length-1]);break;case a.CHORD:this.edges.push([0,1]),this.edges.push([0,this.vertices.length-1]);break;case a.OPEN:this.edges.push([0,1]);break;default:this.faces.push([0,this.vertices.length-2,this.vertices.length-1]),this.edges.push([this.vertices.length-2,this.vertices.length-1])}}}))).computeNormals(),c<=50?t._edgesToVertices(t):this._doStroke&&console.log("Cannot apply a stroke to an ".concat(h," with more than 50 detail")),this.createBuffers(d,t)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([e,r,0]),this.uMVMatrix.scale(n,o,1),this.drawBuffers(d)}finally{this.uMVMatrix=h}return this},s.default.RendererGL.prototype.rect=function(e){var t=e[0],r=e[1],n=e[2],o=e[3];if(void 0===e[4]){var i=this._pInst._glAttributes.perPixelLighting,l=e[4]||(i?1:24),u=e[5]||(i?1:16),c=(i="rect|".concat(l,"|").concat(u),this.geometryInHash(i)||((c=new s.default.Geometry(l,u,(function(){for(var e=0;e<=this.detailY;e++)for(var t=e/this.detailY,r=0;r<=this.detailX;r++){var n=r/this.detailX,o=new s.default.Vector(n,t,0);this.vertices.push(o),this.uvs.push(n,t)}0<l&&0<u&&(this.edges=[[0,l],[l,(l+1)*(u+1)-1],[(l+1)*(u+1)-1,(l+1)*u],[(l+1)*u,0]])}))).computeFaces().computeNormals()._edgesToVertices(),this.createBuffers(i,c)),this.uMVMatrix.copy());try{this.uMVMatrix.translate([t,r,0]),this.uMVMatrix.scale(n,o,1),this.drawBuffers(i)}finally{this.uMVMatrix=c}}else{i=e[4],c=void 0===e[5]?i:e[5];var d=void 0===e[6]?c:e[6],h=(e=void 0===e[7]?d:e[7],n),p=o,f=((h+=t)<t&&(y=t,t=h,h=y),(p+=r)<r&&(y=r,r=p,p=y),(y=Math.min((h-t)/2,(p-r)/2))<i&&(i=y),y<c&&(c=y),y<d&&(d=y),y<e&&(e=y),t),m=r,y=h,g=(t=p,this.beginShape(),0!==c?(this.vertex(y-c,m),this.quadraticVertex(y,m,y,m+c)):this.vertex(y,m),0!==d?(this.vertex(y,t-d),this.quadraticVertex(y,t,y-d,t)):this.vertex(y,t),0!==e?(this.vertex(f+e,t),this.quadraticVertex(f,t,f,t-e)):this.vertex(f,t),0!==i?(this.vertex(f,m+i),this.quadraticVertex(f,m,f+i,m)):this.vertex(f,m),!(this.immediateMode.geometry.uvs.length=0));r=!1,h=void 0;try{for(var v,b=this.immediateMode.geometry.vertices[Symbol.iterator]();!(g=(v=b.next()).done);g=!0){var x=v.value,w=(x.x-f)/n,_=(x.y-m)/o;this.immediateMode.geometry.uvs.push(w,_)}}catch(e){r=!0,h=e}finally{try{g||null==b.return||b.return()}finally{if(r)throw h}}this.endShape(a.CLOSE)}return this},s.default.RendererGL.prototype.quad=function(e,t,r,n,o,a,i,l,u,c,d,h,p,f){void 0===p&&(p=2),void 0===f&&(f=2);var m="quad|".concat(e,"|").concat(t,"|").concat(r,"|").concat(n,"|").concat(o,"|").concat(a,"|").concat(i,"|").concat(l,"|").concat(u,"|").concat(c,"|").concat(d,"|").concat(h,"|").concat(p,"|").concat(f);if(!this.geometryInHash(m)){var y=new s.default.Geometry(p,f,(function(){for(var p=1/(this.detailX-1),f=1/(this.detailY-1),m=0;m<this.detailY;m++)for(var y=0;y<this.detailX;y++){var g=y*p,v=m*f;this.vertices.push(new s.default.Vector((1-g)*((1-v)*e+v*c)+g*((1-v)*n+v*i),(1-g)*((1-v)*t+v*d)+g*((1-v)*o+v*l),(1-g)*((1-v)*r+v*h)+g*((1-v)*a+v*u))),this.uvs.push([g,v])}}));y.faces=[];for(var g=0;g<f-1;g++)for(var v=0;v<p-1;v++){var b=v+g*p,x=v+1+(g+1)*p,w=v+(g+1)*p;y.faces.push([b,v+1+g*p,x]),y.faces.push([b,x,w])}y.computeNormals()._makeTriangleEdges()._edgesToVertices(),this.createBuffers(m,y)}return this.drawBuffers(m),this},s.default.RendererGL.prototype.bezier=function(e,t,r,n,o,s,a,i,l,u,c,d){8===arguments.length&&(c=i,u=a,i=s,a=o,o=n,n=r,r=s=l=d=0);var h=this._pInst._bezierDetail||20;this.beginShape();for(var p=0;p<=h;p++){var f=Math.pow(1-p/h,3),m=p/h*3*Math.pow(1-p/h,2),y=3*Math.pow(p/h,2)*(1-p/h),g=Math.pow(p/h,3);this.vertex(e*f+n*m+a*y+u*g,t*f+o*m+i*y+c*g,r*f+s*m+l*y+d*g)}return this.endShape(),this},s.default.RendererGL.prototype.curve=function(e,t,r,n,o,s,a,i,l,u,c,d){8===arguments.length&&(u=a,c=i,a=o,i=n,o=n=r,r=s=l=d=0);var h=this._pInst._curveDetail;this.beginShape();for(var p=0;p<=h;p++){var f=.5*Math.pow(p/h,3),m=.5*Math.pow(p/h,2),y=p/h*.5;this.vertex(f*(3*n-e-3*a+u)+m*(2*e-5*n+4*a-u)+y*(-e+a)+2*n*.5,f*(3*o-t-3*i+c)+m*(2*t-5*o+4*i-c)+y*(-t+i)+2*o*.5,f*(3*s-r-3*l+d)+m*(2*r-5*s+4*l-d)+y*(-r+l)+2*s*.5)}return this.endShape(),this},s.default.RendererGL.prototype.line=function(){return 6===arguments.length?(this.beginShape(a.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2]),this.vertex(arguments.length<=3?void 0:arguments[3],arguments.length<=4?void 0:arguments[4],arguments.length<=5?void 0:arguments[5]),this.endShape()):4===arguments.length&&(this.beginShape(a.LINES),this.vertex(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],0),this.vertex(arguments.length<=2?void 0:arguments[2],arguments.length<=3?void 0:arguments[3],0),this.endShape()),this},s.default.RendererGL.prototype.bezierVertex=function(){if(0===this.immediateMode._bezierVertex.length)throw Error("vertex() must be used once before calling bezierVertex()");var e,t,r,n,o,s,a=[],i=[],l=arguments.length;if(0===this._lookUpTableBezier.length||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var u=1/this._lutBezierDetail,c=0,d=1,h=0;c<1;){if(s=parseFloat(c.toFixed(6)),this._lookUpTableBezier[h]=this._bezierCoefficients(s),d.toFixed(6)===u.toFixed(6)){s=parseFloat(d.toFixed(6))+parseFloat(c.toFixed(6)),++h,this._lookUpTableBezier[h]=this._bezierCoefficients(s);break}c+=u,d-=u,++h}}for(var p=this._lookUpTableBezier.length,f=[],m=0;m<4;m++)f.push([]);f[0]=this.immediateMode.geometry.vertexColors.slice(-4),f[3]=this.curFillColor.slice();var y=[];for(m=0;m<4;m++)y.push([]);if(y[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),y[3]=this.curStrokeColor.slice(),6===l){this.isBezier=!0,a=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2],arguments.length<=4?void 0:arguments[4]],i=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3],arguments.length<=5?void 0:arguments[5]];var g=Math.hypot(a[0]-a[1],i[0]-i[1]),v=Math.hypot(a[1]-a[2],i[1]-i[2]),b=Math.hypot(a[2]-a[3],i[2]-i[3]);for(g/=v=g+v+b,b/=v,o=0;o<4;o++)f[1].push(f[0][o]*(1-g)+f[3][o]*g),f[2].push(f[0][o]*b+f[3][o]*(1-b)),y[1].push(y[0][o]*(1-g)+y[3][o]*g),y[2].push(y[0][o]*b+y[3][o]*(1-b));for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=0;m<4;m++){for(o=0;o<4;o++)this.curFillColor[o]+=this._lookUpTableBezier[n][m]*f[m][o],this.curStrokeColor[o]+=this._lookUpTableBezier[n][m]*y[m][o];e+=a[m]*this._lookUpTableBezier[n][m],t+=i[m]*this._lookUpTableBezier[n][m]}this.vertex(e,t)}this.curFillColor=f[3],this.curStrokeColor=y[3],this.immediateMode._bezierVertex[0]=arguments.length<=4?void 0:arguments[4],this.immediateMode._bezierVertex[1]=arguments.length<=5?void 0:arguments[5]}else if(9===l){this.isBezier=!0,a=[this.immediateMode._bezierVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3],arguments.length<=6?void 0:arguments[6]],i=[this.immediateMode._bezierVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4],arguments.length<=7?void 0:arguments[7]];var x=[this.immediateMode._bezierVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5],arguments.length<=8?void 0:arguments[8]],w=Math.hypot(a[0]-a[1],i[0]-i[1],x[0]-x[1]),_=(v=Math.hypot(a[1]-a[2],i[1]-i[2],x[1]-x[2]),Math.hypot(a[2]-a[3],i[2]-i[3],x[2]-x[3]));for(w/=l=w+v+_,_/=l,o=0;o<4;o++)f[1].push(f[0][o]*(1-w)+f[3][o]*w),f[2].push(f[0][o]*_+f[3][o]*(1-_)),y[1].push(y[0][o]*(1-w)+y[3][o]*w),y[2].push(y[0][o]*_+y[3][o]*(1-_));for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=r=0;m<4;m++){for(o=0;o<4;o++)this.curFillColor[o]+=this._lookUpTableBezier[n][m]*f[m][o],this.curStrokeColor[o]+=this._lookUpTableBezier[n][m]*y[m][o];e+=a[m]*this._lookUpTableBezier[n][m],t+=i[m]*this._lookUpTableBezier[n][m],r+=x[m]*this._lookUpTableBezier[n][m]}this.vertex(e,t,r)}this.curFillColor=f[3],this.curStrokeColor=y[3],this.immediateMode._bezierVertex[0]=arguments.length<=6?void 0:arguments[6],this.immediateMode._bezierVertex[1]=arguments.length<=7?void 0:arguments[7],this.immediateMode._bezierVertex[2]=arguments.length<=8?void 0:arguments[8]}},s.default.RendererGL.prototype.quadraticVertex=function(){if(0===this.immediateMode._quadraticVertex.length)throw Error("vertex() must be used once before calling quadraticVertex()");var e,t,r,n,o,s,a=[],i=[],l=arguments.length;if(0===this._lookUpTableQuadratic.length||this._lutQuadraticDetail!==this._pInst._curveDetail){this._lookUpTableQuadratic=[],this._lutQuadraticDetail=this._pInst._curveDetail;for(var u=1/this._lutQuadraticDetail,c=0,d=1,h=0;c<1;){if(s=parseFloat(c.toFixed(6)),this._lookUpTableQuadratic[h]=this._quadraticCoefficients(s),d.toFixed(6)===u.toFixed(6)){s=parseFloat(d.toFixed(6))+parseFloat(c.toFixed(6)),++h,this._lookUpTableQuadratic[h]=this._quadraticCoefficients(s);break}c+=u,d-=u,++h}}for(var p=this._lookUpTableQuadratic.length,f=[],m=0;m<3;m++)f.push([]);f[0]=this.immediateMode.geometry.vertexColors.slice(-4),f[2]=this.curFillColor.slice();var y=[];for(m=0;m<3;m++)y.push([]);if(y[0]=this.immediateMode.geometry.vertexStrokeColors.slice(-4),y[2]=this.curStrokeColor.slice(),4===l){this.isQuadratic=!0,a=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=2?void 0:arguments[2]],i=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=3?void 0:arguments[3]];var g=Math.hypot(a[0]-a[1],i[0]-i[1]);for(g/=g+Math.hypot(a[1]-a[2],i[1]-i[2]),o=0;o<4;o++)f[1].push(f[0][o]*(1-g)+f[2][o]*g),y[1].push(y[0][o]*(1-g)+y[2][o]*g);for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=0;m<3;m++){for(o=0;o<4;o++)this.curFillColor[o]+=this._lookUpTableQuadratic[n][m]*f[m][o],this.curStrokeColor[o]+=this._lookUpTableQuadratic[n][m]*y[m][o];e+=a[m]*this._lookUpTableQuadratic[n][m],t+=i[m]*this._lookUpTableQuadratic[n][m]}this.vertex(e,t)}this.curFillColor=f[2],this.curStrokeColor=y[2],this.immediateMode._quadraticVertex[0]=arguments.length<=2?void 0:arguments[2],this.immediateMode._quadraticVertex[1]=arguments.length<=3?void 0:arguments[3]}else if(6===l){this.isQuadratic=!0,a=[this.immediateMode._quadraticVertex[0],arguments.length<=0?void 0:arguments[0],arguments.length<=3?void 0:arguments[3]],i=[this.immediateMode._quadraticVertex[1],arguments.length<=1?void 0:arguments[1],arguments.length<=4?void 0:arguments[4]];var v=[this.immediateMode._quadraticVertex[2],arguments.length<=2?void 0:arguments[2],arguments.length<=5?void 0:arguments[5]],b=Math.hypot(a[0]-a[1],i[0]-i[1],v[0]-v[1]);for(b/=b+Math.hypot(a[1]-a[2],i[1]-i[2],v[1]-v[2]),o=0;o<4;o++)f[1].push(f[0][o]*(1-b)+f[2][o]*b),y[1].push(y[0][o]*(1-b)+y[2][o]*b);for(n=0;n<p;n++){for(this.curFillColor=[0,0,0,0],this.curStrokeColor=[0,0,0,0],m=e=t=r=0;m<3;m++){for(o=0;o<4;o++)this.curFillColor[o]+=this._lookUpTableQuadratic[n][m]*f[m][o],this.curStrokeColor[o]+=this._lookUpTableQuadratic[n][m]*y[m][o];e+=a[m]*this._lookUpTableQuadratic[n][m],t+=i[m]*this._lookUpTableQuadratic[n][m],r+=v[m]*this._lookUpTableQuadratic[n][m]}this.vertex(e,t,r)}this.curFillColor=f[2],this.curStrokeColor=y[2],this.immediateMode._quadraticVertex[0]=arguments.length<=3?void 0:arguments[3],this.immediateMode._quadraticVertex[1]=arguments.length<=4?void 0:arguments[4],this.immediateMode._quadraticVertex[2]=arguments.length<=5?void 0:arguments[5]}},s.default.RendererGL.prototype.curveVertex=function(){var e,t,r,n,o,s,a=[],i=[],l=arguments.length;if(0===this._lookUpTableBezier.length||this._lutBezierDetail!==this._pInst._curveDetail){this._lookUpTableBezier=[],this._lutBezierDetail=this._pInst._curveDetail;for(var u=1/this._lutBezierDetail,c=0,d=1,h=0;c<1;){if(s=parseFloat(c.toFixed(6)),this._lookUpTableBezier[h]=this._bezierCoefficients(s),d.toFixed(6)===u.toFixed(6)){s=parseFloat(d.toFixed(6))+parseFloat(c.toFixed(6)),++h,this._lookUpTableBezier[h]=this._bezierCoefficients(s);break}c+=u,d-=u,++h}}var p=this._lookUpTableBezier.length;if(2===l){if(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),8===this.immediateMode._curveVertex.length){for(this.isCurve=!0,a=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[6]]),i=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[7]]),o=0;o<p;o++)t=a[0]*this._lookUpTableBezier[o][0]+a[1]*this._lookUpTableBezier[o][1]+a[2]*this._lookUpTableBezier[o][2]+a[3]*this._lookUpTableBezier[o][3],r=i[0]*this._lookUpTableBezier[o][0]+i[1]*this._lookUpTableBezier[o][1]+i[2]*this._lookUpTableBezier[o][2]+i[3]*this._lookUpTableBezier[o][3],this.vertex(t,r);for(o=0;o<l;o++)this.immediateMode._curveVertex.shift()}}else if(3===l&&(this.immediateMode._curveVertex.push(arguments.length<=0?void 0:arguments[0]),this.immediateMode._curveVertex.push(arguments.length<=1?void 0:arguments[1]),this.immediateMode._curveVertex.push(arguments.length<=2?void 0:arguments[2]),12===this.immediateMode._curveVertex.length)){for(this.isCurve=!0,a=this._bezierToCatmull([this.immediateMode._curveVertex[0],this.immediateMode._curveVertex[3],this.immediateMode._curveVertex[6],this.immediateMode._curveVertex[9]]),i=this._bezierToCatmull([this.immediateMode._curveVertex[1],this.immediateMode._curveVertex[4],this.immediateMode._curveVertex[7],this.immediateMode._curveVertex[10]]),e=this._bezierToCatmull([this.immediateMode._curveVertex[2],this.immediateMode._curveVertex[5],this.immediateMode._curveVertex[8],this.immediateMode._curveVertex[11]]),o=0;o<p;o++)t=a[0]*this._lookUpTableBezier[o][0]+a[1]*this._lookUpTableBezier[o][1]+a[2]*this._lookUpTableBezier[o][2]+a[3]*this._lookUpTableBezier[o][3],r=i[0]*this._lookUpTableBezier[o][0]+i[1]*this._lookUpTableBezier[o][1]+i[2]*this._lookUpTableBezier[o][2]+i[3]*this._lookUpTableBezier[o][3],n=e[0]*this._lookUpTableBezier[o][0]+e[1]*this._lookUpTableBezier[o][1]+e[2]*this._lookUpTableBezier[o][2]+e[3]*this._lookUpTableBezier[o][3],this.vertex(t,r,n);for(o=0;o<l;o++)this.immediateMode._curveVertex.shift()}},s.default.RendererGL.prototype.image=function(e,t,r,n,o,s,i,l,u){this._isErasing&&this.blendMode(this._cachedBlendMode),this._pInst.push(),this._pInst.noLights(),this._pInst.noStroke(),this._pInst.texture(e),this._pInst.textureMode(a.NORMAL);var c=0,d=(t<=e.width&&(c=t/e.width),1);t+n<=e.width&&(d=(t+n)/e.width),t=0,r<=e.height&&(t=r/e.height),n=1,r+o<=e.height&&(n=(r+o)/e.height),this.beginShape(),this.vertex(s,i,0,c,t),this.vertex(s+l,i,0,d,t),this.vertex(s+l,i+u,0,d,n),this.vertex(s,i+u,0,c,n),this.endShape(a.CLOSE),this._pInst.pop(),this._isErasing&&this.blendMode(a.REMOVE)};var u=s.default;r.default=u},{"../core/constants":262,"../core/main":273,"./p5.Geometry":323,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.math.hypot":169,"core-js/modules/es.math.sign":170,"core-js/modules/es.number.to-fixed":173,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],317:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.math.sign"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(l=e("../core/main"))&&l.__esModule?l:{default:l},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=a();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function a(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,a=function(){return e},e)}function i(e){return(i="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}o.default.prototype.orbitControl=function(e,t,r,n){var s=this,a=(this._assert3d("orbitControl"),o.default._validateParameters("orbitControl",arguments),this._renderer._curCamera);void 0===e&&(e=1),void 0===t&&(t=e),void 0===r&&(r=1),"object"!==i(n)&&(n={}),!0!==this.contextMenuDisabled&&(this.canvas.oncontextmenu=function(){return!1},this._setProperty("contextMenuDisabled",!0)),!0!==this.wheelDefaultDisabled&&(this.canvas.onwheel=function(){return!1},this._setProperty("wheelDefaultDisabled",!0));var l=n.disableTouchActions;!0===this.touchActionsDisabled||void 0!==l&&!l||(this.canvas.style["touch-action"]="none",this._setProperty("touchActionsDisabled",!0)),n=void 0!==(l=n.freeRotation)&&l;var u,c,d,h=[],p=(this.touches.forEach((function(e){s._renderer.prevTouches.forEach((function(t){e.id===t.id&&(t={x:e.x,y:e.y,px:t.x,py:t.y},h.push(t))}))})),this._renderer.prevTouches=this.touches,l=0,0),f=0,m=0,y=0,g=this.height<this.width?this.height:this.width,v=!1;return 0<h.length?(v=0<h[0].x&&h[0].x<this.width&&0<h[0].y&&h[0].y<this.height,1===h.length?(p=-e*((u=h[0]).x-u.px)/g,f=t*(u.y-u.py)/g):(u=h[0],c=h[1],l=-(Math.hypot(u.x-c.x,u.y-c.y)-Math.hypot(u.px-c.px,u.py-c.py))*r*4e-4,m=.5*(u.x+c.x)-.5*(u.px+c.px),y=.5*(u.y+c.y)-.5*(u.py+c.py)),0<this.touches.length?v&&(this._renderer.executeRotateAndMove=!0,this._renderer.executeZoom=!0):(this._renderer.executeRotateAndMove=!1,this._renderer.executeZoom=!1)):(v=0<this.mouseX&&this.mouseX<this.width&&0<this.mouseY&&this.mouseY<this.height,0!==this._mouseWheelDeltaY?(l=Math.sign(this._mouseWheelDeltaY)*r,l*=.01,this._mouseWheelDeltaY=0,v&&(this._renderer.executeZoom=!0)):this._renderer.zoomFlag=!1,this.mouseIsPressed?(this.mouseButton===this.LEFT?(p=-e*this.movedX/g,f=t*this.movedY/g):this.mouseButton===this.RIGHT&&(m=this.movedX,y=this.movedY),v&&(this._renderer.executeRotateAndMove=!0)):this._renderer.executeRotateAndMove=!1),0!==l&&this._renderer.executeZoom&&(this._renderer.zoomVelocity+=l),.001<Math.abs(this._renderer.zoomVelocity)?(n?a._orbitFree(0,0,this._renderer.zoomVelocity):a._orbit(0,0,this._renderer.zoomVelocity),0!==a.projMatrix.mat4[15]&&(a.projMatrix.mat4[0]*=Math.pow(10,-this._renderer.zoomVelocity),a.projMatrix.mat4[5]*=Math.pow(10,-this._renderer.zoomVelocity),this._renderer.uPMatrix.mat4[0]=a.projMatrix.mat4[0],this._renderer.uPMatrix.mat4[5]=a.projMatrix.mat4[5]),this._renderer.zoomVelocity*=.85):this._renderer.zoomVelocity=0,0===p&&0===f||!this._renderer.executeRotateAndMove||this._renderer.rotateVelocity.add(.6*p,.6*f),1e-6<this._renderer.rotateVelocity.magSq()?(n?a._orbitFree(-this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0):a._orbit(this._renderer.rotateVelocity.x,this._renderer.rotateVelocity.y,0),this._renderer.rotateVelocity.mult(.85)):this._renderer.rotateVelocity.set(0,0),0===m&&0===y||!this._renderer.executeRotateAndMove||(u=2*m/this.width,c=2*-y/this.height,this._renderer.moveVelocity.add(.15*u,.15*c)),1e-6<this._renderer.moveVelocity.magSq()?(r=a._getLocalAxes(),e=a.eyeX-a.centerX,t=a.eyeY-a.centerY,g=a.eyeZ-a.centerZ,v=Math.sqrt(e*e+t*t+g*g),l=new o.default.Vector(a.centerX,a.centerY,a.centerZ),l=a.cameraMatrix.multiplyPoint(l),(l=this._renderer.uPMatrix.multiplyAndNormalizePoint(l)).x-=this._renderer.moveVelocity.x,l.y-=this._renderer.moveVelocity.y,f=0===(p=this._renderer.uPMatrix.mat4)[15]?(d=(p[8]+l.x)/p[0]*v,(p[9]+l.y)/p[5]*v):(d=(l.x-p[12])/p[0],(l.y-p[13])/p[5]),a.setPosition(a.eyeX+d*r.x[0]+f*r.y[0],a.eyeY+d*r.x[1]+f*r.y[1],a.eyeZ+d*r.x[2]+f*r.y[2]),this._renderer.moveVelocity.mult(.85)):this._renderer.moveVelocity.set(0,0),this},o.default.prototype.debugMode=function(){this._assert3d("debugMode");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];o.default._validateParameters("debugMode",t);for(var n=this._registeredMethods.post.length-1;0<=n;n--)this._registeredMethods.post[n].toString()!==this._grid().toString()&&this._registeredMethods.post[n].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(n,1);t[0]===s.GRID?this.registerMethod("post",this._grid.call(this,t[1],t[2],t[3],t[4],t[5])):t[0]===s.AXES?this.registerMethod("post",this._axesIcon.call(this,t[1],t[2],t[3],t[4])):(this.registerMethod("post",this._grid.call(this,t[0],t[1],t[2],t[3],t[4])),this.registerMethod("post",this._axesIcon.call(this,t[5],t[6],t[7],t[8])))},o.default.prototype.noDebugMode=function(){this._assert3d("noDebugMode");for(var e=this._registeredMethods.post.length-1;0<=e;e--)this._registeredMethods.post[e].toString()!==this._grid().toString()&&this._registeredMethods.post[e].toString()!==this._axesIcon().toString()||this._registeredMethods.post.splice(e,1)},o.default.prototype._grid=function(e,t,r,n,o){void 0===e&&(e=this.width/2),void 0===t&&(t=Math.round(e/30)<4?4:Math.round(e/30)),void 0===r&&(r=0),void 0===n&&(n=0),void 0===o&&(o=0);var s=e/t,a=e/2;return function(){this.push(),this.stroke(255*this._renderer.curStrokeColor[0],255*this._renderer.curStrokeColor[1],255*this._renderer.curStrokeColor[2]),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]);for(var e=0;e<=t;e++)this.beginShape(this.LINES),this.vertex(-a+r,n,e*s-a+o),this.vertex(a+r,n,e*s-a+o),this.endShape();for(var i=0;i<=t;i++)this.beginShape(this.LINES),this.vertex(i*s-a+r,n,-a+o),this.vertex(i*s-a+r,n,a+o),this.endShape();this.pop()}},o.default.prototype._axesIcon=function(e,t,r,n){return void 0===e&&(e=40<this.width/20?this.width/20:40),void 0===t&&(t=-this.width/4),void 0===r&&(r=t),void 0===n&&(n=t),function(){this.push(),this._renderer.uMVMatrix.set(this._renderer._curCamera.cameraMatrix.mat4[0],this._renderer._curCamera.cameraMatrix.mat4[1],this._renderer._curCamera.cameraMatrix.mat4[2],this._renderer._curCamera.cameraMatrix.mat4[3],this._renderer._curCamera.cameraMatrix.mat4[4],this._renderer._curCamera.cameraMatrix.mat4[5],this._renderer._curCamera.cameraMatrix.mat4[6],this._renderer._curCamera.cameraMatrix.mat4[7],this._renderer._curCamera.cameraMatrix.mat4[8],this._renderer._curCamera.cameraMatrix.mat4[9],this._renderer._curCamera.cameraMatrix.mat4[10],this._renderer._curCamera.cameraMatrix.mat4[11],this._renderer._curCamera.cameraMatrix.mat4[12],this._renderer._curCamera.cameraMatrix.mat4[13],this._renderer._curCamera.cameraMatrix.mat4[14],this._renderer._curCamera.cameraMatrix.mat4[15]),this.strokeWeight(2),this.stroke(255,0,0),this.beginShape(this.LINES),this.vertex(t,r,n),this.vertex(t+e,r,n),this.endShape(),this.stroke(0,255,0),this.beginShape(this.LINES),this.vertex(t,r,n),this.vertex(t,r+e,n),this.endShape(),this.stroke(0,0,255),this.beginShape(this.LINES),this.vertex(t,r,n),this.vertex(t,r,n+e),this.endShape(),this.pop()}};var l=o.default;r.default=l},{"../core/constants":262,"../core/main":273,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.splice":166,"core-js/modules/es.math.hypot":169,"core-js/modules/es.math.sign":170,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.for-each":235,"core-js/modules/web.dom-collections.iterator":236}],318:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.ambientLight=function(e,t,r,o){this._assert3d("ambientLight"),n.default._validateParameters("ambientLight",arguments);var s=this.color.apply(this,arguments);return this._renderer.ambientLightColors.push(s._array[0],s._array[1],s._array[2]),this._renderer._enableLighting=!0,this},n.default.prototype.specularColor=function(e,t,r){this._assert3d("specularColor"),n.default._validateParameters("specularColor",arguments);var o=this.color.apply(this,arguments);return this._renderer.specularColors=[o._array[0],o._array[1],o._array[2]],this},n.default.prototype.directionalLight=function(e,t,r,o,s,a){var i,l;return this._assert3d("directionalLight"),n.default._validateParameters("directionalLight",arguments),e=e instanceof n.default.Color?e:this.color(e,t,r),r="number"==typeof(t=arguments[arguments.length-1])?(i=arguments[arguments.length-3],l=arguments[arguments.length-2],arguments[arguments.length-1]):(i=t.x,l=t.y,t.z),t=Math.sqrt(i*i+l*l+r*r),this._renderer.directionalLightDirections.push(i/t,l/t,r/t),this._renderer.directionalLightDiffuseColors.push(e._array[0],e._array[1],e._array[2]),Array.prototype.push.apply(this._renderer.directionalLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},n.default.prototype.pointLight=function(e,t,r,o,s,a){var i,l;return this._assert3d("pointLight"),n.default._validateParameters("pointLight",arguments),e=e instanceof n.default.Color?e:this.color(e,t,r),r="number"==typeof(t=arguments[arguments.length-1])?(i=arguments[arguments.length-3],l=arguments[arguments.length-2],arguments[arguments.length-1]):(i=t.x,l=t.y,t.z),this._renderer.pointLightPositions.push(i,l,r),this._renderer.pointLightDiffuseColors.push(e._array[0],e._array[1],e._array[2]),Array.prototype.push.apply(this._renderer.pointLightSpecularColors,this._renderer.specularColors),this._renderer._enableLighting=!0,this},n.default.prototype.lights=function(){this._assert3d("lights");var e=this.color("rgb(128,128,128)");return this.ambientLight(e),this.directionalLight(e,0,0,-1),this},n.default.prototype.lightFalloff=function(e,t,r){return this._assert3d("lightFalloff"),n.default._validateParameters("lightFalloff",arguments),e<0&&(e=0,console.warn("Value of constant argument in lightFalloff() should be never be negative. Set to 0.")),t<0&&(t=0,console.warn("Value of linear argument in lightFalloff() should be never be negative. Set to 0.")),r<0&&(r=0,console.warn("Value of quadratic argument in lightFalloff() should be never be negative. Set to 0.")),0===e&&0===t&&0===r&&(e=1,console.warn("Either one of the three arguments in lightFalloff() should be greater than zero. Set constant argument to 1.")),this._renderer.constantAttenuation=e,this._renderer.linearAttenuation=t,this._renderer.quadraticAttenuation=r,this},n.default.prototype.spotLight=function(e,t,r,o,s,a,i,l,u,c,d){this._assert3d("spotLight"),n.default._validateParameters("spotLight",arguments);var h,p,f,m=arguments.length;switch(m){case 11:case 10:h=this.color(e,t,r),p=new n.default.Vector(o,s,a),f=new n.default.Vector(i,l,u);break;case 9:e instanceof n.default.Color?(h=e,p=new n.default.Vector(t,r,o),f=new n.default.Vector(s,a,i),c=l,d=u):o instanceof n.default.Vector?(h=this.color(e,t,r),p=o,f=new n.default.Vector(s,a,i),c=l,d=u):i instanceof n.default.Vector?(h=this.color(e,t,r),p=new n.default.Vector(o,s,a),f=i,c=l,d=u):(h=this.color(e,t,r),p=new n.default.Vector(o,s,a),f=new n.default.Vector(i,l,u));break;case 8:f=e instanceof n.default.Color?(h=e,p=new n.default.Vector(t,r,o),new n.default.Vector(s,a,i)):o instanceof n.default.Vector?(h=this.color(e,t,r),p=o,new n.default.Vector(s,a,i)):(h=this.color(e,t,r),p=new n.default.Vector(o,s,a),i),c=l;break;case 7:e instanceof n.default.Color&&t instanceof n.default.Vector?(h=e,p=t,f=new n.default.Vector(r,o,s),c=a,d=i):e instanceof n.default.Color&&s instanceof n.default.Vector?(h=e,p=new n.default.Vector(t,r,o),f=s,c=a,d=i):o instanceof n.default.Vector&&s instanceof n.default.Vector?(h=this.color(e,t,r),p=o,f=s,c=a,d=i):f=e instanceof n.default.Color?(h=e,p=new n.default.Vector(t,r,o),new n.default.Vector(s,a,i)):o instanceof n.default.Vector?(h=this.color(e,t,r),p=o,new n.default.Vector(s,a,i)):(h=this.color(e,t,r),p=new n.default.Vector(o,s,a),i);break;case 6:o instanceof n.default.Vector&&s instanceof n.default.Vector?(h=this.color(e,t,r),p=o,f=s,c=a):e instanceof n.default.Color&&s instanceof n.default.Vector?(h=e,p=new n.default.Vector(t,r,o),f=s,c=a):e instanceof n.default.Color&&t instanceof n.default.Vector&&(h=e,p=t,f=new n.default.Vector(r,o,s),c=a);break;case 5:e instanceof n.default.Color&&t instanceof n.default.Vector&&r instanceof n.default.Vector?(h=e,p=t,f=r,c=o,d=s):o instanceof n.default.Vector&&s instanceof n.default.Vector?(h=this.color(e,t,r),p=o,f=s):e instanceof n.default.Color&&s instanceof n.default.Vector?(h=e,p=new n.default.Vector(t,r,o),f=s):e instanceof n.default.Color&&t instanceof n.default.Vector&&(h=e,p=t,f=new n.default.Vector(r,o,s));break;case 4:h=e,p=t,f=r,c=o;break;case 3:h=e,p=t,f=r;break;default:return console.warn("Sorry, input for spotlight() is not in prescribed format. Too ".concat(m<3?"few":"many"," arguments were provided")),this}return this._renderer.spotLightDiffuseColors.push(h._array[0],h._array[1],h._array[2]),Array.prototype.push.apply(this._renderer.spotLightSpecularColors,this._renderer.specularColors),this._renderer.spotLightPositions.push(p.x,p.y,p.z),f.normalize(),this._renderer.spotLightDirections.push(f.x,f.y,f.z),void 0===c&&(c=Math.PI/3),void 0!==d&&d<1?(d=1,console.warn("Value of concentration needs to be greater than 1. Setting it to 1")):void 0===d&&(d=100),c=this._renderer._pInst._toRadians(c),this._renderer.spotLightAngle.push(Math.cos(c)),this._renderer.spotLightConc.push(d),this._renderer._enableLighting=!0,this},n.default.prototype.noLights=function(){this._assert3d("noLights");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.default._validateParameters("noLights",t),this._renderer._enableLighting=!1,this._renderer.ambientLightColors.length=0,this._renderer.specularColors=[1,1,1],this._renderer.directionalLightDirections.length=0,this._renderer.directionalLightDiffuseColors.length=0,this._renderer.directionalLightSpecularColors.length=0,this._renderer.pointLightPositions.length=0,this._renderer.pointLightDiffuseColors.length=0,this._renderer.pointLightSpecularColors.length=0,this._renderer.spotLightPositions.length=0,this._renderer.spotLightDirections.length=0,this._renderer.spotLightDiffuseColors.length=0,this._renderer.spotLightSpecularColors.length=0,this._renderer.spotLightAngle.length=0,this._renderer.spotLightConc.length=0,this._renderer.constantAttenuation=1,this._renderer.linearAttenuation=0,this._renderer.quadraticAttenuation=0,this._renderer._useShininess=1,this},e=n.default,r.default=e},{"../core/main":273}],319:[function(e,t,r){"use strict";e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.splice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.match"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.trim"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(o=e("../core/main"))&&o.__esModule?o:{default:o};e("./p5.Geometry"),n.default.prototype.loadModel=function(e){n.default._validateParameters("loadModel",arguments);var t,r,o,s=e.slice(-4),a=("boolean"==typeof arguments[1]?(t=arguments[1],r=arguments[2],o=arguments[3],void 0!==arguments[4]&&(s=arguments[4])):(t=!1,r=arguments[1],o=arguments[2],void 0!==arguments[3]&&(s=arguments[3])),new n.default.Geometry),i=(a.gid="".concat(e,"|").concat(t),this);return s.match(/\.stl$/i)?this.httpDo(e,"GET","arrayBuffer",(function(e){!function(e,t){if(function(e){for(var t=new DataView(e),r=[115,111,108,105,100],n=0;n<5;n++)if(function(e,t,r){for(var n=0,o=e.length;n<o;n++)if(e[n]!==t.getUint8(r+n,!1))return;return 1}(r,t,n))return;return 1}(t))!function(e,t){for(var r,o,s,a,i,l,u,c=new DataView(t),d=c.getUint32(80,!0),h=!1,p=0;p<70;p++)1129270351===c.getUint32(p,!1)&&82===c.getUint8(p+4)&&61===c.getUint8(p+5)&&(h=!0,a=[],i=c.getUint8(p+6)/255,l=c.getUint8(p+7)/255,u=c.getUint8(p+8)/255);for(var f=0;f<d;f++){for(var m,y=84+50*f,g=c.getFloat32(y,!0),v=c.getFloat32(4+y,!0),b=c.getFloat32(8+y,!0),x=(h&&(s=0==(32768&(m=c.getUint16(48+y,!0)))?(r=(31&m)/31,o=(m>>5&31)/31,(m>>10&31)/31):(r=i,o=l,u)),new n.default.Vector(g,v,b)),w=1;w<=3;w++){var _=y+12*w;_=new n.default.Vector(c.getFloat32(_,!0),c.getFloat32(4+_,!0),c.getFloat32(8+_,!0)),e.vertices.push(_),e.vertexNormals.push(x),h&&a.push(r,o,s)}e.faces.push([3*f,3*f+1,3*f+2]),e.uvs.push([0,0],[0,0],[0,0])}}(e,t);else{if(t=new DataView(t),!("TextDecoder"in window))return console.warn("Sorry, ASCII STL loading only works in browsers that support TextDecoder (https://caniuse.com/#feat=textencoder)");!function(e,t){for(var r,o,s="",a=[],i=0;i<t.length;++i){for(var l=t[i].trim(),u=l.split(" "),c=0;c<u.length;++c)""===u[c]&&u.splice(c,1);if(0!==u.length)switch(s){case"":if("solid"!==u[0])return console.error(l),console.error('Invalid state "'.concat(u[0],'", should be "solid"'));s="solid";break;case"solid":if("facet"!==u[0]||"normal"!==u[1])return console.error(l),console.error('Invalid state "'.concat(u[0],'", should be "facet normal"'));r=new n.default.Vector(parseFloat(u[2]),parseFloat(u[3]),parseFloat(u[4])),e.vertexNormals.push(r,r,r),s="facet normal";break;case"facet normal":if("outer"!==u[0]||"loop"!==u[1])return console.error(l),console.error('Invalid state "'.concat(u[0],'", should be "outer loop"'));s="vertex";break;case"vertex":if("vertex"===u[0])o=new n.default.Vector(parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])),e.vertices.push(o),e.uvs.push([0,0]),a.push(e.vertices.indexOf(o));else{if("endloop"!==u[0])return console.error(l),console.error('Invalid state "'.concat(u[0],'", should be "vertex" or "endloop"'));e.faces.push(a),a=[],s="endloop"}break;case"endloop":if("endfacet"!==u[0])return console.error(l),console.error('Invalid state "'.concat(u[0],'", should be "endfacet"'));s="endfacet";break;case"endfacet":if("endsolid"!==u[0]){if("facet"!==u[0]||"normal"!==u[1])return console.error(l),console.error('Invalid state "'.concat(u[0],'", should be "endsolid" or "facet normal"'));r=new n.default.Vector(parseFloat(u[2]),parseFloat(u[3]),parseFloat(u[4])),e.vertexNormals.push(r,r,r),s="facet normal"}break;default:console.error('Invalid state "'.concat(s,'"'))}}}(e,t=new TextDecoder("utf-8").decode(t).split("\n"))}}(a,e),t&&a.normalize(),i._decrementPreload(),"function"==typeof r&&r(a)}),o):s.match(/\.obj$/i)?this.loadStrings(e,(function(e){for(var o=a,s=e,l={v:[],vt:[],vn:[]},u={},c=0;c<s.length;++c){var d=s[c].trim().split(/\b\s+/);if(0<d.length)if("v"===d[0]||"vn"===d[0]){var h=new n.default.Vector(parseFloat(d[1]),parseFloat(d[2]),parseFloat(d[3]));l[d[0]].push(h)}else if("vt"===d[0])h=[parseFloat(d[1]),1-parseFloat(d[2])],l[d[0]].push(h);else if("f"===d[0])for(var p=3;p<d.length;++p){for(var f=[],m=[1,p-1,p],y=0;y<m.length;++y){var g=d[m[y]],v=0;if(void 0!==u[g])v=u[g];else{for(var b=g.split("/"),x=0;x<b.length;x++)b[x]=parseInt(b[x])-1;v=u[g]=o.vertices.length,o.vertices.push(l.v[b[0]].copy()),l.vt[b[1]]?o.uvs.push(l.vt[b[1]].slice()):o.uvs.push([0,0]),l.vn[b[2]]&&o.vertexNormals.push(l.vn[b[2]].copy())}f.push(v)}f[0]!==f[1]&&f[0]!==f[2]&&f[1]!==f[2]&&o.faces.push(f)}}0===o.vertexNormals.length&&o.computeNormals(),t&&a.normalize(),i._decrementPreload(),"function"==typeof r&&r(a)}),o):(n.default._friendlyFileLoadError(3,e),o?o():n.default._friendlyError("Sorry, the file type is invalid. Only OBJ and STL files are supported.")),a},n.default.prototype.model=function(e){this._assert3d("model"),n.default._validateParameters("model",arguments),0<e.vertices.length&&(this._renderer.geometryInHash(e.gid)||(0===e.edges.length&&e._makeTriangleEdges(),e._edgesToVertices(),this._renderer.createBuffers(e.gid,e)),this._renderer.drawBuffers(e.gid))};var o=n.default;r.default=o},{"../core/main":273,"./p5.Geometry":323,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.splice":166,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.match":191,"core-js/modules/es.string.split":196,"core-js/modules/es.string.trim":199}],320:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.join"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(l=e("../core/main"))&&l.__esModule?l:{default:l},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}e("./p5.Texture"),s.default.prototype.loadShader=function(e,t,r,n){function o(){i._decrementPreload(),r&&r(a)}s.default._validateParameters("loadShader",arguments),n=n||console.error;var a=new s.default.Shader,i=this,l=!1,u=!1;return this.loadStrings(e,(function(e){a._vertSrc=e.join("\n"),u=!0,l&&o()}),n),this.loadStrings(t,(function(e){a._fragSrc=e.join("\n"),l=!0,u&&o()}),n),a},s.default.prototype.createShader=function(e,t){return this._assert3d("createShader"),s.default._validateParameters("createShader",arguments),new s.default.Shader(this._renderer,e,t)},s.default.prototype.shader=function(e){return this._assert3d("shader"),s.default._validateParameters("shader",arguments),void 0===e._renderer&&(e._renderer=this._renderer),e.init(),e.isStrokeShader()?this._renderer.userStrokeShader=e:(this._renderer.userFillShader=e,this._renderer._useNormalMaterial=!1),this},s.default.prototype.resetShader=function(){return this._renderer.userFillShader=this._renderer.userStrokeShader=null,this},s.default.prototype.texture=function(e){return this._assert3d("texture"),s.default._validateParameters("texture",arguments),e.gifProperties&&e._animateGif(this),this._renderer.drawMode=a.TEXTURE,this._renderer._useNormalMaterial=!1,this._renderer._tex=e,this._renderer._setProperty("_doFill",!0),this},s.default.prototype.textureMode=function(e){e!==a.IMAGE&&e!==a.NORMAL?console.warn("You tried to set ".concat(e," textureMode only supports IMAGE & NORMAL ")):this._renderer.textureMode=e},s.default.prototype.textureWrap=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:e,r=(this._renderer.textureWrapX=e,this._renderer.textureWrapY=t,!0),n=!1,o=void 0;try{for(var s,a=this._renderer.textures.values()[Symbol.iterator]();!(r=(s=a.next()).done);r=!0)s.value.setWrapMode(e,t)}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}},s.default.prototype.normalMaterial=function(){this._assert3d("normalMaterial");for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default._validateParameters("normalMaterial",t),this._renderer.drawMode=a.FILL,this._renderer._useSpecularMaterial=!1,this._renderer._useEmissiveMaterial=!1,this._renderer._useNormalMaterial=!0,this._renderer.curFillColor=[1,1,1,1],this._renderer._setProperty("_doFill",!0),this.noStroke(),this},s.default.prototype.ambientMaterial=function(e,t,r){this._assert3d("ambientMaterial"),s.default._validateParameters("ambientMaterial",arguments);var n=s.default.prototype.color.apply(this,arguments);return this._renderer._hasSetAmbient=!0,this._renderer.curAmbientColor=n._array,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this._renderer._setProperty("_doFill",!0),this},s.default.prototype.emissiveMaterial=function(e,t,r,n){this._assert3d("emissiveMaterial"),s.default._validateParameters("emissiveMaterial",arguments);var o=s.default.prototype.color.apply(this,arguments);return this._renderer.curEmissiveColor=o._array,this._renderer._useEmissiveMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this},s.default.prototype.specularMaterial=function(e,t,r,n){this._assert3d("specularMaterial"),s.default._validateParameters("specularMaterial",arguments);var o=s.default.prototype.color.apply(this,arguments);return this._renderer.curSpecularColor=o._array,this._renderer._useSpecularMaterial=!0,this._renderer._useNormalMaterial=!1,this._renderer._enableLighting=!0,this},s.default.prototype.shininess=function(e){return this._assert3d("shininess"),s.default._validateParameters("shininess",arguments),this._renderer._useShininess=e=e<1?1:e,this},s.default.RendererGL.prototype._applyColorBlend=function(e){var t=this.GL,r=this.drawMode===a.TEXTURE;return(r=this.userFillShader||this.userStrokeShader||this.userPointShader||r||this.curBlendMode!==a.BLEND||e[e.length-1]<1||this._isErasing)!==this._isBlending&&(r||this.curBlendMode!==a.BLEND&&this.curBlendMode!==a.ADD?t.enable(t.BLEND):t.disable(t.BLEND),t.depthMask(!0),this._isBlending=r),this._applyBlendMode(),e},s.default.RendererGL.prototype._applyBlendMode=function(){if(this._cachedBlendMode!==this.curBlendMode){var e=this.GL;switch(this.curBlendMode){case a.BLEND:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case a.ADD:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE);break;case a.REMOVE:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_ALPHA);break;case a.MULTIPLY:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case a.SCREEN:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ONE_MINUS_SRC_COLOR);break;case a.EXCLUSION:e.blendEquationSeparate(e.FUNC_ADD,e.FUNC_ADD),e.blendFuncSeparate(e.ONE_MINUS_DST_COLOR,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE);break;case a.REPLACE:e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO);break;case a.SUBTRACT:e.blendEquationSeparate(e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case a.DARKEST:this.blendExt?(e.blendEquationSeparate(this.blendExt.MIN||this.blendExt.MIN_EXT,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):console.warn("blendMode(DARKEST) does not work in your browser in WEBGL mode.");break;case a.LIGHTEST:this.blendExt?(e.blendEquationSeparate(this.blendExt.MAX||this.blendExt.MAX_EXT,e.FUNC_ADD),e.blendFuncSeparate(e.ONE,e.ONE,e.ONE,e.ONE)):console.warn("blendMode(LIGHTEST) does not work in your browser in WEBGL mode.");break;default:console.error("Oops! Somehow RendererGL set curBlendMode to an unsupported mode.")}this._isErasing||(this._cachedBlendMode=this.curBlendMode)}};var l=s.default;r.default=l},{"../core/constants":262,"../core/main":273,"./p5.Texture":330,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.join":161,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],321:[function(e,t,r){"use strict";e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.string.sub"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.math.hypot"),e("core-js/modules/es.string.sub"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.prototype.camera=function(){var e;this._assert3d("camera");for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.default._validateParameters("camera",r),(e=this._renderer._curCamera).camera.apply(e,r),this},n.default.prototype.perspective=function(){var e;this._assert3d("perspective");for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.default._validateParameters("perspective",r),(e=this._renderer._curCamera).perspective.apply(e,r),this},n.default.prototype.ortho=function(){var e;this._assert3d("ortho");for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.default._validateParameters("ortho",r),(e=this._renderer._curCamera).ortho.apply(e,r),this},n.default.prototype.frustum=function(){var e;this._assert3d("frustum");for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.default._validateParameters("frustum",r),(e=this._renderer._curCamera).frustum.apply(e,r),this},n.default.prototype.createCamera=function(){this._assert3d("createCamera");var e=new n.default.Camera(this._renderer);return e._computeCameraDefaultSettings(),e._setDefaultCamera(),this._renderer._curCamera=e},n.default.Camera=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._renderer=t,this.cameraType="default",this.cameraMatrix=new n.default.Matrix,this.projMatrix=new n.default.Matrix,this.yScale=1}var t;return(t=[{key:"perspective",value:function(e,t,r,o){this.cameraType=0<arguments.length?"custom":"default",void 0===e?(e=this.defaultCameraFOV,this.cameraFOV=e):this.cameraFOV=this._renderer._pInst._toRadians(e),void 0===t&&(t=this.defaultAspectRatio),void 0===r&&(r=this.defaultCameraNear),void 0===o&&(o=this.defaultCameraFar),r<=1e-4&&(r=.01,console.log("Avoid perspective near plane values close to or below 0. Setting value to 0.01.")),o<r&&console.log("Perspective far plane value is less than near plane value. Nothing will be shown."),this.aspectRatio=t,this.cameraNear=r,this.cameraFar=o,this.projMatrix=n.default.Matrix.identity(),e=1/Math.tan(this.cameraFOV/2);var s=1/(this.cameraNear-this.cameraFar);this.projMatrix.set(e/t,0,0,0,0,-e*this.yScale,0,0,0,0,(o+r)*s,-1,0,0,2*o*r*s,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15])}},{key:"ortho",value:function(e,t,r,o,s,a){void 0===e&&(e=-this._renderer.width/2),void 0===t&&(t=+this._renderer.width/2),void 0===r&&(r=-this._renderer.height/2),void 0===o&&(o=+this._renderer.height/2),void 0===s&&(s=0),void 0===a&&(a=Math.max(this._renderer.width,this._renderer.height)),this.cameraNear=s;var i=t-e,l=o-r,u=(this.cameraFar=a)-s,c=2/i,d=2/l*this.yScale,h=-2/u;t=-(t+e)/i,e=-(o+r)/l,i=-(a+s)/u,this.projMatrix=n.default.Matrix.identity(),this.projMatrix.set(c,0,0,0,0,-d,0,0,0,0,h,0,t,e,i,1),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15]),this.cameraType="custom"}},{key:"frustum",value:function(e,t,r,o,s,a){void 0===e&&(e=.05*-this._renderer.width),void 0===t&&(t=.05*+this._renderer.width),void 0===r&&(r=.05*+this._renderer.height),void 0===o&&(o=.05*-this._renderer.height),void 0===s&&(s=this.defaultCameraNear),void 0===a&&(a=this.defaultCameraFar),this.cameraNear=s;var i=t-e,l=o-r,u=(this.cameraFar=a)-s,c=2*s/i,d=2*s/l*this.yScale,h=-2*a*s/u;t=(t+e)/i,e=(o+r)/l,i=-(a+s)/u,this.projMatrix=n.default.Matrix.identity(),this.projMatrix.set(c,0,0,0,0,-d,0,0,t,e,i,-1,0,0,h,0),this._isActive()&&this._renderer.uPMatrix.set(this.projMatrix.mat4[0],this.projMatrix.mat4[1],this.projMatrix.mat4[2],this.projMatrix.mat4[3],this.projMatrix.mat4[4],this.projMatrix.mat4[5],this.projMatrix.mat4[6],this.projMatrix.mat4[7],this.projMatrix.mat4[8],this.projMatrix.mat4[9],this.projMatrix.mat4[10],this.projMatrix.mat4[11],this.projMatrix.mat4[12],this.projMatrix.mat4[13],this.projMatrix.mat4[14],this.projMatrix.mat4[15]),this.cameraType="custom"}},{key:"_rotateView",value:function(e,t,r,o){var s=this.centerX,a=this.centerY,i=this.centerZ,l=(s-=this.eyeX,a-=this.eyeY,i-=this.eyeZ,n.default.Matrix.identity(this._renderer._pInst));(l.rotate(this._renderer._pInst._toRadians(e),t,r,o),e=[s*l.mat4[0]+a*l.mat4[4]+i*l.mat4[8],s*l.mat4[1]+a*l.mat4[5]+i*l.mat4[9],s*l.mat4[2]+a*l.mat4[6]+i*l.mat4[10]])[0]+=this.eyeX,e[1]+=this.eyeY,e[2]+=this.eyeZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,e[0],e[1],e[2],this.upX,this.upY,this.upZ)}},{key:"pan",value:function(e){var t=this._getLocalAxes();this._rotateView(e,t.y[0],t.y[1],t.y[2])}},{key:"tilt",value:function(e){var t=this._getLocalAxes();this._rotateView(e,t.x[0],t.x[1],t.x[2])}},{key:"lookAt",value:function(e,t,r){this.camera(this.eyeX,this.eyeY,this.eyeZ,e,t,r,this.upX,this.upY,this.upZ)}},{key:"camera",value:function(e,t,r,n,o,s,a,i,l){return void 0===e&&(e=this.defaultEyeX,t=this.defaultEyeY,r=this.defaultEyeZ,n=e,o=t,i=1,l=a=s=0),this.eyeX=e,this.eyeY=t,this.eyeZ=r,void 0!==n&&(this.centerX=n,this.centerY=o,this.centerZ=s),void 0!==a&&(this.upX=a,this.upY=i,this.upZ=l),n=this._getLocalAxes(),this.cameraMatrix.set(n.x[0],n.y[0],n.z[0],0,n.x[1],n.y[1],n.z[1],0,n.x[2],n.y[2],n.z[2],0,0,0,0,1),o=-e,this.cameraMatrix.translate([o,-t,-r]),this._isActive()&&this._renderer.uMVMatrix.set(this.cameraMatrix.mat4[0],this.cameraMatrix.mat4[1],this.cameraMatrix.mat4[2],this.cameraMatrix.mat4[3],this.cameraMatrix.mat4[4],this.cameraMatrix.mat4[5],this.cameraMatrix.mat4[6],this.cameraMatrix.mat4[7],this.cameraMatrix.mat4[8],this.cameraMatrix.mat4[9],this.cameraMatrix.mat4[10],this.cameraMatrix.mat4[11],this.cameraMatrix.mat4[12],this.cameraMatrix.mat4[13],this.cameraMatrix.mat4[14],this.cameraMatrix.mat4[15]),this}},{key:"move",value:function(e,t,r){e=[(n=this._getLocalAxes()).x[0]*e,n.x[1]*e,n.x[2]*e],t=[n.y[0]*t,n.y[1]*t,n.y[2]*t];var n=[n.z[0]*r,n.z[1]*r,n.z[2]*r];this.camera(this.eyeX+e[0]+t[0]+n[0],this.eyeY+e[1]+t[1]+n[1],this.eyeZ+e[2]+t[2]+n[2],this.centerX+e[0]+t[0]+n[0],this.centerY+e[1]+t[1]+n[1],this.centerZ+e[2]+t[2]+n[2],this.upX,this.upY,this.upZ)}},{key:"setPosition",value:function(e,t,r){var n=e-this.eyeX,o=t-this.eyeY,s=r-this.eyeZ;this.camera(e,t,r,this.centerX+n,this.centerY+o,this.centerZ+s,this.upX,this.upY,this.upZ)}},{key:"set",value:function(e){for(var t=0,r=["eyeX","eyeY","eyeZ","centerX","centerY","centerZ","upX","upY","upZ","cameraFOV","aspectRatio","cameraNear","cameraFar","cameraType"];t<r.length;t++){var n=r[t];this[n]=e[n]}this.cameraMatrix=e.cameraMatrix.copy(),this.projMatrix=e.projMatrix.copy(),this._isActive()&&(this._renderer.uMVMatrix.mat4=this.cameraMatrix.mat4.slice(),this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice())}},{key:"slerp",value:function(e,t,r){var o,s,a,i,l,u,c,d,h,p,f,m,y,g,v,b,x,w;0===r?this.set(e):1===r?this.set(t):(0!==this.projMatrix.mat4[15]&&(this.projMatrix.mat4[0]=e.projMatrix.mat4[0]*Math.pow(t.projMatrix.mat4[0]/e.projMatrix.mat4[0],r),this.projMatrix.mat4[5]=e.projMatrix.mat4[5]*Math.pow(t.projMatrix.mat4[5]/e.projMatrix.mat4[5],r),this._isActive()&&(this._renderer.uPMatrix.mat4=this.projMatrix.mat4.slice())),i=new n.default.Vector(e.eyeX,e.eyeY,e.eyeZ),l=new n.default.Vector(t.eyeX,t.eyeY,t.eyeZ),b=new n.default.Vector(e.centerX,e.centerY,e.centerZ),w=new n.default.Vector(t.centerX,t.centerY,t.centerZ),a=n.default.Vector.dist(i,b),o=n.default.Vector.dist(l,w),o=a*Math.pow(o/a,r),a=n.default.Vector.sub(i,l),s=1,1e-6<(x=(g=i.copy().sub(l).sub(b).add(w)).magSq())&&(s=n.default.Vector.dot(a,g)/x,s=Math.max(0,Math.min(s,1))),a=n.default.Vector.lerp(n.default.Vector.lerp(i,b,s),n.default.Vector.lerp(l,w,s),r),g=e.cameraMatrix.createSubMatrix3x3(),x=t.cameraMatrix.createSubMatrix3x3(),i=g.column(2),b=x.column(2),l=g.column(1),w=x.column(1),e=new n.default.Vector,t=new n.default.Vector,u=new n.default.Vector,c=new n.default.Vector,1-(d=.5*((g=(x=x.mult3x3(g.copy().transpose3x3())).diagonal())[0]+g[1]+g[2]-1))<1e-7?(e.set(n.default.Vector.lerp(i,b,r)).normalize(),u.set(e).mult(s*o).add(a),c.set(e).mult((s-1)*o).add(a),t.set(n.default.Vector.lerp(l,w,r)).normalize()):(b=1/(1-d),w=Math.max(g[0],g[1],g[2]),m=x.mat3[1]+x.mat3[3],y=x.mat3[2]+x.mat3[6],v=x.mat3[5]+x.mat3[7],w=w===g[0]?(p=.5*m*(b/=h=Math.sqrt((g[0]-d)*b)),f=.5*y*b,.5*(x.mat3[7]-x.mat3[5])/h):w===g[1]?(f=.5*v*(b/=p=Math.sqrt((g[1]-d)*b)),h=.5*m*b,.5*(x.mat3[2]-x.mat3[6])/p):(h=.5*y*(b/=f=Math.sqrt((g[2]-d)*b)),p=.5*v*b,.5*(x.mat3[3]-x.mat3[1])/f),m=r*Math.atan2(w,d),y=Math.cos(m),g=Math.sin(m),(w=new n.default.Matrix("mat3",[y+(v=1-y)*h*h,v*(b=h*p)-g*f,v*(x=f*h)+g*p,v*b+g*f,y+v*p*p,v*(r=p*f)-g*h,v*x-g*p,v*r+g*h,y+v*f*f])).multiplyVec3(i,e),u.set(e).mult(s*o).add(a),c.set(e).mult((s-1)*o).add(a),w.multiplyVec3(l,t)),this.camera(u.x,u.y,u.z,c.x,c.y,c.z,t.x,t.y,t.z))}},{key:"_computeCameraDefaultSettings",value:function(){this.defaultCameraFOV=60/180*Math.PI,this.defaultAspectRatio=this._renderer.width/this._renderer.height,this.defaultEyeX=0,this.defaultEyeY=0,this.defaultEyeZ=this._renderer.height/2/Math.tan(this.defaultCameraFOV/2),this.defaultCenterX=0,this.defaultCenterY=0,this.defaultCenterZ=0,this.defaultCameraNear=.1*this.defaultEyeZ,this.defaultCameraFar=10*this.defaultEyeZ}},{key:"_setDefaultCamera",value:function(){this.cameraFOV=this.defaultCameraFOV,this.aspectRatio=this.defaultAspectRatio,this.eyeX=this.defaultEyeX,this.eyeY=this.defaultEyeY,this.eyeZ=this.defaultEyeZ,this.centerX=this.defaultCenterX,this.centerY=this.defaultCenterY,this.centerZ=this.defaultCenterZ,this.upX=0,this.upY=1,this.upZ=0,this.cameraNear=this.defaultCameraNear,this.cameraFar=this.defaultCameraFar,this.perspective(),this.camera(),this.cameraType="default"}},{key:"_resize",value:function(){"default"===this.cameraType?(this._computeCameraDefaultSettings(),this._setDefaultCamera()):this.perspective(this.cameraFOV,this._renderer.width/this._renderer.height)}},{key:"copy",value:function(){var e=new n.default.Camera(this._renderer);return e.cameraFOV=this.cameraFOV,e.aspectRatio=this.aspectRatio,e.eyeX=this.eyeX,e.eyeY=this.eyeY,e.eyeZ=this.eyeZ,e.centerX=this.centerX,e.centerY=this.centerY,e.centerZ=this.centerZ,e.upX=this.upX,e.upY=this.upY,e.upZ=this.upZ,e.cameraNear=this.cameraNear,e.cameraFar=this.cameraFar,e.cameraType=this.cameraType,e.cameraMatrix=this.cameraMatrix.copy(),e.projMatrix=this.projMatrix.copy(),e}},{key:"_getLocalAxes",value:function(){var e,t=this.eyeX-this.centerX,r=this.eyeY-this.centerY,n=this.eyeZ-this.centerZ,o=(0!==(o=Math.sqrt(t*t+r*r+n*n))&&(t/=o,r/=o,n/=o),this.upX),s=(l=this.upY)*n-(u=this.upZ)*r,a=-o*n+u*t,i=o*r-l*t,l=(o=r*i-n*a,-t*i+n*s),u=t*a-r*s;return 0!==(0!==(e=Math.sqrt(s*s+a*a+i*i))&&(s/=e,a/=e,i/=e),e=Math.sqrt(o*o+l*l+u*u))&&(o/=e,l/=e,u/=e),{x:[s,a,i],y:[o,l,u],z:[t,r,n]}}},{key:"_orbit",value:function(e,t,r){var o=this.eyeX-this.centerX,s=this.eyeY-this.centerY,a=this.eyeZ-this.centerZ,i=Math.hypot(o,s,a),l=(o=new n.default.Vector(o,s,a).normalize(),s=new n.default.Vector(this.upX,this.upY,this.upZ).normalize(),a=new n.default.Vector.cross(s,o).normalize(),new n.default.Vector.cross(a,s));(i=(i*=Math.pow(10,r))<this.cameraNear?this.cameraNear:i)>this.cameraFar&&(i=this.cameraFar),r=Math.acos(Math.max(-1,Math.min(1,n.default.Vector.dot(o,s))))+t,t=e,(r<=0||r>=Math.PI)&&(this.upX*=-1,this.upY*=-1,this.upZ*=-1),s.mult(Math.cos(r)),l.mult(Math.cos(t)*Math.sin(r)),a.mult(Math.sin(t)*Math.sin(r)),o.set(s).add(l).add(a),this.eyeX=i*o.x+this.centerX,this.eyeY=i*o.y+this.centerY,this.eyeZ=i*o.z+this.centerZ,this.camera(this.eyeX,this.eyeY,this.eyeZ,this.centerX,this.centerY,this.centerZ,this.upX,this.upY,this.upZ)}},{key:"_orbitFree",value:function(e,t,r){var o=this.eyeX-this.centerX,s=this.eyeY-this.centerY,a=this.eyeZ-this.centerZ,i=Math.hypot(o,s,a),l=(o=new n.default.Vector(o,s,a).normalize(),s=new n.default.Vector(this.upX,this.upY,this.upZ),a=new n.default.Vector.cross(s,o).normalize(),new n.default.Vector.cross(o,a)),u=Math.atan2(t,e),c=(l.mult(Math.sin(u)),a.mult(Math.cos(u)).add(l),u=Math.sqrt(e*e+t*t),l=new n.default.Vector.cross(o,a),(i=(i*=Math.pow(10,r))<this.cameraNear?this.cameraNear:i)>this.cameraFar&&(i=this.cameraFar),e=Math.cos(u),t=Math.sin(u),(r=s.dot(o))*e+(u=s.dot(a))*t);r=-r*t+u*e,u=s.dot(l),s.x=c*o.x+r*a.x+u*l.x,s.y=c*o.y+r*a.y+u*l.y,s.z=c*o.z+r*a.z+u*l.z,a.mult(-t),o.mult(e).add(a).mult(i),this.camera(o.x+this.centerX,o.y+this.centerY,o.z+this.centerZ,this.centerX,this.centerY,this.centerZ,s.x,s.y,s.z)}},{key:"_isActive",value:function(){return this===this._renderer._curCamera}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),n.default.prototype.setCamera=function(e){this._renderer._curCamera=e,this._renderer.uPMatrix.set(e.projMatrix.mat4[0],e.projMatrix.mat4[1],e.projMatrix.mat4[2],e.projMatrix.mat4[3],e.projMatrix.mat4[4],e.projMatrix.mat4[5],e.projMatrix.mat4[6],e.projMatrix.mat4[7],e.projMatrix.mat4[8],e.projMatrix.mat4[9],e.projMatrix.mat4[10],e.projMatrix.mat4[11],e.projMatrix.mat4[12],e.projMatrix.mat4[13],e.projMatrix.mat4[14],e.projMatrix.mat4[15])},e=n.default.Camera,r.default=e},{"../core/main":273,"core-js/modules/es.array.slice":164,"core-js/modules/es.math.hypot":169,"core-js/modules/es.string.sub":198}],322:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.reflect.get"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.reflect.get"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint8-clamped-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=(x=e("../core/main"))&&x.__esModule?x:{default:x},s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==d(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")),a=e("./p5.Texture"),i=e("./p5.RendererGL");function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var r=[],n=!0,o=!1,s=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}return r}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function d(e){return(d="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function f(e,t,r){t&&p(e.prototype,t),r&&p(e,r)}function m(e,t,r){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){if(e=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t),e)return(e=Object.getOwnPropertyDescriptor(e,t)).get?e.get.call(r):e.value})(e,t,r||e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&y(t,e);var r=function(e){return function(){var t,r=g(e);if(t=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?(t=g(this).constructor,Reflect.construct(r,arguments,t)):r.apply(this,arguments),r=this,!t||"object"!==d(t)&&"function"!=typeof t){if(void 0!==r)return r;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}}(n);function n(e){var t;return h(this,n),(t=r.call(this,e.target._renderer)).fbo=e,t.yScale=-1,t}return f(n,[{key:"_computeCameraDefaultSettings",value:function(){m(g(n.prototype),"_computeCameraDefaultSettings",this).call(this),this.defaultAspectRatio=this.fbo.width/this.fbo.height,this.defaultEyeZ=this.fbo.height/2/Math.tan(this.defaultCameraFOV/2),this.defaultCameraNear=.1*this.defaultEyeZ,this.defaultCameraFar=10*this.defaultEyeZ}},{key:"_resize",value:function(){"default"===this.cameraType?(this._computeCameraDefaultSettings(),this._setDefaultCamera()):this.perspective(this.cameraFOV,this.fbo.width/this.fbo.height)}}]),n}(o.default.Camera),b=(o.default.FramebufferCamera=v,function(){function e(t,r){h(this,e),this.framebuffer=t,this.property=r}return f(e,[{key:"rawTexture",value:function(){return this.framebuffer[this.property]}},{key:"width",get:function(){return this.framebuffer.width*this.framebuffer.density}},{key:"height",get:function(){return this.framebuffer.height*this.framebuffer.density}}]),e}()),x=(o.default.FramebufferTexture=b,function(){function e(t){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(h(this,e),this.target=t,this.target._renderer.framebuffers.add(this),this.pixels=[],this.format=r.format||s.UNSIGNED_BYTE,this.channels=r.channels||(t._renderer._pInst._glAttributes.alpha?s.RGBA:s.RGB),this.useDepth=void 0===r.depth||r.depth,this.depthFormat=r.depthFormat||s.FLOAT,this.textureFiltering=r.textureFiltering||s.LINEAR,void 0===r.antialias?this.antialiasSamples=t._renderer._pInst._glAttributes.antialias?2:0:"number"==typeof r.antialias?this.antialiasSamples=r.antialias:this.antialiasSamples=r.antialias?2:0,this.antialias=0<this.antialiasSamples,this.antialias&&t.webglVersion!==s.WEBGL2&&(console.warn("Antialiasing is unsupported in a WebGL 1 context"),this.antialias=!1),r.width&&r.height?(this.width=r.width,this.height=r.height,this.autoSized=!1):(void 0===r.width!=(void 0===r.height)&&console.warn("Please supply both width and height for a framebuffer to give it a size. Only one was given, so the framebuffer will match the size of its canvas."),this.width=t.width,this.height=t.height,this.autoSized=!0),this.density=r.density||t.pixelDensity(),r=t._renderer.GL,this.gl=r,this._checkIfFormatsAvailable(),this.framebuffer=r.createFramebuffer(),!this.framebuffer)throw new Error("Unable to create a framebuffer");if(this.antialias&&(this.aaFramebuffer=r.createFramebuffer(),!this.aaFramebuffer))throw new Error("Unable to create a framebuffer for antialiasing");this._recreateTextures(),t=this.target._renderer._curCamera,this.defaultCamera=this.createCamera(),this.target._renderer._curCamera=t}return f(e,[{key:"resize",value:function(e,t){this.autoSized=!1,this.width=e,this.height=t,this._handleResize()}},{key:"pixelDensity",value:function(e){if(!e)return this.density;this.autoSized=!1,this.density=e,this._handleResize()}},{key:"autoSized",value:function(e){if(void 0===e)return this.autoSized;this.autoSized=e,this._handleResize()}},{key:"_checkIfFormatsAvailable",value:function(){var e=this.gl;(this.useDepth&&this.target.webglVersion===s.WEBGL&&!e.getExtension("WEBGL_depth_texture")&&(console.warn("Unable to create depth textures in this environment. Falling back to a framebuffer without depth."),this.useDepth=!1),this.useDepth&&this.target.webglVersion===s.WEBGL&&this.depthFormat===s.FLOAT&&(console.warn("FLOAT depth format is unavailable in WebGL 1. Defaulting to UNSIGNED_INT."),this.depthFormat=s.UNSIGNED_INT),[s.UNSIGNED_BYTE,s.FLOAT,s.HALF_FLOAT].includes(this.format)||(console.warn("Unknown Framebuffer format. Please use UNSIGNED_BYTE, FLOAT, or HALF_FLOAT. Defaulting to UNSIGNED_BYTE."),this.format=s.UNSIGNED_BYTE),this.useDepth&&![s.UNSIGNED_INT,s.FLOAT].includes(this.depthFormat)&&(console.warn("Unknown Framebuffer depth format. Please use UNSIGNED_INT or FLOAT. Defaulting to FLOAT."),this.depthFormat=s.FLOAT),e=(0,a.checkWebGLCapabilities)(this.target._renderer)).float||this.format!==s.FLOAT||(console.warn("This environment does not support FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=s.UNSIGNED_BYTE),this.useDepth&&!e.float&&this.depthFormat===s.FLOAT&&(console.warn("This environment does not support FLOAT depth textures. Falling back to UNSIGNED_INT."),this.depthFormat=s.UNSIGNED_INT),e.halfFloat||this.format!==s.HALF_FLOAT||(console.warn("This environment does not support HALF_FLOAT textures. Falling back to UNSIGNED_BYTE."),this.format=s.UNSIGNED_BYTE),this.channels===s.RGB&&[s.FLOAT,s.HALF_FLOAT].includes(this.format)&&(console.warn("FLOAT and HALF_FLOAT formats do not work cross-platform with only RGB channels. Falling back to RGBA."),this.channels=s.RGBA)}},{key:"_recreateTextures",value:function(){var e=this.gl,t=(this._updateSize(),e.getParameter(e.TEXTURE_BINDING_2D)),r=e.getParameter(e.FRAMEBUFFER_BINDING);if(!(a=e.createTexture()))throw new Error("Unable to create color texture");e.bindTexture(e.TEXTURE_2D,a);var n=this._glColorFormat();if(e.texImage2D(e.TEXTURE_2D,0,n.internalFormat,this.width*this.density,this.height*this.density,0,n.format,n.type,null),this.colorTexture=a,e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),this.useDepth){var a;if(!(a=e.createTexture()))throw new Error("Unable to create depth texture");var i=this._glDepthFormat();e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,i.internalFormat,this.width*this.density,this.height*this.density,0,i.format,i.type,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,a,0),this.depthTexture=a}this.antialias&&(this.colorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.colorRenderbuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,e.getParameter(e.MAX_SAMPLES))),n.internalFormat,this.width*this.density,this.height*this.density),this.useDepth&&(i=this._glDepthFormat(),this.depthRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.depthRenderbuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,Math.max(0,Math.min(this.antialiasSamples,e.getParameter(e.MAX_SAMPLES))),i.internalFormat,this.width*this.density,this.height*this.density)),e.bindFramebuffer(e.FRAMEBUFFER,this.aaFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,this.colorRenderbuffer),this.useDepth&&e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,this.depthRenderbuffer)),this.useDepth&&(this.depth=new b(this,"depthTexture"),a=e.NEAREST,this.depthP5Texture=new o.default.Texture(this.target._renderer,this.depth,{minFilter:a,magFilter:a}),this.target._renderer.textures.set(this.depth,this.depthP5Texture)),this.color=new b(this,"colorTexture"),n=this.textureFiltering===s.LINEAR?e.LINEAR:e.NEAREST,this.colorP5Texture=new o.default.Texture(this.target._renderer,this.color,{glMinFilter:n,glMagFilter:n}),this.target._renderer.textures.set(this.color,this.colorP5Texture),e.bindTexture(e.TEXTURE_2D,t),e.bindFramebuffer(e.FRAMEBUFFER,r)}},{key:"_glColorFormat",value:function(){var e,t,r=this.gl,n=this.format===s.FLOAT?r.FLOAT:this.format===s.HALF_FLOAT?this.target.webglVersion===s.WEBGL2?r.HALF_FLOAT:r.getExtension("OES_texture_half_float").HALF_FLOAT_OES:r.UNSIGNED_BYTE,o=this.channels===s.RGBA?r.RGBA:r.RGB;return{internalFormat:this.target.webglVersion===s.WEBGL2?(c(t={},r.FLOAT,c({},r.RGBA,r.RGBA32F)),c(t,r.HALF_FLOAT,c({},r.RGBA,r.RGBA16F)),c(t,r.UNSIGNED_BYTE,(c(e={},r.RGBA,r.RGBA8),c(e,r.RGB,r.RGB8),e)),t[n][o]):this.format===s.HALF_FLOAT?r.RGBA:o,format:o,type:n}}},{key:"_glDepthFormat",value:function(){var e=this.gl,t=this.depthFormat===s.FLOAT?e.FLOAT:e.UNSIGNED_INT,r=e.DEPTH_COMPONENT;return{internalFormat:e=this.target.webglVersion===s.WEBGL2?this.depthFormat===s.FLOAT?e.DEPTH_COMPONENT32F:e.DEPTH_COMPONENT24:e.DEPTH_COMPONENT,format:r,type:t}}},{key:"_updateSize",value:function(){this.autoSized&&(this.width=this.target.width,this.height=this.target.height,this.density=this.target.pixelDensity())}},{key:"_canvasSizeChanged",value:function(){this.autoSized&&this._handleResize()}},{key:"_handleResize",value:function(){var e=this.color,t=this.depth,r=this.colorRenderbuffer,n=this.depthRenderbuffer;this._deleteTexture(e),t&&this._deleteTexture(t),e=this.gl,r&&e.deleteRenderbuffer(r),n&&e.deleteRenderbuffer(n),this._recreateTextures(),this.defaultCamera._resize()}},{key:"createCamera",value:function(){var e=new v(this);return e._computeCameraDefaultSettings(),e._setDefaultCamera(),this.target._renderer._curCamera=e}},{key:"_deleteTexture",value:function(e){this.gl.deleteTexture(e.rawTexture()),this.target._renderer.textures.delete(e)}},{key:"remove",value:function(){var e=this.gl;this._deleteTexture(this.color),this.depth&&this._deleteTexture(this.depth),e.deleteFramebuffer(this.framebuffer),this.aaFramebuffer&&e.deleteFramebuffer(this.aaFramebuffer),this.depthRenderbuffer&&e.deleteRenderbuffer(this.depthRenderbuffer),this.colorRenderbuffer&&e.deleteRenderbuffer(this.colorRenderbuffer),this.target._renderer.framebuffers.delete(this)}},{key:"begin",value:function(){var e=this.gl;this.prevFramebuffer=e.getParameter(e.FRAMEBUFFER_BINDING),this.antialias?e.bindFramebuffer(e.FRAMEBUFFER,this.aaFramebuffer):e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),this.prevViewport=e.getParameter(e.VIEWPORT),e.viewport(0,0,this.width*this.density,this.height*this.density),this.target.push(),this.target.setCamera(this.defaultCamera),this.target._renderer.uMVMatrix.set(this.target._renderer._curCamera.cameraMatrix.mat4[0],this.target._renderer._curCamera.cameraMatrix.mat4[1],this.target._renderer._curCamera.cameraMatrix.mat4[2],this.target._renderer._curCamera.cameraMatrix.mat4[3],this.target._renderer._curCamera.cameraMatrix.mat4[4],this.target._renderer._curCamera.cameraMatrix.mat4[5],this.target._renderer._curCamera.cameraMatrix.mat4[6],this.target._renderer._curCamera.cameraMatrix.mat4[7],this.target._renderer._curCamera.cameraMatrix.mat4[8],this.target._renderer._curCamera.cameraMatrix.mat4[9],this.target._renderer._curCamera.cameraMatrix.mat4[10],this.target._renderer._curCamera.cameraMatrix.mat4[11],this.target._renderer._curCamera.cameraMatrix.mat4[12],this.target._renderer._curCamera.cameraMatrix.mat4[13],this.target._renderer._curCamera.cameraMatrix.mat4[14],this.target._renderer._curCamera.cameraMatrix.mat4[15])}},{key:"end",value:function(){var e=this.gl;if(this.antialias){e.bindFramebuffer(e.READ_FRAMEBUFFER,this.aaFramebuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,this.framebuffer);var t=[[e.COLOR_BUFFER_BIT,this.colorP5Texture.glMagFilter]];this.useDepth&&t.push([e.DEPTH_BUFFER_BIT,this.depthP5Texture.glMagFilter]);for(var r=0,n=t;r<n.length;r++){var o=(s=u(n[r],2))[0],s=s[1];e.blitFramebuffer(0,0,this.width*this.density,this.height*this.density,0,0,this.width*this.density,this.height*this.density,o,s)}}e.bindFramebuffer(e.FRAMEBUFFER,this.prevFramebuffer),e.viewport.apply(e,function(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}(this.prevViewport)),this.target.pop()}},{key:"draw",value:function(e){this.begin(),e(),this.end()}},{key:"loadPixels",value:function(){var e=this.gl,t=e.getParameter(e.FRAMEBUFFER_BINDING),r=(e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),this._glColorFormat());this.pixels=(0,i.readPixelsWebGL)(this.pixels,e,this.framebuffer,0,0,this.width*this.density,this.height*this.density,r.format,r.type),e.bindFramebuffer(e.FRAMEBUFFER,t)}},{key:"get",value:function(e,t,r,n){o.default._validateParameters("p5.Framebuffer.get",arguments);var s=this._glColorFormat();if(void 0===e&&void 0===t)t=e=0,r=this.width,n=this.height;else if(void 0===r&&void 0===n)return(e<0||t<0||e>=this.width||t>=this.height)&&(console.warn("The x and y values passed to p5.Framebuffer.get are outside of its range and will be clamped."),e=this.target.constrain(e,0,this.width-1),t=this.target.constrain(t,0,this.height-1)),(0,i.readPixelWebGL)(this.gl,this.framebuffer,e*this.density,t*this.density,s.format,s.type);e=this.target.constrain(e,0,this.width-1),t=this.target.constrain(t,0,this.height-1),r=this.target.constrain(r,1,this.width-e),n=this.target.constrain(n,1,this.height-t);for(var a=(0,i.readPixelsWebGL)(void 0,this.gl,this.framebuffer,e*this.density,t*this.density,r*this.density,n*this.density,s.format,s.type),l=new Uint8ClampedArray(r*n*this.density*this.density*4),u=(l.fill(255),s.type===this.gl.RGB?3:4),c=0;c<n*this.density;c++)for(var d=0;d<r*this.density;d++)for(var h=0;h<4;h++){var p,f=4*(c*r*this.density+d)+h;h<u&&(p=4==u?f:(c*r*this.density+d)*u+h,l[f]=a[p])}return(e=new o.default.Image(r*this.density,n*this.density)).imageData=e.canvas.getContext("2d").createImageData(e.width,e.height),e.imageData.data.set(l),e.pixels=e.imageData.data,e.updatePixels(),1!==this.density&&e.resize(r,n),e}},{key:"updatePixels",value:function(){var e=this.gl,t=(this.colorP5Texture.bindTexture(),this._glColorFormat()),r=t.format===e.RGBA?4:3,n=(r=this.width*this.height*this.density*this.density*r,t.type===e.UNSIGNED_BYTE?Uint8Array:Float32Array);if(!(this.pixels instanceof n)||this.pixels.length!==r)throw new Error("The pixels array has not been set correctly. Please call loadPixels() before updatePixels().");e.texImage2D(e.TEXTURE_2D,0,t.internalFormat,this.width*this.density,this.height*this.density,0,t.format,t.type,this.pixels),this.colorP5Texture.unbindTexture(),this.prevFramebuffer=e.getParameter(e.FRAMEBUFFER_BINDING),this.antialias?(this.begin(),this.target.push(),this.target.imageMode(this.target.CENTER),this.target.resetMatrix(),this.target.noStroke(),this.target.clear(),this.target.image(this,0,0),this.target.pop(),this.useDepth&&(e.clearDepth(1),e.clear(e.DEPTH_BUFFER_BIT)),this.end()):(e.bindFramebuffer(e.FRAMEBUFFER,this.framebuffer),this.useDepth&&(e.clearDepth(1),e.clear(e.DEPTH_BUFFER_BIT)),e.bindFramebuffer(e.FRAMEBUFFER,this.prevFramebuffer))}}]),e}());e=o.default.Framebuffer=x,r.default=e},{"../core/constants":262,"../core/main":273,"./p5.RendererGL":328,"./p5.Texture":330,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.from":157,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.reflect.get":183,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.float32-array":209,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint8-array":232,"core-js/modules/es.typed-array.uint8-clamped-array":233,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],323:[function(e,t,r){"use strict";e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.string.sub"),e("core-js/modules/web.dom-collections.for-each"),e("core-js/modules/es.array.for-each"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.string.sub"),e("core-js/modules/web.dom-collections.for-each"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.Geometry=function(){function e(t,r,n){if(this instanceof e)return this.vertices=[],this.lineVertices=[],this.lineTangentsIn=[],this.lineTangentsOut=[],this.lineSides=[],this.vertexNormals=[],this.faces=[],this.uvs=[],this.edges=[],this.vertexColors=[],this.vertexStrokeColors=[],this.lineVertexColors=[],this.detailX=void 0!==t?t:1,this.detailY=void 0!==r?r:1,this.dirtyFlags={},n instanceof Function&&n.call(this),this;throw new TypeError("Cannot call a class as a function")}var t;return(t=[{key:"reset",value:function(){this.lineVertices.length=0,this.lineTangentsIn.length=0,this.lineTangentsOut.length=0,this.lineSides.length=0,this.vertices.length=0,this.edges.length=0,this.vertexColors.length=0,this.vertexStrokeColors.length=0,this.lineVertexColors.length=0,this.vertexNormals.length=0,this.uvs.length=0,this.dirtyFlags={}}},{key:"computeFaces",value:function(){this.faces.length=0;for(var e,t,r,n=this.detailX+1,o=0;o<this.detailY;o++)for(var s=0;s<this.detailX;s++)t=(o+1)*n+s+1,this.faces.push([o*n+s,e=o*n+s+1,r=(o+1)*n+s]),this.faces.push([r,e,t]);return this}},{key:"_getFaceNormal",value:function(e){e=this.faces[e];var t=this.vertices[e[0]],r=this.vertices[e[1]],o=(e=this.vertices[e[2]],r=n.default.Vector.sub(r,t),e=n.default.Vector.sub(e,t),t=n.default.Vector.cross(r,e),n.default.Vector.mag(t));return 0==(r=o/(n.default.Vector.mag(r)*n.default.Vector.mag(e)))||isNaN(r)?(console.warn("p5.Geometry.prototype._getFaceNormal:","face has colinear sides or a repeated vertex"),t):(1<r&&(r=1),t.mult(Math.asin(r)/o))}},{key:"computeNormals",value:function(){for(var e=this,t=this.vertexNormals,r=this.vertices,o=this.faces,s=t.length=0;s<r.length;++s)t.push(new n.default.Vector);for(o.forEach((function(r,n){for(var o=e._getFaceNormal(n),s=0;s<3;++s){var a=r[s];t[a].add(o)}})),s=0;s<r.length;++s)t[s].normalize();return this}},{key:"averageNormals",value:function(){for(var e=0;e<=this.detailY;e++){var t=this.detailX+1,r=n.default.Vector.add(this.vertexNormals[e*t],this.vertexNormals[e*t+this.detailX]);r=n.default.Vector.div(r,2),this.vertexNormals[e*t]=r,this.vertexNormals[e*t+this.detailX]=r}return this}},{key:"averagePoleNormals",value:function(){for(var e=new n.default.Vector(0,0,0),t=0;t<this.detailX;t++)e.add(this.vertexNormals[t]);e=n.default.Vector.div(e,this.detailX);for(var r=0;r<this.detailX;r++)this.vertexNormals[r]=e;e=new n.default.Vector(0,0,0);for(var o=this.vertices.length-1;o>this.vertices.length-1-this.detailX;o--)e.add(this.vertexNormals[o]);e=n.default.Vector.div(e,this.detailX);for(var s=this.vertices.length-1;s>this.vertices.length-1-this.detailX;s--)this.vertexNormals[s]=e;return this}},{key:"_makeTriangleEdges",value:function(){for(var e=this.edges.length=0;e<this.faces.length;e++)this.edges.push([this.faces[e][0],this.faces[e][1]]),this.edges.push([this.faces[e][1],this.faces[e][2]]),this.edges.push([this.faces[e][2],this.faces[e][0]]);return this}},{key:"_edgesToVertices",value:function(){this.lineVertices.length=0,this.lineTangentsIn.length=0,this.lineTangentsOut.length=0,this.lineSides.length=0;for(var e,t=1<this.edges.length&&this.edges[0][0]===this.edges[this.edges.length-1][1],r=!1,n=0;n<this.edges.length;n++){var o=this.edges[n-1],s=this.edges[n],a=this.vertices[s[0]],i=this.vertices[s[1]],l=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*s[0],4*(s[0]+1)):[0,0,0,0],u=0<this.vertexStrokeColors.length?this.vertexStrokeColors.slice(4*s[1],4*(s[1]+1)):[0,0,0,0],c=i.copy().sub(a).normalize(),d=0<c.magSq();d&&this._addSegment(a,i,l,u,c),0<n&&o[1]===s[0]?(e&&d&&c.dot(e)<1-1e-8&&this._addJoin(a,e,c,l),!d||r||t||(this._addCap(a,c.copy().mult(-1),l),r=!0)):(r=!1,d&&(!t||0<n)&&(this._addCap(a,c.copy().mult(-1),l),r=!0),e&&(!t||n<this.edges.length-1)&&(this._addCap(this.vertices[o[1]],e,l),e=void 0)),n===this.edges.length-1&&(t?this._addJoin(i,c,this.vertices[this.edges[0][1]].copy().sub(i).normalize(),u):this._addCap(i,c,u)),d&&(e=c)}return this}},{key:"_addSegment",value:function(e,t,r,n,o){e=e.array(),t=t.array();var s=o.array();this.lineSides.push(1,-1,1,1,-1,-1);for(var a=0,i=[this.lineTangentsIn,this.lineTangentsOut];a<i.length;a++)i[a].push(s,s,s,s,s,s);return this.lineVertices.push(e,e,t,t,e,t),this.lineVertexColors.push(r,r,n,n,r,n),this}},{key:"_addCap",value:function(e,t,r){for(var n=e.array(),o=t.array(),s=[0,0,0],a=0;a<6;a++)this.lineVertices.push(n),this.lineTangentsIn.push(o),this.lineTangentsOut.push(s),this.lineVertexColors.push(r);return this.lineSides.push(-1,-2,2,2,1,-1),this}},{key:"_addJoin",value:function(e,t,r,n){for(var o=e.array(),s=t.array(),a=r.array(),i=0;i<12;i++)this.lineVertices.push(o),this.lineTangentsIn.push(s),this.lineTangentsOut.push(a),this.lineVertexColors.push(n);for(var l=0,u=[-1,1];l<u.length;l++){var c=u[l];this.lineSides.push(c,2*c,3*c,c,3*c,0)}return this}},{key:"normalize",value:function(){if(0<this.vertices.length){for(var e=this.vertices[0].copy(),t=this.vertices[0].copy(),r=0;r<this.vertices.length;r++)e.x=Math.max(e.x,this.vertices[r].x),t.x=Math.min(t.x,this.vertices[r].x),e.y=Math.max(e.y,this.vertices[r].y),t.y=Math.min(t.y,this.vertices[r].y),e.z=Math.max(e.z,this.vertices[r].z),t.z=Math.min(t.z,this.vertices[r].z);for(var o=n.default.Vector.lerp(e,t,.5),s=n.default.Vector.sub(e,t),a=200/Math.max(Math.max(s.x,s.y),s.z),i=0;i<this.vertices.length;i++)this.vertices[i].sub(o),this.vertices[i].mult(a)}return this}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=n.default.Geometry,r.default=e},{"../core/main":273,"core-js/modules/es.array.for-each":156,"core-js/modules/es.array.slice":164,"core-js/modules/es.string.sub":198,"core-js/modules/web.dom-collections.for-each":235}],324:[function(e,t,r){"use strict";e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s=Array,a=function(e){return Array.isArray(e)};"undefined"!=typeof Float32Array&&(s=Float32Array,a=function(e){return Array.isArray(e)||e instanceof Float32Array}),n.default.Matrix=function(){function e(){var t=this,r=e;if(t instanceof r)return arguments.length&&((t=arguments.length-1)<0||arguments.length<=t?void 0:arguments[t])instanceof n.default&&(this.p5=(r=arguments.length-1)<0||arguments.length<=r?void 0:arguments[r]),"mat3"===(arguments.length<=0?void 0:arguments[0])?this.mat3=Array.isArray(arguments.length<=1?void 0:arguments[1])?arguments.length<=1?void 0:arguments[1]:new s([1,0,0,0,1,0,0,0,1]):this.mat4=Array.isArray(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:new s([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),this;throw new TypeError("Cannot call a class as a function")}var t,r,i;return t=e,i=[{key:"identity",value:function(e){return new n.default.Matrix(e)}}],(r=[{key:"set",value:function(e){return e instanceof n.default.Matrix?this.mat4=e.mat4:a(e)?this.mat4=e:16===arguments.length&&(this.mat4[0]=e,this.mat4[1]=arguments[1],this.mat4[2]=arguments[2],this.mat4[3]=arguments[3],this.mat4[4]=arguments[4],this.mat4[5]=arguments[5],this.mat4[6]=arguments[6],this.mat4[7]=arguments[7],this.mat4[8]=arguments[8],this.mat4[9]=arguments[9],this.mat4[10]=arguments[10],this.mat4[11]=arguments[11],this.mat4[12]=arguments[12],this.mat4[13]=arguments[13],this.mat4[14]=arguments[14],this.mat4[15]=arguments[15]),this}},{key:"get",value:function(){return new n.default.Matrix(this.mat4,this.p5)}},{key:"copy",value:function(){var e;return void 0!==this.mat3?((e=new n.default.Matrix("mat3",this.p5)).mat3[0]=this.mat3[0],e.mat3[1]=this.mat3[1],e.mat3[2]=this.mat3[2],e.mat3[3]=this.mat3[3],e.mat3[4]=this.mat3[4],e.mat3[5]=this.mat3[5],e.mat3[6]=this.mat3[6],e.mat3[7]=this.mat3[7],e.mat3[8]=this.mat3[8]):((e=new n.default.Matrix(this.p5)).mat4[0]=this.mat4[0],e.mat4[1]=this.mat4[1],e.mat4[2]=this.mat4[2],e.mat4[3]=this.mat4[3],e.mat4[4]=this.mat4[4],e.mat4[5]=this.mat4[5],e.mat4[6]=this.mat4[6],e.mat4[7]=this.mat4[7],e.mat4[8]=this.mat4[8],e.mat4[9]=this.mat4[9],e.mat4[10]=this.mat4[10],e.mat4[11]=this.mat4[11],e.mat4[12]=this.mat4[12],e.mat4[13]=this.mat4[13],e.mat4[14]=this.mat4[14],e.mat4[15]=this.mat4[15]),e}},{key:"transpose",value:function(e){var t,r,o,s,i,l;return e instanceof n.default.Matrix?(t=e.mat4[1],r=e.mat4[2],o=e.mat4[3],s=e.mat4[6],i=e.mat4[7],l=e.mat4[11],this.mat4[0]=e.mat4[0],this.mat4[1]=e.mat4[4],this.mat4[2]=e.mat4[8],this.mat4[3]=e.mat4[12],this.mat4[4]=t,this.mat4[5]=e.mat4[5],this.mat4[6]=e.mat4[9],this.mat4[7]=e.mat4[13],this.mat4[8]=r,this.mat4[9]=s,this.mat4[10]=e.mat4[10],this.mat4[11]=e.mat4[14],this.mat4[12]=o,this.mat4[13]=i,this.mat4[14]=l,this.mat4[15]=e.mat4[15]):a(e)&&(t=e[1],r=e[2],o=e[3],s=e[6],i=e[7],l=e[11],this.mat4[0]=e[0],this.mat4[1]=e[4],this.mat4[2]=e[8],this.mat4[3]=e[12],this.mat4[4]=t,this.mat4[5]=e[5],this.mat4[6]=e[9],this.mat4[7]=e[13],this.mat4[8]=r,this.mat4[9]=s,this.mat4[10]=e[10],this.mat4[11]=e[14],this.mat4[12]=o,this.mat4[13]=i,this.mat4[14]=l,this.mat4[15]=e[15]),this}},{key:"invert",value:function(e){e instanceof n.default.Matrix?(t=e.mat4[0],r=e.mat4[1],o=e.mat4[2],s=e.mat4[3],i=e.mat4[4],l=e.mat4[5],u=e.mat4[6],c=e.mat4[7],d=e.mat4[8],h=e.mat4[9],p=e.mat4[10],f=e.mat4[11],m=e.mat4[12],y=e.mat4[13],g=e.mat4[14],v=e.mat4[15]):a(e)&&(t=e[0],r=e[1],o=e[2],s=e[3],i=e[4],l=e[5],u=e[6],c=e[7],d=e[8],h=e[9],p=e[10],f=e[11],m=e[12],y=e[13],g=e[14],v=e[15]);var t,r,o,s,i,l,u,c,d,h,p,f,m,y,g,v,b=t*u-o*i,x=t*c-s*i,w=r*u-o*l,_=r*c-s*l,S=o*c-s*u,k=d*y-h*m,T=d*g-p*m,E=d*v-f*m,j=h*g-p*y,C=h*v-f*y,I=p*v-f*g,O=(e=t*l-r*i)*I-b*C+x*j+w*E-_*T+S*k;return O?(this.mat4[0]=(l*I-u*C+c*j)*(O=1/O),this.mat4[1]=(o*C-r*I-s*j)*O,this.mat4[2]=(y*S-g*_+v*w)*O,this.mat4[3]=(p*_-h*S-f*w)*O,this.mat4[4]=(u*E-i*I-c*T)*O,this.mat4[5]=(t*I-o*E+s*T)*O,this.mat4[6]=(g*x-m*S-v*b)*O,this.mat4[7]=(d*S-p*x+f*b)*O,this.mat4[8]=(i*C-l*E+c*k)*O,this.mat4[9]=(r*E-t*C-s*k)*O,this.mat4[10]=(m*_-y*x+v*e)*O,this.mat4[11]=(h*x-d*_-f*e)*O,this.mat4[12]=(l*T-i*j-u*k)*O,this.mat4[13]=(t*j-r*T+o*k)*O,this.mat4[14]=(y*b-m*w-g*e)*O,this.mat4[15]=(d*w-h*b+p*e)*O,this):null}},{key:"invert3x3",value:function(){var e=this.mat3[0],t=this.mat3[1],r=this.mat3[2],n=this.mat3[3],o=this.mat3[4],s=this.mat3[5],a=this.mat3[6],i=this.mat3[7],l=this.mat3[8],u=l*o-s*i,c=-l*n+s*a,d=i*n-o*a,h=e*u+t*c+r*d;return h?(this.mat3[0]=u*(h=1/h),this.mat3[1]=(-l*t+r*i)*h,this.mat3[2]=(s*t-r*o)*h,this.mat3[3]=c*h,this.mat3[4]=(l*e-r*a)*h,this.mat3[5]=(-s*e+r*n)*h,this.mat3[6]=d*h,this.mat3[7]=(-i*e+t*a)*h,this.mat3[8]=(o*e-t*n)*h,this):null}},{key:"transpose3x3",value:function(e){var t=(e=void 0===e?this.mat3:e)[1],r=e[2],n=e[5];return this.mat3[0]=e[0],this.mat3[1]=e[3],this.mat3[2]=e[6],this.mat3[3]=t,this.mat3[4]=e[4],this.mat3[5]=e[7],this.mat3[6]=r,this.mat3[7]=n,this.mat3[8]=e[8],this}},{key:"inverseTranspose",value:function(e){if(e=e.mat4,void 0===this.mat3?n.default._friendlyError("sorry, this function only works with mat3"):(this.mat3[0]=e[0],this.mat3[1]=e[1],this.mat3[2]=e[2],this.mat3[3]=e[4],this.mat3[4]=e[5],this.mat3[5]=e[6],this.mat3[6]=e[8],this.mat3[7]=e[9],this.mat3[8]=e[10]),e=this.invert3x3())e.transpose3x3(this.mat3);else for(var t=0;t<9;t++)this.mat3[t]=0;return this}},{key:"determinant",value:function(){var e=this.mat4[0]*this.mat4[5]-this.mat4[1]*this.mat4[4],t=this.mat4[0]*this.mat4[6]-this.mat4[2]*this.mat4[4],r=this.mat4[0]*this.mat4[7]-this.mat4[3]*this.mat4[4],n=this.mat4[1]*this.mat4[6]-this.mat4[2]*this.mat4[5],o=this.mat4[1]*this.mat4[7]-this.mat4[3]*this.mat4[5],s=this.mat4[2]*this.mat4[7]-this.mat4[3]*this.mat4[6],a=this.mat4[8]*this.mat4[13]-this.mat4[9]*this.mat4[12],i=this.mat4[8]*this.mat4[14]-this.mat4[10]*this.mat4[12],l=this.mat4[8]*this.mat4[15]-this.mat4[11]*this.mat4[12],u=this.mat4[9]*this.mat4[14]-this.mat4[10]*this.mat4[13],c=this.mat4[9]*this.mat4[15]-this.mat4[11]*this.mat4[13];return e*(this.mat4[10]*this.mat4[15]-this.mat4[11]*this.mat4[14])-t*c+r*u+n*l-o*i+s*a}},{key:"mult",value:function(e){var t;if(e===this||e===this.mat4)t=this.copy().mat4;else if(e instanceof n.default.Matrix)t=e.mat4;else if(a(e))t=e;else{if(16!==arguments.length)return;t=arguments}e=this.mat4[0];var r=this.mat4[1],o=this.mat4[2],s=this.mat4[3];return this.mat4[0]=e*t[0]+r*t[4]+o*t[8]+s*t[12],this.mat4[1]=e*t[1]+r*t[5]+o*t[9]+s*t[13],this.mat4[2]=e*t[2]+r*t[6]+o*t[10]+s*t[14],this.mat4[3]=e*t[3]+r*t[7]+o*t[11]+s*t[15],e=this.mat4[4],r=this.mat4[5],o=this.mat4[6],s=this.mat4[7],this.mat4[4]=e*t[0]+r*t[4]+o*t[8]+s*t[12],this.mat4[5]=e*t[1]+r*t[5]+o*t[9]+s*t[13],this.mat4[6]=e*t[2]+r*t[6]+o*t[10]+s*t[14],this.mat4[7]=e*t[3]+r*t[7]+o*t[11]+s*t[15],e=this.mat4[8],r=this.mat4[9],o=this.mat4[10],s=this.mat4[11],this.mat4[8]=e*t[0]+r*t[4]+o*t[8]+s*t[12],this.mat4[9]=e*t[1]+r*t[5]+o*t[9]+s*t[13],this.mat4[10]=e*t[2]+r*t[6]+o*t[10]+s*t[14],this.mat4[11]=e*t[3]+r*t[7]+o*t[11]+s*t[15],e=this.mat4[12],r=this.mat4[13],o=this.mat4[14],s=this.mat4[15],this.mat4[12]=e*t[0]+r*t[4]+o*t[8]+s*t[12],this.mat4[13]=e*t[1]+r*t[5]+o*t[9]+s*t[13],this.mat4[14]=e*t[2]+r*t[6]+o*t[10]+s*t[14],this.mat4[15]=e*t[3]+r*t[7]+o*t[11]+s*t[15],this}},{key:"apply",value:function(e){var t;if(e===this||e===this.mat4)t=this.copy().mat4;else if(e instanceof n.default.Matrix)t=e.mat4;else if(a(e))t=e;else{if(16!==arguments.length)return;t=arguments}var r=(e=this.mat4)[0],o=e[4],s=e[8],i=e[12];return e[0]=t[0]*r+t[1]*o+t[2]*s+t[3]*i,e[4]=t[4]*r+t[5]*o+t[6]*s+t[7]*i,e[8]=t[8]*r+t[9]*o+t[10]*s+t[11]*i,e[12]=t[12]*r+t[13]*o+t[14]*s+t[15]*i,r=e[1],o=e[5],s=e[9],i=e[13],e[1]=t[0]*r+t[1]*o+t[2]*s+t[3]*i,e[5]=t[4]*r+t[5]*o+t[6]*s+t[7]*i,e[9]=t[8]*r+t[9]*o+t[10]*s+t[11]*i,e[13]=t[12]*r+t[13]*o+t[14]*s+t[15]*i,r=e[2],o=e[6],s=e[10],i=e[14],e[2]=t[0]*r+t[1]*o+t[2]*s+t[3]*i,e[6]=t[4]*r+t[5]*o+t[6]*s+t[7]*i,e[10]=t[8]*r+t[9]*o+t[10]*s+t[11]*i,e[14]=t[12]*r+t[13]*o+t[14]*s+t[15]*i,r=e[3],o=e[7],s=e[11],i=e[15],e[3]=t[0]*r+t[1]*o+t[2]*s+t[3]*i,e[7]=t[4]*r+t[5]*o+t[6]*s+t[7]*i,e[11]=t[8]*r+t[9]*o+t[10]*s+t[11]*i,e[15]=t[12]*r+t[13]*o+t[14]*s+t[15]*i,this}},{key:"scale",value:function(e,t,r){return e instanceof n.default.Vector?(t=e.y,r=e.z,e=e.x):e instanceof Array&&(t=e[1],r=e[2],e=e[0]),this.mat4[0]*=e,this.mat4[1]*=e,this.mat4[2]*=e,this.mat4[3]*=e,this.mat4[4]*=t,this.mat4[5]*=t,this.mat4[6]*=t,this.mat4[7]*=t,this.mat4[8]*=r,this.mat4[9]*=r,this.mat4[10]*=r,this.mat4[11]*=r,this}},{key:"rotate",value:function(e,t,r,o){t instanceof n.default.Vector?(r=t.y,o=t.z,t=t.x):t instanceof Array&&(r=t[1],o=t[2],t=t[0]);var s=(t*=1/(s=Math.sqrt(t*t+r*r+o*o)),r*=1/s,o*=1/s,this.mat4[0]),a=this.mat4[1],i=this.mat4[2],l=this.mat4[3],u=this.mat4[4],c=this.mat4[5],d=this.mat4[6],h=this.mat4[7],p=this.mat4[8],f=this.mat4[9],m=this.mat4[10],y=this.mat4[11],g=Math.sin(e),v=1-(e=Math.cos(e)),b=t*t*v+e,x=r*t*v+o*g,w=o*t*v-r*g,_=t*r*v-o*g,S=r*r*v+e,k=o*r*v+t*g,T=t*o*v+r*g;return r=r*o*v-t*g,t=o*o*v+e,this.mat4[0]=s*b+u*x+p*w,this.mat4[1]=a*b+c*x+f*w,this.mat4[2]=i*b+d*x+m*w,this.mat4[3]=l*b+h*x+y*w,this.mat4[4]=s*_+u*S+p*k,this.mat4[5]=a*_+c*S+f*k,this.mat4[6]=i*_+d*S+m*k,this.mat4[7]=l*_+h*S+y*k,this.mat4[8]=s*T+u*r+p*t,this.mat4[9]=a*T+c*r+f*t,this.mat4[10]=i*T+d*r+m*t,this.mat4[11]=l*T+h*r+y*t,this}},{key:"translate",value:function(e){var t=e[0],r=e[1];e=e[2]||0,this.mat4[12]+=this.mat4[0]*t+this.mat4[4]*r+this.mat4[8]*e,this.mat4[13]+=this.mat4[1]*t+this.mat4[5]*r+this.mat4[9]*e,this.mat4[14]+=this.mat4[2]*t+this.mat4[6]*r+this.mat4[10]*e,this.mat4[15]+=this.mat4[3]*t+this.mat4[7]*r+this.mat4[11]*e}},{key:"rotateX",value:function(e){this.rotate(e,1,0,0)}},{key:"rotateY",value:function(e){this.rotate(e,0,1,0)}},{key:"rotateZ",value:function(e){this.rotate(e,0,0,1)}},{key:"perspective",value:function(e,t,r,n){e=1/Math.tan(e/2);var o=1/(r-n);return this.mat4[0]=e/t,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=e,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=(n+r)*o,this.mat4[11]=-1,this.mat4[12]=0,this.mat4[13]=0,this.mat4[14]=2*n*r*o,this.mat4[15]=0,this}},{key:"ortho",value:function(e,t,r,n,o,s){var a=1/(e-t),i=1/(r-n),l=1/(o-s);return this.mat4[0]=-2*a,this.mat4[1]=0,this.mat4[2]=0,this.mat4[3]=0,this.mat4[4]=0,this.mat4[5]=-2*i,this.mat4[6]=0,this.mat4[7]=0,this.mat4[8]=0,this.mat4[9]=0,this.mat4[10]=2*l,this.mat4[11]=0,this.mat4[12]=(e+t)*a,this.mat4[13]=(n+r)*i,this.mat4[14]=(s+o)*l,this.mat4[15]=1,this}},{key:"multiplyVec4",value:function(e,t,r,n){var o=new Array(4),s=this.mat4;return o[0]=s[0]*e+s[4]*t+s[8]*r+s[12]*n,o[1]=s[1]*e+s[5]*t+s[9]*r+s[13]*n,o[2]=s[2]*e+s[6]*t+s[10]*r+s[14]*n,o[3]=s[3]*e+s[7]*t+s[11]*r+s[15]*n,o}},{key:"multiplyPoint",value:function(e){var t=e.x,r=e.y;return e=e.z,t=this.multiplyVec4(t,r,e,1),new n.default.Vector(t[0],t[1],t[2])}},{key:"multiplyAndNormalizePoint",value:function(e){var t=e.x,r=e.y;return e=e.z,(t=this.multiplyVec4(t,r,e,1))[0]/=t[3],t[1]/=t[3],t[2]/=t[3],new n.default.Vector(t[0],t[1],t[2])}},{key:"multiplyDirection",value:function(e){var t=e.x,r=e.y;return e=e.z,t=this.multiplyVec4(t,r,e,0),new n.default.Vector(t[0],t[1],t[2])}},{key:"mult3x3",value:function(e){var t;if(e===this||e===this.mat3)t=this.copy().mat3;else if(e instanceof n.default.Matrix)t=e.mat3;else if(a(e))t=e;else{if(9!==arguments.length)return;t=arguments}e=this.mat3[0];var r=this.mat3[1],o=this.mat3[2];return this.mat3[0]=e*t[0]+r*t[3]+o*t[6],this.mat3[1]=e*t[1]+r*t[4]+o*t[7],this.mat3[2]=e*t[2]+r*t[5]+o*t[8],e=this.mat3[3],r=this.mat3[4],o=this.mat3[5],this.mat3[3]=e*t[0]+r*t[3]+o*t[6],this.mat3[4]=e*t[1]+r*t[4]+o*t[7],this.mat3[5]=e*t[2]+r*t[5]+o*t[8],e=this.mat3[6],r=this.mat3[7],o=this.mat3[8],this.mat3[6]=e*t[0]+r*t[3]+o*t[6],this.mat3[7]=e*t[1]+r*t[4]+o*t[7],this.mat3[8]=e*t[2]+r*t[5]+o*t[8],this}},{key:"column",value:function(e){return new n.default.Vector(this.mat3[e],this.mat3[e+3],this.mat3[e+6])}},{key:"row",value:function(e){return new n.default.Vector(this.mat3[3*e],this.mat3[3*e+1],this.mat3[3*e+2])}},{key:"diagonal",value:function(){return void 0!==this.mat3?[this.mat3[0],this.mat3[4],this.mat3[8]]:[this.mat4[0],this.mat4[5],this.mat4[10],this.mat4[15]]}},{key:"multiplyVec3",value:function(e,t){return(t=void 0===t?e.copy():t).x=this.row(0).dot(e),t.y=this.row(1).dot(e),t.z=this.row(2).dot(e),t}},{key:"createSubMatrix3x3",value:function(){var e=new n.default.Matrix("mat3");return e.mat3[0]=this.mat4[0],e.mat3[1]=this.mat4[1],e.mat3[2]=this.mat4[2],e.mat3[3]=this.mat4[4],e.mat3[4]=this.mat4[5],e.mat3[5]=this.mat4[6],e.mat3[6]=this.mat4[8],e.mat3[7]=this.mat4[9],e.mat3[8]=this.mat4[10],e}}])&&o(t.prototype,r),i&&o(t,i),e}(),e=n.default.Matrix,r.default=e},{"../core/main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.to-string":180,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.float32-array":209,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229}],325:[function(e,t,r){"use strict";e("core-js/modules/es.array.map"),e("core-js/modules/es.array.map"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0,(e=(e=e("../core/main"))&&e.__esModule?e:{default:e}).default.RenderBuffer=function(){function e(t,r,n,o,s,a){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.size=t,this.src=r,this.dst=n,this.attr=o,this._renderer=s,this.map=a}var t;return(t=[{key:"_prepareBuffer",value:function(e,t){var r,n,o,s=t.attributes,a=this._renderer.GL,i=e.model||e;(s=s[this.attr])&&(r=e[this.dst],0<(n=i[this.src]).length?((o=!r)&&(e[this.dst]=r=a.createBuffer()),a.bindBuffer(a.ARRAY_BUFFER,r),!o&&!1===i.dirtyFlags[this.src]||(o=(e=this.map)?e(n):n,this._renderer._bindBuffer(r,a.ARRAY_BUFFER,o),i.dirtyFlags[this.src]=!1),t.enableAttrib(s,this.size)):-1!==(e=s.location)&&this._renderer.registerEnabled[e]&&(a.disableVertexAttribArray(e),this._renderer.registerEnabled[e]=!1))}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=e.default.RenderBuffer,r.default=e},{"../core/main":273,"core-js/modules/es.array.map":163}],326:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.map"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(c=e("../core/main"))&&c.__esModule?c:{default:c},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}e("./p5.RenderBuffer"),s.default.RendererGL.prototype.beginShape=function(e){return this.immediateMode.shapeMode=void 0!==e?e:a.TESS,this.immediateMode.geometry.reset(),this};var u={vertices:1,vertexNormals:1,vertexColors:4,vertexStrokeColors:4,uvs:2},c=(s.default.RendererGL.prototype.vertex=function(e,t){if(this.immediateMode.shapeMode===a.QUADS&&this.immediateMode.geometry.vertices.length%6==3)for(var r in u){var n=u[r];(r=this.immediateMode.geometry[r]).push.apply(r,l(r.slice(r.length-3*n,r.length-2*n)).concat(l(r.slice(r.length-n,r.length))))}var o,i,c=o=i=0,d=(3===arguments.length?c=arguments[2]:4===arguments.length?(o=arguments[2],i=arguments[3]):5===arguments.length&&(c=arguments[2],o=arguments[3],i=arguments[4]),new s.default.Vector(e,t,c));return this.immediateMode.geometry.vertices.push(d),this.immediateMode.geometry.vertexNormals.push(this._currentNormal),d=this.curFillColor||[.5,.5,.5,1],this.immediateMode.geometry.vertexColors.push(d[0],d[1],d[2],d[3]),d=this.curStrokeColor||[.5,.5,.5,1],this.immediateMode.geometry.vertexStrokeColors.push(d[0],d[1],d[2],d[3]),this.textureMode===a.IMAGE&&(null!==this._tex?0<this._tex.width&&0<this._tex.height&&(o/=this._tex.width,i/=this._tex.height):!this.isProcessingVertices&&null===this._tex&&4<=arguments.length&&console.warn("You must first call texture() before using vertex() with image based u and v coordinates")),this.immediateMode.geometry.uvs.push(o,i),this.immediateMode._bezierVertex[0]=e,this.immediateMode._bezierVertex[1]=t,this.immediateMode._bezierVertex[2]=c,this.immediateMode._quadraticVertex[0]=e,this.immediateMode._quadraticVertex[1]=t,this.immediateMode._quadraticVertex[2]=c,this},s.default.RendererGL.prototype.normal=function(e,t,r){return e instanceof s.default.Vector?this._currentNormal=e:this._currentNormal=new s.default.Vector(e,t,r),this},s.default.RendererGL.prototype.endShape=function(e,t,r,n,o,s){return this.immediateMode.shapeMode===a.POINTS?this._drawPoints(this.immediateMode.geometry.vertices,this.immediateMode.buffers.point):(this.isProcessingVertices=!0,this._processVertices.apply(this,arguments),this.isProcessingVertices=!1,this._doFill&&1<this.immediateMode.geometry.vertices.length&&this._drawImmediateFill(),this._doStroke&&1<this.immediateMode.geometry.lineVertices.length&&this._drawImmediateStroke(),this.isBezier=!1,this.isQuadratic=!1,this.isCurve=!1,this.immediateMode._bezierVertex.length=0,this.immediateMode._quadraticVertex.length=0,this.immediateMode._curveVertex.length=0),this},s.default.RendererGL.prototype._processVertices=function(e){var t;0!==this.immediateMode.geometry.vertices.length&&(t=this._doStroke,e=e===a.CLOSE,t&&(this.immediateMode.geometry.edges=this._calculateEdges(this.immediateMode.shapeMode,this.immediateMode.geometry.vertices,e),this.immediateMode.geometry._edgesToVertices()),t=this.immediateMode.shapeMode===a.TESS,this._doFill&&(this.isBezier||this.isQuadratic||this.isCurve||t)&&this.immediateMode.shapeMode!==a.LINES&&this._tesselateShape())},s.default.RendererGL.prototype._calculateEdges=function(e,t,r){var n=[],o=0;switch(e){case a.TRIANGLE_STRIP:for(o=0;o<t.length-2;o++)n.push([o,o+1]),n.push([o,o+2]);n.push([o,o+1]);break;case a.TRIANGLE_FAN:for(o=1;o<t.length-1;o++)n.push([0,o]),n.push([o,o+1]);n.push([0,t.length-1]);break;case a.TRIANGLES:for(o=0;o<t.length-2;o+=3)n.push([o,o+1]),n.push([o+1,o+2]),n.push([o+2,o]);break;case a.LINES:for(o=0;o<t.length-1;o+=2)n.push([o,o+1]);break;case a.QUADS:for(o=0;o<t.length-5;o+=6)n.push([o,o+1]),n.push([o+1,o+2]),n.push([o+3,o+5]),n.push([o+4,o+5]);break;case a.QUAD_STRIP:for(o=0;o<t.length-2;o+=2)n.push([o,o+1]),n.push([o,o+2]),n.push([o+1,o+3]);n.push([o,o+1]);break;default:for(o=0;o<t.length-1;o++)n.push([o,o+1])}return r&&n.push([t.length-1,0]),n},s.default.RendererGL.prototype._tesselateShape=function(){for(var e=this,t=(this.immediateMode.shapeMode=a.TRIANGLES,[this._flatten(this.immediateMode.geometry.vertices.map((function(t,r){return[t.x,t.y,t.z,e.immediateMode.geometry.uvs[2*r],e.immediateMode.geometry.uvs[2*r+1],e.immediateMode.geometry.vertexColors[4*r],e.immediateMode.geometry.vertexColors[4*r+1],e.immediateMode.geometry.vertexColors[4*r+2],e.immediateMode.geometry.vertexColors[4*r+3],e.immediateMode.geometry.vertexNormals[r].x,e.immediateMode.geometry.vertexNormals[r].y,e.immediateMode.geometry.vertexNormals[r].z]})))]),r=this._triangulate(t),n=(this.immediateMode.geometry.vertices=[],this.immediateMode.geometry.vertexNormals=[],this.immediateMode.geometry.uvs=[],[]),o=0,i=r.length;o<i;o+=s.default.RendererGL.prototype.tessyVertexSize)n.push.apply(n,l(r.slice(o+5,o+9))),this.normal.apply(this,l(r.slice(o+9,o+12))),this.vertex.apply(this,l(r.slice(o,o+5)));this.immediateMode.geometry.vertexColors=n},s.default.RendererGL.prototype._drawImmediateFill=function(){var e=this.GL,t=(this._useVertexColor=0<this.immediateMode.geometry.vertexColors.length,this._getImmediateFillShader()),r=(this._setFillUniforms(t),!0),n=!1,o=void 0;try{for(var s,i=this.immediateMode.buffers.fill[Symbol.iterator]();!(r=(s=i.next()).done);r=!0)s.value._prepareBuffer(this.immediateMode.geometry,t)}catch(e){n=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}this.immediateMode.shapeMode!==a.LINE_STRIP&&this.immediateMode.shapeMode!==a.LINES||(this.immediateMode.shapeMode=a.TRIANGLE_FAN),this.immediateMode.shapeMode===a.QUADS?this.immediateMode.shapeMode=a.TRIANGLES:this.immediateMode.shapeMode===a.QUAD_STRIP&&(this.immediateMode.shapeMode=a.TRIANGLE_STRIP),this._applyColorBlend(this.curFillColor),e.drawArrays(this.immediateMode.shapeMode,0,this.immediateMode.geometry.vertices.length),t.unbindShader()},s.default.RendererGL.prototype._drawImmediateStroke=function(){var e=this.GL,t=e.isEnabled(e.CULL_FACE),r=(e.disable(e.CULL_FACE),this._getImmediateStrokeShader()),n=(this._useLineColor=0<this.immediateMode.geometry.vertexStrokeColors.length,this._setStrokeUniforms(r),!0),o=!1,s=void 0;try{for(var a,i=this.immediateMode.buffers.stroke[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)a.value._prepareBuffer(this.immediateMode.geometry,r)}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}this._applyColorBlend(this.curStrokeColor),e.drawArrays(e.TRIANGLES,0,this.immediateMode.geometry.lineVertices.length),t&&e.enable(e.CULL_FACE),r.unbindShader()},s.default.RendererGL);r.default=c},{"../core/constants":262,"../core/main":273,"./p5.RenderBuffer":325,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.from":157,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.map":163,"core-js/modules/es.array.slice":164,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],327:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.some"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.some"),e("core-js/modules/es.object.keys"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var s=(u=e("../core/main"))&&u.__esModule?u:{default:u},a=(e("./p5.RendererGL"),e("./p5.RenderBuffer"),function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}var l=0,u=(s.default.RendererGL.prototype._initBufferDefaults=function(e){var t;return this._freeBuffers(e),1e3<++l&&(t=Object.keys(this.retainedMode.geometry)[0],delete this.retainedMode.geometry[t],l--),this.retainedMode.geometry[e]={}},s.default.RendererGL.prototype._freeBuffers=function(e){var t,r=this.retainedMode.geometry[e];function n(e){var n=!0,o=!1,s=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done);n=!0){var l=a.value;r[l.dst]&&(t.deleteBuffer(r[l.dst]),r[l.dst]=null)}}catch(e){o=!0,s=e}finally{try{n||null==i.return||i.return()}finally{if(o)throw s}}}r&&(delete this.retainedMode.geometry[e],l--,t=this.GL,r.indexBuffer&&t.deleteBuffer(r.indexBuffer),n(this.retainedMode.buffers.stroke),n(this.retainedMode.buffers.fill))},s.default.RendererGL.prototype.createBuffers=function(e,t){var r,n,o,a=this.GL,i=((e=this._initBufferDefaults(e)).model=t,e.indexBuffer);return t.faces.length?(i=i||(e.indexBuffer=a.createBuffer()),o=(n=(r=s.default.RendererGL.prototype._flatten(t.faces)).some((function(e){return 65535<e})))?Uint32Array:Uint16Array,this._bindBuffer(i,a.ELEMENT_ARRAY_BUFFER,r,o),e.indexBufferType=n?a.UNSIGNED_INT:a.UNSIGNED_SHORT,e.vertexCount=3*t.faces.length):(i&&(a.deleteBuffer(i),e.indexBuffer=null),e.vertexCount=t.vertices?t.vertices.length:0),e.lineVertexCount=t.lineVertices?t.lineVertices.length:0,e},s.default.RendererGL.prototype.drawBuffers=function(e){var t=this.GL,r=this.retainedMode.geometry[e];if(this._doFill){this._useVertexColor=0<r.model.vertexColors.length;var n=this._getRetainedFillShader(),o=(this._setFillUniforms(n),!0),s=!1,a=void 0;try{for(var i,l=this.retainedMode.buffers.fill[Symbol.iterator]();!(o=(i=l.next()).done);o=!0)i.value._prepareBuffer(r,n)}catch(e){s=!0,a=e}finally{try{o||null==l.return||l.return()}finally{if(s)throw a}}r.indexBuffer&&this._bindBuffer(r.indexBuffer,t.ELEMENT_ARRAY_BUFFER),this._applyColorBlend(this.curFillColor),this._drawElements(t.TRIANGLES,e),n.unbindShader()}if(this._doStroke&&0<r.lineVertexCount){s=t.isEnabled(t.CULL_FACE);var u=(t.disable(t.CULL_FACE),this._getRetainedStrokeShader()),c=(this._useLineColor=0<r.model.vertexStrokeColors.length,this._setStrokeUniforms(u),!0),d=void(a=!1);try{for(var h,p=this.retainedMode.buffers.stroke[Symbol.iterator]();!(c=(h=p.next()).done);c=!0)h.value._prepareBuffer(r,u)}catch(e){a=!0,d=e}finally{try{c||null==p.return||p.return()}finally{if(a)throw d}}this._applyColorBlend(this.curStrokeColor),this._drawArrays(t.TRIANGLES,e),s&&t.enable(t.CULL_FACE),u.unbindShader()}return this},s.default.RendererGL.prototype.drawBuffersScaled=function(e,t,r,n){var o=this.uMVMatrix.copy();try{this.uMVMatrix.scale(t,r,n),this.drawBuffers(e)}finally{this.uMVMatrix=o}},s.default.RendererGL.prototype._drawArrays=function(e,t){return this.GL.drawArrays(e,0,this.retainedMode.geometry[t].lineVertexCount),this},s.default.RendererGL.prototype._drawElements=function(e,t){t=this.retainedMode.geometry[t];var r=this.GL;if(t.indexBuffer){if(this._pInst.webglVersion!==a.WEBGL2&&t.indexBufferType===r.UNSIGNED_INT&&!r.getExtension("OES_element_index_uint"))throw new Error("Unable to render a 3d model with > 65535 triangles. Your web browser does not support the WebGL Extension OES_element_index_uint.");r.drawElements(r.TRIANGLES,t.vertexCount,t.indexBufferType,0)}else r.drawArrays(e||r.TRIANGLES,0,t.vertexCount)},s.default.RendererGL.prototype._drawPoints=function(e,t){var r=this.GL,n=this._getImmediatePointShader();this._setPointUniforms(n),this._bindBuffer(t,r.ARRAY_BUFFER,this._vToNArray(e),Float32Array,r.STATIC_DRAW),n.enableAttrib(n.attributes.aPosition,3),this._applyColorBlend(this.curStrokeColor),r.drawArrays(r.Points,0,e.length),n.unbindShader()},s.default.RendererGL);r.default=u},{"../core/constants":262,"../core/main":273,"./p5.RenderBuffer":325,"./p5.RendererGL":328,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.some":165,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.keys":179,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.float32-array":209,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint16-array":230,"core-js/modules/es.typed-array.uint32-array":231,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],328:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.copy-within"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.map"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.float64-array"),e("core-js/modules/es.typed-array.int16-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.concat"),e("core-js/modules/es.array.copy-within"),e("core-js/modules/es.array.every"),e("core-js/modules/es.array.fill"),e("core-js/modules/es.array.from"),e("core-js/modules/es.array.includes"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.array.some"),e("core-js/modules/es.map"),e("core-js/modules/es.object.assign"),e("core-js/modules/es.object.get-prototype-of"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.reflect.construct"),e("core-js/modules/es.regexp.to-string"),e("core-js/modules/es.set"),e("core-js/modules/es.string.includes"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.float32-array"),e("core-js/modules/es.typed-array.float64-array"),e("core-js/modules/es.typed-array.int16-array"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.uint16-array"),e("core-js/modules/es.typed-array.uint32-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.readPixelsWebGL=_,r.readPixelWebGL=S,r.default=void 0;var o=l(e("../core/main")),s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==u(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var s;Object.prototype.hasOwnProperty.call(e,r)&&((s=o?Object.getOwnPropertyDescriptor(e,r):null)&&(s.get||s.set)?Object.defineProperty(n,r,s):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants")),a=l(e("libtess"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return(u="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}function c(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return function(){var t,r,n=f(e);return t=function(){if("undefined"!=typeof Reflect&&Reflect.construct&&!Reflect.construct.sham){if("function"==typeof Proxy)return 1;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),1}catch(e){}}}()?(t=f(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments),n=this,!(r=t)||"object"!==u(r)&&"function"!=typeof r?p(n):r}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function m(e,t){b+="#define STROKE_CAP_".concat(e," ").concat(t,"\n"),g[s[e]]=t}function y(e,t){b+="#define STROKE_JOIN_".concat(e," ").concat(t,"\n"),v[s[e]]=t}e("./p5.Shader"),e("./p5.Camera"),e("../core/p5.Renderer"),e("./p5.Matrix"),e("path");var g={},v={},b="",x="#ifdef WEBGL2\n\n#define IN in\n#define OUT out\n\n#ifdef FRAGMENT_SHADER\nout vec4 outColor;\n#define OUT_COLOR outColor\n#endif\n#define TEXTURE texture\n\n#else\n\n#ifdef FRAGMENT_SHADER\n#define IN varying\n#else\n#define IN attribute\n#endif\n#define OUT varying\n#define TEXTURE texture2D\n\n#ifdef FRAGMENT_SHADER\n#define OUT_COLOR gl_FragColor\n#endif\n\n#endif\n",w={immediateVert:"attribute vec3 aPosition;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uResolution;\nuniform float uPointSize;\n\nvarying vec4 vColor;\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n  gl_PointSize = uPointSize;\n}\n",vertexColorVert:"attribute vec3 aPosition;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vColor = aVertexColor;\n}\n",vertexColorFrag:"precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n  gl_FragColor = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",normalVert:"attribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform vec4 uMaterialColor;\nuniform bool uUseVertexColor;\n\nvarying vec3 vVertexNormal;\nvarying highp vec2 vVertTexCoord;\nvarying vec4 vColor;\n\nvoid main(void) {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vVertexNormal = normalize(vec3( uNormalMatrix * aNormal ));\n  vVertTexCoord = aTexCoord;\n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",normalFrag:"precision mediump float;\nvarying vec3 vVertexNormal;\nvoid main(void) {\n  gl_FragColor = vec4(vVertexNormal, 1.0);\n}",basicFrag:"precision mediump float;\nvarying vec4 vColor;\nvoid main(void) {\n  gl_FragColor = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",lightVert:(m("ROUND",0),m("PROJECT",1),m("SQUARE",2),y("ROUND",0),y("MITER",1),y("BEVEL",2),(e="precision highp float;\nprecision highp int;\n\nuniform mat4 uViewMatrix;\n\nuniform bool uUseLighting;\n\nuniform int uAmbientLightCount;\nuniform vec3 uAmbientColor[5];\n\nuniform int uDirectionalLightCount;\nuniform vec3 uLightingDirection[5];\nuniform vec3 uDirectionalDiffuseColors[5];\nuniform vec3 uDirectionalSpecularColors[5];\n\nuniform int uPointLightCount;\nuniform vec3 uPointLightLocation[5];\nuniform vec3 uPointLightDiffuseColors[5];\t\nuniform vec3 uPointLightSpecularColors[5];\n\nuniform int uSpotLightCount;\nuniform float uSpotLightAngle[5];\nuniform float uSpotLightConc[5];\nuniform vec3 uSpotLightDiffuseColors[5];\nuniform vec3 uSpotLightSpecularColors[5];\nuniform vec3 uSpotLightLocation[5];\nuniform vec3 uSpotLightDirection[5];\n\nuniform bool uSpecular;\nuniform float uShininess;\n\nuniform float uConstantAttenuation;\nuniform float uLinearAttenuation;\nuniform float uQuadraticAttenuation;\n\nconst float specularFactor = 2.0;\nconst float diffuseFactor = 0.73;\n\nstruct LightResult {\n  float specular;\n  float diffuse;\n};\n\nfloat _phongSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float shininess) {\n\n  vec3 R = reflect(lightDirection, surfaceNormal);\n  return pow(max(0.0, dot(R, viewDirection)), shininess);\n}\n\nfloat _lambertDiffuse(vec3 lightDirection, vec3 surfaceNormal) {\n  return max(0.0, dot(-lightDirection, surfaceNormal));\n}\n\nLightResult _light(vec3 viewDirection, vec3 normal, vec3 lightVector) {\n\n  vec3 lightDir = normalize(lightVector);\n\n  //compute our diffuse & specular terms\n  LightResult lr;\n  if (uSpecular)\n    lr.specular = _phongSpecular(lightDir, viewDirection, normal, uShininess);\n  lr.diffuse = _lambertDiffuse(lightDir, normal);\n  return lr;\n}\n\nvoid totalLight(\n  vec3 modelPosition,\n  vec3 normal,\n  out vec3 totalDiffuse,\n  out vec3 totalSpecular\n) {\n\n  totalSpecular = vec3(0.0);\n\n  if (!uUseLighting) {\n    totalDiffuse = vec3(1.0);\n    return;\n  }\n\n  totalDiffuse = vec3(0.0);\n\n  vec3 viewDirection = normalize(-modelPosition);\n\n  for (int j = 0; j < 5; j++) {\n    if (j < uDirectionalLightCount) {\n      vec3 lightVector = (uViewMatrix * vec4(uLightingDirection[j], 0.0)).xyz;\n      vec3 lightColor = uDirectionalDiffuseColors[j];\n      vec3 specularColor = uDirectionalSpecularColors[j];\n      LightResult result = _light(viewDirection, normal, lightVector);\n      totalDiffuse += result.diffuse * lightColor;\n      totalSpecular += result.specular * lightColor * specularColor;\n    }\n\n    if (j < uPointLightCount) {\n      vec3 lightPosition = (uViewMatrix * vec4(uPointLightLocation[j], 1.0)).xyz;\n      vec3 lightVector = modelPosition - lightPosition;\n    \n      //calculate attenuation\n      float lightDistance = length(lightVector);\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\n      vec3 lightColor = lightFalloff * uPointLightDiffuseColors[j];\n      vec3 specularColor = lightFalloff * uPointLightSpecularColors[j];\n\n      LightResult result = _light(viewDirection, normal, lightVector);\n      totalDiffuse += result.diffuse * lightColor;\n      totalSpecular += result.specular * lightColor * specularColor;\n    }\n\n    if(j < uSpotLightCount) {\n      vec3 lightPosition = (uViewMatrix * vec4(uSpotLightLocation[j], 1.0)).xyz;\n      vec3 lightVector = modelPosition - lightPosition;\n    \n      float lightDistance = length(lightVector);\n      float lightFalloff = 1.0 / (uConstantAttenuation + lightDistance * uLinearAttenuation + (lightDistance * lightDistance) * uQuadraticAttenuation);\n\n      vec3 lightDirection = (uViewMatrix * vec4(uSpotLightDirection[j], 0.0)).xyz;\n      float spotDot = dot(normalize(lightVector), normalize(lightDirection));\n      float spotFalloff;\n      if(spotDot < uSpotLightAngle[j]) {\n        spotFalloff = 0.0;\n      }\n      else {\n        spotFalloff = pow(spotDot, uSpotLightConc[j]);\n      }\n      lightFalloff *= spotFalloff;\n\n      vec3 lightColor = uSpotLightDiffuseColors[j];\n      vec3 specularColor = uSpotLightSpecularColors[j];\n     \n      LightResult result = _light(viewDirection, normal, lightVector);\n      \n      totalDiffuse += result.diffuse * lightColor * lightFalloff;\n      totalSpecular += result.specular * lightColor * specularColor * lightFalloff;\n    }\n  }\n\n  totalDiffuse *= diffuseFactor;\n  totalSpecular *= specularFactor;\n}\n")+"// include lighting.glgl\n\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\nattribute vec4 aVertexColor;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform bool uUseVertexColor;\nuniform vec4 uMaterialColor;\n\nvarying highp vec2 vVertTexCoord;\nvarying vec3 vDiffuseColor;\nvarying vec3 vSpecularColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n  gl_Position = uProjectionMatrix * viewModelPosition;\n\n  vec3 vertexNormal = normalize(uNormalMatrix * aNormal);\n  vVertTexCoord = aTexCoord;\n\n  totalLight(viewModelPosition.xyz, vertexNormal, vDiffuseColor, vSpecularColor);\n\n  for (int i = 0; i < 8; i++) {\n    if (i < uAmbientLightCount) {\n      vDiffuseColor += uAmbientColor[i];\n    }\n  }\n  \n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n"),lightTextureFrag:"precision highp float;\n\nuniform vec4 uTint;\nuniform sampler2D uSampler;\nuniform bool isTexture;\nuniform bool uEmissive;\n\nvarying highp vec2 vVertTexCoord;\nvarying vec3 vDiffuseColor;\nvarying vec3 vSpecularColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n  if(uEmissive && !isTexture) {\n    gl_FragColor = vColor;\n  }\n  else {\n    vec4 baseColor = isTexture\n      // Textures come in with premultiplied alpha. To apply tint and still have\n      // premultiplied alpha output, we need to multiply the RGB channels by the\n      // tint RGB, and all channels by the tint alpha.\n      ? texture2D(uSampler, vVertTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)\n      // Colors come in with unmultiplied alpha, so we need to multiply the RGB\n      // channels by alpha to convert it to premultiplied alpha.\n      : vec4(vColor.rgb * vColor.a, vColor.a);\n    gl_FragColor = vec4(baseColor.rgb * vDiffuseColor + vSpecularColor, baseColor.a);\n  }\n}\n",phongVert:"precision highp float;\nprecision highp int;\n\nattribute vec3 aPosition;\nattribute vec3 aNormal;\nattribute vec2 aTexCoord;\nattribute vec4 aVertexColor;\n\nuniform vec3 uAmbientColor[5];\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\nuniform int uAmbientLightCount;\n\nuniform bool uUseVertexColor;\nuniform vec4 uMaterialColor;\n\nvarying vec3 vNormal;\nvarying vec2 vTexCoord;\nvarying vec3 vViewPosition;\nvarying vec3 vAmbientColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  vec4 viewModelPosition = uModelViewMatrix * vec4(aPosition, 1.0);\n\n  // Pass varyings to fragment shader\n  vViewPosition = viewModelPosition.xyz;\n  gl_Position = uProjectionMatrix * viewModelPosition;  \n\n  vNormal = uNormalMatrix * aNormal;\n  vTexCoord = aTexCoord;\n\n  // TODO: this should be a uniform\n  vAmbientColor = vec3(0.0);\n  for (int i = 0; i < 5; i++) {\n    if (i < uAmbientLightCount) {\n      vAmbientColor += uAmbientColor[i];\n    }\n  }\n  \n  vColor = (uUseVertexColor ? aVertexColor : uMaterialColor);\n}\n",phongFrag:e+"// include lighting.glsl\nprecision highp float;\nprecision highp int;\n\nuniform bool uHasSetAmbient;\nuniform vec4 uSpecularMatColor;\nuniform vec4 uAmbientMatColor;\nuniform vec4 uEmissiveMatColor;\n\nuniform vec4 uTint;\nuniform sampler2D uSampler;\nuniform bool isTexture;\n\nvarying vec3 vNormal;\nvarying vec2 vTexCoord;\nvarying vec3 vViewPosition;\nvarying vec3 vAmbientColor;\nvarying vec4 vColor;\n\nvoid main(void) {\n\n  vec3 diffuse;\n  vec3 specular;\n  totalLight(vViewPosition, normalize(vNormal), diffuse, specular);\n\n  // Calculating final color as result of all lights (plus emissive term).\n\n  vec4 baseColor = isTexture\n    // Textures come in with premultiplied alpha. To apply tint and still have\n    // premultiplied alpha output, we need to multiply the RGB channels by the\n    // tint RGB, and all channels by the tint alpha.\n    ? texture2D(uSampler, vTexCoord) * vec4(uTint.rgb/255., 1.) * (uTint.a/255.)\n    // Colors come in with unmultiplied alpha, so we need to multiply the RGB\n    // channels by alpha to convert it to premultiplied alpha.\n    : vec4(vColor.rgb * vColor.a, vColor.a);\n  gl_FragColor = vec4(diffuse * baseColor.rgb + \n                    vAmbientColor * (\n                      uHasSetAmbient ? uAmbientMatColor.rgb : baseColor.rgb\n                    ) + \n                    specular * uSpecularMatColor.rgb + \n                    uEmissiveMatColor.rgb, baseColor.a);\n}\n",fontVert:x+"IN vec3 aPosition;\nIN vec2 aTexCoord;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nuniform vec4 uGlyphRect;\nuniform float uGlyphOffset;\n\nOUT vec2 vTexCoord;\nOUT float w;\n\nvoid main() {\n  vec4 positionVec4 = vec4(aPosition, 1.0);\n\n  // scale by the size of the glyph's rectangle\n  positionVec4.xy *= uGlyphRect.zw - uGlyphRect.xy;\n\n  // Expand glyph bounding boxes by 1px on each side to give a bit of room\n  // for antialiasing\n  vec2 pixelScale = vec2(\n    1. / uModelViewMatrix[0][0],\n    1. / uModelViewMatrix[1][1]\n  );\n  vec2 offset = pixelScale * normalize(aTexCoord - vec2(0.5, 0.5)) * vec2(1., -1.);\n  vec2 textureOffset = offset * (1. / vec2(\n    uGlyphRect.z - uGlyphRect.x,\n    uGlyphRect.w - uGlyphRect.y\n  ));\n\n  // move to the corner of the glyph\n  positionVec4.xy += uGlyphRect.xy;\n\n  // move to the letter's line offset\n  positionVec4.x += uGlyphOffset;\n\n  positionVec4.xy += offset;\n  \n  gl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n  vTexCoord = aTexCoord + textureOffset;\n  w = gl_Position.w;\n}\n",fontFrag:x+"#ifndef WEBGL2\n#extension GL_OES_standard_derivatives : enable\n#endif\n\n#if 0\n  // simulate integer math using floats\n\t#define int float\n\t#define ivec2 vec2\n\t#define INT(x) float(x)\n\n\tint ifloor(float v) { return floor(v); }\n\tivec2 ifloor(vec2 v) { return floor(v); }\n\n#else\n  // use native integer math\n\tprecision highp int;\n\t#define INT(x) x\n\n\tint ifloor(float v) { return int(v); }\n\tint ifloor(int v) { return v; }\n\tivec2 ifloor(vec2 v) { return ivec2(v); }\n\n#endif\n\nuniform sampler2D uSamplerStrokes;\nuniform sampler2D uSamplerRowStrokes;\nuniform sampler2D uSamplerRows;\nuniform sampler2D uSamplerColStrokes;\nuniform sampler2D uSamplerCols;\n\nuniform ivec2 uStrokeImageSize;\nuniform ivec2 uCellsImageSize;\nuniform ivec2 uGridImageSize;\n\nuniform ivec2 uGridOffset;\nuniform ivec2 uGridSize;\nuniform vec4 uMaterialColor;\n\nIN vec2 vTexCoord;\n\n// some helper functions\nint ROUND(float v) { return ifloor(v + 0.5); }\nivec2 ROUND(vec2 v) { return ifloor(v + 0.5); }\nfloat saturate(float v) { return clamp(v, 0.0, 1.0); }\nvec2 saturate(vec2 v) { return clamp(v, 0.0, 1.0); }\n\nint mul(float v1, int v2) {\n  return ifloor(v1 * float(v2));\n}\n\nivec2 mul(vec2 v1, ivec2 v2) {\n  return ifloor(v1 * vec2(v2) + 0.5);\n}\n\n// unpack a 16-bit integer from a float vec2\nint getInt16(vec2 v) {\n  ivec2 iv = ROUND(v * 255.0);\n  return iv.x * INT(128) + iv.y;\n}\n\nvec2 pixelScale;\nvec2 coverage = vec2(0.0);\nvec2 weight = vec2(0.5);\nconst float minDistance = 1.0/8192.0;\nconst float hardness = 1.05; // amount of antialias\n\n// the maximum number of curves in a glyph\nconst int N = INT(250);\n\n// retrieves an indexed pixel from a sampler\nvec4 getTexel(sampler2D sampler, int pos, ivec2 size) {\n  int width = size.x;\n  int y = ifloor(pos / width);\n  int x = pos - y * width;  // pos % width\n\n  return TEXTURE(sampler, (vec2(x, y) + 0.5) / vec2(size));\n}\n\nvoid calulateCrossings(vec2 p0, vec2 p1, vec2 p2, out vec2 C1, out vec2 C2) {\n\n  // get the coefficients of the quadratic in t\n  vec2 a = p0 - p1 * 2.0 + p2;\n  vec2 b = p0 - p1;\n  vec2 c = p0 - vTexCoord;\n\n  // found out which values of 't' it crosses the axes\n  vec2 surd = sqrt(max(vec2(0.0), b * b - a * c));\n  vec2 t1 = ((b - surd) / a).yx;\n  vec2 t2 = ((b + surd) / a).yx;\n\n  // approximate straight lines to avoid rounding errors\n  if (abs(a.y) < 0.001)\n    t1.x = t2.x = c.y / (2.0 * b.y);\n\n  if (abs(a.x) < 0.001)\n    t1.y = t2.y = c.x / (2.0 * b.x);\n\n  // plug into quadratic formula to find the corrdinates of the crossings\n  C1 = ((a * t1 - b * 2.0) * t1 + c) * pixelScale;\n  C2 = ((a * t2 - b * 2.0) * t2 + c) * pixelScale;\n}\n\nvoid coverageX(vec2 p0, vec2 p1, vec2 p2) {\n\n  vec2 C1, C2;\n  calulateCrossings(p0, p1, p2, C1, C2);\n\n  // determine on which side of the x-axis the points lie\n  bool y0 = p0.y > vTexCoord.y;\n  bool y1 = p1.y > vTexCoord.y;\n  bool y2 = p2.y > vTexCoord.y;\n\n  // could web be under the curve (after t1)?\n  if (y1 ? !y2 : y0) {\n    // add the coverage for t1\n    coverage.x += saturate(C1.x + 0.5);\n    // calculate the anti-aliasing for t1\n    weight.x = min(weight.x, abs(C1.x));\n  }\n\n  // are we outside the curve (after t2)?\n  if (y1 ? !y0 : y2) {\n    // subtract the coverage for t2\n    coverage.x -= saturate(C2.x + 0.5);\n    // calculate the anti-aliasing for t2\n    weight.x = min(weight.x, abs(C2.x));\n  }\n}\n\n// this is essentially the same as coverageX, but with the axes swapped\nvoid coverageY(vec2 p0, vec2 p1, vec2 p2) {\n\n  vec2 C1, C2;\n  calulateCrossings(p0, p1, p2, C1, C2);\n\n  bool x0 = p0.x > vTexCoord.x;\n  bool x1 = p1.x > vTexCoord.x;\n  bool x2 = p2.x > vTexCoord.x;\n\n  if (x1 ? !x2 : x0) {\n    coverage.y -= saturate(C1.y + 0.5);\n    weight.y = min(weight.y, abs(C1.y));\n  }\n\n  if (x1 ? !x0 : x2) {\n    coverage.y += saturate(C2.y + 0.5);\n    weight.y = min(weight.y, abs(C2.y));\n  }\n}\n\nvoid main() {\n\n  // calculate the pixel scale based on screen-coordinates\n  pixelScale = hardness / fwidth(vTexCoord);\n\n  // which grid cell is this pixel in?\n  ivec2 gridCoord = ifloor(vTexCoord * vec2(uGridSize));\n\n  // intersect curves in this row\n  {\n    // the index into the row info bitmap\n    int rowIndex = gridCoord.y + uGridOffset.y;\n    // fetch the info texel\n    vec4 rowInfo = getTexel(uSamplerRows, rowIndex, uGridImageSize);\n    // unpack the rowInfo\n    int rowStrokeIndex = getInt16(rowInfo.xy);\n    int rowStrokeCount = getInt16(rowInfo.zw);\n\n    for (int iRowStroke = INT(0); iRowStroke < N; iRowStroke++) {\n      if (iRowStroke >= rowStrokeCount)\n        break;\n\n      // each stroke is made up of 3 points: the start and control point\n      // and the start of the next curve.\n      // fetch the indices of this pair of strokes:\n      vec4 strokeIndices = getTexel(uSamplerRowStrokes, rowStrokeIndex++, uCellsImageSize);\n\n      // unpack the stroke index\n      int strokePos = getInt16(strokeIndices.xy);\n\n      // fetch the two strokes\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\n\n      // calculate the coverage\n      coverageX(stroke0.xy, stroke0.zw, stroke1.xy);\n    }\n  }\n\n  // intersect curves in this column\n  {\n    int colIndex = gridCoord.x + uGridOffset.x;\n    vec4 colInfo = getTexel(uSamplerCols, colIndex, uGridImageSize);\n    int colStrokeIndex = getInt16(colInfo.xy);\n    int colStrokeCount = getInt16(colInfo.zw);\n    \n    for (int iColStroke = INT(0); iColStroke < N; iColStroke++) {\n      if (iColStroke >= colStrokeCount)\n        break;\n\n      vec4 strokeIndices = getTexel(uSamplerColStrokes, colStrokeIndex++, uCellsImageSize);\n\n      int strokePos = getInt16(strokeIndices.xy);\n      vec4 stroke0 = getTexel(uSamplerStrokes, strokePos + INT(0), uStrokeImageSize);\n      vec4 stroke1 = getTexel(uSamplerStrokes, strokePos + INT(1), uStrokeImageSize);\n      coverageY(stroke0.xy, stroke0.zw, stroke1.xy);\n    }\n  }\n\n  weight = saturate(1.0 - weight * 2.0);\n  float distance = max(weight.x + weight.y, minDistance); // manhattan approx.\n  float antialias = abs(dot(coverage, weight) / distance);\n  float cover = min(abs(coverage.x), abs(coverage.y));\n  OUT_COLOR = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;\n  OUT_COLOR *= saturate(max(antialias, cover));\n}\n",lineVert:b+"/*\n  Part of the Processing project - http://processing.org\n  Copyright (c) 2012-15 The Processing Foundation\n  Copyright (c) 2004-12 Ben Fry and Casey Reas\n  Copyright (c) 2001-04 Massachusetts Institute of Technology\n  This library is free software; you can redistribute it and/or\n  modify it under the terms of the GNU Lesser General Public\n  License as published by the Free Software Foundation, version 2.1.\n  This library is distributed in the hope that it will be useful,\n  but WITHOUT ANY WARRANTY; without even the implied warranty of\n  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n  Lesser General Public License for more details.\n  You should have received a copy of the GNU Lesser General\n  Public License along with this library; if not, write to the\n  Free Software Foundation, Inc., 59 Temple Place, Suite 330,\n  Boston, MA  02111-1307  USA\n*/\n\n#define PROCESSING_LINE_SHADER\n\nprecision mediump float;\nprecision mediump int;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform float uStrokeWeight;\n\nuniform bool uUseLineColor;\nuniform vec4 uMaterialColor;\n\nuniform vec4 uViewport;\nuniform int uPerspective;\nuniform int uStrokeJoin;\n\nattribute vec4 aPosition;\nattribute vec3 aTangentIn;\nattribute vec3 aTangentOut;\nattribute float aSide;\nattribute vec4 aVertexColor;\n\nvarying vec4 vColor;\nvarying vec2 vTangent;\nvarying vec2 vCenter;\nvarying vec2 vPosition;\nvarying float vMaxDist;\nvarying float vCap;\nvarying float vJoin;\n\nvec2 lineIntersection(vec2 aPoint, vec2 aDir, vec2 bPoint, vec2 bDir) {\n  // Rotate and translate so a starts at the origin and goes out to the right\n  bPoint -= aPoint;\n  vec2 rotatedBFrom = vec2(\n    bPoint.x*aDir.x + bPoint.y*aDir.y,\n    bPoint.y*aDir.x - bPoint.x*aDir.y\n  );\n  vec2 bTo = bPoint + bDir;\n  vec2 rotatedBTo = vec2(\n    bTo.x*aDir.x + bTo.y*aDir.y,\n    bTo.y*aDir.x - bTo.x*aDir.y\n  );\n  float intersectionDistance =\n    rotatedBTo.x + (rotatedBFrom.x - rotatedBTo.x) * rotatedBTo.y /\n    (rotatedBTo.y - rotatedBFrom.y);\n  return aPoint + aDir * intersectionDistance;\n}\n\nvoid main() {\n  // Caps have one of either the in or out tangent set to 0\n  vCap = (aTangentIn == vec3(0.)) != (aTangentOut == (vec3(0.)))\n    ? 1. : 0.;\n\n  // Joins have two unique, defined tangents\n  vJoin = (\n    aTangentIn != vec3(0.) &&\n    aTangentOut != vec3(0.) &&\n    aTangentIn != aTangentOut\n  ) ? 1. : 0.;\n\n  vec4 posp = uModelViewMatrix * aPosition;\n  vec4 posqIn = uModelViewMatrix * (aPosition + vec4(aTangentIn, 0));\n  vec4 posqOut = uModelViewMatrix * (aPosition + vec4(aTangentOut, 0));\n\n  float facingCamera = pow(\n    // The word space tangent's z value is 0 if it's facing the camera\n    abs(normalize(posqIn-posp).z),\n\n    // Using pow() here to ramp `facingCamera` up from 0 to 1 really quickly\n    // so most lines get scaled and don't get clipped\n    0.25\n  );\n\n  // using a scale <1 moves the lines towards the camera\n  // in order to prevent popping effects due to half of\n  // the line disappearing behind the geometry faces.\n  float scale = mix(1., 0.995, facingCamera);\n\n  // Moving vertices slightly toward the camera\n  // to avoid depth-fighting with the fill triangles.\n  // Discussed here:\n  // http://www.opengl.org/discussion_boards/ubbthreads.php?ubb=showflat&Number=252848  \n  posp.xyz = posp.xyz * scale;\n  posqIn.xyz = posqIn.xyz * scale;\n  posqOut.xyz = posqOut.xyz * scale;\n\n  vec4 p = uProjectionMatrix * posp;\n  vec4 qIn = uProjectionMatrix * posqIn;\n  vec4 qOut = uProjectionMatrix * posqOut;\n  vCenter = p.xy;\n\n  // formula to convert from clip space (range -1..1) to screen space (range 0..[width or height])\n  // screen_p = (p.xy/p.w + <1,1>) * 0.5 * uViewport.zw\n\n  // prevent division by W by transforming the tangent formula (div by 0 causes\n  // the line to disappear, see https://github.com/processing/processing/issues/5183)\n  // t = screen_q - screen_p\n  //\n  // tangent is normalized and we don't care which aDirection it points to (+-)\n  // t = +- normalize( screen_q - screen_p )\n  // t = +- normalize( (q.xy/q.w+<1,1>)*0.5*uViewport.zw - (p.xy/p.w+<1,1>)*0.5*uViewport.zw )\n  //\n  // extract common factor, <1,1> - <1,1> cancels out\n  // t = +- normalize( (q.xy/q.w - p.xy/p.w) * 0.5 * uViewport.zw )\n  //\n  // convert to common divisor\n  // t = +- normalize( ((q.xy*p.w - p.xy*q.w) / (p.w*q.w)) * 0.5 * uViewport.zw )\n  //\n  // remove the common scalar divisor/factor, not needed due to normalize and +-\n  // (keep uViewport - can't remove because it has different components for x and y\n  //  and corrects for aspect ratio, see https://github.com/processing/processing/issues/5181)\n  // t = +- normalize( (q.xy*p.w - p.xy*q.w) * uViewport.zw )\n\n  vec2 tangentIn = normalize((qIn.xy*p.w - p.xy*qIn.w) * uViewport.zw);\n  vec2 tangentOut = normalize((qOut.xy*p.w - p.xy*qOut.w) * uViewport.zw);\n\n  vec2 curPerspScale;\n  if(uPerspective == 1) {\n    // Perspective ---\n    // convert from world to clip by multiplying with projection scaling factor\n    // to get the right thickness (see https://github.com/processing/processing/issues/5182)\n    // invert Y, projections in Processing invert Y\n    curPerspScale = (uProjectionMatrix * vec4(1, -1, 0, 0)).xy;\n  } else {\n    // No Perspective ---\n    // multiply by W (to cancel out division by W later in the pipeline) and\n    // convert from screen to clip (derived from clip to screen above)\n    curPerspScale = p.w / (0.5 * uViewport.zw);\n  }\n\n  vec2 offset;\n  if (vJoin == 1.) {\n    vTangent = normalize(tangentIn + tangentOut);\n    vec2 normalIn = vec2(-tangentIn.y, tangentIn.x);\n    vec2 normalOut = vec2(-tangentOut.y, tangentOut.x);\n    float side = sign(aSide);\n    float sideEnum = abs(aSide);\n\n    // We generate vertices for joins on either side of the centerline, but\n    // the \"elbow\" side is the only one needing a join. By not setting the\n    // offset for the other side, all its vertices will end up in the same\n    // spot and not render, effectively discarding it.\n    if (sign(dot(tangentOut, vec2(-tangentIn.y, tangentIn.x))) != side) {\n      // Side enums:\n      //   1: the side going into the join\n      //   2: the middle of the join\n      //   3: the side going out of the join\n      if (sideEnum == 2.) {\n        // Calculate the position + tangent on either side of the join, and\n        // find where the lines intersect to find the elbow of the join\n        vec2 c = (posp.xy/posp.w + vec2(1.,1.)) * 0.5 * uViewport.zw;\n        vec2 intersection = lineIntersection(\n          c + (side * normalIn * uStrokeWeight / 2.) * curPerspScale,\n          tangentIn,\n          c + (side * normalOut * uStrokeWeight / 2.) * curPerspScale,\n          tangentOut\n        );\n        offset = (intersection - c);\n\n        // When lines are thick and the angle of the join approaches 180, the\n        // elbow might be really far from the center. We'll apply a limit to\n        // the magnitude to avoid lines going across the whole screen when this\n        // happens.\n        float mag = length(offset);\n        float maxMag = 3. * uStrokeWeight;\n        if (mag > maxMag) {\n          offset *= maxMag / mag;\n        }\n      } else if (sideEnum == 1.) {\n        offset = side * normalIn * curPerspScale * uStrokeWeight / 2.;\n      } else if (sideEnum == 3.) {\n        offset = side * normalOut * curPerspScale * uStrokeWeight / 2.;\n      }\n    }\n    if (uStrokeJoin == STROKE_JOIN_BEVEL) {\n      vec2 avgNormal = vec2(-vTangent.y, vTangent.x);\n      vMaxDist = abs(dot(avgNormal, normalIn * uStrokeWeight / 2.));\n    } else {\n      vMaxDist = uStrokeWeight / 2.;\n    }\n  } else {\n    vec2 tangent = aTangentIn == vec3(0.) ? tangentOut : tangentIn;\n    vTangent = tangent;\n    vec2 normal = vec2(-tangent.y, tangent.x);\n\n    float normalOffset = sign(aSide);\n    // Caps will have side values of -2 or 2 on the edge of the cap that\n    // extends out from the line\n    float tangentOffset = abs(aSide) - 1.;\n    offset = (normal * normalOffset + tangent * tangentOffset) *\n      uStrokeWeight * 0.5 * curPerspScale;\n    vMaxDist = uStrokeWeight / 2.;\n  }\n  vPosition = vCenter + offset / curPerspScale;\n\n  gl_Position.xy = p.xy + offset.xy;\n  gl_Position.zw = p.zw;\n  \n  vColor = (uUseLineColor ? aVertexColor : uMaterialColor);\n}\n",lineFrag:b+"precision mediump float;\nprecision mediump int;\n\nuniform vec4 uMaterialColor;\nuniform int uStrokeCap;\nuniform int uStrokeJoin;\nuniform float uStrokeWeight;\n\nvarying vec4 vColor;\nvarying vec2 vTangent;\nvarying vec2 vCenter;\nvarying vec2 vPosition;\nvarying float vMaxDist;\nvarying float vCap;\nvarying float vJoin;\n\nfloat distSquared(vec2 a, vec2 b) {\n  vec2 aToB = b - a;\n  return dot(aToB, aToB);\n}\n\nvoid main() {\n  if (vCap > 0.) {\n    if (\n      uStrokeCap == STROKE_CAP_ROUND &&\n      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25\n    ) {\n      discard;\n    } else if (\n      uStrokeCap == STROKE_CAP_SQUARE &&\n      dot(vPosition - vCenter, vTangent) > 0.\n    ) {\n      discard;\n    }\n    // Use full area for PROJECT\n  } else if (vJoin > 0.) {\n    if (\n      uStrokeJoin == STROKE_JOIN_ROUND &&\n      distSquared(vPosition, vCenter) > uStrokeWeight * uStrokeWeight * 0.25\n    ) {\n      discard;\n    } else if (uStrokeJoin == STROKE_JOIN_BEVEL) {\n      vec2 normal = vec2(-vTangent.y, vTangent.x);\n      if (abs(dot(vPosition - vCenter, normal)) > vMaxDist) {\n        discard;\n      }\n    }\n    // Use full area for MITER\n  }\n  gl_FragColor = vec4(vColor.rgb, 1.) * vColor.a;\n}\n",pointVert:"attribute vec3 aPosition;\nuniform float uPointSize;\nvarying float vStrokeWeight;\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\nvoid main() {\n\tvec4 positionVec4 =  vec4(aPosition, 1.0);\n\tgl_Position = uProjectionMatrix * uModelViewMatrix * positionVec4;\n\tgl_PointSize = uPointSize;\n\tvStrokeWeight = uPointSize;\n}",pointFrag:"precision mediump float;\nprecision mediump int;\nuniform vec4 uMaterialColor;\nvarying float vStrokeWeight;\n\nvoid main(){\n  float mask = 0.0;\n\n  // make a circular mask using the gl_PointCoord (goes from 0 - 1 on a point)\n  // might be able to get a nicer edge on big strokeweights with smoothstep but slightly less performant\n\n  mask = step(0.98, length(gl_PointCoord * 2.0 - 1.0));\n\n  // if strokeWeight is 1 or less lets just draw a square\n  // this prevents weird artifacting from carving circles when our points are really small\n  // if strokeWeight is larger than 1, we just use it as is\n\n  mask = mix(0.0, mask, clamp(floor(vStrokeWeight - 0.5),0.0,1.0));\n\n  // throw away the borders of the mask\n  // otherwise we get weird alpha blending issues\n\n  if(mask > 0.98){\n    discard;\n  }\n\n  gl_FragColor = vec4(uMaterialColor.rgb, 1.) * uMaterialColor.a;\n}\n"};function _(e,t,r,n,o,s,a,i,l,u){var c=t.getParameter(t.FRAMEBUFFER_BINDING),d=s*a*(t.bindFramebuffer(t.FRAMEBUFFER,r),r=i===t.RGBA?4:3),h=l===t.UNSIGNED_BYTE?Uint8Array:Float32Array;if(e instanceof h&&e.length===d||(e=new h(d)),t.readPixels(n,u?u-o-a:o,s,a,i,l,e),t.bindFramebuffer(t.FRAMEBUFFER,c),u)for(var p=Math.floor(a/2),f=new h(s*r),m=0;m<p;m++){var y=m*s*4,g=(a-m-1)*s*4;f.set(e.subarray(y,y+4*s)),e.copyWithin(y,g,g+4*s),e.set(f,g)}return e}function S(e,t,r,n,o,s,a){var i=e.getParameter(e.FRAMEBUFFER_BINDING);return e.bindFramebuffer(e.FRAMEBUFFER,t),t=o===e.RGBA?4:3,t=new(s===e.UNSIGNED_BYTE?Uint8Array:Float32Array)(t),e.readPixels(r,a?a-n-1:n,1,1,o,s,t),e.bindFramebuffer(e.FRAMEBUFFER,i),Array.from(t)}o.default.prototype.setAttributes=function(e,t){if(void 0===this._glAttributes)console.log("You are trying to use setAttributes on a p5.Graphics object that does not use a WEBGL renderer.");else{var r=!0;if(void 0!==t?(null===this._glAttributes&&(this._glAttributes={}),this._glAttributes[e]!==t&&(this._glAttributes[e]=t,r=!1)):e instanceof Object&&this._glAttributes!==e&&(this._glAttributes=e,r=!1),this._renderer.isP3D&&!r){if(!this._setupDone)for(var n in this._renderer.retainedMode.geometry)if(this._renderer.retainedMode.geometry.hasOwnProperty(n))return void o.default._friendlyError("Sorry, Could not set the attributes, you need to call setAttributes() before calling the other drawing methods in setup()");this.push(),this._renderer._resetContext(),this.pop(),this._renderer._curCamera&&(this._renderer._curCamera._renderer=this._renderer)}}},o.default.RendererGL=function(e){var t=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e);var r=h(n);function n(e,t,a,i){if(this instanceof n)return(e=r.call(this,e,t,a))._setAttributeDefaults(t),e._initContext(),e.isP3D=!0,e.GL=e.drawingContext,e._pInst._setProperty("drawingContext",e.drawingContext),e._isErasing=!1,e._enableLighting=!1,e.ambientLightColors=[],e.specularColors=[1,1,1],e.directionalLightDirections=[],e.directionalLightDiffuseColors=[],e.directionalLightSpecularColors=[],e.pointLightPositions=[],e.pointLightDiffuseColors=[],e.pointLightSpecularColors=[],e.spotLightPositions=[],e.spotLightDirections=[],e.spotLightDiffuseColors=[],e.spotLightSpecularColors=[],e.spotLightAngle=[],e.spotLightConc=[],e.drawMode=s.FILL,e.curFillColor=e._cachedFillStyle=[1,1,1,1],e.curAmbientColor=e._cachedFillStyle=[1,1,1,1],e.curSpecularColor=e._cachedFillStyle=[0,0,0,0],e.curEmissiveColor=e._cachedFillStyle=[0,0,0,0],e.curStrokeColor=e._cachedStrokeStyle=[0,0,0,1],e.curBlendMode=s.BLEND,e._cachedBlendMode=void 0,e.webglVersion===s.WEBGL2?e.blendExt=e.GL:e.blendExt=e.GL.getExtension("EXT_blend_minmax"),e._isBlending=!1,e._hasSetAmbient=!1,e._useSpecularMaterial=!1,e._useEmissiveMaterial=!1,e._useNormalMaterial=!1,e._useShininess=1,e._useLineColor=!1,e._useVertexColor=!1,e.registerEnabled=[],e._tint=[255,255,255,255],e.constantAttenuation=1,e.linearAttenuation=0,e.quadraticAttenuation=0,e.uMVMatrix=new o.default.Matrix,e.uPMatrix=new o.default.Matrix,e.uNMatrix=new o.default.Matrix("mat3"),e._currentNormal=new o.default.Vector(0,0,1),e._curCamera=new o.default.Camera(p(e)),e._curCamera._computeCameraDefaultSettings(),e._curCamera._setDefaultCamera(),e.prevTouches=[],e.zoomVelocity=0,e.rotateVelocity=new o.default.Vector(0,0),e.moveVelocity=new o.default.Vector(0,0),e.executeZoom=!1,e.executeRotateAndMove=!1,e._defaultLightShader=void 0,e._defaultImmediateModeShader=void 0,e._defaultNormalShader=void 0,e._defaultColorShader=void 0,e._defaultPointShader=void 0,e.userFillShader=void 0,e.userStrokeShader=void 0,e.userPointShader=void 0,e.retainedMode={geometry:{},buffers:{stroke:[new o.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",p(e),e._flatten),new o.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",p(e),e._flatten),new o.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",p(e),e._flatten),new o.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",p(e),e._flatten),new o.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",p(e))],fill:[new o.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",p(e),e._vToNArray),new o.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",p(e),e._vToNArray),new o.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",p(e)),new o.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",p(e)),new o.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",p(e),e._flatten)],text:[new o.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",p(e),e._vToNArray),new o.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",p(e),e._flatten)]}},e.immediateMode={geometry:new o.default.Geometry,shapeMode:s.TRIANGLE_FAN,_bezierVertex:[],_quadraticVertex:[],_curveVertex:[],buffers:{fill:[new o.default.RenderBuffer(3,"vertices","vertexBuffer","aPosition",p(e),e._vToNArray),new o.default.RenderBuffer(3,"vertexNormals","normalBuffer","aNormal",p(e),e._vToNArray),new o.default.RenderBuffer(4,"vertexColors","colorBuffer","aVertexColor",p(e)),new o.default.RenderBuffer(3,"vertexAmbients","ambientBuffer","aAmbientColor",p(e)),new o.default.RenderBuffer(2,"uvs","uvBuffer","aTexCoord",p(e),e._flatten)],stroke:[new o.default.RenderBuffer(4,"lineVertexColors","lineColorBuffer","aVertexColor",p(e),e._flatten),new o.default.RenderBuffer(3,"lineVertices","lineVerticesBuffer","aPosition",p(e),e._flatten),new o.default.RenderBuffer(3,"lineTangentsIn","lineTangentsInBuffer","aTangentIn",p(e),e._flatten),new o.default.RenderBuffer(3,"lineTangentsOut","lineTangentsOutBuffer","aTangentOut",p(e),e._flatten),new o.default.RenderBuffer(1,"lineSides","lineSidesBuffer","aSide",p(e))],point:e.GL.createBuffer()}},e.pointSize=5,e.curStrokeWeight=1,e.curStrokeCap=s.ROUND,e.curStrokeJoin=s.ROUND,e.textures=new Map,e.framebuffers=new Set,e.textureMode=s.IMAGE,e.textureWrapX=s.CLAMP,e.textureWrapY=s.CLAMP,e._tex=null,e._curveTightness=6,e._lookUpTableBezier=[],e._lookUpTableQuadratic=[],e._lutBezierDetail=0,e._lutQuadraticDetail=0,e.isProcessingVertices=!1,e._tessy=e._initTessy(),e.fontInfos={},e._curShader=void 0,e;throw new TypeError("Cannot call a class as a function")}return t=n,(e=[{key:"_setAttributeDefaults",value:function(e){var t={alpha:!0,depth:!0,stencil:!0,antialias:navigator.userAgent.toLowerCase().includes("safari"),premultipliedAlpha:!0,preserveDrawingBuffer:!0,perPixelLighting:!0,version:2};null===e._glAttributes?e._glAttributes=t:e._glAttributes=Object.assign(t,e._glAttributes)}},{key:"_initContext",value:function(){if(1!==this._pInst._glAttributes.version&&(this.drawingContext=this.canvas.getContext("webgl2",this._pInst._glAttributes)),this.webglVersion=this.drawingContext?s.WEBGL2:s.WEBGL,this._pInst._setProperty("webglVersion",this.webglVersion),this.drawingContext||(this.drawingContext=this.canvas.getContext("webgl",this._pInst._glAttributes)||this.canvas.getContext("experimental-webgl",this._pInst._glAttributes)),null===this.drawingContext)throw new Error("Error creating webgl context");var e=this.drawingContext;e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.viewport(0,0,e.drawingBufferWidth,e.drawingBufferHeight),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),this._viewport=this.drawingContext.getParameter(this.drawingContext.VIEWPORT)}},{key:"_resetContext",value:function(e,t){var r,n=this.width,s=this.height,a=this.canvas.id,i=this._pInst instanceof o.default.Graphics;i?((r=this._pInst).canvas.parentNode.removeChild(r.canvas),r.canvas=document.createElement("canvas"),(r._pInst._userNode||document.body).appendChild(r.canvas),o.default.Element.call(r,r.canvas,r._pInst),r.width=n,r.height=s):((r=this.canvas)&&r.parentNode.removeChild(r),(r=document.createElement("canvas")).id=a,(this._pInst._userNode||document.body).appendChild(r),this._pInst.canvas=r,this.canvas=r),a=new o.default.RendererGL(this._pInst.canvas,this._pInst,!i),this._pInst._setProperty("_renderer",a),a.resize(n,s),a._applyDefaults(),i||this._pInst._elements.push(a),"function"==typeof t&&setTimeout((function(){t.apply(window._renderer,e)}),0)}},{key:"_update",value:function(){this.uMVMatrix.set(this._curCamera.cameraMatrix.mat4[0],this._curCamera.cameraMatrix.mat4[1],this._curCamera.cameraMatrix.mat4[2],this._curCamera.cameraMatrix.mat4[3],this._curCamera.cameraMatrix.mat4[4],this._curCamera.cameraMatrix.mat4[5],this._curCamera.cameraMatrix.mat4[6],this._curCamera.cameraMatrix.mat4[7],this._curCamera.cameraMatrix.mat4[8],this._curCamera.cameraMatrix.mat4[9],this._curCamera.cameraMatrix.mat4[10],this._curCamera.cameraMatrix.mat4[11],this._curCamera.cameraMatrix.mat4[12],this._curCamera.cameraMatrix.mat4[13],this._curCamera.cameraMatrix.mat4[14],this._curCamera.cameraMatrix.mat4[15]),this.ambientLightColors.length=0,this.specularColors=[1,1,1],this.directionalLightDirections.length=0,this.directionalLightDiffuseColors.length=0,this.directionalLightSpecularColors.length=0,this.pointLightPositions.length=0,this.pointLightDiffuseColors.length=0,this.pointLightSpecularColors.length=0,this.spotLightPositions.length=0,this.spotLightDirections.length=0,this.spotLightDiffuseColors.length=0,this.spotLightSpecularColors.length=0,this.spotLightAngle.length=0,this.spotLightConc.length=0,this._enableLighting=!1,this._tint=[255,255,255,255],this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}},{key:"background",value:function(){var e=(n=(n=this._pInst).color.apply(n,arguments)).levels[0]/255,t=n.levels[1]/255,r=n.levels[2]/255,n=n.levels[3]/255;this.clear(e,t,r,n)}},{key:"fill",value:function(e,t,r,n){var a=o.default.prototype.color.apply(this._pInst,arguments);this.curFillColor=a._array,this.drawMode=s.FILL,this._useNormalMaterial=!1,this._tex=null}},{key:"stroke",value:function(e,t,r,n){var s=o.default.prototype.color.apply(this._pInst,arguments);this.curStrokeColor=s._array}},{key:"strokeCap",value:function(e){this.curStrokeCap=e}},{key:"strokeJoin",value:function(e){this.curStrokeJoin=e}},{key:"filter",value:function(e){o.default._friendlyError("filter() does not work in WEBGL mode")}},{key:"blendMode",value:function(e){e===s.DARKEST||e===s.LIGHTEST||e===s.ADD||e===s.BLEND||e===s.SUBTRACT||e===s.SCREEN||e===s.EXCLUSION||e===s.REPLACE||e===s.MULTIPLY||e===s.REMOVE?this.curBlendMode=e:e!==s.BURN&&e!==s.OVERLAY&&e!==s.HARD_LIGHT&&e!==s.SOFT_LIGHT&&e!==s.DODGE||console.warn("BURN, OVERLAY, HARD_LIGHT, SOFT_LIGHT, and DODGE only work for blendMode in 2D mode.")}},{key:"erase",value:function(e,t){this._isErasing||(this._applyBlendMode(s.REMOVE),this._isErasing=!0,this._cachedFillStyle=this.curFillColor.slice(),this.curFillColor=[1,1,1,e/255],this._cachedStrokeStyle=this.curStrokeColor.slice(),this.curStrokeColor=[1,1,1,t/255])}},{key:"noErase",value:function(){this._isErasing&&(this._isErasing=!1,this.curFillColor=this._cachedFillStyle.slice(),this.curStrokeColor=this._cachedStrokeStyle.slice(),this.blendMode(this._cachedBlendMode))}},{key:"strokeWeight",value:function(e){this.curStrokeWeight!==e&&(this.pointSize=e,this.curStrokeWeight=e)}},{key:"_getPixel",value:function(e,t){var r=this.GL;return S(r,null,e,t,r.RGBA,r.UNSIGNED_BYTE,this._pInst.height*this._pInst.pixelDensity())}},{key:"loadPixels",value:function(){var e,t,r=this._pixelsState;!0!==this._pInst._glAttributes.preserveDrawingBuffer?console.log("loadPixels only works in WebGL when preserveDrawingBuffer is true."):(e=this._pInst._pixelDensity,t=this.GL,r._setProperty("pixels",_(r.pixels,t,null,0,0,this.width*e,this.height*e,t.RGBA,t.UNSIGNED_BYTE,this.height*e)))}},{key:"updatePixels",value:function(){var e=this._getTempFramebuffer();e.pixels=this._pixelsState.pixels,e.updatePixels(),this._pInst.push(),this._pInst.resetMatrix(),this._pInst.clear(),this._pInst.imageMode(s.CENTER),this._pInst.image(e,0,0),this._pInst.pop(),this.GL.clearDepth(1),this.GL.clear(this.GL.DEPTH_BUFFER_BIT)}},{key:"_getTempFramebuffer",value:function(){return this._tempFramebuffer||(this._tempFramebuffer=this._pInst.createFramebuffer({format:s.UNSIGNED_BYTE,useDepth:this._pInst._glAttributes.depth,depthFormat:s.UNSIGNED_INT,antialias:this._pInst._glAttributes.antialias})),this._tempFramebuffer}},{key:"geometryInHash",value:function(e){return void 0!==this.retainedMode.geometry[e]}},{key:"resize",value:function(e,t){o.default.Renderer.prototype.resize.call(this,e,t),this.GL.viewport(0,0,this.GL.drawingBufferWidth,this.GL.drawingBufferHeight),this._viewport=this.GL.getParameter(this.GL.VIEWPORT),this._curCamera._resize();var r=(void 0!==(e=this._pixelsState).pixels&&e._setProperty("pixels",new Uint8Array(this.GL.drawingBufferWidth*this.GL.drawingBufferHeight*4)),!0);t=!1,e=void 0;try{for(var n,s=this.framebuffers[Symbol.iterator]();!(r=(n=s.next()).done);r=!0)n.value._canvasSizeChanged()}catch(r){t=!0,e=r}finally{try{r||null==s.return||s.return()}finally{if(t)throw e}}}},{key:"clear",value:function(){var e=(arguments.length<=0?void 0:arguments[0])||0,t=(arguments.length<=1?void 0:arguments[1])||0,r=(arguments.length<=2?void 0:arguments[2])||0,n=(arguments.length<=3?void 0:arguments[3])||0;this.GL.clearColor(e*n,t*n,r*n,n),this.GL.clearDepth(1),this.GL.clear(this.GL.COLOR_BUFFER_BIT|this.GL.DEPTH_BUFFER_BIT)}},{key:"applyMatrix",value:function(e,t,r,n,s,a){16===arguments.length?o.default.Matrix.prototype.apply.apply(this.uMVMatrix,arguments):this.uMVMatrix.apply([e,t,0,0,r,n,0,0,0,0,1,0,s,a,0,1])}},{key:"translate",value:function(e,t,r){return e instanceof o.default.Vector&&(r=e.z,t=e.y,e=e.x),this.uMVMatrix.translate([e,t,r]),this}},{key:"scale",value:function(e,t,r){return this.uMVMatrix.scale(e,t,r),this}},{key:"rotate",value:function(e,t){return void 0===t?this.rotateZ(e):(o.default.Matrix.prototype.rotate.apply(this.uMVMatrix,arguments),this)}},{key:"rotateX",value:function(e){return this.rotate(e,1,0,0),this}},{key:"rotateY",value:function(e){return this.rotate(e,0,1,0),this}},{key:"rotateZ",value:function(e){return this.rotate(e,0,0,1),this}},{key:"push",value:function(){var e=o.default.Renderer.prototype.push.apply(this),t=e.properties;return t.uMVMatrix=this.uMVMatrix.copy(),t.uPMatrix=this.uPMatrix.copy(),t._curCamera=this._curCamera,this._curCamera=this._curCamera.copy(),t.ambientLightColors=this.ambientLightColors.slice(),t.specularColors=this.specularColors.slice(),t.directionalLightDirections=this.directionalLightDirections.slice(),t.directionalLightDiffuseColors=this.directionalLightDiffuseColors.slice(),t.directionalLightSpecularColors=this.directionalLightSpecularColors.slice(),t.pointLightPositions=this.pointLightPositions.slice(),t.pointLightDiffuseColors=this.pointLightDiffuseColors.slice(),t.pointLightSpecularColors=this.pointLightSpecularColors.slice(),t.spotLightPositions=this.spotLightPositions.slice(),t.spotLightDirections=this.spotLightDirections.slice(),t.spotLightDiffuseColors=this.spotLightDiffuseColors.slice(),t.spotLightSpecularColors=this.spotLightSpecularColors.slice(),t.spotLightAngle=this.spotLightAngle.slice(),t.spotLightConc=this.spotLightConc.slice(),t.userFillShader=this.userFillShader,t.userStrokeShader=this.userStrokeShader,t.userPointShader=this.userPointShader,t.pointSize=this.pointSize,t.curStrokeWeight=this.curStrokeWeight,t.curStrokeColor=this.curStrokeColor,t.curFillColor=this.curFillColor,t.curAmbientColor=this.curAmbientColor,t.curSpecularColor=this.curSpecularColor,t.curEmissiveColor=this.curEmissiveColor,t._hasSetAmbient=this._hasSetAmbient,t._useSpecularMaterial=this._useSpecularMaterial,t._useEmissiveMaterial=this._useEmissiveMaterial,t._useShininess=this._useShininess,t.constantAttenuation=this.constantAttenuation,t.linearAttenuation=this.linearAttenuation,t.quadraticAttenuation=this.quadraticAttenuation,t._enableLighting=this._enableLighting,t._useNormalMaterial=this._useNormalMaterial,t._tex=this._tex,t.drawMode=this.drawMode,t._currentNormal=this._currentNormal,t.curBlendMode=this.curBlendMode,e}},{key:"resetMatrix",value:function(){return this.uMVMatrix.set(this._curCamera.cameraMatrix.mat4[0],this._curCamera.cameraMatrix.mat4[1],this._curCamera.cameraMatrix.mat4[2],this._curCamera.cameraMatrix.mat4[3],this._curCamera.cameraMatrix.mat4[4],this._curCamera.cameraMatrix.mat4[5],this._curCamera.cameraMatrix.mat4[6],this._curCamera.cameraMatrix.mat4[7],this._curCamera.cameraMatrix.mat4[8],this._curCamera.cameraMatrix.mat4[9],this._curCamera.cameraMatrix.mat4[10],this._curCamera.cameraMatrix.mat4[11],this._curCamera.cameraMatrix.mat4[12],this._curCamera.cameraMatrix.mat4[13],this._curCamera.cameraMatrix.mat4[14],this._curCamera.cameraMatrix.mat4[15]),this}},{key:"_getImmediateStrokeShader",value:function(){var e=this.userStrokeShader;return e&&e.isStrokeShader()?e:this._getLineShader()}},{key:"_getRetainedStrokeShader",value:function(){return this._getImmediateStrokeShader()}},{key:"_getImmediateFillShader",value:function(){var e=this.userFillShader;if(this._useNormalMaterial&&(!e||!e.isNormalShader()))return this._getNormalShader();if(this._enableLighting){if(!e||!e.isLightShader())return this._getLightShader()}else if(this._tex){if(!e||!e.isTextureShader())return this._getLightShader()}else if(!e)return this._getImmediateModeShader();return e}},{key:"_getRetainedFillShader",value:function(){if(this._useNormalMaterial)return this._getNormalShader();var e=this.userFillShader;if(this._enableLighting){if(!e||!e.isLightShader())return this._getLightShader()}else if(this._tex){if(!e||!e.isTextureShader())return this._getLightShader()}else if(!e)return this._getColorShader();return e}},{key:"_getImmediatePointShader",value:function(){var e=this.userPointShader;return e&&e.isPointShader()?e:this._getPointShader()}},{key:"_getRetainedLineShader",value:function(){return this._getImmediateLineShader()}},{key:"_getLightShader",value:function(){return this._defaultLightShader||(this._pInst._glAttributes.perPixelLighting?this._defaultLightShader=new o.default.Shader(this,w.phongVert,w.phongFrag):this._defaultLightShader=new o.default.Shader(this,w.lightVert,w.lightTextureFrag)),this._defaultLightShader}},{key:"_getImmediateModeShader",value:function(){return this._defaultImmediateModeShader||(this._defaultImmediateModeShader=new o.default.Shader(this,w.immediateVert,w.vertexColorFrag)),this._defaultImmediateModeShader}},{key:"_getNormalShader",value:function(){return this._defaultNormalShader||(this._defaultNormalShader=new o.default.Shader(this,w.normalVert,w.normalFrag)),this._defaultNormalShader}},{key:"_getColorShader",value:function(){return this._defaultColorShader||(this._defaultColorShader=new o.default.Shader(this,w.normalVert,w.basicFrag)),this._defaultColorShader}},{key:"_getPointShader",value:function(){return this._defaultPointShader||(this._defaultPointShader=new o.default.Shader(this,w.pointVert,w.pointFrag)),this._defaultPointShader}},{key:"_getLineShader",value:function(){return this._defaultLineShader||(this._defaultLineShader=new o.default.Shader(this,w.lineVert,w.lineFrag)),this._defaultLineShader}},{key:"_getFontShader",value:function(){return this._defaultFontShader||(this.webglVersion===s.WEBGL&&this.GL.getExtension("OES_standard_derivatives"),this._defaultFontShader=new o.default.Shader(this,this._webGL2CompatibilityPrefix("vert","mediump")+w.fontVert,this._webGL2CompatibilityPrefix("frag","mediump")+w.fontFrag)),this._defaultFontShader}},{key:"_webGL2CompatibilityPrefix",value:function(e,t){var r="";return this.webglVersion===s.WEBGL2&&(r+="#version 300 es\n#define WEBGL2\n"),"vert"===e?r+="#define VERTEX_SHADER\n":"frag"===e&&(r+="#define FRAGMENT_SHADER\n"),t&&(r+="precision ".concat(t," float;\n")),r}},{key:"_getEmptyTexture",value:function(){var e;return this._emptyTexture||((e=new o.default.Image(1,1)).set(0,0,255),this._emptyTexture=new o.default.Texture(this,e)),this._emptyTexture}},{key:"getTexture",value:function(e){e instanceof o.default.Framebuffer&&(e=e.color);var t=this.textures.get(e);return t||(t=new o.default.Texture(this,e),this.textures.set(e,t),t)}},{key:"createFramebuffer",value:function(e){return new o.default.Framebuffer(this,e)}},{key:"_setStrokeUniforms",value:function(e){e.bindShader(),e.setUniform("uUseLineColor",this._useLineColor),e.setUniform("uMaterialColor",this.curStrokeColor),e.setUniform("uStrokeWeight",this.curStrokeWeight),e.setUniform("uStrokeCap",g[this.curStrokeCap]),e.setUniform("uStrokeJoin",v[this.curStrokeJoin])}},{key:"_setFillUniforms",value:function(e){e.bindShader(),e.setUniform("uUseVertexColor",this._useVertexColor),e.setUniform("uMaterialColor",this.curFillColor),e.setUniform("isTexture",!!this._tex),this._tex&&e.setUniform("uSampler",this._tex),e.setUniform("uTint",this._tint),e.setUniform("uHasSetAmbient",this._hasSetAmbient),e.setUniform("uAmbientMatColor",this.curAmbientColor),e.setUniform("uSpecularMatColor",this.curSpecularColor),e.setUniform("uEmissiveMatColor",this.curEmissiveColor),e.setUniform("uSpecular",this._useSpecularMaterial),e.setUniform("uEmissive",this._useEmissiveMaterial),e.setUniform("uShininess",this._useShininess),e.setUniform("uUseLighting",this._enableLighting);var t=this.pointLightDiffuseColors.length/3;e.setUniform("uPointLightCount",t),e.setUniform("uPointLightLocation",this.pointLightPositions),e.setUniform("uPointLightDiffuseColors",this.pointLightDiffuseColors),e.setUniform("uPointLightSpecularColors",this.pointLightSpecularColors),t=this.directionalLightDiffuseColors.length/3,e.setUniform("uDirectionalLightCount",t),e.setUniform("uLightingDirection",this.directionalLightDirections),e.setUniform("uDirectionalDiffuseColors",this.directionalLightDiffuseColors),e.setUniform("uDirectionalSpecularColors",this.directionalLightSpecularColors),t=this.ambientLightColors.length/3,e.setUniform("uAmbientLightCount",t),e.setUniform("uAmbientColor",this.ambientLightColors),t=this.spotLightDiffuseColors.length/3,e.setUniform("uSpotLightCount",t),e.setUniform("uSpotLightAngle",this.spotLightAngle),e.setUniform("uSpotLightConc",this.spotLightConc),e.setUniform("uSpotLightDiffuseColors",this.spotLightDiffuseColors),e.setUniform("uSpotLightSpecularColors",this.spotLightSpecularColors),e.setUniform("uSpotLightLocation",this.spotLightPositions),e.setUniform("uSpotLightDirection",this.spotLightDirections),e.setUniform("uConstantAttenuation",this.constantAttenuation),e.setUniform("uLinearAttenuation",this.linearAttenuation),e.setUniform("uQuadraticAttenuation",this.quadraticAttenuation),e.bindTextures()}},{key:"_setPointUniforms",value:function(e){e.bindShader(),e.setUniform("uMaterialColor",this.curStrokeColor),e.setUniform("uPointSize",this.pointSize*this._pInst._pixelDensity)}},{key:"_bindBuffer",value:function(e,t,r,n,o){t=t||this.GL.ARRAY_BUFFER,this.GL.bindBuffer(t,e),void 0!==r&&(e=new(n||Float32Array)(r),this.GL.bufferData(t,e,o||this.GL.STATIC_DRAW))}},{key:"_arraysEqual",value:function(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))}},{key:"_isTypedArray",value:function(e){return[Float32Array,Float64Array,Int16Array,Uint16Array,Uint32Array].some((function(t){return e instanceof t}))}},{key:"_flatten",value:function(e){if(0===e.length)return[];var t;if(2e4<e.length){for(var r=[],n=e.slice(),o=n.pop();Array.isArray(o)?n.push.apply(n,c(o)):r.push(o),n.length&&void 0!==(o=n.pop()););return r.reverse(),r}return(t=[]).concat.apply(t,c(e))}},{key:"_vToNArray",value:function(e){var t=[],r=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var i=s.value;t.push(i.x,i.y,i.z)}}catch(e){n=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return t}},{key:"_bezierCoefficients",value:function(e){var t=e*e,r=1-e,n=r*r;return[n*r,3*n*e,3*r*t,t*e]}},{key:"_quadraticCoefficients",value:function(e){var t=1-e;return[t*t,2*t*e,e*e]}},{key:"_bezierToCatmull",value:function(e){return[e[1],e[1]+(e[2]-e[0])/this._curveTightness,e[2]-(e[3]-e[1])/this._curveTightness,e[2]]}},{key:"_initTessy",value:function(){var e=new a.default.GluTesselator;return e.gluTessCallback(a.default.gluEnum.GLU_TESS_VERTEX_DATA,(function(e,t){for(var r=0;r<e.length;r++)t.push(e[r])})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_BEGIN,(function(e){e!==a.default.primitiveType.GL_TRIANGLES&&console.log("expected TRIANGLES but got type: ".concat(e))})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_ERROR,(function(e){console.log("error callback"),console.log("error number: ".concat(e))})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_COMBINE,(function(e,t,r){for(var n=new Array(o.default.RendererGL.prototype.tessyVertexSize).fill(0),s=0;s<r.length;s++)for(var a=0;a<n.length;a++)0!==r[s]&&t[s]&&(n[a]+=t[s][a]*r[s]);return n})),e.gluTessCallback(a.default.gluEnum.GLU_TESS_EDGE_FLAG,(function(e){})),e}},{key:"_triangulate",value:function(e){var t=e[0]?e[0][2]:void 0,r=!0,n=!0,s=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(n=(i=l.next()).done);n=!0)for(var u=i.value,c=0;c<u.length;c+=o.default.RendererGL.prototype.tessyVertexSize)if(u[c+2]!==t){r=!1;break}}catch(e){s=!0,a=e}finally{try{n||null==l.return||l.return()}finally{if(s)throw a}}r?this._tessy.gluTessNormal(0,0,1):this._tessy.gluTessNormal(0,0,0),s=[];var d=(this._tessy.gluTessBeginPolygon(s),!0),h=void(a=!1);try{for(var p,f=e[Symbol.iterator]();!(d=(p=f.next()).done);d=!0){var m=p.value;this._tessy.gluTessBeginContour();for(var y=0;y<m.length;y+=o.default.RendererGL.prototype.tessyVertexSize){var g=m.slice(y,y+o.default.RendererGL.prototype.tessyVertexSize);this._tessy.gluTessVertex(g,g)}this._tessy.gluTessEndContour()}}catch(e){a=!0,h=e}finally{try{d||null==f.return||f.return()}finally{if(a)throw h}}return this._tessy.gluTessEndPolygon(),s}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),n}(o.default.Renderer),o.default.prototype._assert3d=function(e){if(!this._renderer.isP3D)throw new Error("".concat(e,"() is only supported in WEBGL mode. If you'd like to use 3D graphics and WebGL, see  https://p5js.org/examples/form-3d-primitives.html for more information."))},o.default.RendererGL.prototype.tessyVertexSize=12,e=o.default.RendererGL,r.default=e},{"../core/constants":262,"../core/main":273,"../core/p5.Renderer":276,"./p5.Camera":321,"./p5.Matrix":324,"./p5.Shader":329,"core-js/modules/es.array.concat":151,"core-js/modules/es.array.copy-within":152,"core-js/modules/es.array.every":153,"core-js/modules/es.array.fill":154,"core-js/modules/es.array.from":157,"core-js/modules/es.array.includes":158,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.array.some":165,"core-js/modules/es.map":168,"core-js/modules/es.object.assign":174,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.get-prototype-of":178,"core-js/modules/es.object.to-string":180,"core-js/modules/es.reflect.construct":182,"core-js/modules/es.regexp.to-string":186,"core-js/modules/es.set":187,"core-js/modules/es.string.includes":189,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.float32-array":209,"core-js/modules/es.typed-array.float64-array":210,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.int16-array":214,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint16-array":230,"core-js/modules/es.typed-array.uint32-array":231,"core-js/modules/es.typed-array.uint8-array":232,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236,libtess:245,path:248}],329:[function(e,t,r){"use strict";e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.index-of"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.array.slice"),e("core-js/modules/es.function.name"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=(e=e("../core/main"))&&e.__esModule?e:{default:e};n.default.Shader=function(){function e(t,r,n){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._renderer=t,this._vertSrc=r,this._fragSrc=n,this._vertShader=-1,this._fragShader=-1,this._glProgram=0,this._loadedAttributes=!1,this.attributes={},this._loadedUniforms=!1,this.uniforms={},this._bound=!1,this.samplers=[]}var t;return(t=[{key:"init",value:function(){if(0===this._glProgram){var e=this._renderer.GL;if(this._vertShader=e.createShader(e.VERTEX_SHADER),e.shaderSource(this._vertShader,this._vertSrc),e.compileShader(this._vertShader),!e.getShaderParameter(this._vertShader,e.COMPILE_STATUS))return n.default._friendlyError("Yikes! An error occurred compiling the vertex shader:".concat(e.getShaderInfoLog(this._vertShader))),null;if(this._fragShader=e.createShader(e.FRAGMENT_SHADER),e.shaderSource(this._fragShader,this._fragSrc),e.compileShader(this._fragShader),!e.getShaderParameter(this._fragShader,e.COMPILE_STATUS))return n.default._friendlyError("Darn! An error occurred compiling the fragment shader:".concat(e.getShaderInfoLog(this._fragShader))),null;this._glProgram=e.createProgram(),e.attachShader(this._glProgram,this._vertShader),e.attachShader(this._glProgram,this._fragShader),e.linkProgram(this._glProgram),e.getProgramParameter(this._glProgram,e.LINK_STATUS)||n.default._friendlyError("Snap! Error linking shader program: ".concat(e.getProgramInfoLog(this._glProgram))),this._loadAttributes(),this._loadUniforms()}return this}},{key:"_loadAttributes",value:function(){if(!this._loadedAttributes){this.attributes={};for(var e=this._renderer.GL,t=e.getProgramParameter(this._glProgram,e.ACTIVE_ATTRIBUTES),r=0;r<t;++r){var n=e.getActiveAttrib(this._glProgram,r),o=n.name,s=e.getAttribLocation(this._glProgram,o),a={};a.name=o,a.location=s,a.index=r,a.type=n.type,a.size=n.size,this.attributes[o]=a}this._loadedAttributes=!0}}},{key:"_loadUniforms",value:function(){if(!this._loadedUniforms){for(var e=this._renderer.GL,t=e.getProgramParameter(this._glProgram,e.ACTIVE_UNIFORMS),r=0,n=0;n<t;++n){var o=e.getActiveUniform(this._glProgram,n),s={},a=(s.location=e.getUniformLocation(this._glProgram,o.name),s.size=o.size,o.name);1<o.size&&(a=a.substring(0,a.indexOf("[0]"))),s.name=a,s.type=o.type,s._cachedData=void 0,s.type===e.SAMPLER_2D&&(s.samplerIndex=r,r++,this.samplers.push(s)),s.isArray=1<o.size||s.type===e.FLOAT_MAT3||s.type===e.FLOAT_MAT4||s.type===e.FLOAT_VEC2||s.type===e.FLOAT_VEC3||s.type===e.FLOAT_VEC4||s.type===e.INT_VEC2||s.type===e.INT_VEC4||s.type===e.INT_VEC3,this.uniforms[a]=s}this._loadedUniforms=!0}}},{key:"compile",value:function(){}},{key:"bindShader",value:function(){this.init(),this._bound||(this.useProgram(),this._bound=!0,this._setMatrixUniforms(),this.setUniform("uViewport",this._renderer._viewport))}},{key:"unbindShader",value:function(){return this._bound&&(this.unbindTextures(),this._bound=!1),this}},{key:"bindTextures",value:function(){var e=this._renderer.GL,t=!0,r=!1,n=void 0;try{for(var o,s=this.samplers[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a=o.value,i=a.texture;void 0===i&&(i=this._renderer._getEmptyTexture()),e.activeTexture(e.TEXTURE0+a.samplerIndex),i.bindTexture(),i.update(),e.uniform1i(a.location,a.samplerIndex)}}catch(e){r=!0,n=e}finally{try{t||null==s.return||s.return()}finally{if(r)throw n}}}},{key:"updateTextures",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,o=this.samplers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var s=n.value.texture;s&&s.update()}}catch(e){t=!0,r=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw r}}}},{key:"unbindTextures",value:function(){var e=!0,t=!1,r=void 0;try{for(var n,o=this.samplers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var s=n.value;this.setUniform(s.name,this._renderer._getEmptyTexture())}}catch(e){t=!0,r=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw r}}}},{key:"_setMatrixUniforms",value:function(){var e=this._renderer._curCamera.cameraMatrix,t=this._renderer.uPMatrix,r=this._renderer.uMVMatrix,n=r.copy();n.mult(t),this.isStrokeShader()&&("default"===this._renderer._curCamera.cameraType?this.setUniform("uPerspective",1):this.setUniform("uPerspective",0)),this.setUniform("uViewMatrix",e.mat4),this.setUniform("uProjectionMatrix",t.mat4),this.setUniform("uModelViewMatrix",r.mat4),this.setUniform("uModelViewProjectionMatrix",n.mat4),this.uniforms.uNormalMatrix&&(this._renderer.uNMatrix.inverseTranspose(this._renderer.uMVMatrix),this.setUniform("uNormalMatrix",this._renderer.uNMatrix.mat3))}},{key:"useProgram",value:function(){var e=this._renderer.GL;return this._renderer._curShader!==this&&(e.useProgram(this._glProgram),this._renderer._curShader=this),this}},{key:"setUniform",value:function(e,t){var r=this.uniforms[e];if(r){var o=this._renderer.GL;if(r.isArray){if(r._cachedData&&this._renderer._arraysEqual(r._cachedData,t))return;r._cachedData=t.slice(0)}else{if(r._cachedData&&r._cachedData===t)return;Array.isArray(t)?r._cachedData=t.slice(0):r._cachedData=t}var s=r.location;switch(this.useProgram(),r.type){case o.BOOL:!0===t?o.uniform1i(s,1):o.uniform1i(s,0);break;case o.INT:1<r.size?t.length&&o.uniform1iv(s,t):o.uniform1i(s,t);break;case o.FLOAT:1<r.size?t.length&&o.uniform1fv(s,t):o.uniform1f(s,t);break;case o.FLOAT_MAT3:o.uniformMatrix3fv(s,!1,t);break;case o.FLOAT_MAT4:o.uniformMatrix4fv(s,!1,t);break;case o.FLOAT_VEC2:1<r.size?t.length&&o.uniform2fv(s,t):o.uniform2f(s,t[0],t[1]);break;case o.FLOAT_VEC3:1<r.size?t.length&&o.uniform3fv(s,t):o.uniform3f(s,t[0],t[1],t[2]);break;case o.FLOAT_VEC4:1<r.size?t.length&&o.uniform4fv(s,t):o.uniform4f(s,t[0],t[1],t[2],t[3]);break;case o.INT_VEC2:1<r.size?t.length&&o.uniform2iv(s,t):o.uniform2i(s,t[0],t[1]);break;case o.INT_VEC3:1<r.size?t.length&&o.uniform3iv(s,t):o.uniform3i(s,t[0],t[1],t[2]);break;case o.INT_VEC4:1<r.size?t.length&&o.uniform4iv(s,t):o.uniform4i(s,t[0],t[1],t[2],t[3]);break;case o.SAMPLER_2D:o.activeTexture(o.TEXTURE0+r.samplerIndex),r.texture=t instanceof n.default.Texture?t:this._renderer.getTexture(t),o.uniform1i(s,r.samplerIndex),r.texture.src.gifProperties&&r.texture.src._animateGif(this._renderer._pInst)}return this}}},{key:"isLightShader",value:function(){return void 0!==this.attributes.aNormal||void 0!==this.uniforms.uUseLighting||void 0!==this.uniforms.uAmbientLightCount||void 0!==this.uniforms.uDirectionalLightCount||void 0!==this.uniforms.uPointLightCount||void 0!==this.uniforms.uAmbientColor||void 0!==this.uniforms.uDirectionalDiffuseColors||void 0!==this.uniforms.uDirectionalSpecularColors||void 0!==this.uniforms.uPointLightLocation||void 0!==this.uniforms.uPointLightDiffuseColors||void 0!==this.uniforms.uPointLightSpecularColors||void 0!==this.uniforms.uLightingDirection||void 0!==this.uniforms.uSpecular}},{key:"isNormalShader",value:function(){return void 0!==this.attributes.aNormal}},{key:"isTextureShader",value:function(){return 0<this.samplers.length}},{key:"isColorShader",value:function(){return void 0!==this.attributes.aVertexColor||void 0!==this.uniforms.uMaterialColor}},{key:"isTexLightShader",value:function(){return this.isLightShader()&&this.isTextureShader()}},{key:"isStrokeShader",value:function(){return void 0!==this.uniforms.uStrokeWeight}},{key:"enableAttrib",value:function(e,t,r,n,o,s){var a;return e&&-1!==(e=e.location)&&(a=this._renderer.GL,this._renderer.registerEnabled[e]||(a.enableVertexAttribArray(e),this._renderer.registerEnabled[e]=!0),this._renderer.GL.vertexAttribPointer(e,t,r||a.FLOAT,n||!1,o||0,s||0)),this}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}(),e=n.default.Shader,r.default=e},{"../core/main":273,"core-js/modules/es.array.index-of":159,"core-js/modules/es.array.iterator":160,"core-js/modules/es.array.slice":164,"core-js/modules/es.function.name":167,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/web.dom-collections.iterator":236}],330:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.typed-array.uint8-array"),e("core-js/modules/es.typed-array.copy-within"),e("core-js/modules/es.typed-array.every"),e("core-js/modules/es.typed-array.fill"),e("core-js/modules/es.typed-array.filter"),e("core-js/modules/es.typed-array.find"),e("core-js/modules/es.typed-array.find-index"),e("core-js/modules/es.typed-array.for-each"),e("core-js/modules/es.typed-array.includes"),e("core-js/modules/es.typed-array.index-of"),e("core-js/modules/es.typed-array.iterator"),e("core-js/modules/es.typed-array.join"),e("core-js/modules/es.typed-array.last-index-of"),e("core-js/modules/es.typed-array.map"),e("core-js/modules/es.typed-array.reduce"),e("core-js/modules/es.typed-array.reduce-right"),e("core-js/modules/es.typed-array.reverse"),e("core-js/modules/es.typed-array.set"),e("core-js/modules/es.typed-array.slice"),e("core-js/modules/es.typed-array.some"),e("core-js/modules/es.typed-array.sort"),e("core-js/modules/es.typed-array.subarray"),e("core-js/modules/es.typed-array.to-locale-string"),e("core-js/modules/es.typed-array.to-string"),Object.defineProperty(r,"__esModule",{value:!0}),r.checkWebGLCapabilities=l,r.default=void 0;var s=(u=e("../core/main"))&&u.__esModule?u:{default:u},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=i();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function i(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,i=function(){return e},e)}function l(e){var t=e.GL,r=(e=e.webglVersion)===a.WEBGL2?t.getExtension("EXT_color_buffer_float")&&t.getExtension("EXT_float_blend"):t.getExtension("OES_texture_float");return{float:r,floatLinear:r&&t.getExtension("OES_texture_float_linear"),halfFloat:e=e===a.WEBGL2?t.getExtension("EXT_color_buffer_float"):t.getExtension("OES_texture_half_float"),halfFloatLinear:e&&t.getExtension("OES_texture_half_float_linear")}}s.default.Texture=function(){function e(t,r,n){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this._renderer=t;var o=this._renderer.GL;return n=n||{},this.src=r,this.glTex=void 0,this.glTarget=o.TEXTURE_2D,this.glFormat=n.format||o.RGBA,this.mipmaps=!1,this.glMinFilter=n.minFilter||o.LINEAR,this.glMagFilter=n.magFilter||o.LINEAR,this.glWrapS=n.wrapS||o.CLAMP_TO_EDGE,this.glWrapT=n.wrapT||o.CLAMP_TO_EDGE,this.glDataType=n.dataType||o.UNSIGNED_BYTE,n=l(t),this.glFormat!==o.HALF_FLOAT||n.halfFloat||(console.log("This device does not support dataType HALF_FLOAT. Falling back to FLOAT."),this.glDataType=o.FLOAT),this.glFormat!==o.HALF_FLOAT||this.glMinFilter!==o.LINEAR&&this.glMagFilter!==o.LINEAR||n.halfFloatLinear||(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===o.LINEAR&&(this.glMinFilter=o.NEAREST),this.glMagFilter===o.LINEAR&&(this.glMagFilter=o.NEAREST)),this.glFormat!==o.FLOAT||n.float||(console.log("This device does not support dataType FLOAT. Falling back to UNSIGNED_BYTE."),this.glDataType=o.UNSIGNED_BYTE),this.glFormat!==o.FLOAT||this.glMinFilter!==o.LINEAR&&this.glMagFilter!==o.LINEAR||n.floatLinear||(console.log("This device does not support linear filtering for dataType FLOAT. Falling back to NEAREST."),this.glMinFilter===o.LINEAR&&(this.glMinFilter=o.NEAREST),this.glMagFilter===o.LINEAR&&(this.glMagFilter=o.NEAREST)),this.isSrcMediaElement=void 0!==s.default.MediaElement&&r instanceof s.default.MediaElement,this._videoPrevUpdateTime=0,this.isSrcHTMLElement=void 0!==s.default.Element&&r instanceof s.default.Element&&!(r instanceof s.default.Graphics)&&!(r instanceof s.default.Renderer),this.isSrcP5Image=r instanceof s.default.Image,this.isSrcP5Graphics=r instanceof s.default.Graphics,this.isSrcP5Renderer=r instanceof s.default.Renderer,this.isImageData="undefined"!=typeof ImageData&&r instanceof ImageData,this.isFramebufferTexture=r instanceof s.default.FramebufferTexture,t=this._getTextureDataFromSource(),this.width=t.width,this.height=t.height,this.init(t),this}var t;return(t=[{key:"_getTextureDataFromSource",value:function(){var e;return this.isFramebufferTexture?e=this.src.rawTexture():this.isSrcP5Image?e=this.src.canvas:this.isSrcMediaElement||this.isSrcP5Graphics||this.isSrcP5Renderer||this.isSrcHTMLElement?e=this.src.elt:this.isImageData&&(e=this.src),e}},{key:"init",value:function(e){var t,r=this._renderer.GL;this.isFramebufferTexture||(this.glTex=r.createTexture()),this.glWrapS=this._renderer.textureWrapX,this.glWrapT=this._renderer.textureWrapY,this.setWrapMode(this.glWrapS,this.glWrapT),this.bindTexture(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.glMagFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.glMinFilter),this.isFramebufferTexture||(0===this.width||0===this.height||this.isSrcMediaElement&&!this.src.loadedmetadata?(t=new Uint8Array([1,1,1,1]),r.texImage2D(this.glTarget,0,r.RGBA,1,1,0,this.glFormat,this.glDataType,t)):r.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,e))}},{key:"update",value:function(){var e,t,r,n=this.src;return 0!==n.width&&0!==n.height&&!this.isFramebufferTexture&&(e=this._getTextureDataFromSource(),t=!1,r=this._renderer.GL,e.width!==this.width||e.height!==this.height?(t=!0,this.width=e.width||n.width,this.height=e.height||n.height,this.isSrcP5Image?n.setModified(!1):(this.isSrcMediaElement||this.isSrcHTMLElement)&&n.setModified(!0)):this.isSrcP5Image?n.isModified()&&n.setModified(!(t=!0)):this.isSrcMediaElement?n.isModified()?n.setModified(!(t=!0)):n.loadedmetadata&&this._videoPrevUpdateTime!==n.time()&&(this._videoPrevUpdateTime=n.time(),t=!0):this.isImageData?n._dirty&&(t=!(n._dirty=!1)):t=!0,t&&(this.bindTexture(),r.texImage2D(this.glTarget,0,this.glFormat,this.glFormat,this.glDataType,e)),t)}},{key:"bindTexture",value:function(){return this._renderer.GL.bindTexture(this.glTarget,this.getTexture()),this}},{key:"unbindTexture",value:function(){this._renderer.GL.bindTexture(this.glTarget,null)}},{key:"getTexture",value:function(){return this.isFramebufferTexture?this.src.rawTexture():this.glTex}},{key:"setInterpolation",value:function(e,t){var r=this._renderer.GL;e===a.NEAREST?this.glMinFilter=r.NEAREST:this.glMinFilter=r.LINEAR,t===a.NEAREST?this.glMagFilter=r.NEAREST:this.glMagFilter=r.LINEAR,this.bindTexture(),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,this.glMinFilter),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,this.glMagFilter),this.unbindTexture()}},{key:"setWrapMode",value:function(e,t){function r(e){return 0==(e&e-1)}var n=this._renderer.GL,o=(o=this._getTextureDataFromSource()).naturalWidth&&o.naturalHeight?(s=o.naturalWidth,o.naturalHeight):(s=this.width,this.height),s=r(s);o=r(o),e===a.REPEAT?this._renderer.webglVersion===a.WEBGL2||s&&o?this.glWrapS=n.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=n.CLAMP_TO_EDGE):e===a.MIRROR?this._renderer.webglVersion===a.WEBGL2||s&&o?this.glWrapS=n.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapS=n.CLAMP_TO_EDGE):this.glWrapS=n.CLAMP_TO_EDGE,t===a.REPEAT?this._renderer.webglVersion===a.WEBGL2||s&&o?this.glWrapT=n.REPEAT:(console.warn("You tried to set the wrap mode to REPEAT but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=n.CLAMP_TO_EDGE):t===a.MIRROR?this._renderer.webglVersion===a.WEBGL2||s&&o?this.glWrapT=n.MIRRORED_REPEAT:(console.warn("You tried to set the wrap mode to MIRROR but the texture size is not a power of two. Setting to CLAMP instead"),this.glWrapT=n.CLAMP_TO_EDGE):this.glWrapT=n.CLAMP_TO_EDGE,this.bindTexture(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,this.glWrapS),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,this.glWrapT),this.unbindTexture()}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();var u=s.default.Texture;r.default=u},{"../core/constants":262,"../core/main":273,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.string.iterator":190,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.typed-array.copy-within":203,"core-js/modules/es.typed-array.every":204,"core-js/modules/es.typed-array.fill":205,"core-js/modules/es.typed-array.filter":206,"core-js/modules/es.typed-array.find":208,"core-js/modules/es.typed-array.find-index":207,"core-js/modules/es.typed-array.for-each":211,"core-js/modules/es.typed-array.includes":212,"core-js/modules/es.typed-array.index-of":213,"core-js/modules/es.typed-array.iterator":216,"core-js/modules/es.typed-array.join":217,"core-js/modules/es.typed-array.last-index-of":218,"core-js/modules/es.typed-array.map":219,"core-js/modules/es.typed-array.reduce":221,"core-js/modules/es.typed-array.reduce-right":220,"core-js/modules/es.typed-array.reverse":222,"core-js/modules/es.typed-array.set":223,"core-js/modules/es.typed-array.slice":224,"core-js/modules/es.typed-array.some":225,"core-js/modules/es.typed-array.sort":226,"core-js/modules/es.typed-array.subarray":227,"core-js/modules/es.typed-array.to-locale-string":228,"core-js/modules/es.typed-array.to-string":229,"core-js/modules/es.typed-array.uint8-array":232,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}],331:[function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e){return(o="function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?function(e){return n(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)})(e)}e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.get-own-property-descriptor"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.sub"),e("core-js/modules/es.weak-map"),e("core-js/modules/web.dom-collections.iterator"),e("core-js/modules/es.symbol"),e("core-js/modules/es.symbol.description"),e("core-js/modules/es.symbol.iterator"),e("core-js/modules/es.array.iterator"),e("core-js/modules/es.object.to-string"),e("core-js/modules/es.regexp.exec"),e("core-js/modules/es.string.iterator"),e("core-js/modules/es.string.split"),e("core-js/modules/es.string.sub"),e("core-js/modules/web.dom-collections.iterator");var s,a=(s=e("../core/main"))&&s.__esModule?s:{default:s},i=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==o(e)&&"function"!=typeof e)return{default:e};var t=l();if(t&&t.has(e))return t.get(e);var r,n={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(r in e){var a;Object.prototype.hasOwnProperty.call(e,r)&&((a=s?Object.getOwnPropertyDescriptor(e,r):null)&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r])}return n.default=e,t&&t.set(e,n),n}(e("../core/constants"));function l(){var e;return"function"!=typeof WeakMap?null:(e=new WeakMap,l=function(){return e},e)}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){t&&c(e.prototype,t),r&&c(e,r)}e("./p5.Shader"),e("./p5.RendererGL.Retained"),a.default.RendererGL.prototype._applyTextProperties=function(){},a.default.RendererGL.prototype.textWidth=function(e){return this._isOpenType()?this._textFont._textWidth(e,this._textSize):0};var h=function(){function e(t,r){u(this,e),this.width=t,this.height=r,this.infos=[]}return d(e,[{key:"findImage",value:function(e){var t,r,n=this.width*this.height;if(n<e)throw new Error("font is too complex to render in 3D");for(var o=this.infos.length-1;0<=o;--o){var s=this.infos[o];if(s.index+e<n){r=(t=s).imageData;break}}if(!t){try{r=new ImageData(this.width,this.height)}catch(e){var a=document.getElementsByTagName("canvas")[0],i=!a,l=(a||((a=document.createElement("canvas")).style.display="none",document.body.appendChild(a)),a.getContext("2d"));l&&(r=l.createImageData(this.width,this.height)),i&&document.body.removeChild(a)}this.infos.push(t={index:0,imageData:r})}return l=t.index,t.index+=e,r._dirty=!0,{imageData:r,index:l}}}]),e}();function p(e,t,r,n,o){var s=e.imageData.data;e=4*e.index++,s[e++]=t,s[e++]=r,s[e++]=n,s[+e]=o}var f=Math.sqrt(3),m=function(){function e(t){u(this,e),this.font=t,this.strokeImageInfos=new h(64,64),this.colDimImageInfos=new h(64,64),this.rowDimImageInfos=new h(64,64),this.colCellImageInfos=new h(64,64),this.rowCellImageInfos=new h(64,64),this.glyphInfos={}}return d(e,[{key:"getGlyphInfo",value:function(e){var t=this.glyphInfos[e.index];if(!t){var r=e.getBoundingBox(),n=r.x1,o=r.y1,s=r.x2-n,i=r.y2-o,l=e.path.commands;if(0==s||0==i||!l.length)return this.glyphInfos[e.index]={};for(var c=[],h=[],m=[],y=8;0<=y;--y)m.push([]);for(y=8;0<=y;--y)h.push([]);var g,v,b,x,w=function(){function e(t,r,n,o){u(this,e),this.p0=t,this.c0=r,this.c1=n,this.p1=o}return d(e,[{key:"toQuadratic",value:function(){return{x:this.p0.x,y:this.p0.y,x1:this.p1.x,y1:this.p1.y,cx:(3*(this.c0.x+this.c1.x)-(this.p0.x+this.p1.x))/4,cy:(3*(this.c0.y+this.c1.y)-(this.p0.y+this.p1.y))/4}}},{key:"quadError",value:function(){return a.default.Vector.sub(a.default.Vector.sub(this.p1,this.p0),a.default.Vector.mult(a.default.Vector.sub(this.c1,this.c0),3)).mag()/2}},{key:"split",value:function(t){var r=a.default.Vector.lerp(this.p0,this.c0,t),n=a.default.Vector.lerp(this.c0,this.c1,t),o=a.default.Vector.lerp(r,n,t);return this.c1=a.default.Vector.lerp(this.c1,this.p1,t),this.c0=a.default.Vector.lerp(n,this.c1,t),n=a.default.Vector.lerp(o,this.c0,t),t=new e(this.p0,r,o,n),this.p0=n,t}},{key:"splitInflections",value:function(){var e=a.default.Vector.sub(this.c0,this.p0),t=a.default.Vector.sub(a.default.Vector.sub(this.c1,this.c0),e),r=a.default.Vector.sub(a.default.Vector.sub(a.default.Vector.sub(this.p1,this.c1),e),a.default.Vector.mult(t,2)),n=[],o=t.x*r.y-t.y*r.x;return 0!==o&&0<=(e=(r=e.x*r.y-e.y*r.x)*r-4*o*(e.x*t.y-e.y*t.x))&&(o<0&&(o=-o,r=-r),e=(-r+(t=Math.sqrt(e)))/(2*o),0<(r=(-r-t)/(2*o))&&r<1&&(n.push(this.split(r)),e=1-(1-e)/(1-r)),0<e&&e<1&&n.push(this.split(e))),n.push(this),n}}]),e}(),_=!0,S=!1,k=void 0;try{for(var T,E=l[Symbol.iterator]();!(_=(T=E.next()).done);_=!0){var j=T.value,C=(j.x-n)/s,I=(j.y-o)/i;if(!G(g,v,C,I)){switch(j.type){case"M":b=C,x=I;break;case"L":V(g,v,C,I);break;case"Q":var O=(j.x1-n)/s,A=(j.y1-o)/i;B([g,C,O],[v,I,A],{x:g,y:v,cx:O,cy:A});break;case"Z":G(g,v,b,x)?c.push({x:g,y:v}):(V(g,v,b,x),c.push({x:b,y:x}));break;case"C":for(var R=function(e,t,r,n,o,s,i,l){e=new w(new a.default.Vector(e,t),new a.default.Vector(r,n),new a.default.Vector(o,s),new a.default.Vector(i,l)).splitInflections();var u=[],c=30/f,d=!0;t=!1,r=void 0;try{for(var h,p=e[Symbol.iterator]();!(d=(h=p.next()).done);d=!0){for(var m=h.value,y=[],g=void 0;!(.125<=(g=c/m.quadError()));){var v=Math.pow(g,1/3),b=m.split(v),x=m.split(1-v/(1-v));u.push(b),y.push(m),m=x}g<1&&u.push(m.split(.5)),u.push(m),Array.prototype.push.apply(u,y.reverse())}}catch(e){t=!0,r=e}finally{try{d||null==p.return||p.return()}finally{if(t)throw r}}return u}(g,v,(j.x1-n)/s,(j.y1-o)/i,(j.x2-n)/s,(j.y2-o)/i,C,I),N=0;N<R.length;N++){var M=R[N].toQuadratic();B([M.x,M.x1,M.cx],[M.y,M.y1,M.cy],M)}break;default:throw new Error("unknown command type: ".concat(j.type))}g=C,v=I}}}catch(e){S=!0,k=e}finally{try{_||null==E.return||E.return()}finally{if(S)throw k}}for(var P=c.length,L=this.strokeImageInfos.findImage(P),D=L.index,F=0;F<P;++F){var $=c[F];p(L,U($.x),U($.y),U($.cx),U($.cy))}(t=this.glyphInfos[e.index]={glyph:e,uGlyphRect:[r.x1,-r.y1,r.x2,-r.y2],strokeImageInfo:L,strokes:c,colInfo:z(m,this.colDimImageInfos,this.colCellImageInfos),rowInfo:z(h,this.rowDimImageInfos,this.rowCellImageInfos)}).uGridOffset=[t.colInfo.dimOffset,t.rowInfo.dimOffset]}return t;function B(e,t,r){var n=c.length;function o(e,t,r){for(var n=e.length;0<n--;){var o=e[n];o<t&&(t=o),r<o&&(r=o)}return{min:t,max:r}}c.push(r),r=o(e,1,0),e=Math.max(Math.floor(9*r.min-.5),0);for(var s=Math.min(Math.ceil(9*r.max+.5),9),a=e;a<s;++a)m[a].push(n);r=o(t,1,0),e=Math.max(Math.floor(9*r.min-.5),0);for(var i=Math.min(Math.ceil(9*r.max+.5),9),l=e;l<i;++l)h[l].push(n)}function U(e){return(e*=255)<0?0:255<e?255:e}function V(e,t,r,n){B([e,r],[t,n],{x:e,y:t,cx:(e+r)/2,cy:(t+n)/2})}function G(e,t,r,n){return Math.abs(r-e)<1e-5&&Math.abs(n-t)<1e-5}function z(e,t,r){for(var n=e.length,o=t.findImage(n),s=(t=o.index,0),a=0;a<n;++a)s+=e[a].length;for(var i=r.findImage(s),l=0;l<n;++l){var u=e[l],c=u.length,d=i.index;p(o,d>>7,127&d,c>>7,127&c);for(var h=0;h<c;++h){var f=u[h]+D;p(i,f>>7,127&f,0,0)}}return{cellImageInfo:i,dimOffset:t,dimImageInfo:o}}}}]),e}();a.default.RendererGL.prototype._renderText=function(e,t,r,n,o){if(this._textFont&&"string"!=typeof this._textFont){if(!(o<=n)&&this._doFill){if(this._isOpenType()){e.push(),o=this._doStroke;var s=this.drawMode,l=(this._doStroke=!1,this.drawMode=i.TEXTURE,this._textFont.font),u=(u=this._textFont._fontInfo)||(this._textFont._fontInfo=new m(l)),c=(r=this._textFont._handleAlignment(this,t,r,n),n=this._textSize/l.unitsPerEm,this.translate(r.x,r.y,0),this.scale(n,n,1),this.GL),d=(r=!this._defaultFontShader,this._getFontShader()),h=(d.init(),d.bindShader(),r&&(d.setUniform("uGridImageSize",[64,64]),d.setUniform("uCellsImageSize",[64,64]),d.setUniform("uStrokeImageSize",[64,64]),d.setUniform("uGridSize",[9,9])),this._applyColorBlend(this.curFillColor),this.retainedMode.geometry.glyph),p=(h||((n=this._textGeom=new a.default.Geometry(1,1,(function(){for(var e=0;e<=1;e++)for(var t=0;t<=1;t++)this.vertices.push(new a.default.Vector(t,e,0)),this.uvs.push(t,e)}))).computeFaces().computeNormals(),h=this.createBuffers("glyph",n)),!0);r=!1,n=void 0;try{for(var f,y=this.retainedMode.buffers.text[Symbol.iterator]();!(p=(f=y.next()).done);p=!0)f.value._prepareBuffer(h,d)}catch(e){r=!0,n=e}finally{try{p||null==y.return||y.return()}finally{if(r)throw n}}this._bindBuffer(h.indexBuffer,c.ELEMENT_ARRAY_BUFFER),d.setUniform("uMaterialColor",this.curFillColor),c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1);try{var g=0,v=null,b=l.stringToGlyphs(t),x=!0,w=!1,_=void 0;try{for(var S,k=b[Symbol.iterator]();!(x=(S=k.next()).done);x=!0){var T,E,j=S.value,C=(v&&(g+=l.getKerningValue(v,j)),u.getGlyphInfo(j));C.uGlyphRect&&(T=C.rowInfo,E=C.colInfo,d.setUniform("uSamplerStrokes",C.strokeImageInfo.imageData),d.setUniform("uSamplerRowStrokes",T.cellImageInfo.imageData),d.setUniform("uSamplerRows",T.dimImageInfo.imageData),d.setUniform("uSamplerColStrokes",E.cellImageInfo.imageData),d.setUniform("uSamplerCols",E.dimImageInfo.imageData),d.setUniform("uGridOffset",C.uGridOffset),d.setUniform("uGlyphRect",C.uGlyphRect),d.setUniform("uGlyphOffset",g),d.bindTextures(),c.drawElements(c.TRIANGLES,6,this.GL.UNSIGNED_SHORT,0)),g+=j.advanceWidth,v=j}}catch(e){w=!0,_=e}finally{try{x||null==k.return||k.return()}finally{if(w)throw _}}}finally{d.unbindShader(),this._doStroke=o,this.drawMode=s,c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.pop()}}else console.log("WEBGL: only Opentype (.otf) and Truetype (.ttf) fonts are supported");return e}}else console.log("WEBGL: you must load and set a font before drawing text. See `loadFont` and `textFont` for more details.")}},{"../core/constants":262,"../core/main":273,"./p5.RendererGL.Retained":327,"./p5.Shader":329,"core-js/modules/es.array.iterator":160,"core-js/modules/es.object.get-own-property-descriptor":176,"core-js/modules/es.object.to-string":180,"core-js/modules/es.regexp.exec":185,"core-js/modules/es.string.iterator":190,"core-js/modules/es.string.split":196,"core-js/modules/es.string.sub":198,"core-js/modules/es.symbol":202,"core-js/modules/es.symbol.description":200,"core-js/modules/es.symbol.iterator":201,"core-js/modules/es.weak-map":234,"core-js/modules/web.dom-collections.iterator":236}]},{},[257])(257)}))},377:(e,t,r)=>{var n=r(832),o=r(652),s=r(801),a=r(30),i=r(618),l=r(49),u=r(971);u.alea=n,u.xor128=o,u.xorwow=s,u.xorshift7=a,u.xor4096=i,u.tychei=l,e.exports=u},832:function(e,t,r){var n;!function(e,o,s){function a(e){var t,r=this,n=(t=4022871197,function(e){e=String(e);for(var r=0;r<e.length;r++){var n=.02519603282416938*(t+=e.charCodeAt(r));n-=t=n>>>0,t=(n*=t)>>>0,t+=4294967296*(n-=t)}return 2.3283064365386963e-10*(t>>>0)});r.next=function(){var e=2091639*r.s0+2.3283064365386963e-10*r.c;return r.s0=r.s1,r.s1=r.s2,r.s2=e-(r.c=0|e)},r.c=1,r.s0=n(" "),r.s1=n(" "),r.s2=n(" "),r.s0-=n(e),r.s0<0&&(r.s0+=1),r.s1-=n(e),r.s1<0&&(r.s1+=1),r.s2-=n(e),r.s2<0&&(r.s2+=1),n=null}function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function l(e,t){var r=new a(e),n=t&&t.state,o=r.next;return o.int32=function(){return 4294967296*r.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,o))||(o.exports=n):this.alea=l}(0,e=r.nmd(e),r.amdD)},49:function(e,t,r){var n;!function(e,o,s){function a(e){var t=this,r="";t.next=function(){var e=t.b,r=t.c,n=t.d,o=t.a;return e=e<<25^e>>>7^r,r=r-n|0,n=n<<24^n>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^r,t.c=r=r-n|0,t.d=n<<16^r>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):r+=e;for(var n=0;n<r.length+20;n++)t.b^=0|r.charCodeAt(n),t.next()}function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function l(e,t){var r=new a(e),n=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,o))||(o.exports=n):this.tychei=l}(0,e=r.nmd(e),r.amdD)},652:function(e,t,r){var n;!function(e,o,s){function a(e){var t=this,r="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function l(e,t){var r=new a(e),n=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,o))||(o.exports=n):this.xor128=l}(0,e=r.nmd(e),r.amdD)},618:function(e,t,r){var n;!function(e,o,s){function a(e){var t=this;t.next=function(){var e,r,n=t.w,o=t.X,s=t.i;return t.w=n=n+1640531527|0,r=o[s+34&127],e=o[s=s+1&127],r^=r<<13,e^=e<<17,r^=r>>>15,e^=e>>>12,r=o[s]=r^e,t.i=s,r+(n^n>>>16)|0},function(e,t){var r,n,o,s,a,i=[],l=128;for(t===(0|t)?(n=t,t=null):(t+="\0",n=0,l=Math.max(l,t.length)),o=0,s=-32;s<l;++s)t&&(n^=t.charCodeAt((s+32)%t.length)),0===s&&(a=n),n^=n<<10,n^=n>>>15,n^=n<<4,n^=n>>>13,s>=0&&(a=a+1640531527|0,o=0==(r=i[127&s]^=n+a)?o+1:0);for(o>=128&&(i[127&(t&&t.length||0)]=-1),o=127,s=512;s>0;--s)n=i[o+34&127],r=i[o=o+1&127],n^=n<<13,r^=r<<17,n^=n>>>15,r^=r>>>12,i[o]=n^r;e.w=a,e.X=i,e.i=o}(t,e)}function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function l(e,t){null==e&&(e=+new Date);var r=new a(e),n=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,n&&(n.X&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,o))||(o.exports=n):this.xor4096=l}(0,e=r.nmd(e),r.amdD)},30:function(e,t,r){var n;!function(e,o,s){function a(e){var t=this;t.next=function(){var e,r,n=t.x,o=t.i;return e=n[o],r=(e^=e>>>7)^e<<24,r^=(e=n[o+1&7])^e>>>10,r^=(e=n[o+3&7])^e>>>3,r^=(e=n[o+4&7])^e<<7,e=n[o+7&7],r^=(e^=e<<13)^e<<9,n[o]=r,t.i=o+1&7,r},function(e,t){var r,n=[];if(t===(0|t))n[0]=t;else for(t=""+t,r=0;r<t.length;++r)n[7&r]=n[7&r]<<15^t.charCodeAt(r)+n[r+1&7]<<13;for(;n.length<8;)n.push(0);for(r=0;r<8&&0===n[r];++r);for(8==r?n[7]=-1:n[r],e.x=n,e.i=0,r=256;r>0;--r)e.next()}(t,e)}function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function l(e,t){null==e&&(e=+new Date);var r=new a(e),n=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,n&&(n.x&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,o))||(o.exports=n):this.xorshift7=l}(0,e=r.nmd(e),r.amdD)},801:function(e,t,r){var n;!function(e,o,s){function a(e){var t=this,r="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:r+=e;for(var n=0;n<r.length+64;n++)t.x^=0|r.charCodeAt(n),n==r.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function l(e,t){var r=new a(e),n=t&&t.state,o=function(){return(r.next()>>>0)/4294967296};return o.double=function(){do{var e=((r.next()>>>11)+(r.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=r.next,o.quick=o,n&&("object"==typeof n&&i(n,r),o.state=function(){return i(r,{})}),o}o&&o.exports?o.exports=l:r.amdD&&r.amdO?void 0===(n=function(){return l}.call(t,r,t,o))||(o.exports=n):this.xorwow=l}(0,e=r.nmd(e),r.amdD)},971:function(e,t,r){var n;!function(o,s,a){var i,l=256,u=a.pow(l,6),c=a.pow(2,52),d=2*c,h=l-1;function p(e,t,r){var n=[],h=g(y((t=1==t?{entropy:!0}:t||{}).entropy?[e,v(s)]:null==e?function(){try{var e;return i&&(e=i.randomBytes)?e=e(l):(e=new Uint8Array(l),(o.crypto||o.msCrypto).getRandomValues(e)),v(e)}catch(e){var t=o.navigator,r=t&&t.plugins;return[+new Date,o,r,o.screen,v(s)]}}():e,3),n),p=new f(n),b=function(){for(var e=p.g(6),t=u,r=0;e<c;)e=(e+r)*l,t*=l,r=p.g(1);for(;e>=d;)e/=2,t/=2,r>>>=1;return(e+r)/t};return b.int32=function(){return 0|p.g(4)},b.quick=function(){return p.g(4)/4294967296},b.double=b,g(v(p.S),s),(t.pass||r||function(e,t,r,n){return n&&(n.S&&m(n,p),e.state=function(){return m(p,{})}),r?(a.random=e,t):e})(b,h,"global"in t?t.global:this==a,t.state)}function f(e){var t,r=e.length,n=this,o=0,s=n.i=n.j=0,a=n.S=[];for(r||(e=[r++]);o<l;)a[o]=o++;for(o=0;o<l;o++)a[o]=a[s=h&s+e[o%r]+(t=a[o])],a[s]=t;(n.g=function(e){for(var t,r=0,o=n.i,s=n.j,a=n.S;e--;)t=a[o=h&o+1],r=r*l+a[h&(a[o]=a[s=h&s+t])+(a[s]=t)];return n.i=o,n.j=s,r})(l)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function y(e,t){var r,n=[],o=typeof e;if(t&&"object"==o)for(r in e)try{n.push(y(e[r],t-1))}catch(e){}return n.length?n:"string"==o?e:e+"\0"}function g(e,t){for(var r,n=e+"",o=0;o<n.length;)t[h&o]=h&(r^=19*t[h&o])+n.charCodeAt(o++);return v(t)}function v(e){return String.fromCharCode.apply(0,e)}if(g(a.random(),s),e.exports){e.exports=p;try{i=r(42)}catch(e){}}else void 0===(n=function(){return p}.call(t,r,t,e))||(e.exports=n)}("undefined"!=typeof self?self:this,[],Math)},410:()=>{},628:()=>{},42:()=>{}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var s=r[e]={id:e,loaded:!1,exports:{}};return t[e].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var o={};return(()=>{"use strict";n.r(o),n.d(o,{camera:()=>sI,depthData:()=>cI,depthH:()=>hI,depthW:()=>dI,getWindowHeight:()=>AI,getWindowWidth:()=>OI,mainP5Sketch:()=>uI,posNormal:()=>lI,poseDetection:()=>aI,position:()=>iI,posterTasks:()=>jI,screens:()=>fI,setup:()=>_I,skeletons:()=>pI,vh:()=>gI,vw:()=>yI});var e={};n.r(e),n.d(e,{browserFiles:()=>Is,browserHTTPRequest:()=>Fs,concatenateArrayBuffers:()=>Ro,copyModel:()=>vs,decodeWeights:()=>Co,encodeWeights:()=>jo,fromMemory:()=>Vs,fromMemorySync:()=>Gs,getLoadHandlers:()=>zo,getModelArtifactsForJSON:()=>Lo,getModelArtifactsForJSONSync:()=>Po,getModelArtifactsInfoForJSON:()=>Do,getSaveHandlers:()=>Go,getWeightSpecs:()=>Fo,http:()=>Ds,isHTTPScheme:()=>Ps,listModels:()=>ys,loadWeights:()=>Rs,moveModel:()=>bs,registerLoadRouter:()=>Vo,registerSaveRouter:()=>Uo,removeModel:()=>gs,weightsLoaderFactory:()=>Ns,withSaveHandler:()=>zs,withSaveHandlerSync:()=>Ws});var t={};n.r(t),n.d(t,{assertParamsValid:()=>ta,computeFlatOffset:()=>fa,computeOutShape:()=>na,getNormalizedAxes:()=>ia,isSliceContinous:()=>pa,maskToAxes:()=>ra,parseSliceParams:()=>ma,sliceInfo:()=>ya,startForAxis:()=>da,startIndicesWithElidedDims:()=>la,stopForAxis:()=>ha,stopIndicesWithElidedDims:()=>ua,stridesForAxis:()=>ca,stridesWithElidedDims:()=>oa});var r={};n.r(r),n.d(r,{conv2d:()=>Vc,depthwiseConv2d:()=>Wc,matMul:()=>Hc});var s={};n.r(s),n.d(s,{collectGatherOpShapeInfo:()=>Kh,computeOutShape:()=>Yh,segOpComputeOptimalWindowSize:()=>Xh});var a={};n.r(a),n.d(a,{ERF_A1:()=>hh,ERF_A2:()=>ph,ERF_A3:()=>fh,ERF_A4:()=>mh,ERF_A5:()=>yh,ERF_P:()=>dh,PARALLELIZE_THRESHOLD:()=>eh,RowPartitionType:()=>Yd,SELU_SCALE:()=>ch,SELU_SCALEALPHA:()=>uh,applyActivation:()=>Bc,assertAndGetBroadcastShape:()=>Xs,assertAxesAreInnerMostDims:()=>qi,assertParamsConsistent:()=>qd,assignToTypedArray:()=>_h,axesAreInnerMostDims:()=>Gi,calculateShapes:()=>Ic,checkEinsumDimSizes:()=>Ah,checkPadOnDimRoundingMode:()=>Wa,combineLocations:()=>zi,combineRaggedTensorToTensorShapes:()=>Kd,complexWithEvenIndex:()=>bh,complexWithOddIndex:()=>xh,computeConv2DInfo:()=>Pa,computeConv3DInfo:()=>La,computeDefaultPad:()=>Da,computeDilation2DInfo:()=>Ra,computeOptimalWindowSize:()=>th,computeOutAndReduceShapes:()=>Wi,computeOutShape:()=>Xd,computePool2DInfo:()=>Na,computePool3DInfo:()=>Ma,convertConv2DDataFormat:()=>za,decodeEinsumEquation:()=>Ih,eitherStridesOrDilationsAreOne:()=>Ga,expandShapeToKeepDim:()=>Hi,exponent:()=>kh,exponents:()=>Sh,fromStringArrayToUint8:()=>Qh,fromUint8ToStringArray:()=>Zh,getAxesPermutation:()=>Xi,getBroadcastDims:()=>Hs,getComplexWithIndex:()=>wh,getEinsumComputePath:()=>Rh,getEinsumPermutation:()=>Oh,getFusedBiasGradient:()=>$c,getFusedDyActivation:()=>Fc,getImageCenter:()=>rh,getInnerMostAxes:()=>Ki,getPermuted:()=>oh,getRaggedRank:()=>Qd,getReductionAxes:()=>qs,getReshaped:()=>nh,getReshapedPermuted:()=>sh,getRowPartitionTypesHelper:()=>Zd,getSliceBeginCoords:()=>ah,getSliceSize:()=>ih,getSparseFillEmptyRowsIndicesDenseShapeMismatch:()=>Lh,getSparseFillEmptyRowsNegativeIndexErrorMessage:()=>Dh,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:()=>Fh,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:()=>Uh,getSparseReshapeInputOutputMismatchErrorMessage:()=>Gh,getSparseReshapeInputOutputMultipleErrorMessage:()=>Vh,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:()=>$h,getSparseReshapeNegativeOutputDimErrorMessage:()=>Bh,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:()=>qh,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:()=>zh,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:()=>Wh,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:()=>Hh,getUndoAxesPermutation:()=>Yi,isIdentityPermutation:()=>Nh,log:()=>nn,mergeRealAndImagArrays:()=>gh,prepareAndValidate:()=>lh,prepareSplitSize:()=>Ph,segment_util:()=>s,shouldFuse:()=>Uc,slice_util:()=>t,splitRealAndImagArrays:()=>vh,tupleValuesAreOne:()=>Va,upcastType:()=>eo,validateDefaultValueShape:()=>Jd,validateInput:()=>Cc,validateUpdateShape:()=>jc,warn:()=>rn});var i={};n.r(i),n.d(i,{json:()=>cp});var l={};n.r(l),n.d(l,{json:()=>dp});var u={};n.r(u),n.d(u,{json:()=>hp});var c={};n.r(c),n.d(c,{json:()=>pp});var d={};n.r(d),n.d(d,{json:()=>fp});var h={};n.r(h),n.d(h,{json:()=>mp});var p={};n.r(p),n.d(p,{json:()=>yp});var f={};n.r(f),n.d(f,{json:()=>gp});var m={};n.r(m),n.d(m,{json:()=>vp});var y={};n.r(y),n.d(y,{json:()=>bp});var g={};n.r(g),n.d(g,{json:()=>xp});var v={};n.r(v),n.d(v,{json:()=>wp});var b={};n.r(b),n.d(b,{json:()=>_p});var x={};n.r(x),n.d(x,{json:()=>Sp});var w={};n.r(w),n.d(w,{json:()=>kp});var _={};n.r(_),n.d(_,{json:()=>Tp});var S={};n.r(S),n.d(S,{json:()=>Ep});var k={};n.r(k),n.d(k,{json:()=>jp});var T={};n.r(T),n.d(T,{json:()=>Cp});var E={};n.r(E),n.d(E,{OP_SCOPE_SUFFIX:()=>xo,abs:()=>va,acos:()=>ba,acosh:()=>xa,add:()=>wa,addN:()=>_a,all:()=>Sa,any:()=>ka,argMax:()=>Ta,argMin:()=>Ea,asin:()=>ja,asinh:()=>Ca,atan:()=>Ia,atan2:()=>Oa,atanh:()=>Aa,avgPool:()=>qa,avgPool3d:()=>Xa,basicLSTMCell:()=>ti,batchNorm:()=>ni,batchNorm2d:()=>oi,batchNorm3d:()=>si,batchNorm4d:()=>ai,batchToSpaceND:()=>ri,bincount:()=>ii,booleanMaskAsync:()=>bc,broadcastArgs:()=>li,broadcastTo:()=>ui,buffer:()=>_s,cast:()=>Ss,ceil:()=>ci,clipByValue:()=>hi,clone:()=>ks,complex:()=>_o,concat:()=>Ya,concat1d:()=>pi,concat2d:()=>fi,concat3d:()=>mi,concat4d:()=>yi,conv1d:()=>vi,conv2d:()=>gi,conv2dTranspose:()=>xi,conv3d:()=>wi,conv3dTranspose:()=>Si,cos:()=>ki,cosh:()=>Ti,cosineWindow:()=>Pc,cumprod:()=>Ei,cumsum:()=>ji,denseBincount:()=>Ci,depthToSpace:()=>Ii,depthwiseConv2d:()=>Oi,diag:()=>Ai,dilation2d:()=>Ri,div:()=>Mi,divNoNan:()=>Fi,dot:()=>$i,dropout:()=>Nc,einsum:()=>Bi,elu:()=>Ui,enclosingPowerOfTwo:()=>Mc,equal:()=>Pi,erf:()=>Vi,euclideanNorm:()=>al,exp:()=>il,expandDims:()=>ll,expm1:()=>ul,eye:()=>dl,fft:()=>Xu,fill:()=>di,floor:()=>hl,floorDiv:()=>Ni,fused:()=>r,gather:()=>pl,gatherND:()=>Rc,greater:()=>fl,greaterEqual:()=>ml,ifft:()=>Yu,imag:()=>yl,image:()=>Ud,inTopKAsync:()=>Lc,irfft:()=>Ku,isFinite:()=>gl,isInf:()=>vl,isNaN:()=>bl,leakyRelu:()=>xl,less:()=>wl,lessEqual:()=>_l,linalg:()=>Vd,linspace:()=>Sl,localResponseNormalization:()=>kl,log:()=>Tl,log1p:()=>El,logSigmoid:()=>Ol,logSoftmax:()=>Rl,logSumExp:()=>Nl,logicalAnd:()=>Ml,logicalNot:()=>Pl,logicalOr:()=>Ll,logicalXor:()=>Dl,losses:()=>Gd,lowerBound:()=>Bl,matMul:()=>Ka,max:()=>Zi,maxPool:()=>Ul,maxPool3d:()=>Vl,maxPoolWithArgmax:()=>Gl,maximum:()=>zl,mean:()=>Wl,meshgrid:()=>Xl,min:()=>Qi,minimum:()=>Yl,mirrorPad:()=>Kl,mod:()=>Zl,moments:()=>Ql,movingAverage:()=>Ec,mul:()=>Za,multiRNNCell:()=>Jl,multinomial:()=>eu,neg:()=>Cl,norm:()=>sl,notEqual:()=>tu,oneHot:()=>ru,ones:()=>ql,onesLike:()=>nu,op:()=>wo,outerProduct:()=>ou,pad:()=>su,pad1d:()=>au,pad2d:()=>iu,pad3d:()=>lu,pad4d:()=>uu,pool:()=>du,pow:()=>Ji,prelu:()=>hu,print:()=>Ts,prod:()=>pu,raggedGather:()=>fu,raggedTensorToTensor:()=>mu,rand:()=>yu,randomGamma:()=>wu,randomNormal:()=>_u,randomStandardNormal:()=>Su,randomUniform:()=>ku,range:()=>Tu,real:()=>Eu,reciprocal:()=>ju,relu:()=>Cu,relu6:()=>Iu,reshape:()=>Ha,reverse:()=>Ou,reverse1d:()=>Au,reverse2d:()=>Ru,reverse3d:()=>Nu,reverse4d:()=>Mu,rfft:()=>Qu,round:()=>Pu,rsqrt:()=>Lu,scalar:()=>el,scatterND:()=>Oc,searchSorted:()=>$l,selu:()=>Du,separableConv2d:()=>Fu,setdiff1dAsync:()=>$u,sigmoid:()=>Qa,sign:()=>Bu,signal:()=>Bd,sin:()=>Uu,sinh:()=>Vu,slice:()=>Ja,slice1d:()=>Gu,slice2d:()=>zu,slice3d:()=>Wu,slice4d:()=>Hu,softmax:()=>qu,softplus:()=>Il,spaceToBatchND:()=>cu,sparse:()=>zd,sparseToDense:()=>Ac,spectral:()=>$d,split:()=>Zu,sqrt:()=>tl,square:()=>rl,squaredDifference:()=>Ju,squeeze:()=>ec,stack:()=>tc,step:()=>rc,stridedSlice:()=>nc,string:()=>Wd,sub:()=>Al,sum:()=>nl,tan:()=>oc,tanh:()=>ei,tensor:()=>ko,tensor1d:()=>sc,tensor2d:()=>ac,tensor3d:()=>Ys,tensor4d:()=>ic,tensor5d:()=>lc,tensor6d:()=>uc,tile:()=>cl,topk:()=>cc,transpose:()=>Tc,truncatedNormal:()=>dc,unique:()=>hc,unsortedSegmentSum:()=>pc,unstack:()=>fc,upperBound:()=>mc,variable:()=>yc,where:()=>Li,whereAsync:()=>vc,zeros:()=>Hl,zerosLike:()=>Di});var j={};n.r(j),n.d(j,{addImpl:()=>lv,bincountImpl:()=>cv,bincountReduceImpl:()=>dv,castImpl:()=>ov,ceilImpl:()=>mv,concatImpl:()=>yv,equalImpl:()=>gv,expImpl:()=>vv,expm1Impl:()=>bv,floorImpl:()=>xv,gatherNdImpl:()=>wv,gatherV2Impl:()=>_v,greaterEqualImpl:()=>kv,greaterImpl:()=>Sv,lessEqualImpl:()=>Ev,lessImpl:()=>Tv,linSpaceImpl:()=>jv,logImpl:()=>Cv,maxImpl:()=>Iv,maximumImpl:()=>Ov,minimumImpl:()=>Av,multiplyImpl:()=>Rv,negImpl:()=>Mv,notEqualImpl:()=>Pv,prodImpl:()=>Dv,raggedGatherImpl:()=>$v,raggedTensorToTensorImpl:()=>zv,rangeImpl:()=>Wv,rsqrtImpl:()=>Hv,scatterImpl:()=>qv,sigmoidImpl:()=>Xv,simpleAbsImpl:()=>Jg,sliceImpl:()=>Yv,sparseFillEmptyRowsImpl:()=>Kv,sparseReshapeImpl:()=>Zv,sparseSegmentReductionImpl:()=>Qv,sqrtImpl:()=>Jv,stridedSliceImpl:()=>eb,stringNGramsImpl:()=>rb,stringSplitImpl:()=>ob,stringToHashBucketFastImpl:()=>sb,subImpl:()=>ab,tileImpl:()=>lb,topKImpl:()=>db,transposeImpl:()=>Lv,uniqueImpl:()=>hb});var C=n(35),I=n.n(C);let O=0,A=0;class R{constructor(e){}static async setup(e){const t=new R;if(t.video=e,!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Browser API navigator.mediaDevices.getUserMedia not available");const r=await navigator.mediaDevices.getUserMedia({audio:!1,video:{width:{ideal:1920},height:{ideal:1080}}});return t.video.srcObject=r,await new Promise((r=>{t.video.onloadedmetadata=()=>{r(e)}})),t.video.play(),O=t.video.videoWidth,A=t.video.videoHeight,t.video.width=O/4,t.video.height=A/4,console.log("Width: "+O+"px"),console.log("Height: "+A+"px"),t}}var N=n(264);class M{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class P{refCount(e){return L("refCount")}incRef(e){return L("incRef")}timerAvailable(){return!0}time(e){return L("time")}read(e){return L("read")}readSync(e){return L("readSync")}readToGPU(e,t){return L("readToGPU")}numDataIds(){return L("numDataIds")}disposeData(e,t){return L("disposeData")}write(e,t,r){return L("write")}move(e,t,r,n,o){return L("move")}memory(){return L("memory")}floatPrecision(){return L("floatPrecision")}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}dispose(){return L("dispose")}}function L(e){throw new Error(`'${e}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}function D(e,t,r){return Math.max(e,Math.min(t,r))}function F(e){return e%2==0?e:e+1}function $(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function B(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function U(e,t,r=""){B(W(e,t),(()=>r+` Shapes ${e} and ${t} must match`))}function V(e){B(null!=e,(()=>"The input to the tensor constructor must be a non-null value."))}function G(e,t=[],r=!1){if(null==t&&(t=[]),Array.isArray(e)||te(e)&&!r)for(let n=0;n<e.length;++n)G(e[n],t,r);else t.push(e);return t}function z(e){if(0===e.length)return 1;let t=e[0];for(let r=1;r<e.length;r++)t*=e[r];return t}function W(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function H(e){return e%1==0}function q(e){const t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function X(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function Y(e,t=(e=>0),r,n=setTimeout){return new Promise(((o,s)=>{let a=0;const i=()=>{if(e())return void o();a++;const l=t(a);null!=r&&a>=r?s():n(i,l)};i()}))}function K(e,t){const r=t.length;return B((e=null==e?t.map(((e,t)=>t)):[].concat(e)).every((e=>e>=-r&&e<r)),(()=>`All values in axis param must be in range [-${r}, ${r}) but got axis ${e}`)),B(e.every((e=>H(e))),(()=>`All values in axis param must be integers but got axis ${e}`)),e.map((e=>e<0?r+e:e))}function Z(e,t){const r=[],n=[],o=null!=t&&Array.isArray(t)&&0===t.length,s=null==t||o?null:K(t,e).sort();let a=0;for(let t=0;t<e.length;++t){if(null!=s){if(s[a]===t&&1!==e[t])throw new Error(`Can't squeeze axis ${t} since its dim '${e[t]}' is not 1`);(null==s[a]||s[a]>t)&&1===e[t]&&(r.push(e[t]),n.push(t)),s[a]<=t&&a++}1!==e[t]&&(r.push(e[t]),n.push(t))}return{newShape:r,keptDims:n}}function Q(e,t){let r=null;if(null==e||"float32"===e)r=new Float32Array(t);else if("int32"===e)r=new Int32Array(t);else{if("bool"!==e)throw new Error(`Unknown data type ${e}`);r=new Uint8Array(t)}return r}function J(e,t){let r=null;if(null==e||"float32"===e)r=new Float32Array(t);else if("int32"===e)r=new Int32Array(t);else if("bool"===e)r=new Uint8Array(t);else{if("string"!==e)throw new Error(`Unknown data type ${e}`);r=new Array(t)}return r}function ee(e,t){return!("complex64"===t||"float32"===t&&"complex64"!==e||"int32"===t&&"float32"!==e&&"complex64"!==e||"bool"===t&&"bool"===e)}function te(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray}function re(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error(`Unknown dtype ${e}`)}function ne(e){return"string"==typeof e||e instanceof String}function oe(e){return Array.isArray(e)?oe(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray?"int32":"number"==typeof e?"float32":ne(e)?"string":"boolean"==typeof e?"bool":"float32"}function se(e){return!!(e&&e.constructor&&e.call&&e.apply)}function ae(e,t){for(let r=t;r<e;++r)if(e%r==0)return r;return e}function ie(e){const t=e.length;if(t<2)return[];const r=new Array(t-1);r[t-2]=e[t-1];for(let n=t-3;n>=0;--n)r[n]=r[n+1]*e[n+1];return r}function le(e,t,r,n=!1){const o=new Array;if(1===t.length){const s=t[0]*(n?2:1);for(let t=0;t<s;t++)o[t]=r[e+t]}else{const s=t[0],a=t.slice(1),i=a.reduce(((e,t)=>e*t))*(n?2:1);for(let t=0;t<s;t++)o[t]=le(e+t*i,a,r,n)}return o}function ue(e,t,r=!1){if(0===e.length)return t[0];const n=e.reduce(((e,t)=>e*t))*(r?2:1);if(0===n)return[];if(n!==t.length)throw new Error(`[${e}] does not match the input size ${t.length}${r?" for a complex tensor":""}.`);return le(0,e,t,r)}function ce(e,t){const r=de(e,t);for(let e=0;e<r.length;e++)r[e]=1;return r}function de(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error(`Unknown data type ${t}`)}function he(e){e.forEach((t=>{B(Number.isInteger(t)&&t>=0,(()=>`Tensor must have a shape comprised of positive integers but got shape [${e}].`))}))}function pe(e,t,r){if(0===t)return 0;if(1===t)return e[0];let n=e[e.length-1];for(let t=0;t<e.length-1;++t)n+=r[t]*e[t];return n}function fe(e,t,r){if(0===t)return[];if(1===t)return[e];const n=new Array(t);for(let t=0;t<n.length-1;++t)n[t]=Math.floor(e/r[t]),e-=n[t]*r[t];return n[n.length-1]=e,n}function me(e){return e&&e.then&&"function"==typeof e.then}const ye="tfjsflags";class ge{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ve,this.populateURLFlags()}setPlatform(e,t){null!=this.platform&&(be().getBool("IS_TEST")||be().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},null!=this.urlFlags[e]){const t=this.urlFlags[e];be().getBool("IS_TEST")||be().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${t}.`),this.set(e,t)}}async getAsync(e){return e in this.flags||(this.flags[e]=await this.evaluateFlag(e)),this.flags[e]}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(me(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(null==this.flagRegistry[e])throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(null==this.flagRegistry[e])throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(void 0===this.global||void 0===this.global.location||void 0===this.global.location.search)return;const e=this.getQueryParams(this.global.location.search);ye in e&&e[ye].split(",").forEach((e=>{const[t,r]=e.split(":");this.urlFlags[t]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error(`Could not parse value flag value ${t} for flag ${e}.`)}(t,r)}))}}function ve(e){const t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,((e,...r)=>(function(e,t,r){e[decodeURIComponent(t)]=decodeURIComponent(r||"")}(t,r[0],r[1]),r.join("=")))),t}function be(){return we}let xe,we=null;function _e(){if(null==xe){let e;if("undefined"!=typeof window)e=window;else if(void 0!==n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}xe=e}return xe}function Se(e,t){const r=function(){const e=_e();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(r.has(e))return r.get(e);{const n=t();return r.set(e,n),r.get(e)}}const ke="Acos",Te="Acosh",Ee="Add",je="AddN",Ce="ArgMax",Ie="ArgMin",Oe="Asin",Ae="Asinh",Re="Atan",Ne="Atanh",Me="Atan2",Pe="AvgPool",Le="AvgPool3D",De="BatchMatMul",Fe="BatchToSpaceND",$e="Bincount",Be="BroadcastArgs",Ue="Cast",Ve="Ceil",Ge="ClipByValue",ze="Complex",We="ComplexAbs",He="Concat",qe="Conv2D",Xe="Conv2DBackpropFilter",Ye="Conv2DBackpropInput",Ke="Conv3D",Ze="Conv3DBackpropInputV2",Qe="Cosh",Je="Cumprod",et="Cumsum",tt="CropAndResize",rt="DenseBincount",nt="DepthToSpace",ot="DepthwiseConv2dNative",st="DepthwiseConv2dNativeBackpropFilter",at="DepthwiseConv2dNativeBackpropInput",it="Diag",lt="Dilation2D",ut="RealDiv",ct="Einsum",dt="Equal",ht="Exp",pt="ExpandDims",ft="Expm1",mt="Fill",yt="FlipLeftRight",gt="Floor",vt="FloorDiv",bt="FusedBatchNorm",xt="GatherV2",wt="GatherNd",_t="Greater",St="GreaterEqual",kt="Identity",Tt="IFFT",Et="Imag",jt="IsFinite",Ct="IsInf",It="IsNan",Ot="LeakyRelu",At="Less",Rt="LessEqual",Nt="LinSpace",Mt="Log",Pt="Log1p",Lt="LogicalAnd",Dt="LogicalNot",Ft="LogicalOr",$t="Maximum",Bt="MaxPool",Ut="MaxPool3D",Vt="MaxPoolWithArgmax",Gt="Mean",zt="Minimum",Wt="MirrorPad",Ht="Multinomial",qt="Multiply",Xt="NotEqual",Yt="NonMaxSuppressionV3",Kt="NonMaxSuppressionV4",Zt="NonMaxSuppressionV5",Qt="OnesLike",Jt="OneHot",er="Pack",tr="PadV2",rr="Prelu",nr="Prod",or="RaggedGather",sr="RaggedTensorToTensor",ar="Range",ir="Real",lr="Reciprocal",ur="Relu",cr="Reshape",dr="ResizeNearestNeighbor",hr="ResizeBilinear",pr="Relu6",fr="Reverse",mr="Round",yr="Rsqrt",gr="ScatterNd",vr="SearchSorted",br="Select",xr="Selu",wr="Slice",_r="Sinh",Sr="Sign",kr="Sigmoid",Tr="Softplus",Er="Sqrt",jr="SpaceToBatchND",Cr="SplitV",Ir="Softmax",Or="SparseFillEmptyRows",Ar="SparseReshape",Rr="SparseSegmentMean",Nr="SparseSegmentSum",Mr="SparseToDense",Pr="SquaredDifference",Lr="StridedSlice",Dr="StringNGrams",Fr="StringSplit",$r="StringToHashBucketFast",Br="Sub",Ur="Tanh",Vr="Tile",Gr="TopK",zr="Transform",Wr="Transpose",Hr="Unique",qr="Unpack",Xr="UnsortedSegmentSum",Yr="ZerosLike",Kr="Step",Zr="FromPixels",Qr="RotateWithOffset",Jr="_FusedMatMul",en="FusedConv2D",tn="FusedDepthwiseConv2D";function rn(...e){be().getBool("IS_TEST")||be().getBool("PROD")||console.warn(...e)}function nn(...e){be().getBool("IS_TEST")||be().getBool("PROD")||console.log(...e)}const on=Se("kernelRegistry",(()=>new Map)),sn=Se("gradRegistry",(()=>new Map));function an(e,t){const r=dn(e,t);return on.get(r)}function ln(e){return sn.get(e)}function un(e){const t=on.entries(),r=[];for(;;){const{done:n,value:o}=t.next();if(n)break;const[s,a]=o,[i]=s.split("_");i===e&&r.push(a)}return r}function cn(e){const{kernelName:t,backendName:r}=e,n=dn(t,r);on.has(n)&&rn(`The kernel '${t}' for backend '${r}' is already registered`),on.set(n,e)}function dn(e,t){return`${t}_${e}`}var hn=n(720);const pn=n.n(hn)()||hn;function fn(e){return pn.fromString(e,!0,16)}const mn=fn("c3a5c85c97cb3127"),yn=fn("b492b66fbe98f273"),gn=fn("9ae16a3b2f90404f");function vn(e){return e.xor(e.shru(47))}function bn(e,t,r){const n=e.slice(t,t+r);return pn.fromBytes(Array.from(n),!0,!0)}function xn(e,t){return bn(e,t,8)}function wn(e,t){return bn(e,t,4)}function _n(e,t){return 0===t?e:e.shru(t).or(e.shl(64-t))}function Sn(e,t,r=fn("9ddfea08eb382d69")){let n=e.xor(t).mul(r);n=n.xor(n.shru(47));let o=t.xor(n).mul(r);return o=o.xor(o.shru(47)),o=o.mul(r),o}function kn(e,t,r,n){return function(e,t,r,n,o,s){o=o.add(e),s=_n(s.add(o).add(n),21);const a=o;return o=(o=o.add(t)).add(r),s=s.add(_n(o,44)),[o.add(n),s.add(a)]}(xn(e,t),xn(e,t+8),xn(e,t+16),xn(e,t+24),r,n)}function Tn(e,t=e.length){const r=pn.fromNumber(81,!0);if(t<=32)return t<=16?function(e,t=e.length){if(t>=8){const r=gn.add(2*t),n=xn(e,0).add(gn),o=xn(e,t-8);return Sn(_n(o,37).mul(r).add(n),_n(n,25).add(o).mul(r),r)}if(t>=4){const r=gn.add(2*t);return Sn(wn(e,0).shl(3).add(t),wn(e,t-4),r)}if(t>0){const r=e[0]+(e[t>>1]<<8),n=t+(e[t-1]<<2);return vn(gn.mul(r).xor(mn.mul(n))).mul(gn)}return gn}(e,t):function(e,t=e.length){const r=gn.add(2*t),n=xn(e,0).mul(yn),o=xn(e,8),s=xn(e,t-8).mul(r),a=xn(e,t-16).mul(gn);return Sn(_n(n.add(o),43).add(_n(s,30)).add(a),n.add(_n(o.add(gn),18)).add(s),r)}(e,t);if(t<=64)return function(e,t=e.length){const r=gn.add(2*t),n=xn(e,0).mul(gn),o=xn(e,8),s=xn(e,t-8).mul(r),a=xn(e,t-16).mul(gn),i=_n(n.add(o),43).add(_n(s,30)).add(a),l=Sn(i,n.add(_n(o.add(gn),18)).add(s),r),u=xn(e,16).mul(r),c=xn(e,24),d=i.add(xn(e,t-32)).mul(r),h=l.add(xn(e,t-24)).mul(r);return Sn(_n(u.add(c),43).add(_n(d,30)).add(h),u.add(_n(c.add(n),18)).add(d),r)}(e,t);let n=r,o=r.mul(yn).add(113),s=vn(o.mul(gn).add(113)).mul(gn),a=[pn.UZERO,pn.UZERO],i=[pn.UZERO,pn.UZERO];n=n.mul(gn).add(xn(e,0));let l=0;const u=64*(t-1>>6),c=u+(t-1&63)-63;do{n=_n(n.add(o).add(a[0]).add(xn(e,l+8)),37).mul(yn),o=_n(o.add(a[1]).add(xn(e,l+48)),42).mul(yn),n=n.xor(i[1]),o=o.add(a[0]).add(xn(e,l+40)),s=_n(s.add(i[0]),33).mul(yn),a=kn(e,l,a[1].mul(yn),n.add(i[0])),i=kn(e,l+32,s.add(i[1]),o.add(xn(e,l+16))),[s,n]=[n,s],l+=64}while(l!==u);const d=yn.add(s.and(255).shl(1));return l=c,i[0]=i[0].add(t-1&63),a[0]=a[0].add(i[0]),i[0]=i[0].add(a[0]),n=_n(n.add(o).add(a[0]).add(xn(e,l+8)),37).mul(d),o=_n(o.add(a[1]).add(xn(e,l+48)),42).mul(d),n=n.xor(i[1].mul(9)),o=o.add(a[0].mul(9).add(xn(e,l+40))),s=_n(s.add(i[0]),33).mul(d),a=kn(e,l,a[1].mul(d),n.add(i[0])),i=kn(e,l+32,s.add(i[1]),o.add(xn(e,l+16))),[s,n]=[n,s],Sn(Sn(a[0],i[0],d).add(vn(o).mul(mn)).add(s),Sn(a[1],i[1],d).add(n),d)}function En(e,t){return"string"===t?In(e):jn([e],t)}function jn(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=G(e)),be().getBool("DEBUG")&&function(e,t){for(let r=0;r<e.length;r++){const n=e[r];if(isNaN(n)||!isFinite(n))throw Error(`A tensor of type ${t} being uploaded contains ${n}.`)}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){const t=new Uint8Array(e.length);for(let r=0;r<t.length;++r)0!==Math.round(e[r])&&(t[r]=1);return t}throw new Error(`Unknown data type ${t}`)}function Cn(){return be().platform.now()}function In(e,t="utf-8"){return t=t||"utf-8",be().platform.encode(e,t)}function On(e,t="utf-8"){return t=t||"utf-8",be().platform.decode(e,t)}class An{constructor(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new Nn)}profileKernel(e,t,r){let n;const o=()=>{n=r()};let s;const a=Cn();if(this.backendTimer.timerAvailable())s=this.backendTimer.time(o);else{o();for(const e of n)e.dataSync();s=Promise.resolve({kernelMs:Cn()-a})}if(be().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let t=0;t<n.length;t++){const r=n[t];r.data().then((t=>{Rn(t,r.dtype,e)}))}return{kernelName:e,outputs:n,inputs:t,timeMs:s.then((e=>e.kernelMs)),extraInfo:s.then((e=>null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""))}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:n,inputs:o,extraInfo:s}=e;r.forEach((e=>{Promise.all([e.data(),n,s]).then((r=>{this.logger.logKernelProfile(t,e,r[0],r[1],o,r[2])}))}))}}function Rn(e,t,r){if("float32"!==t)return!1;for(let t=0;t<e.length;t++){const n=e[t];if(isNaN(n)||!isFinite(n))return console.warn(`Found ${n} in the result of '${r}'`),!0}return!1}class Nn{logKernelProfile(e,t,r,n,o,s){const a="number"==typeof n?X(`${n}ms`,9):n.error,i=X(e,25),l=t.rank,u=t.size,c=X(t.shape.toString(),14);let d="";for(const e in o){const r=o[e];if(null!=r){const n=r.shape||t.shape,o=n.length;d+=`${e}: ${o}D ${o>0?n:""} `}}console.log(`%c${i}\t%c${a}\t%c${l}D ${c}\t%c${u}\t%c${d}\t%c${s}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}const Mn=20,Pn=3,Ln=7;function Dn(e,t,r,n){const o=ie(t),s=function(e,t,r,n){const o=z(t),s=n[n.length-1],a=new Array(s).fill(0),i=t.length,l="complex64"===r?Un(e):e;if(i>1)for(let e=0;e<o/s;e++){const t=e*s;for(let e=0;e<s;e++)a[e]=Math.max(a[e],Fn(l[t+e],0,r).length)}return a}(e,t,r,o),a=t.length,i=Bn(e,t,r,o,s),l=["Tensor"];return n&&(l.push(`  dtype: ${r}`),l.push(`  rank: ${a}`),l.push(`  shape: [${t}]`),l.push("  values:")),l.push(i.map((e=>"    "+e)).join("\n")),l.join("\n")}function Fn(e,t,r){let n;return n=Array.isArray(e)?`${parseFloat(e[0].toFixed(Ln))} + ${parseFloat(e[1].toFixed(Ln))}j`:ne(e)?`'${e}'`:"bool"===r?$n(e):parseFloat(e.toFixed(Ln)).toString(),X(n,t)}function $n(e){return 0===e?"false":"true"}function Bn(e,t,r,n,o,s=!0){const a="complex64"===r?2:1,i=t[0],l=t.length;if(0===l)return"complex64"===r?[Fn(Un(e)[0],0,r)]:"bool"===r?[$n(e[0])]:[e[0].toString()];if(1===l){if(i>Mn){const t=Pn*a;let n=Array.from(e.slice(0,t)),s=Array.from(e.slice((i-Pn)*a,i*a));return"complex64"===r&&(n=Un(n),s=Un(s)),["["+n.map(((e,t)=>Fn(e,o[t],r))).join(", ")+", ..., "+s.map(((e,t)=>Fn(e,o[i-Pn+t],r))).join(", ")+"]"]}return["["+("complex64"===r?Un(e):Array.from(e)).map(((e,t)=>Fn(e,o[t],r))).join(", ")+"]"]}const u=t.slice(1),c=n.slice(1),d=n[0]*a,h=[];if(i>Mn){for(let t=0;t<Pn;t++){const n=t*d,s=n+d;h.push(...Bn(e.slice(n,s),u,r,c,o,!1))}h.push("...");for(let t=i-Pn;t<i;t++){const n=t*d,s=n+d;h.push(...Bn(e.slice(n,s),u,r,c,o,t===i-1))}}else for(let t=0;t<i;t++){const n=t*d,s=n+d;h.push(...Bn(e.slice(n,s),u,r,c,o,t===i-1))}const p=2===l?",":"";h[0]="["+h[0]+p;for(let e=1;e<h.length-1;e++)h[e]=" "+h[e]+p;let f=",\n";for(let e=2;e<l;e++)f+="\n";return h[h.length-1]=" "+h[h.length-1]+"]"+(s?"":f),h}function Un(e){const t=[];for(let r=0;r<e.length;r+=2)t.push([e[r],e[r+1]]);return t}class Vn{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=z(e),null!=r){const e=r.length;B(e===this.size,(()=>`Length of values '${e}' does not match the size inferred by the shape '${this.size}'.`))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||J(t,this.size),this.strides=ie(e)}set(e,...t){0===t.length&&(t=[0]),B(t.length===this.rank,(()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`));const r=this.locToIndex(t);this.values[r]=e}get(...e){0===e.length&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const t=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(t)}t++}let r=e[e.length-1];for(let t=0;t<e.length-1;++t)r+=this.strides[t]*e[t];return this.values[r]}locToIndex(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(0===this.rank)return[];if(1===this.rank)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Gn().makeTensor(this.values,this.shape,this.dtype)}}let Gn=null,zn=null,Wn=null;class Hn{constructor(e,t,r,n){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=z(e),this.strides=ie(e),this.dataId=r,this.id=n,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return zn.buffer(this.shape,this.dtype,e)}bufferSync(){return zn.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return ue(this.shape,e,"complex64"===this.dtype)}arraySync(){return ue(this.shape,this.dataSync(),"complex64"===this.dtype)}async data(){this.throwIfDisposed();const e=Gn().read(this.dataId);if("string"===this.dtype){const t=await e;try{return t.map((e=>On(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Gn().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Gn().readSync(this.dataId);if("string"===this.dtype)try{return e.map((e=>On(e)))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Gn().read(this.dataId);return"string"===this.dtype?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(Gn().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return zn.print(this,e)}clone(){return this.throwIfDisposed(),zn.clone(this)}toString(e=!1){return Dn(this.dataSync(),this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),zn.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),Gn().makeVariable(this,e,t,r)}}Object.defineProperty(Hn,Symbol.hasInstance,{value:e=>!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}),Se("Tensor",(()=>Hn));class qn extends Hn{constructor(e,t,r,n){super(e.shape,e.dtype,e.dataId,n),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!W(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Gn().disposeTensor(this),this.dataId=e.dataId,Gn().incRef(this,null)}dispose(){Gn().disposeVariable(this),this.isDisposedInternal=!0}}var Xn,Yn,Kn,Zn,Qn;Object.defineProperty(qn,Symbol.hasInstance,{value:e=>e instanceof Hn&&null!=e.assign&&e.assign instanceof Function}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(Xn||(Xn={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Yn||(Yn={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Kn||(Kn={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(Zn||(Zn={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Qn||(Qn={}));const Jn={float32:Zn,int32:Yn,bool:Kn,complex64:Qn};function eo(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error(`Can not upcast ${e} with ${t}`)}return Jn[e][t]}function to(e){return eo(e,"int32")}function ro(e,t){if(e.dtype===t.dtype)return[e,t];const r=eo(e.dtype,t.dtype);return[e.cast(r),t.cast(r)]}function no(e){const t=[];return oo(e,t,new Set),t}function oo(e,t,r){if(null==e)return;if(e instanceof Hn)return void t.push(e);if(n=e,!Array.isArray(n)&&"object"!=typeof n)return;var n;const o=e;for(const e in o){const n=o[e];r.has(n)||(r.add(n),oo(n,t,r))}}function so(e){return null!=e.kernelName}class ao{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((e=>e.name))))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class io{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new ao}async ready(){if(null!=this.pendingBackendInit)return this.pendingBackendInit.then((()=>{}));if(null!=this.backendInstance)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success)return void await this.setBackend(r)}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(null!=this.pendingBackendInit)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(null==this.backendInstance){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;{const{asyncInit:t}=this.initializeBackend(e);if(t)return null}}return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(rn(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(null==this.registryFactory[e])throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,null==this.registry[e]){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new An(this.backendInstance),!0}setupRegisteredKernels(){un(this.backendName).forEach((e=>{null!=e.setupFunc&&e.setupFunc(this.backendInstance)}))}disposeRegisteredKernels(e){un(e).forEach((t=>{null!=t.disposeFunc&&t.disposeFunc(this.registry[e])}))}initializeBackend(e){const t=this.registryFactory[e];if(null==t)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(!r||r instanceof P||"function"!=typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};{const t=++this.pendingBackendInitId,n=r.then((r=>!(t<this.pendingBackendInitId||(this.registry[e]=r,this.pendingBackendInit=null,0)))).catch((r=>(t<this.pendingBackendInitId||(this.pendingBackendInit=null,rn(`Initialization of backend ${e} failed`),rn(r.stack||r.message)),!1)));return this.pendingBackendInit=n,{success:n,asyncInit:!0}}}catch(t){return rn(`Initialization of backend ${e} failed`),rn(t.stack||t.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort(((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority))}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:n,asyncInit:o}=this.initializeBackend(r);if(o||n)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),n=r.backend,o=this.readSync(t),s=n.refCount(t);n.disposeData(t,!0),r.backend=e,e.move(t,o,r.shape,r.dtype,s),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r,n=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");n=e}return this.scopedRun((()=>this.startScope(n)),(()=>this.endScope(r)),(()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r)))}scopedRun(e,t,r){e();try{const e=r();return t(),e}catch(e){throw t(),e}}nextTensorId(){return io.nextTensorId++}nextVariableId(){return io.nextVariableId++}clone(e){const t=uo.runKernel(kt,{x:e}),r={x:e};return this.addTapeNode(this.state.activeScope.name,r,[t],(e=>({x:()=>{const t={x:e};return uo.runKernel(Ue,t,{dtype:"float32"})}})),[],{}),t}runKernel(e,t,r){if(null==this.backendName&&this.backend,null==an(e,this.backendName))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const n=this.backend.numDataIds();let o=0;r.forEach((e=>{o+="complex64"===e.dtype?3:1}));const s=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=n-t-o-s;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const n=this.isTapeOn(),o=this.state.numBytes,s=this.state.numTensors;let a,i;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;const l=so(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(so(e)){const{kernelName:t,inputs:o,attrs:s}=e;null==this.backendName&&this.backend;const l=an(t,this.backendName);B(null!=l,(()=>`Cannot find registered kernel '${t}' for backend '${this.backendName}'`)),a=()=>{const e=this.backend.numDataIds();i=l.kernelFunc({inputs:o,attrs:s,backend:this.backend});const a=Array.isArray(i)?i:[i];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(t,e,a);const u=a.map((e=>null!=e.rank?e:this.makeTensorFromTensorInfo(e)));if(n){const e=this.getTensorsForGradient(t,o,u);r=this.saveTensorsForBackwardMode(e)}return u}}else{const{forwardFunc:t}=e,o=e=>{n&&(r=e.map((e=>this.keep(this.clone(e)))))};a=()=>{const e=this.backend.numDataIds();i=this.tidy((()=>t(this.backend,o)));const r=Array.isArray(i)?i:[i];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(l,e,r),r}}const{inputs:u,attrs:c}=e,d=so(e)?null:e.backwardsFunc;let h;return this.scopedRun((()=>this.state.kernelDepth++),(()=>this.state.kernelDepth--),(()=>{this.ENV.getBool("DEBUG")||this.state.profiling?(h=this.profiler.profileKernel(l,u,(()=>a())),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),t=h.outputs):t=a()})),n&&this.addTapeNode(l,u,t,d,r,c),this.state.profiling&&this.state.activeProfile.kernels.push({name:l,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-s,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map((e=>null!=u[e]?u[e].shape:null)),outputShapes:t.map((e=>e.shape)),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(i)?t:t[0]}saveTensorsForBackwardMode(e){const t=e.map((e=>this.keep(this.clone(e))));return t}getTensorsForGradient(e,t,r){const n=ln(e);if(null!=n){const e=n.inputsToSave||[],o=n.outputsToSave||[];let s;n.saveAllInputs?(B(Array.isArray(t),(()=>"saveAllInputs is true, expected inputs to be an array.")),s=Object.keys(t).map((e=>t[e]))):s=e.map((e=>t[e]));const a=r.filter(((e,t)=>o[t]));return s.concat(a)}return[]}makeTensor(e,t,r,n){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",n=n||this.backend;let o=e;"string"===r&&ne(e[0])&&(o=e.map((e=>In(e))));const s=n.write(o,t,r),a=new Hn(t,r,s,this.nextTensorId());if(this.trackTensor(a,n),"string"===r){const e=this.state.tensorInfo.get(s),t=function(e){if(null==e)return 0;let t=0;return e.forEach((e=>t+=e.length)),t}(o);this.state.numBytes+=t-e.bytes,e.bytes=t}return a}makeTensorFromDataId(e,t,r,n){const o={dataId:e,shape:t,dtype:r=r||"float32"};return this.makeTensorFromTensorInfo(o,n)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:n,dtype:o}=e,s=new Hn(n,o,r,this.nextTensorId());return this.trackTensor(s,t),s}makeVariable(e,t=!0,r,n){r=r||this.nextVariableId().toString(),null!=n&&n!==e.dtype&&(e=e.cast(n));const o=new qn(e,t,r,this.nextTensorId());if(null!=this.state.registeredVariables[o.name])throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;let r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*re(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof qn||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){const t=e.size*re(e.dtype);this.state.numBytes-=t}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map((e=>e.totalBytesSnapshot))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const e of this.state.activeProfile.kernels)e.kernelTimeMs=await e.kernelTimeMs,e.extraInfo=await e.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}addTapeNode(e,t,r,n,o,s){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:o},i=ln(e);null!=i&&(n=i.gradFunc),null!=n&&(a.gradient=e=>(e=e.map(((e,t)=>{if(null==e){const e=r[t],n=de(e.size,e.dtype);return this.makeTensor(n,e.shape,e.dtype)}return e})),n(e.length>1?e:e[0],o,s))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=no(e),r=new Set(t.map((e=>e.id)));for(let e=0;e<this.state.activeScope.track.length;e++){const t=this.state.activeScope.track[e];t.kept||r.has(t.id)||t.dispose()}const n=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach((e=>{e.kept||e.scopeId!==n.id||this.track(e)}))}gradients(e,t,r,n=!1){if(B(t.length>0,(()=>"gradients() received an empty list of xs.")),null!=r&&"float32"!==r.dtype)throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun((()=>this.startTape()),(()=>this.endTape()),(()=>this.tidy("forward",e)));B(o instanceof Hn,(()=>"The result y returned by f() must be a tensor."));const s=function(e,t,r){const n={},o={};for(let e=0;e<t.length;e++)n[t[e].id]=!0;for(let r=0;r<e.length;r++){const s=e[r],a=s.inputs;for(const e in a){const r=a[e];let i=!1;for(let e=0;e<t.length;e++)if(n[r.id]){s.outputs.forEach((e=>n[e.id]=!0)),i=!0,o[s.id]=!0;break}if(i)break}}const s={};s[r.id]=!0;const a={};for(let t=e.length-1;t>=0;t--){const r=e[t],n=r.inputs;for(let e=0;e<r.outputs.length;e++)if(s[r.outputs[e].id]){for(const e in n)s[n[e].id]=!0,a[r.id]=!0;break}}const i=[];for(let t=0;t<e.length;t++){const r=e[t];if(o[r.id]&&a[r.id]){const e={};for(const t in r.inputs){const o=r.inputs[t];n[o.id]&&(e[t]=o)}const t=Object.assign({},r);t.inputs=e,t.outputs=r.outputs,i.push(t)}}return i}(this.state.activeTape,t,o);if(!n&&0===s.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(()=>{const e={};e[o.id]=null==r?function(e){const t=ce(z(e),"float32");return uo.makeTensor(t,e,"float32")}(o.shape):r,function(e,t,r,n){for(let o=t.length-1;o>=0;o--){const s=t[o],a=[];if(s.outputs.forEach((t=>{const r=e[t.id];null!=r?a.push(r):a.push(null)})),null==s.gradient)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const i=s.gradient(a);for(const t in s.inputs){if(!(t in i))throw new Error(`Cannot backprop through input ${t}. Available gradients found: ${Object.keys(i)}.`);const o=r((()=>i[t]()));if("float32"!==o.dtype)throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${t} must have 'float32' dtype, but has '${o.dtype}'`);const a=s.inputs[t];if(!W(o.shape,a.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${t}' has shape '${o.shape}', which does not match the shape of the input '${a.shape}'`);if(null==e[a.id])e[a.id]=o;else{const t=e[a.id];e[a.id]=n(t,o),t.dispose()}}}}(e,s,(e=>this.tidy(e)),co);const n=t.map((t=>e[t.id]));return 0===this.state.gradientDepth&&(this.state.activeTape.forEach((e=>{for(const t of e.saved)t.dispose()})),this.state.activeTape=null),{value:o,grads:n}}))}customGrad(e){return B(se(e),(()=>"The f passed in customGrad(f) must be a function.")),(...t)=>{let r;B(t.every((e=>e instanceof Hn)),(()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors"));const n={};return t.forEach(((e,t)=>{n[t]=e})),this.runKernelFunc({forwardFunc:(n,o)=>(r=e(...t,o),B(r.value instanceof Hn,(()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor")),B(se(r.gradFunc),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.")),r.value),backwardsFunc:(e,n)=>{const o=r.gradFunc(e,n),s=Array.isArray(o)?o:[o];B(s.length===t.length,(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).")),B(s.every((e=>e instanceof Hn)),(()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."));const a={};return s.forEach(((e,t)=>{a[t]=()=>e})),a},inputs:n})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Cn(),r=await this.backend.time(e);return r.wallMs=Cn()-t,r}track(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new ao;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}function lo(){const e=_e();if(null==e._tfengine){const t=new ge(e);e._tfengine=new io(t)}var t;return t=e._tfengine.ENV,we=t,Gn=()=>e._tfengine,e._tfengine}io.nextTensorId=0,io.nextVariableId=0;const uo=lo();function co(e,t){const r={a:e,b:t};return uo.runKernel(Ee,r)}function ho(e){if(e||"undefined"!=typeof navigator&&null!=navigator){if(e||(e=navigator),"ReactNative"===e.product)return!0;const t=e.userAgent||e.vendor||("undefined"!=typeof window?window.opera:"");if(!t){const t=e;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))}return!1}function po(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}const fo=be();function mo(e,t){let r=e;if(te(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];const n=[];for(;Array.isArray(r)||te(r)&&"string"!==t;)n.push(r.length),r=r[0];return Array.isArray(e)&&be().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&yo(e,n,[]),n}function yo(e,t,r){if(r=r||[],!Array.isArray(e)&&!te(e))return void B(0===t.length,(()=>`Element arr[${r.join("][")}] is a primitive, but should be an array/TypedArray of ${t[0]} elements`));B(t.length>0,(()=>`Element arr[${r.join("][")}] should be a primitive, but is an array of ${e.length} elements`)),B(e.length===t[0],(()=>`Element arr[${r.join("][")}] should have ${t[0]} elements, but has ${e.length} elements`));const n=t.slice(1);for(let t=0;t<e.length;++t)yo(e[t],n,r.concat(t))}function go(e,t,r,n){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error(`Argument '${r}' passed to '${n}' must be ${e} tensor, but got ${t} tensor`)}}function vo(e,t,r,n="numeric"){if(e instanceof Hn)return go(n,e.dtype,t,r),e;let o=oe(e);if("string"!==o&&["bool","int32","float32"].indexOf(n)>=0&&(o=n),go(n,o,t,r),null==e||!te(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){const n=null==e?"null":e.constructor.name;throw new Error(`Argument '${t}' passed to '${r}' must be a Tensor or TensorLike, but got '${n}'`)}const s=mo(e,o);te(e)||Array.isArray(e)||(e=[e]);const a="string"!==o?jn(e,o):G(e,[],!0);return uo.makeTensor(a,s,o)}function bo(e,t,r,n="numeric"){if(!Array.isArray(e))throw new Error(`Argument ${t} passed to ${r} must be a \`Tensor[]\` or \`TensorLike[]\``);return e.map(((e,o)=>vo(e,`${t}[${o}]`,r,n)))}fo.registerFlag("DEBUG",(()=>!1),(e=>{e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),fo.registerFlag("IS_BROWSER",(()=>po())),fo.registerFlag("IS_NODE",(()=>"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node)),fo.registerFlag("IS_CHROME",(()=>"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor))),fo.registerFlag("PROD",(()=>!1)),fo.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(()=>fo.getBool("DEBUG"))),fo.registerFlag("DEPRECATION_WARNINGS_ENABLED",(()=>!0)),fo.registerFlag("IS_TEST",(()=>!1)),fo.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(()=>!0)),fo.registerFlag("WRAP_TO_IMAGEBITMAP",(()=>!1)),fo.registerFlag("ENGINE_COMPILE_ONLY",(()=>!1)),fo.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",(()=>!1)),fo.registerFlag("USE_SETTIMEOUTCUSTOM",(()=>!1));const xo="__op";function wo(e){const t=Object.keys(e);if(1!==t.length)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${t.length} keys.`);let r=t[0];const n=e[r];r.endsWith("_")&&(r=r.substring(0,r.length-1)),r+=xo;const o=(...e)=>{uo.startScope(r);try{const t=n(...e);return me(t)&&console.error("Cannot return a Promise inside of tidy."),uo.endScope(t),t}catch(e){throw uo.endScope(null),e}};return Object.defineProperty(o,"name",{value:r,configurable:!0}),o}const _o=wo({complex_:function(e,t){const r=vo(e,"real","complex"),n=vo(t,"imag","complex");U(r.shape,n.shape,`real and imag shapes, ${r.shape} and ${n.shape}, must match in call to tf.complex().`);const o={real:r,imag:n};return uo.runKernel(ze,o)}});function So(e,t,r,n){if(null==n&&(n=oe(e)),"complex64"===n)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!te(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){he(t);const e=z(t),n=z(r);B(e===n,(()=>`Based on the provided shape, [${t}], the tensor should have ${e} values but has ${n}`));for(let e=0;e<r.length;++e){const n=r[e],o=e!==r.length-1||n!==z(t.slice(e));B(r[e]===t[e]||!o,(()=>`Error creating a new Tensor. Inferred shape (${r}) does not match the provided shape (${t}). `))}}return te(e)||Array.isArray(e)||(e=[e]),t=t||r,e="string"!==n?jn(e,n):G(e,[],!0),uo.makeTensor(e,t,n)}function ko(e,t,r){return So(e,t,mo(e,r),r)}const To={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8},Eo=4;async function jo(e,t){const r=[],n=[],o=Array.isArray(e)?e.map((e=>e.name)):Object.keys(e);for(let s=0;s<o.length;++s){const a=o[s],i=Array.isArray(e)?e[s].tensor:e[a];if("float32"!==i.dtype&&"int32"!==i.dtype&&"bool"!==i.dtype&&"string"!==i.dtype&&"complex64"!==i.dtype)throw new Error(`Unsupported dtype in weight '${a}': ${i.dtype}`);const l={name:a,shape:i.shape,dtype:i.dtype};if("string"===i.dtype){const e=new Promise((async e=>{const t=await i.bytes(),r=t.reduce(((e,t)=>e+t.length),0)+Eo*t.length,n=new Uint8Array(r);let o=0;for(let e=0;e<t.length;e++){const r=t[e],s=new Uint8Array(new Uint32Array([r.length]).buffer);n.set(s,o),o+=Eo,n.set(r,o),o+=r.length}e(n)}));n.push(e)}else n.push(i.data());null!=t&&(l.group=t),r.push(l)}return{data:Io(await Promise.all(n)),specs:r}}function Co(e,t){const r={};let n,o=0;for(const s of t){const t=s.name,a=s.dtype,i=s.shape,l=z(i);let u;if("quantization"in s){const r=s.quantization;if("uint8"===r.dtype||"uint16"===r.dtype){if(!("min"in r)||!("scale"in r))throw new Error(`Weight ${s.name} with quantization ${r.dtype} doesn't have corresponding metadata min and scale.`)}else{if("float16"!==r.dtype)throw new Error(`Weight ${s.name} has unknown quantization dtype ${r.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);if("float32"!==a)throw new Error(`Weight ${s.name} is quantized with ${r.dtype} which only supports weights of type float32 not ${a}.`)}const i=To[r.dtype],c=e.slice(o,o+l*i),d="uint8"===r.dtype?new Uint8Array(c):new Uint16Array(c);if("float32"===a)if("uint8"===r.dtype||"uint16"===r.dtype){u=new Float32Array(d.length);for(let e=0;e<d.length;e++){const t=d[e];u[e]=t*r.scale+r.min}}else{if("float16"!==r.dtype)throw new Error(`Unsupported quantization type ${r.dtype} for weight type float32.`);void 0===n&&(n=$o()),u=n(d)}else{if("int32"!==a)throw new Error(`Unsupported dtype in weight '${t}': ${a}`);if("uint8"!==r.dtype&&"uint16"!==r.dtype)throw new Error(`Unsupported quantization type ${r.dtype} for weight type int32.`);u=new Int32Array(d.length);for(let e=0;e<d.length;e++){const t=d[e];u[e]=Math.round(t*r.scale+r.min)}}o+=l*i}else if("string"===a){const t=z(s.shape);u=[];for(let r=0;r<t;r++){const t=new Uint32Array(e.slice(o,o+Eo))[0];o+=Eo;const r=new Uint8Array(e.slice(o,o+t));u.push(r),o+=t}}else{const n=To[a],s=e.slice(o,o+l*n);if("float32"===a)u=new Float32Array(s);else if("int32"===a)u=new Int32Array(s);else if("bool"===a)u=new Uint8Array(s);else{if("complex64"!==a)throw new Error(`Unsupported dtype in weight '${t}': ${a}`);{u=new Float32Array(s);const e=new Float32Array(u.length/2),n=new Float32Array(u.length/2);for(let t=0;t<e.length;t++)e[t]=u[2*t],n[t]=u[2*t+1];const o=ko(e,i,"float32"),a=ko(n,i,"float32");r[t]=_o(o,a),o.dispose(),a.dispose()}}o+=l*n}"complex64"!==a&&(r[t]=ko(u,i,a))}return r}function Io(e){if(null===e)throw new Error(`Invalid input value: ${JSON.stringify(e)}`);let t=0;const r=[];e.forEach((e=>{if(t+=e.byteLength,r.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${e.constructor.name}`)}));const n=new Uint8Array(t);let o=0;return r.forEach((e=>{n.set(new Uint8Array(e.buffer),o),o+=e.byteLength})),n.buffer}const Oo="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function Ao(e){return Oo?Buffer.byteLength(e):new Blob([e]).size}function Ro(e){if(1===e.length)return e[0];let t=0;e.forEach((e=>{t+=e.byteLength}));const r=new Uint8Array(t);let n=0;return e.forEach((e=>{r.set(new Uint8Array(e),n),n+=e.byteLength})),r.buffer}function No(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);const t=e.split("/");return t[t.length-1]}function Mo(e,t){const r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:t};return null!=e.signature&&(r.signature=e.signature),null!=e.userDefinedMetadata&&(r.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(r.modelInitializer=e.modelInitializer),null!=e.trainingConfig&&(r.trainingConfig=e.trainingConfig),r}function Po(e,t,r){const n={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy};if(null!=e.trainingConfig&&(n.trainingConfig=e.trainingConfig),null!=e.weightsManifest){if(!t)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!r)throw new Error("modelJSON has weightsManifest but weightData is null");n.weightSpecs=t,n.weightData=r}return null!=e.signature&&(n.signature=e.signature),null!=e.userDefinedMetadata&&(n.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(n.modelInitializer=e.modelInitializer),n}async function Lo(e,t){let r,n;return null!=e.weightsManifest&&([r,n]=await t(e.weightsManifest)),Po(e,r,n)}function Do(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Ao(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Ao(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function Fo(e){const t=[];for(const r of e)t.push(...r.weights);return t}function $o(){const e=function(){const e=e=>{let t=e<<13,r=0;for(;0==(8388608&t);)r-=8388608,t<<=1;return t&=-8388609,r+=947912704,t|r},t=new Uint32Array(2048);t[0]=0;for(let r=1;r<1024;r++)t[r]=e(r);for(let e=1024;e<2048;e++)t[e]=939524096+(e-1024<<13);return t}(),t=function(){const e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(let t=1;t<31;t++)e[t]=t<<23;for(let t=33;t<63;t++)e[t]=2147483648+(t-32<<23);return e}(),r=function(){const e=new Uint32Array(64);for(let t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return n=>{const o=new ArrayBuffer(4*n.length),s=new Uint32Array(o);for(let o=0;o<n.length;o++){const a=n[o],i=e[r[a>>10]+(1023&a)]+t[a>>10];s[o]=i}return new Float32Array(o)}}class Bo{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return null==Bo.instance&&(Bo.instance=new Bo),Bo.instance}static registerSaveRouter(e){Bo.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Bo.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Bo.getHandlers(e,"save")}static getLoadHandlers(e,t){return Bo.getHandlers(e,"load",t)}static getHandlers(e,t,r){const n=[];return("load"===t?Bo.getInstance().loadRouters:Bo.getInstance().saveRouters).forEach((t=>{const o=t(e,r);null!==o&&n.push(o)})),n}}const Uo=e=>Bo.registerSaveRouter(e),Vo=e=>Bo.registerLoadRouter(e),Go=e=>Bo.getSaveHandlers(e),zo=(e,t)=>Bo.getLoadHandlers(e,t),Wo="tensorflowjs",Ho="models_store",qo="model_info_store";function Xo(){if(!be().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Yo(e){const t=e.result;t.createObjectStore(Ho,{keyPath:"modelPath"}),t.createObjectStore(qo,{keyPath:"modelPath"})}class Ko{constructor(e){if(this.indexedDB=Xo(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise(((e,r)=>{const n=this.indexedDB.open(Wo,1);n.onupgradeneeded=()=>Yo(n),n.onsuccess=()=>{const o=n.result;if(null==t){const t=o.transaction(Ho,"readonly"),n=t.objectStore(Ho).get(this.modelPath);n.onsuccess=()=>{if(null==n.result)return o.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));e(n.result.modelArtifacts)},n.onerror=e=>(o.close(),r(n.error)),t.oncomplete=()=>o.close()}else{const n=Do(t),s=o.transaction(qo,"readwrite");let a=s.objectStore(qo);const i=a.put({modelPath:this.modelPath,modelArtifactsInfo:n});let l;i.onsuccess=()=>{l=o.transaction(Ho,"readwrite");const i=l.objectStore(Ho).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:n});i.onsuccess=()=>e({modelArtifactsInfo:n}),i.onerror=e=>{a=s.objectStore(qo);const t=a.delete(this.modelPath);t.onsuccess=()=>(o.close(),r(i.error)),t.onerror=e=>(o.close(),r(i.error))}},i.onerror=e=>(o.close(),r(i.error)),s.oncomplete=()=>{null==l?o.close():l.oncomplete=()=>o.close()}}},n.onerror=e=>r(n.error)}))}}Ko.URL_SCHEME="indexeddb://";const Zo=e=>{return be().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Ko.URL_SCHEME)?(t=e.slice(Ko.URL_SCHEME.length),new Ko(t)):null;var t};Bo.registerSaveRouter(Zo),Bo.registerLoadRouter(Zo);class Qo{constructor(){this.indexedDB=Xo()}async listModels(){return new Promise(((e,t)=>{const r=this.indexedDB.open(Wo,1);r.onupgradeneeded=()=>Yo(r),r.onsuccess=()=>{const n=r.result,o=n.transaction(qo,"readonly"),s=o.objectStore(qo).getAll();s.onsuccess=()=>{const t={};for(const e of s.result)t[e.modelPath]=e.modelArtifactsInfo;e(t)},s.onerror=e=>(n.close(),t(s.error)),o.oncomplete=()=>n.close()},r.onerror=e=>t(r.error)}))}async removeModel(e){var t;return e=(t=e).startsWith(Ko.URL_SCHEME)?t.slice(Ko.URL_SCHEME.length):t,new Promise(((t,r)=>{const n=this.indexedDB.open(Wo,1);n.onupgradeneeded=()=>Yo(n),n.onsuccess=()=>{const o=n.result,s=o.transaction(qo,"readwrite"),a=s.objectStore(qo),i=a.get(e);let l;i.onsuccess=()=>{if(null==i.result)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const n=a.delete(e),s=()=>{l=o.transaction(Ho,"readwrite");const n=l.objectStore(Ho).delete(e);n.onsuccess=()=>t(i.result.modelArtifactsInfo),n.onerror=e=>r(i.error)};n.onsuccess=s,n.onerror=e=>(s(),o.close(),r(i.error))}},i.onerror=e=>(o.close(),r(i.error)),s.oncomplete=()=>{null==l?o.close():l.oncomplete=()=>o.close()}},n.onerror=e=>r(n.error)}))}}const Jo="/",es="tensorflowjs_models",ts="info",rs="model_topology",ns="weight_specs",os="weight_data",ss="model_metadata";function as(e){return{info:[es,e,ts].join(Jo),topology:[es,e,rs].join(Jo),weightSpecs:[es,e,ns].join(Jo),weightData:[es,e,os].join(Jo),modelMetadata:[es,e,ss].join(Jo)}}function is(e){for(const t of Object.values(e))window.localStorage.removeItem(t)}function ls(e){const t=e.split(Jo);if(t.length<3)throw new Error(`Invalid key format: ${e}`);return t.slice(1,t.length-1).join(Jo)}class us{constructor(e){if(!be().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=as(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),n=Do(e);try{this.LS.setItem(this.keys.info,JSON.stringify(n)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,function(e){if(Oo)return Buffer.from(e).toString("base64");const t=new Uint8Array(e);let r="";for(let e=0,n=t.length;e<n;e++)r+=String.fromCharCode(t[e]);return btoa(r)}(e.weightData));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:null!=e.signature?e.signature:void 0,userDefinedMetadata:null!=e.userDefinedMetadata?e.userDefinedMetadata:void 0,modelInitializer:null!=e.modelInitializer?e.modelInitializer:void 0,trainingConfig:null!=e.trainingConfig?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:n}}catch(e){throw is(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${n.modelTopologyBytes}, weightSpecsBytes=${n.weightSpecsBytes}, weightDataBytes=${n.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(null==e)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(null==r)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const n=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(null==n)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=n;const o=this.LS.getItem(this.keys.modelMetadata);if(null!=o){const e=JSON.parse(o);t.format=e.format,t.generatedBy=e.generatedBy,t.convertedBy=e.convertedBy,null!=e.signature&&(t.signature=e.signature),null!=e.userDefinedMetadata&&(t.userDefinedMetadata=e.userDefinedMetadata),null!=e.modelInitializer&&(t.modelInitializer=e.modelInitializer),null!=e.trainingConfig&&(t.trainingConfig=e.trainingConfig)}const s=this.LS.getItem(this.keys.weightData);if(null==s)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=function(e){if(Oo){const t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}const t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;++e)r.set([t.charCodeAt(e)],e);return r.buffer}(s),t}}us.URL_SCHEME="localstorage://";const cs=e=>{return be().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(us.URL_SCHEME)?(t=e.slice(us.URL_SCHEME.length),new us(t)):null;var t};Bo.registerSaveRouter(cs),Bo.registerLoadRouter(cs);class ds{constructor(){B(be().getBool("IS_BROWSER"),(()=>"Current environment is not a web browser")),B("undefined"==typeof window||void 0!==window.localStorage,(()=>"Current browser does not appear to support localStorage")),this.LS=window.localStorage}async listModels(){const e={},t=es+Jo,r=Jo+ts;for(let n=0;n<this.LS.length;++n){const o=this.LS.key(n);o.startsWith(t)&&o.endsWith(r)&&(e[ls(o)]=JSON.parse(this.LS.getItem(o)))}return e}async removeModel(e){var t;const r=as(e=(t=e).startsWith(us.URL_SCHEME)?t.slice(us.URL_SCHEME.length):t);if(null==this.LS.getItem(r.info))throw new Error(`Cannot find model at path '${e}'`);const n=JSON.parse(this.LS.getItem(r.info));return is(r),n}}const hs="://";class ps{constructor(){this.managers={}}static getInstance(){return null==ps.instance&&(ps.instance=new ps),ps.instance}static registerManager(e,t){B(null!=e,(()=>"scheme must not be undefined or null.")),e.endsWith(hs)&&(e=e.slice(0,e.indexOf(hs))),B(e.length>0,(()=>"scheme must not be an empty string."));const r=ps.getInstance();B(null==r.managers[e],(()=>`A model store manager is already registered for scheme '${e}'.`)),r.managers[e]=t}static getManager(e){const t=ps.getInstance().managers[e];if(null==t)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(ps.getInstance().managers)}}function fs(e){if(-1===e.indexOf(hs))throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ps.getSchemes().join(",")}`);return{scheme:e.split(hs)[0],path:e.split(hs)[1]}}async function ms(e,t,r=!1){B(e!==t,(()=>`Old path and new path are the same: '${e}'`));const n=Bo.getLoadHandlers(e);B(n.length>0,(()=>`Copying failed because no load handler is found for source URL ${e}.`)),B(n.length<2,(()=>`Copying failed because more than one (${n.length}) load handlers for source URL ${e}.`));const o=n[0],s=Bo.getSaveHandlers(t);B(s.length>0,(()=>`Copying failed because no save handler is found for destination URL ${t}.`)),B(s.length<2,(()=>`Copying failed because more than one (${n.length}) save handlers for destination URL ${t}.`));const a=s[0],i=fs(e).scheme,l=fs(e).path,u=i===fs(e).scheme,c=await o.load();r&&u&&await ps.getManager(i).removeModel(l);const d=await a.save(c);return r&&!u&&await ps.getManager(i).removeModel(l),d.modelArtifactsInfo}async function ys(){const e=ps.getSchemes(),t={};for(const r of e){const e=await ps.getManager(r).listModels();for(const n in e)t[r+hs+n]=e[n]}return t}async function gs(e){const t=fs(e);return ps.getManager(t.scheme).removeModel(t.path)}async function vs(e,t){return ms(e,t,!1)}async function bs(e,t){return ms(e,t,!0)}class xs{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){window&&be().getBool("USE_SETTIMEOUTCUSTOM")?(this.functionRefs.push(e),setTimeout((()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")}),t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",(e=>{e.source===window&&e.data.name===this.messageName&&(e.stopPropagation(),(0,this.functionRefs[e.data.index])(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0))}),!0))):setTimeout(e,t)}}if(be().get("IS_BROWSER")){be().setPlatform("browser",new xs);try{ps.registerManager(us.URL_SCHEME,new ds)}catch(e){}try{ps.registerManager(Ko.URL_SCHEME,new Qo)}catch(e){}}let ws;function _s(e,t="float32",r){return t=t||"float32",he(e),new Vn(e,t,r)}be().get("IS_NODE")&&!be().get("IS_BROWSER")&&be().setPlatform("node",new class{constructor(){this.util=n(628),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return null!=be().global.fetch?be().global.fetch(e,t):(null==ws&&(ws=n(410)),ws(e,t))}now(){const e=process.hrtime();return 1e3*e[0]+e[1]/1e6}encode(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}});const Ss=wo({cast_:function(e,t){const r=vo(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error(`Failed to cast to unknown dtype ${t}`);if("string"===t&&"string"!==r.dtype||"string"!==t&&"string"===r.dtype)throw new Error("Only strings can be casted to strings");const n={x:r},o={dtype:t};return uo.runKernel(Ue,n,o)}}),ks=wo({clone_:function(e){const t={x:vo(e,"x","clone","string_or_numeric")};return uo.runKernel(kt,t)}});function Ts(e,t=!1){console.log(e.toString(t))}function Es(e){return new Promise((e=>setTimeout(e))).then(e)}lo(),zn={buffer:_s,cast:Ss,clone:ks,print:Ts};class js{constructor(e){if(!be().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(js.URL_SCHEME)&&(e=e.slice(js.URL_SCHEME.length)),null!=e&&0!==e.length||(e="model"),this.modelJsonFileName=e+".json",this.weightDataFileName=e+".weights.bin"}async save(e){if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=Mo(e,[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}]),n=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),o=null==this.modelJsonAnchor?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=n,await Es((()=>o.dispatchEvent(new MouseEvent("click")))),null!=e.weightData){const e=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor;e.download=this.weightDataFileName,e.href=t,await Es((()=>e.dispatchEvent(new MouseEvent("click"))))}return{modelArtifactsInfo:Do(e)}}}}js.URL_SCHEME="downloads://";class Cs{constructor(e){if(null==e||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise(((e,t)=>{const r=new FileReader;r.onload=r=>{const n=JSON.parse(r.target.result),o=n.modelTopology;if(null==o)return void t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));if(null==n.weightsManifest)return void t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));if(0===this.weightsFiles.length)return void e({modelTopology:o});const s=Lo(n,(e=>this.loadWeights(e)));e(s)},r.onerror=e=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)}))}loadWeights(e){const t=[],r=[];for(const n of e)t.push(...n.weights),r.push(...n.paths);const n=this.checkManifestAndWeightFiles(e),o=r.map((e=>this.loadWeightsFile(e,n[e])));return Promise.all(o).then((e=>[t,Ro(e)]))}loadWeightsFile(e,t){return new Promise(((r,n)=>{const o=new FileReader;o.onload=e=>{const t=e.target.result;r(t)},o.onerror=t=>n(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(t)}))}checkManifestAndWeightFiles(e){const t=[],r=this.weightsFiles.map((e=>No(e.name))),n={};for(const o of e)o.paths.forEach((e=>{const o=No(e);if(-1!==t.indexOf(o))throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(t.push(o),-1===r.indexOf(o))throw new Error(`Weight file with basename '${o}' is not provided.`);n[e]=this.weightsFiles[r.indexOf(o)]}));if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return n}}function Is(e){return new Cs(e)}function Os(e,t,r,n){!function(e){B(null!=e&&Array.isArray(e)&&e.length>0,(()=>"promises must be a none empty array"))}(e),function(e,t){B(e>=0&&e<=1,(()=>`Progress fraction must be in range [0, 1], but got startFraction ${e}`)),B(t>=0&&t<=1,(()=>`Progress fraction must be in range [0, 1], but got endFraction ${t}`)),B(t>=e,(()=>`startFraction must be no more than endFraction, but got startFraction ${e} and endFraction ${t}`))}(r=null==r?0:r,n=null==n?1:n);let o=0;return Promise.all(e.map((s=>(s.then((s=>{const a=r+ ++o/e.length*(n-r);return t(a),s})),s))))}async function As(e,t){null==t&&(t={});const r=null==t.fetchFunc?be().platform.fetch:t.fetchFunc,n=e.map((e=>r(e,t.requestInit,{isBinary:!0}))),o=(null==t.onProgress?await Promise.all(n):await Os(n,t.onProgress,0,.5)).map((e=>e.arrayBuffer()));return null==t.onProgress?await Promise.all(o):await Os(o,t.onProgress,.5,1)}async function Rs(e,t="",r,n){return Ns((e=>As(e,{requestInit:n})))(e,t,r)}function Ns(e){return async(t,r="",n)=>{const o=t.map((()=>!1)),s={},a=null!=n?n.map((()=>!1)):[],i=[];if(t.forEach(((e,t)=>{let r=0;e.weights.forEach((e=>{const l="quantization"in e?e.quantization.dtype:e.dtype,u=To[l]*z(e.shape),c=()=>{o[t]=!0,null==s[t]&&(s[t]=[]),s[t].push({manifestEntry:e,groupOffset:r,sizeBytes:u})};null!=n?n.forEach(((t,r)=>{t===e.name&&(c(),a[r]=!0)})):c(),i.push(e.name),r+=u}))})),!a.every((e=>e))){const e=n.filter(((e,t)=>!a[t]));throw new Error(`Could not find weights in manifest with names: ${e.join(", ")}. \nManifest JSON has weights with names: ${i.join(", ")}.`)}const l=o.reduce(((e,t,r)=>(t&&e.push(r),e)),[]),u=[];l.forEach((e=>{t[e].paths.forEach((e=>{const t=r+(r.endsWith("/")?"":"/")+e;u.push(t)}))}));const c=await e(u),d={};let h=0;return l.forEach((e=>{const r=t[e].paths.length;let n=0;for(let e=0;e<r;e++)n+=c[h+e].byteLength;const o=new ArrayBuffer(n),a=new Uint8Array(o);let i=0;for(let e=0;e<r;e++){const t=new Uint8Array(c[h+e]);a.set(t,i),i+=t.byteLength}s[e].forEach((e=>{const t=Co(o.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(const e in t)d[e]=t[e]})),h+=r})),d}}Bo.registerSaveRouter((e=>be().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(js.URL_SCHEME)?function(e="model"){return new js(e)}(e.slice(js.URL_SCHEME.length)):null));class Ms{constructor(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,null!=t.fetchFunc?(B("function"==typeof t.fetchFunc,(()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)")),this.fetch=t.fetchFunc):this.fetch=be().platform.fetch,B(null!=e&&e.length>0,(()=>"URL path for http must not be null, undefined or empty.")),Array.isArray(e)&&B(2===e.length,(()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`)),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=Mo(e,[{paths:["./model.weights.bin"],weights:e.weightSpecs}]);t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin");const n=await this.fetch(this.path,t);if(n.ok)return{modelArtifactsInfo:Do(e),responses:[n]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${n.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch(e){let t=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?t+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":t+=" Please make sure the server is serving valid JSON for this request.",new Error(t)}const r=t.modelTopology,n=t.weightsManifest;if(null==r&&null==n)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return Lo(t,(e=>this.loadWeights(e)))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,n]=function(e){const t=e.lastIndexOf("/"),r=e.lastIndexOf("?");return[e.substring(0,t)+"/",r>t?e.substring(r):""]}(t),o=this.weightPathPrefix||r,s=Fo(e),a=[],i=[];for(const t of e)for(const e of t.paths)null!=this.weightUrlConverter?i.push(this.weightUrlConverter(e)):a.push(o+e+n);return this.weightUrlConverter&&a.push(...await Promise.all(i)),[s,Ro(await As(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress}))]}}function Ps(e){return null!=e.match(Ms.URL_SCHEME_REGEX)}Ms.URL_SCHEME_REGEX=/^https?:\/\//;const Ls=(e,t)=>{if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;{let r=!0;if(r=Array.isArray(e)?e.every((e=>Ps(e))):Ps(e),r)return Ds(e,t)}return null};function Ds(e,t){return new Ms(e,t)}function Fs(e,t){return Ds(e,t)}Bo.registerSaveRouter(Ls),Bo.registerLoadRouter(Ls);class $s{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class Bs{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Us{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function Vs(e,t,r,n){return new Us(Gs(...arguments))}function Gs(e,t,r,n){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new $s(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new $s({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new $s({modelTopology:e,weightSpecs:t,weightData:r,trainingConfig:n}))}function zs(e){return new Bs(e)}function Ws(e){return new Bs(e)}function Hs(e,t){const r=e.length,n=[];for(let o=0;o<r;o++){const s=r-1-o,a=e[s]||1;(t[t.length-1-o]||1)>1&&1===a&&n.unshift(s)}return n}function qs(e,t){const r=[];for(let n=0;n<t.length;n++){const o=e[e.length-n-1],s=t.length-n-1,a=t[s];(null==o||1===o&&a>1)&&r.unshift(s)}return r}function Xs(e,t){const r=[],n=Math.max(e.length,t.length);for(let o=0;o<n;o++){let n=e[e.length-o-1];null==n&&(n=1);let s=t[t.length-o-1];if(null==s&&(s=1),1===n)r.unshift(s);else if(1===s)r.unshift(n);else{if(n!==s)throw Error(`Operands could not be broadcast together with shapes ${e} and ${t}.`);r.unshift(n)}}return r}function Ys(e,t,r){if(V(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");const n=mo(e,r);if(3!==n.length&&1!==n.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===n.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return So(e,t,n,r)}let Ks;async function Zs(e,t){let r=vo(e,"img","toPixels");if(!(e instanceof Hn)){const e=r;r=Ss(e,"int32"),e.dispose()}if(2!==r.rank&&3!==r.rank)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${r.rank}.`);const[n,o]=r.shape.slice(0,2),s=2===r.rank?1:r.shape[2];if(s>4||2===s)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${s}`);if("float32"!==r.dtype&&"int32"!==r.dtype)throw new Error(`Unsupported type for toPixels: ${r.dtype}. Please use float32 or int32 tensors.`);const a=await r.data(),i="float32"===r.dtype?255:1,l=new Uint8ClampedArray(o*n*4);for(let e=0;e<n*o;++e){const t=[0,0,0,255];for(let n=0;n<s;n++){const o=a[e*s+n];if("float32"===r.dtype){if(o<0||o>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${o}.`)}else if("int32"===r.dtype&&(o<0||o>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${o}.`);1===s?(t[0]=o*i,t[1]=o*i,t[2]=o*i):t[n]=o*i}const n=4*e;l[n+0]=Math.round(t[0]),l[n+1]=Math.round(t[1]),l[n+2]=Math.round(t[2]),l[n+3]=Math.round(t[3])}if(null!=t){t.width=o,t.height=n;const e=t.getContext("2d"),r=new ImageData(l,o,n);e.putImageData(r,0,0)}return r!==e&&r.dispose(),l}const Qs=wo({fromPixels_:function(e,t=3){if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let r=!1,n=!1,o=!1,s=!1,a=!1,i=!1;if(e.data instanceof Uint8Array)r=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)n=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)o=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)s=!0;else if(null!=e.getContext)a=!0;else{if(!("undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${e.constructor.name}`);i=!0}if(null!=an(Zr,uo.backendName)){const r={pixels:e},n={numChannels:t};return uo.runKernel(Zr,r,n)}const[l,u]=o?[e.videoWidth,e.videoHeight]:[e.width,e.height];let c,d;if(a)c=e.getContext("2d").getImageData(0,0,l,u).data;else if(n||r)c=e.data;else if(s||o||i){if(null==Ks)if("undefined"==typeof document){if("undefined"==typeof OffscreenCanvas||"undefined"==typeof OffscreenCanvasRenderingContext2D)throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");Ks=new OffscreenCanvas(1,1).getContext("2d")}else Ks=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ks.canvas.width=l,Ks.canvas.height=u,Ks.drawImage(e,0,0,l,u),c=Ks.getImageData(0,0,l,u).data}if(4===t)d=new Int32Array(c);else{const e=l*u;d=new Int32Array(e*t);for(let r=0;r<e;r++)for(let e=0;e<t;++e)d[r*t+e]=c[4*r+e]}return Ys(d,[u,l,t],"int32")}}),Js=-2,ea=-1;function ta(e,t,r){const n=e.shape.length;B(n===t.length,(()=>`Error in slice${n}D: Length of begin ${t} must match the rank of the array (${n}).`)),B(n===r.length,(()=>`Error in slice${n}D: Length of size ${r} must match the rank of the array (${n}).`));for(let o=0;o<n;++o)B(t[o]+r[o]<=e.shape[o],(()=>`Error in slice${n}D: begin[${o}] + size[${o}] (${t[o]+r[o]}) would overflow input.shape[${o}] (${e.shape[o]})`))}function ra(e){const t=[];let r=0;for(;e>0;)1&e&&t.push(r),e/=2,r++;return t}function na(e,t,r){const n=[];for(let o=0;o<e.length;o++)n[o]=Math.ceil((t[o]-e[o])/r[o]);return n}function oa(e,t,r,n){const o=[...e];for(let e=o.length;e<n.length;e++)o.push(1);for(let e=0;e<r;e++)0===e?o[t]=1:(o.splice(t,0,1),o.pop());return o}function sa(e,t,r){return r<=e?r:r-(t-1)}function aa(e,t){const r=[];for(let n=0;n<e;n++)r.push(t+n);return r}function ia(e,t,r,n,o,s,a,i,l){const u=e.length;let c=new Array(u),d=new Array(u),h=new Array(u);if(t.length&&r>0){const l=t[0],u=r+1;c=la(a,l,u,n,e),d=ua(i,l,u,o,e),h=oa(s,l,u,e)}else for(let t=0;t<u;t++)c[t]=da(a,n,s,e,t,l),d[t]=ha(i,o,s,e,t,l),h[t]=ca(s,t,l);return{begin:c,end:d,strides:h}}function la(e,t,r,n,o){const s=[...o],a=aa(r,t);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=0;else{const a=sa(t,r,o);let i=n[a];e&1<<a&&(i=0),s[o]=i}return s}function ua(e,t,r,n,o){const s=[...o],a=aa(r,t);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=Number.MAX_SAFE_INTEGER;else{const a=sa(t,r,o);let i=n[a];e&1<<a&&(i=Number.MAX_SAFE_INTEGER),s[o]=i}for(let e=0;e<s.length;e++){const t=o[e];s[e]<0&&(s[e]+=t),s[e]=D(0,s[e],o[e])}return s}function ca(e,t,r){let n=e[t];return(r&1<<t||null==n)&&(n=1),n}function da(e,t,r,n,o,s){let a=t[o];const i=r[o]||1;(e&1<<o||s&1<<o||null==a)&&(a=i>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);const l=n[o];return a<0&&(a+=l),a=D(0,a,l-1),a}function ha(e,t,r,n,o,s){let a=t[o];const i=r[o]||1;(e&1<<o||s&1<<o||null==a)&&(a=i>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);const l=n[o];return a<0&&(a+=l),a=i>0?D(0,a,l):D(-1,a,l-1),a}function pa(e,t,r){let n=r.length;for(let e=0;e<r.length;e++)if(r[e]>1){n=e;break}for(let o=n+1;o<r.length;o++)if(t[o]>0||r[o]!==e[o])return!1;return!0}function fa(e,t){let r=e.length>0?e[e.length-1]:1;for(let n=0;n<e.length-1;n++)r+=e[n]*t[n];return r}function ma(e,t,r){let n;const o=e.shape.length;let s;return n="number"==typeof t?[t,...new Array(o-1).fill(0)]:t.length<o?t.concat(new Array(o-t.length).fill(0)):t.slice(),n.forEach((e=>{B(-1!==e,(()=>"slice() does not support negative begin indexing."))})),s=null==r?new Array(o).fill(-1):"number"==typeof r?[r,...new Array(o-1).fill(-1)]:r.length<o?r.concat(new Array(o-r.length).fill(-1)):r,s=s.map(((t,r)=>t>=0?t:(B(-1===t,(()=>`Negative size values should be exactly -1 but got ${t} for the slice() size at index ${r}.`)),e.shape[r]-n[r]))),[n,s]}function ya(e,t,r,n,o,s,a,i,l){let u;if(null==n?(u=new Array(t.length),u.fill(1)):u=n,null!=a&&0!=(a&a-1))throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:t.slice(),end:r.slice(),strides:u.slice(),beginMask:o,endMask:s,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};for(let e=0;e<d.dims;e++)c&&0!=(1<<e&i)&&d.numAddAxisAfterEllipsis++,1<<e&a&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:e.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};!function(e,t){t.beginMask=0,t.endMask=0,t.shrinkAxisMask=0;let r=0;t.beginValid=null!=e.begin,t.endValid=null!=e.end,t.begin=new Array(t.dims),t.end=new Array(t.dims),t.strides=new Array(t.dims),t.finalShapeGatherIndices=[],t.finalShapeGatherIndicesSparse=[],t.inputShapeGatherIndicesSparse=new Array(t.dims);for(let n=0;n<e.dims;n++)if(1<<n&e.ellipsisMask){const o=Math.min(t.dims-(e.dims-n)+1+e.numAddAxisAfterEllipsis,t.dims);for(;r<o;r++)t.begin[r]=0,t.end[r]=0,t.strides[r]=1,t.beginMask|=1<<r,t.endMask|=1<<r,t.finalShapeGatherIndices.push(r),t.finalShapeGatherIndicesSparse.push(-1),t.inputShapeGatherIndicesSparse[r]=n}else if(1<<n&e.newAxisMask)t.finalShapeGatherIndices.push(Js),t.finalShapeGatherIndicesSparse.push(-1);else{if(r===t.begin.length)throw Error(`Index out of range using input dim ${r}; input has only ${t.dims} dims, ${t.begin.length}.`);null!=e.begin&&(t.begin[r]=e.begin[n]),null!=e.end&&(t.end[r]=e.end[n]),t.strides[r]=e.strides[n],e.beginMask&1<<n&&(t.beginMask|=1<<r),e.endMask&1<<n&&(t.endMask|=1<<r),e.shrinkAxisMask&1<<n?(t.finalShapeGatherIndices.push(ea),t.finalShapeGatherIndicesSparse.push(-1),t.shrinkAxisMask|=1<<r):(t.finalShapeGatherIndices.push(r),t.finalShapeGatherIndicesSparse.push(n)),t.inputShapeGatherIndicesSparse[r]=n,r++}}(d,h);let p=!0,f=!0,m=!0;const y=[],g=[];for(let t=0;t<e.length;++t){if(0===h.strides[t])throw Error(`strides[${t}] must be non-zero`);const r=!!(h.shrinkAxisMask&1<<t),n=e[t];if(-1===n){y.push(r?1:-1);continue}const o=[h.beginMask&1<<t,h.endMask&1<<t],s=[h.strides[t]>0?0:-1,h.strides[t]>0?n:n-1];if(r&&h.strides[t]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&1===h.strides[t];const a=!!(h.beginMask&1<<t&&h.endMask&1<<t);if(h.beginValid&&h.endValid){if(r){const e=h.begin[t]<0?n+h.begin[t]:h.begin[t];if(h.begin[t]=e,h.end[t]=h.begin[t]+1,e<0||e>=n)throw Error(`slice index ${h.begin[t]} of dimension ${t} out of bounds.`)}else h.begin[t]=ga(h.begin[t],0,h.strides[t],n,o,s),h.end[t]=ga(h.end[t],1,h.strides[t],n,o,s);const e=1===h.strides[t]&&0===h.begin[t]&&h.end[t]===n;p=p&&e,f=f&&(0===t&&1===h.strides[t]||e)}else p=p&&1===h.strides[t]&&a,f=f&&(0===t&&1===h.strides[t]||a);let i,l=!1;if(h.beginValid&&h.endValid?(i=h.end[t]-h.begin[t],l=!0):r?(i=1,l=!0):a&&n>=0&&(i=h.strides[t]<0?-n:n,l=!0),l){let e;e=0===i||i<0!=h.strides[t]<0?0:Math.trunc(i/h.strides[t])+(i%h.strides[t]!=0?1:0),y.push(e)}else y.push(-1)}for(let e=0;e<h.finalShapeGatherIndices.length;++e){const t=h.finalShapeGatherIndices[e];t>=0?g.push(y[t]):t===Js&&g.push(1)}return{finalShapeSparse:g.filter(((e,t)=>h.finalShapeGatherIndices[t]!==Js)),finalShape:g,isIdentity:p,sliceDim0:f,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function ga(e,t,r,n,o,s){if(o[t])return r>0?s[t]:s[t+1&1];{const t=e<0?n+e:e;return t<s[0]?s[0]:t>s[1]?s[1]:t}}const va=wo({abs_:function(e){const t=vo(e,"x","abs");if("complex64"===t.dtype){const e={x:t};return uo.runKernel(We,e)}{const e={x:t};return uo.runKernel("Abs",e)}}}),ba=wo({acos_:function(e){const t={x:vo(e,"x","acos")};return uo.runKernel(ke,t)}}),xa=wo({acosh_:function(e){const t={x:vo(e,"x","acosh")};return uo.runKernel(Te,t)}}),wa=wo({add_:function(e,t){let r=vo(e,"a","add"),n=vo(t,"b","add");[r,n]=ro(r,n);const o={a:r,b:n};return uo.runKernel(Ee,o)}}),_a=wo({addN_:function(e){B(Array.isArray(e),(()=>"The argument passed to tf.addN() must be a list of tensors")),B(e.length>=1,(()=>`Must pass at least one tensor to tf.addN(), but got ${e.length}`));const t=e.map(((e,t)=>vo(e,`tensors${t}`,"addN"))),r=t[0];t.forEach((e=>{if(e.dtype!==r.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((e=>{if(!W(e.shape,r.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));const n=t;return uo.runKernel(je,n)}}),Sa=wo({all_:function(e,t=null,r=!1){const n={x:vo(e,"x","all","bool")},o={axis:t,keepDims:r};return uo.runKernel("All",n,o)}}),ka=wo({any_:function(e,t=null,r=!1){const n={x:vo(e,"x","any","bool")},o={axis:t,keepDims:r};return uo.runKernel("Any",n,o)}}),Ta=wo({argMax_:function(e,t=0){const r={x:vo(e,"x","argMax")},n={axis:t};return uo.runKernel(Ce,r,n)}}),Ea=wo({argMin_:function(e,t=0){const r={x:vo(e,"x","argMin")},n={axis:t};return uo.runKernel(Ie,r,n)}}),ja=wo({asin_:function(e){const t={x:vo(e,"x","asin")};return uo.runKernel(Oe,t)}}),Ca=wo({asinh_:function(e){const t={x:vo(e,"x","asinh")};return uo.runKernel(Ae,t)}}),Ia=wo({atan_:function(e){const t={x:vo(e,"x","atan")};return uo.runKernel(Re,t)}}),Oa=wo({atan2_:function(e,t){let r=vo(e,"a","atan2"),n=vo(t,"b","atan2");[r,n]=ro(r,n);const o={a:r,b:n};return uo.runKernel(Me,o)}}),Aa=wo({atanh_:function(e){const t={x:vo(e,"x","atanh")};return uo.runKernel(Ne,t)}});function Ra(e,t,r,n,o="NHWC",s){return Pa(e,[...t,e[3]],r,s,n,null,null,za(o))}function Na(e,t,r,n,o,s,a="channelsLast"){const[i,l]=Fa(t);let u;if("channelsLast"===a)u=[i,l,e[3],e[3]];else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);u=[i,l,e[1],e[1]]}return Pa(e,u,r,n,o,s,!1,a)}function Ma(e,t,r,n,o,s,a="NDHWC"){const[i,l,u]=$a(t);let c,d;if("NDHWC"===a)d="channelsLast",c=[i,l,u,e[4],e[4]];else{if("NCDHW"!==a)throw new Error(`Unknown dataFormat ${a}`);d="channelsFirst",c=[i,l,u,e[1],e[1]]}return La(e,c,r,n,o,!1,d,s)}function Pa(e,t,r,n,o,s,a=!1,i="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if("channelsLast"===i)[l,u,c,d]=e;else{if("channelsFirst"!==i)throw new Error(`Unknown dataFormat ${i}`);[l,d,u,c]=e}const[h,p,,f]=t,[m,y]=Fa(r),[g,v]=Fa(n),b=Ba(h,g),x=Ba(p,v),{padInfo:w,outHeight:_,outWidth:S}=function(e,t,r,n,o,s,a,i,l){let u,c,d;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};const o=function(e,t,r,n,o){null==n&&(n=Da(e,t,r));const s=e[1];return[Ua((e[0]-t+2*n)/r+1,o),Ua((s-t+2*n)/r+1,o)]}([t,r],s,n,e,i);c=o[0],d=o[1]}else if("same"===e){c=Math.ceil(t/n),d=Math.ceil(r/o);const e=Math.max(0,(c-1)*n+s-t),i=Math.max(0,(d-1)*o+a-r),l=Math.floor(e/2),h=e-l,p=Math.floor(i/2);u={top:l,bottom:h,left:p,right:i-p,type:"SAME"}}else if("valid"===e)u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-s+1)/n),d=Math.ceil((r-a+1)/o);else{if("object"!=typeof e)throw Error(`Unknown padding parameter: ${e}`);{const h="channelsLast"===l?e[1][0]:e[2][0],p="channelsLast"===l?e[1][1]:e[2][1],f="channelsLast"===l?e[2][0]:e[3][0],m="channelsLast"===l?e[2][1]:e[3][1];u={top:h,bottom:p,left:f,right:m,type:0===h&&0===p&&0===f&&0===m?"VALID":"EXPLICIT"},c=Ua((t-s+h+p)/n+1,i),d=Ua((r-a+f+m)/o+1,i)}}return{padInfo:u,outHeight:c,outWidth:d}}(o,u,c,m,y,b,x,s,i),k=a?f*d:f;let T;return"channelsFirst"===i?T=[l,k,_,S]:"channelsLast"===i&&(T=[l,_,S,k]),{batchSize:l,dataFormat:i,inHeight:u,inWidth:c,inChannels:d,outHeight:_,outWidth:S,outChannels:k,padInfo:w,strideHeight:m,strideWidth:y,filterHeight:h,filterWidth:p,effectiveFilterHeight:b,effectiveFilterWidth:x,dilationHeight:g,dilationWidth:v,inShape:e,outShape:T,filterShape:t}}function La(e,t,r,n,o,s=!1,a="channelsLast",i){let[l,u,c,d,h]=[-1,-1,-1,-1,-1];if("channelsLast"===a)[l,u,c,d,h]=e;else{if("channelsFirst"!==a)throw new Error(`Unknown dataFormat ${a}`);[l,h,u,c,d]=e}const[p,f,m,,y]=t,[g,v,b]=$a(r),[x,w,_]=$a(n),S=Ba(p,x),k=Ba(f,w),T=Ba(m,_),{padInfo:E,outDepth:j,outHeight:C,outWidth:I}=function(e,t,r,n,o,s,a,i,l,u,c){let d,h,p,f;if("number"==typeof e){d={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};const s=function(e,t,r,n,o,s){null==o&&(o=Da(e,t,n));const a=e[1],i=e[2];return[Ua((e[0]-t+2*o)/n+1,s),Ua((a-t+2*o)/n+1,s),Ua((i-t+2*o)/n+1,s),1]}([t,r,n,1],i,0,o,e,c);h=s[0],p=s[1],f=s[2]}else if("same"===e){h=Math.ceil(t/o),p=Math.ceil(r/s),f=Math.ceil(n/a);const e=(h-1)*o+i-t,c=(p-1)*s+l-r,m=(f-1)*a+u-n,y=Math.floor(e/2),g=e-y,v=Math.floor(c/2),b=c-v,x=Math.floor(m/2);d={top:v,bottom:b,left:x,right:m-x,front:y,back:g,type:"SAME"}}else{if("valid"!==e)throw Error(`Unknown padding parameter: ${e}`);d={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-i+1)/o),p=Math.ceil((r-l+1)/s),f=Math.ceil((n-u+1)/a)}return{padInfo:d,outDepth:h,outHeight:p,outWidth:f}}(o,u,c,d,g,v,b,S,k,T,i),O=s?y*h:y;let A;return"channelsFirst"===a?A=[l,O,j,C,I]:"channelsLast"===a&&(A=[l,j,C,I,O]),{batchSize:l,dataFormat:a,inDepth:u,inHeight:c,inWidth:d,inChannels:h,outDepth:j,outHeight:C,outWidth:I,outChannels:O,padInfo:E,strideDepth:g,strideHeight:v,strideWidth:b,filterDepth:p,filterHeight:f,filterWidth:m,effectiveFilterDepth:S,effectiveFilterHeight:k,effectiveFilterWidth:T,dilationDepth:x,dilationHeight:w,dilationWidth:_,inShape:e,outShape:A,filterShape:t}}function Da(e,t,r,n=1){const o=Ba(t,n);return Math.floor((e[0]*(r-1)-r+o)/2)}function Fa(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function $a(e){return"number"==typeof e?[e,e,e]:e}function Ba(e,t){return t<=1?e:e+(e-1)*(t-1)}function Ua(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error(`Unknown roundingMode ${t}`)}}function Va(e){const[t,r,n]=Fa(e);return 1===t&&1===r&&1===n}function Ga(e,t){return Va(e)||Va(t)}function za(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error(`Unknown dataFormat ${e}`)}function Wa(e,t,r){if(null!=r){if("string"==typeof t)throw Error(`Error in ${e}: pad must be an integer when using dimRoundingMode ${r} but got pad ${t}.`);if("number"==typeof t)B(H(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${r} but got pad ${t}.`));else{if("object"!=typeof t)throw Error(`Error in ${e}: Unknown padding parameter: ${t}`);t.forEach((t=>{t.forEach((t=>{B(H(t),(()=>`Error in ${e}: pad must be an integer when using dimRoundingMode ${r} but got pad ${t}.`))}))}))}}}const Ha=wo({reshape_:function(e,t){const r={x:vo(e,"x","reshape","string_or_numeric")},n={shape:t};return uo.runKernel(cr,r,n)}}),qa=wo({avgPool_:function(e,t,r,n,o){const s=vo(e,"x","avgPool","float32");B(Ga(r,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${r} and dilations '1'`));let a=s,i=!1;3===s.rank&&(i=!0,a=Ha(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(4===a.rank,(()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`)),Wa("avgPool",n,o);const l={x:a},u={filterSize:t,strides:r,pad:n,dimRoundingMode:o};let c=uo.runKernel(Pe,l,u);return c=Ss(c,s.dtype),i?Ha(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),Xa=wo({avgPool3d_:function(e,t,r,n,o,s="NDHWC"){const a=vo(e,"x","avgPool3d","float32");let i=a,l=!1;4===a.rank&&(l=!0,i=Ha(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(5===i.rank,(()=>`Error in avgPool3d: x must be rank 5 but got rank ${i.rank}.`)),B("NDHWC"===s,(()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`)),Wa("avgPool3d",n,o);const u={x:i},c={filterSize:t,strides:r,pad:n,dimRoundingMode:o,dataFormat:s};let d=uo.runKernel(Le,u,c);return d=Ss(d,i.dtype),l?Ha(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),Ya=wo({concat_:function(e,t=0){B(e.length>=1,(()=>"Pass at least one tensor to concat"));const r=bo(e,"tensors","concat","string_or_numeric");if("complex64"===r[0].dtype&&r.forEach((e=>{if("complex64"!==e.dtype)throw new Error(`Cannot concatenate complex64 tensors with a tensor\n          with dtype ${e.dtype}. `)})),1===r.length)return ks(r[0]);const n=r,o={axis:t};return uo.runKernel(He,n,o)}}),Ka=wo({matMul_:function(e,t,r=!1,n=!1){let o=vo(e,"a","matMul"),s=vo(t,"b","matMul");[o,s]=ro(o,s);const a={a:o,b:s},i={transposeA:r,transposeB:n};return uo.runKernel(De,a,i)}}),Za=wo({mul_:function(e,t){let r=vo(e,"a","mul"),n=vo(t,"b","mul");[r,n]=ro(r,n);const o={a:r,b:n};return uo.runKernel(qt,o)}}),Qa=wo({sigmoid_:function(e){const t={x:vo(e,"x","sigmoid","float32")};return uo.runKernel(kr,t)}}),Ja=wo({slice_:function(e,t,r){const n=vo(e,"x","slice","string_or_numeric");if(0===n.rank)throw new Error("Slicing scalar is not possible");const o={x:n},s={begin:t,size:r};return uo.runKernel(wr,o,s)}}),ei=wo({tanh_:function(e){const t={x:vo(e,"x","tanh","float32")};return uo.runKernel(Ur,t)}}),ti=wo({basicLSTMCell_:function(e,t,r,n,o,s){const a=vo(e,"forgetBias","basicLSTMCell"),i=vo(t,"lstmKernel","basicLSTMCell"),l=vo(r,"lstmBias","basicLSTMCell"),u=vo(n,"data","basicLSTMCell"),c=vo(o,"c","basicLSTMCell"),d=vo(s,"h","basicLSTMCell"),h=Ya([u,d],1),p=Ka(h,i),f=wa(p,l),m=f.shape[0],y=f.shape[1]/4,g=[m,y],v=Ja(f,[0,0],g),b=Ja(f,[0,y],g),x=Ja(f,[0,2*y],g),w=Ja(f,[0,3*y],g),_=wa(Za(Qa(v),ei(b)),Za(c,Qa(wa(a,x))));return[_,Za(ei(_),Qa(w))]}}),ri=wo({batchToSpaceND_:function(e,t,r){const n=vo(e,"x","batchToSpaceND"),o=t.reduce(((e,t)=>e*t));B(n.rank>=1+t.length,(()=>`input rank is ${n.rank} but should be > than blockShape.length ${t.length}`)),B(r.length===t.length,(()=>`crops.length is ${r.length} but should be equal to blockShape.length  ${t.length}`)),B(n.shape[0]%o==0,(()=>`input tensor batch is ${n.shape[0]} but is not divisible by the product of the elements of blockShape ${t.join(" * ")} === ${o}`));const s={x:n},a={blockShape:t,crops:r};return uo.runKernel(Fe,s,a)}}),ni=wo({batchNorm_:function(e,t,r,n,o,s){null==s&&(s=.001);const a=vo(e,"x","batchNorm"),i=vo(t,"mean","batchNorm"),l=vo(r,"variance","batchNorm");let u,c;null!=o&&(u=vo(o,"scale","batchNorm")),null!=n&&(c=vo(n,"offset","batchNorm")),B(i.rank===l.rank,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),B(null==c||i.rank===c.rank,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),B(null==u||i.rank===u.rank,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));const d={x:function(e){let t;return t=0===e.rank||1===e.rank?Ha(e,[1,1,1,e.size]):2===e.rank?Ha(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Ha(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e,t}(a),scale:u,offset:c,mean:i,variance:l},h={varianceEpsilon:s},p=uo.runKernel(bt,d,h);return Ha(p,a.shape)}}),oi=wo({batchNorm2d_:function(e,t,r,n,o,s){const a=vo(e,"x","batchNorm"),i=vo(t,"mean","batchNorm"),l=vo(r,"variance","batchNorm");let u,c;return null!=o&&(u=vo(o,"scale","batchNorm")),null!=n&&(c=vo(n,"offset","batchNorm")),B(2===a.rank,(()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`)),B(2===i.rank||1===i.rank,(()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${i.rank}.`)),B(2===l.rank||1===l.rank,(()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`)),null!=u&&B(2===u.rank||1===u.rank,(()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`)),null!=c&&B(2===c.rank||1===c.rank,(()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`)),ni(a,i,l,c,u,s)}}),si=wo({batchNorm3d_:function(e,t,r,n,o,s){const a=vo(e,"x","batchNorm"),i=vo(t,"mean","batchNorm"),l=vo(r,"variance","batchNorm");let u,c;return null!=o&&(u=vo(o,"scale","batchNorm")),null!=n&&(c=vo(n,"offset","batchNorm")),B(3===a.rank,(()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`)),B(3===i.rank||1===i.rank,(()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${i.rank}.`)),B(3===l.rank||1===l.rank,(()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`)),null!=u&&B(3===u.rank||1===u.rank,(()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`)),null!=c&&B(3===c.rank||1===c.rank,(()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`)),ni(a,i,l,c,u,s)}}),ai=wo({batchNorm4d_:function(e,t,r,n,o,s){const a=vo(e,"x","batchNorm"),i=vo(t,"mean","batchNorm"),l=vo(r,"variance","batchNorm");let u,c;return null!=o&&(u=vo(o,"scale","batchNorm")),null!=n&&(c=vo(n,"offset","batchNorm")),B(4===a.rank,(()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`)),B(4===i.rank||1===i.rank,(()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${i.rank}.`)),B(4===l.rank||1===l.rank,(()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`)),null!=u&&B(4===u.rank||1===u.rank,(()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`)),null!=c&&B(4===c.rank||1===c.rank,(()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`)),ni(a,i,l,c,u,s)}}),ii=wo({bincount_:function(e,t,r){const n=vo(e,"x","bincount"),o=vo(t,"weights","bincount");B("int32"===n.dtype,(()=>`Error in bincount: input dtype must be int32, but got ${n.dtype}`)),B(r>=0,(()=>`size must be non-negative, but got ${r}.`)),B(o.size===n.size||0===o.size,(()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${n.shape}, weights shape: ${o.shape}.`));const s={x:n,weights:o},a={size:r};return uo.runKernel($e,s,a)}}),li=wo({broadcastArgs_:function(e,t){const r=vo(e,"s0","broadcastArgs","int32"),n=vo(t,"s1","broadcastArgs","int32");if(1!==r.rank)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${r.rank}`);if(1!==n.rank)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${n.rank}`);const o={s0:r,s1:n};return uo.runKernel(Be,o)}}),ui=wo({broadcastTo_:function(e,t){let r=vo(e,"broadcastTo","x");const n=r.shape;if(t.some((e=>!(e>0)||e%1!=0)))throw new Error(`broadcastTo(): Invalid broadcast shape [${t}].`);if(t.length<r.rank)throw new Error(`broadcastTo(): shape.length=${t.length} < input.rank=${r.rank}.`);if(t.length>r.rank){const e=r.shape.slice();for(;e.length<t.length;)e.unshift(1);r=Ha(r,e)}const o=r.shape,s=Array.from(t);for(let e=t.length-1;e>=0;e--)if(o[e]===t[e])s[e]=1;else if(1!==r.shape[e])throw new Error(`broadcastTo(): [${n}] cannot be broadcast to [${t}].`);if(0===s.map(((e,t)=>e>1?t:-1)).filter((e=>e>=0)).length)return ks(r);const a={x:r},i={reps:s};return uo.runKernel(Vr,a,i)}}),ci=wo({ceil_:function(e){const t={x:vo(e,"x","ceil","float32")};return uo.runKernel(Ve,t)}});function di(e,t,r){const n={shape:e,value:t,dtype:r};return uo.runKernel(mt,{},n)}const hi=wo({clipByValue_:function(e,t,r){const n=vo(e,"x","clipByValue");if(B(t<=r,(()=>`Error in clip: min (${t}) must be less than or equal to max (${r}).`)),t===r)return di(n.shape,t,n.dtype);const o={x:n},s={clipValueMin:t,clipValueMax:r};return uo.runKernel(Ge,o,s)}}),pi=wo({concat1d_:function(e){return Ya(e,0)}}),fi=wo({concat2d_:function(e,t){return Ya(e,t)}}),mi=wo({concat3d_:function(e,t){return Ya(e,t)}}),yi=wo({concat4d_:function(e,t){return Ya(e,t)}}),gi=wo({conv2d_:function(e,t,r,n,o="NHWC",s=[1,1],a){const i=vo(e,"x","conv2d","float32"),l=vo(t,"filter","conv2d","float32");let u=i,c=!1;3===i.rank&&(c=!0,u=Ha(i,[1,i.shape[0],i.shape[1],i.shape[2]])),B(4===u.rank,(()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`)),B(4===l.rank,(()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`)),Wa("conv2d",n,a);const d="NHWC"===o?u.shape[3]:u.shape[1];B(d===l.shape[2],(()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`)),B(Ga(r,s),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`));const h={x:u,filter:l},p={strides:r,pad:n,dataFormat:o,dilations:s,dimRoundingMode:a},f=uo.runKernel(qe,h,p);return c?Ha(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),vi=wo({conv1d_:function(e,t,r,n,o="NWC",s=1,a){const i=vo(e,"x","conv1d"),l=vo(t,"filter","conv1d");let u=i,c=!1;2===i.rank&&(c=!0,u=Ha(i,[1,i.shape[0],i.shape[1]])),B(3===u.rank,(()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`)),B(3===l.rank,(()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`)),Wa("conv1d",n,a),B(u.shape[2]===l.shape[1],(()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`)),B(Ga(r,s),(()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${r} and dilation '${s}'`)),B("NWC"===o,(()=>`Error in conv1d: got dataFormat of ${o} but only NWC is currently supported.`));const d=Ha(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=Ha(u,[u.shape[0],1,u.shape[1],u.shape[2]]),p=gi(h,d,[1,r],n,"NHWC",[1,s],a);return Ha(p,c?[p.shape[2],p.shape[3]]:[p.shape[0],p.shape[2],p.shape[3]])}}),bi=wo({conv2DBackpropInput_:function(e,t,r,n,o,s="NHWC",a){B(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let i=e,l=t,u=!1;3===t.rank&&(u=!0,l=Ha(t,[1,t.shape[0],t.shape[1],t.shape[2]]),i=[1,e[0],e[1],e[2]]),B(4===i.length,(()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${i.length}.`)),B(4===l.rank,(()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`)),B(4===r.rank,(()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${r.rank}`));const c="NHWC"===s?i[3]:i[1],d="NHWC"===s?l.shape[3]:l.shape[1];B(c===r.shape[2],(()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${r.shape[2]}.`)),B(d===r.shape[3],(()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${r.shape[3]}.`)),Wa("conv2dDerInput",o,a);const h={dy:l,filter:r},p={strides:n,pad:o,dataFormat:s,dimRoundingMode:a,inputShape:i},f=uo.runKernel(Ye,h,p);return u?Ha(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),xi=wo({conv2dTranspose_:function(e,t,r,n,o,s){const a=vo(e,"x","conv2dTranspose"),i=vo(t,"filter","conv2dTranspose");return bi(r,a,i,n,o,"NHWC",s)}}),wi=wo({conv3d_:function(e,t,r,n,o="NDHWC",s=[1,1,1]){const a=vo(e,"x","conv3d"),i=vo(t,"filter","conv3d");let l=a,u=!1;4===a.rank&&(u=!0,l=Ha(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(5===l.rank,(()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`)),B(5===i.rank,(()=>`Error in conv3d: filter must be rank 5, but got rank ${i.rank}.`)),B(l.shape[4]===i.shape[3],(()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${i.shape[3]}.`)),B(Ga(r,s),(()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`)),B("NDHWC"===o,(()=>`Error in conv3d: got dataFormat of ${o} but only NDHWC is currently supported.`));const c={x:l,filter:i},d={strides:r,pad:n,dataFormat:o,dilations:s},h=uo.runKernel(Ke,c,d);return u?Ha(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),_i=wo({conv3DBackpropInput_:function(e,t,r,n,o){B(e.length===t.rank,(()=>`Length of inShape (${e.length}) and rank of dy (${t.rank}) must match`));let s=e,a=t,i=!1;4===t.rank&&(i=!0,a=Ha(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),s=[1,e[0],e[1],e[2],e[3]]);const l=s[4],u=a.shape[4];B(5===s.length,(()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`)),B(5===a.rank,(()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`)),B(5===r.rank,(()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${r.rank}`)),B(l===r.shape[3],(()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${r.shape[3]}.`)),B(u===r.shape[4],(()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${r.shape[4]}.`));const c={dy:a,filter:r},d={pad:o,strides:n,inputShape:s},h=uo.runKernel(Ze,c,d);return i?Ha(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}}),Si=wo({conv3dTranspose_:function(e,t,r,n,o){const s=vo(e,"x","conv3dTranspose"),a=vo(t,"filter","conv3dTranspose");return _i(r,s,a,n,o)}}),ki=wo({cos_:function(e){const t={x:vo(e,"x","cos","float32")};return uo.runKernel("Cos",t)}}),Ti=wo({cosh_:function(e){const t={x:vo(e,"x","cosh","float32")};return uo.runKernel(Qe,t)}}),Ei=wo({cumprod_:function(e,t=0,r=!1,n=!1){const o={x:vo(e,"x","cumprod")},s={axis:t,exclusive:r,reverse:n};return uo.runKernel(Je,o,s)}}),ji=wo({cumsum_:function(e,t=0,r=!1,n=!1){const o={x:vo(e,"x","cumsum")},s={axis:t,exclusive:r,reverse:n};return uo.runKernel(et,o,s)}}),Ci=wo({denseBincount_:function(e,t,r,n=!1){const o=vo(e,"x","denseBincount"),s=vo(t,"weights","denseBincount");B("int32"===o.dtype,(()=>`Error in denseBincount: input dtype must be int32, but got ${o.dtype}`)),B(o.rank<=2,(()=>`Error in denseBincount: input must be at most rank 2, but got rank ${o.rank}.`)),B(r>=0,(()=>`size must be non-negative, but got ${r}.`)),B(s.size===o.size||0===s.size,(()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${o.shape}, weights shape: ${s.shape}.`));const a={x:o,weights:s},i={size:r,binaryOutput:n};return uo.runKernel(rt,a,i)}}),Ii=wo({depthToSpace_:function(e,t,r="NHWC"){const n=vo(e,"x","depthToSpace","float32"),o="NHWC"===r?n.shape[1]:n.shape[2],s="NHWC"===r?n.shape[2]:n.shape[3],a="NHWC"===r?n.shape[3]:n.shape[1];B(t>1,(()=>`blockSize should be > 1 for depthToSpace, but was: ${t}`)),B(o*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${o} and ${t}  for depthToSpace with input shape\n    ${n.shape}`)),B(s*t>=0,(()=>`Negative dimension size caused by overflow when multiplying\n    ${s} and ${t} for depthToSpace with input shape\n        ${n.shape}`)),B(a%(t*t)==0,(()=>`Dimension size must be evenly divisible by ${t*t} but is ${a} for depthToSpace with input shape ${n.shape}`));const i={x:n},l={blockSize:t,dataFormat:r};return uo.runKernel(nt,i,l)}}),Oi=wo({depthwiseConv2d_:function(e,t,r,n,o="NHWC",s=[1,1],a){const i=vo(e,"x","depthwiseConv2d","float32"),l=vo(t,"filter","depthwiseConv2d","float32");let u=i,c=!1;3===i.rank&&(c=!0,u=Ha(i,[1,i.shape[0],i.shape[1],i.shape[2]])),B(4===u.rank,(()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`)),B(4===l.rank,(()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`));const d="NHWC"===o?u.shape[3]:u.shape[1];B(d===l.shape[2],(()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`)),Wa("depthwiseConv2d",n,a);const h={x:u,filter:l},p={strides:r,pad:n,dataFormat:o,dilations:s,dimRoundingMode:a},f=uo.runKernel(ot,h,p);return c?Ha(f,[f.shape[1],f.shape[2],f.shape[3]]):f}}),Ai=wo({diag_:function(e){const t={x:vo(e,"x","diag")};return uo.runKernel(it,t)}}),Ri=wo({dilation2d_:function(e,t,r,n,o=[1,1],s="NHWC"){const a=vo(e,"x","dilation2d"),i=vo(t,"filter","dilation2d");B(3===a.rank||4===a.rank,(()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`)),B(3===i.rank,(()=>`Error in dilation2d: filter must be rank 3, but got rank ${i.rank}.`)),B("NHWC"===s,(()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`));let l=a,u=!1;3===a.rank&&(l=Ha(a,[1,a.shape[0],a.shape[1],a.shape[2]]),u=!0);const c={x:l,filter:i},d={strides:r,pad:n,dilations:o},h=uo.runKernel(lt,c,d);return u?Ha(h,[h.shape[1],h.shape[2],h.shape[3]]):h}}),Ni=wo({floorDiv_:function(e,t){let r=vo(e,"a","floorDiv"),n=vo(t,"b","floorDiv");[r,n]=ro(r,n);const o={a:r,b:n};return uo.runKernel(vt,o)}}),Mi=wo({div_:function(e,t){let r=vo(e,"a","div"),n=vo(t,"b","div");if([r,n]=ro(r,n),"int32"===r.dtype&&"int32"===n.dtype)return Ni(r,n);const o={a:r,b:n};return uo.runKernel(ut,o,{})}}),Pi=wo({equal_:function(e,t){let r=vo(e,"a","equal","string_or_numeric"),n=vo(t,"b","equal","string_or_numeric");[r,n]=ro(r,n),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(dt,o)}}),Li=wo({where_:function(e,t,r){const n=vo(t,"a","where"),o=vo(r,"b","where"),s=vo(e,"condition","where","bool"),a=Xs(Xs(s.shape,n.shape),o.shape),i={condition:ui(s,a),t:ui(n,a),e:ui(o,a)};return uo.runKernel(br,i)}}),Di=wo({zerosLike_:function(e){const t={x:vo(e,"x","zerosLike")};return uo.runKernel(Yr,t)}}),Fi=wo({divNoNan_:function(e,t){let r=vo(e,"a","div"),n=vo(t,"b","div");[r,n]=ro(r,n);const o=Mi(r,n),s=Di(o),a=Pi(n,s);return Li(a,s,o)}}),$i=wo({dot_:function(e,t){const r=vo(e,"t1","dot"),n=vo(t,"t2","dot");B(!(1!==r.rank&&2!==r.rank||1!==n.rank&&2!==n.rank),(()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${r.rank} and ${n.rank}.`));const o=1===r.rank?r.size:r.shape[1],s=1===n.rank?n.size:n.shape[0];if(B(o===s,(()=>`Error in dot: inner dimensions of inputs must match, but got ${o} and ${s}.`)),1===r.rank&&1===n.rank){const e=Ha(r,[1,-1]),t=Ha(n,[-1,1]),o=Ka(e,t);return Ha(o,[])}if(1===r.rank&&2===n.rank){const e=Ha(r,[1,-1]),t=Ha(n,[n.shape[0],n.shape[1]]),o=Ka(e,t);return Ha(o,[o.size])}if(2===r.rank&&1===n.rank){const e=Ha(n,[-1,1]),t=Ka(r,e);return Ha(t,[t.size])}{const e=Ha(n,[n.shape[0],n.shape[1]]);return Ka(r,e)}}}),Bi=wo({einsum_:function(e,...t){const r=t.map(((e,t)=>vo(e,`tensors${t}`,"einsum"))),n={equation:e};return uo.runKernel(ct,r,n)}}),Ui=wo({elu_:function(e){const t={x:vo(e,"x","elu","float32")};return uo.runKernel("Elu",t)}}),Vi=wo({erf_:function(e){let t=vo(e,"x","erf");B("int32"===t.dtype||"float32"===t.dtype,(()=>"Input dtype must be `int32` or `float32`.")),"int32"===t.dtype&&(t=Ss(t,"float32"));const r={x:t};return uo.runKernel("Erf",r)}});function Gi(e,t){for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0}function zi(e,t,r){const n=e.length+t.length,o=[];let s=0,a=0;for(let i=0;i<n;i++)-1===r.indexOf(i)?o.push(e[s++]):o.push(t[a++]);return o}function Wi(e,t){const r=[],n=e.length;for(let o=0;o<n;o++)-1===t.indexOf(o)&&r.push(e[o]);return[r,t.map((t=>e[t]))]}function Hi(e,t){return zi(e,t.map((e=>1)),t)}function qi(e,t,r){B(Gi(t,r),(()=>`${e} supports only inner-most axes for now. Got axes ${t} and rank-${r} input.`))}function Xi(e,t){if(Gi(e,t))return null;const r=[];for(let n=0;n<t;++n)-1===e.indexOf(n)&&r.push(n);return e.forEach((e=>r.push(e))),r}function Yi(e){return e.map(((e,t)=>[t,e])).sort(((e,t)=>e[1]-t[1])).map((e=>e[0]))}function Ki(e,t){const r=[];for(let n=t-e;n<t;++n)r.push(n);return r}const Zi=wo({max_:function(e,t=null,r=!1){const n={x:vo(e,"x","max")},o={reductionIndices:t,keepDims:r};return uo.runKernel("Max",n,o)}}),Qi=wo({min_:function(e,t=null,r=!1){const n={x:vo(e,"x","min")},o={axis:t,keepDims:r};return uo.runKernel("Min",n,o)}}),Ji=wo({pow_:function(e,t){let r=vo(e,"base","pow"),n=vo(t,"exp","pow");[r,n]=ro(r,n);const o={a:r,b:n};return uo.runKernel("Pow",o)}});function el(e,t){if((te(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&te(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return So(e,[],[],t)}const tl=wo({sqrt_:function(e){const t={x:vo(e,"x","sqrt","float32")};return uo.runKernel(Er,t)}}),rl=wo({square_:function(e){const t=vo(e,"x","square");return uo.runKernel("Square",{x:t},{})}}),nl=wo({sum_:function(e,t=null,r=!1){let n=vo(e,"x","sum");"bool"===n.dtype&&(n=Ss(n,"int32"));const o={x:n},s={axis:t,keepDims:r};return uo.runKernel("Sum",o,s)}});function ol(e,t,r=null){if(0===e.rank)return va(e);if(1!==e.rank&&null===r)return ol(Ha(e,[-1]),t,r);if(1===e.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===t)return nl(va(e),r);if(t===1/0)return Zi(va(e),r);if(t===-1/0)return Qi(va(e),r);if("euclidean"===t||2===t)return tl(nl(Ji(va(e),el(2,"int32")),r));throw new Error(`Error in norm: invalid ord value: ${t}`)}if(Array.isArray(r)&&2===r.length){if(1===t)return Zi(nl(va(e),r[0]),r[1]-1);if(t===1/0)return Zi(nl(va(e),r[1]),r[0]);if(t===-1/0)return Qi(nl(va(e),r[1]),r[0]);if("fro"===t||"euclidean"===t)return tl(nl(rl(e),r));throw new Error(`Error in norm: invalid ord value: ${t}`)}throw new Error(`Error in norm: invalid axis: ${r}`)}const sl=wo({norm_:function(e,t="euclidean",r=null,n=!1){const o=ol(e=vo(e,"x","norm"),t,r);let s=o.shape;if(n){const t=K(r,e.shape);s=Hi(o.shape,t)}return Ha(o,s)}}),al=wo({euclideanNorm_:function(e,t=null,r=!1){return sl(e,"euclidean",t,r)}}),il=wo({exp_:function(e){const t={x:vo(e,"x","exp")};return uo.runKernel(ht,t)}}),ll=wo({expandDims_:function(e,t=0){const r=vo(e,"x","expandDims","string_or_numeric");B(t<=r.rank,(()=>"Axis must be <= rank of the tensor"));const n={input:r},o={dim:t};return uo.runKernel(pt,n,o)}}),ul=wo({expm1_:function(e){const t={x:vo(e,"x","expm1")};return uo.runKernel(ft,t)}}),cl=wo({tile_:function(e,t){const r=vo(e,"x","tile","string_or_numeric");B(r.rank===t.length,(()=>`Error in transpose: rank of input ${r.rank} must match length of reps ${t}.`));const n={x:r},o={reps:t};return uo.runKernel(Vr,n,o)}}),dl=wo({eye_:function(e,t,r,n="float32"){null==t&&(t=e);const o=_s([e,t],n),s=e<=t?e:t;for(let e=0;e<s;++e)o.set(1,e,e);const a=Ha(o.toTensor(),[e,t]);if(null==r)return a;if(1===r.length)return cl(ll(a,0),[r[0],1,1]);if(2===r.length)return cl(ll(ll(a,0),0),[r[0],r[1],1,1]);if(3===r.length)return cl(ll(ll(ll(a,0),0),0),[r[0],r[1],r[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${r.length}D.`)}}),hl=wo({floor_:function(e){const t={x:vo(e,"x","floor","float32")};return uo.runKernel(gt,t)}}),pl=wo({gather_:function(e,t,r=0,n=0){const o={x:vo(e,"x","gather"),indices:vo(t,"indices","gather","int32")},s={axis:r,batchDims:n};return uo.runKernel(xt,o,s)}}),fl=wo({greater_:function(e,t){let r=vo(e,"a","greater","string_or_numeric"),n=vo(t,"b","greater","string_or_numeric");[r,n]=ro(r,n),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(_t,o)}}),ml=wo({greaterEqual_:function(e,t){let r=vo(e,"a","greaterEqual","string_or_numeric"),n=vo(t,"b","greaterEqual","string_or_numeric");[r,n]=ro(r,n),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(St,o)}}),yl=wo({imag_:function(e){const t={input:vo(e,"input","imag")};return uo.runKernel(Et,t)}}),gl=wo({isFinite_:function(e){const t={x:vo(e,"x","isFinite")};return uo.runKernel(jt,t)}}),vl=wo({isInf_:function(e){const t={x:vo(e,"x","isInf")};return uo.runKernel(Ct,t)}}),bl=wo({isNaN_:function(e){const t={x:vo(e,"x","isNaN")};return uo.runKernel(It,t)}}),xl=wo({leakyRelu_:function(e,t=.2){const r={x:vo(e,"x","leakyRelu")},n={alpha:t};return uo.runKernel(Ot,r,n)}}),wl=wo({less_:function(e,t){let r=vo(e,"a","less","string_or_numeric"),n=vo(t,"b","less","string_or_numeric");[r,n]=ro(r,n),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(At,o)}}),_l=wo({lessEqual_:function(e,t){let r=vo(e,"a","lessEqual","string_or_numeric"),n=vo(t,"b","lessEqual","string_or_numeric");[r,n]=ro(r,n),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(Rt,o)}});function Sl(e,t,r){if(r<=0)throw new Error("The number of values should be positive.");const n={start:e,stop:t,num:r};return uo.runKernel(Nt,{},n)}const kl=wo({localResponseNormalization_:function(e,t=5,r=1,n=1,o=.5){const s=vo(e,"x","localResponseNormalization");B(4===s.rank||3===s.rank,(()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ${s.rank}.`)),B(H(t),(()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${t}.`));let a=s,i=!1;3===s.rank&&(i=!0,a=Ha(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:a},u={depthRadius:t,bias:r,alpha:n,beta:o},c=uo.runKernel("LRN",l,u);return i?Ha(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),Tl=wo({log_:function(e){const t={x:vo(e,"x","log","float32")};return uo.runKernel(Mt,t)}}),El=wo({log1p_:function(e){const t={x:vo(e,"x","log1p")};return uo.runKernel(Pt,t)}});function jl(e){return uo.customGrad(e)}const Cl=wo({neg_:function(e){const t={x:vo(e,"x","neg")};return uo.runKernel("Neg",t)}}),Il=wo({softplus_:function(e){const t={x:vo(e,"x","softplus")};return uo.runKernel(Tr,t)}}),Ol=wo({logSigmoid_:function(e){const t=vo(e,"x","logSigmoid");return jl((e=>({value:Cl(Il(Cl(e))),gradFunc:t=>Za(t,Qa(Cl(e)))})))(t)}}),Al=wo({sub_:function(e,t){let r=vo(e,"a","sub"),n=vo(t,"b","sub");[r,n]=ro(r,n);const o={a:r,b:n};return uo.runKernel(Br,o)}}),Rl=wo({logSoftmax_:function(e,t=-1){const r=vo(e,"logits","logSoftmax");if(-1===t&&(t=r.rank-1),t!==r.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${r.rank} and axis was ${t}`);const n=jl(((e,r)=>{const n=Zi(e,t,!0),o=Al(e,n),s=Al(Ss(o,"float32"),Tl(nl(il(o),t,!0)));return r([s]),{value:s,gradFunc:(e,r)=>{const[n]=r,o=il(n);return Al(e,Za(nl(e,t,!0),o))}}}));return n(r)}}),Nl=wo({logSumExp_:function(e,t=null,r=!1){const n=vo(e,"x","logSumExp"),o=K(t,n.shape),s=Zi(n,o,!0),a=Al(n,s),i=il(a),l=nl(i,o),u=Tl(l),c=wa(Ha(s,u.shape),u);if(r){const e=Hi(c.shape,o);return Ha(c,e)}return c}}),Ml=wo({logicalAnd_:function(e,t){const r=vo(e,"a","logicalAnd","bool"),n=vo(t,"b","logicalAnd","bool");Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(Lt,o)}}),Pl=wo({logicalNot_:function(e){const t={x:vo(e,"x","logicalNot","bool")};return uo.runKernel(Dt,t)}}),Ll=wo({logicalOr_:function(e,t){const r=vo(e,"a","logicalOr","bool"),n=vo(t,"b","logicalOr","bool");Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(Ft,o)}}),Dl=wo({logicalXor_:function(e,t){const r=vo(e,"a","logicalXor","bool"),n=vo(t,"b","logicalXor","bool");return Xs(r.shape,n.shape),Ml(Ll(e,t),Pl(Ml(e,t)))}}),Fl=2147483648,$l=wo({searchSorted_:function(e,t,r="left"){const n=vo(e,"sortedSequence","searchSorted"),o=vo(t,"values","searchSorted"),s=n.shape[n.shape.length-1],a=o.shape[o.shape.length-1],i=Ha(n,[-1,s]),l=Ha(o,[-1,a]);if(i.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(i.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(z(l.shape)>=Fl)throw new Error("values tensor size must less than 2147483648");if(i.shape[1]>=Fl)throw new Error(`trailing dim_size must less than 2147483648 for int32 output type, was ${i.shape[1]}`);const u={sortedSequence:i,values:l},c={side:r};return uo.runKernel(vr,u,c)}});function Bl(e,t){return $l(e,t,"left")}const Ul=wo({maxPool_:function(e,t,r,n,o){const s=vo(e,"x","maxPool");let a=s,i=!1;3===s.rank&&(i=!0,a=Ha(s,[1,s.shape[0],s.shape[1],s.shape[2]])),B(4===a.rank,(()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`)),B(Ga(r,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${r} and dilations '1'`)),Wa("maxPool",n,o);const l={x:a},u={filterSize:t,strides:r,pad:n,dimRoundingMode:o},c=uo.runKernel(Bt,l,u);return i?Ha(c,[c.shape[1],c.shape[2],c.shape[3]]):c}}),Vl=wo({maxPool3d_:function(e,t=[1,1,1],r,n,o,s="NDHWC"){const a=vo(e,"x","maxPool3d");let i=a,l=!1;4===a.rank&&(l=!0,i=Ha(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(5===i.rank,(()=>`Error in maxPool3d: x must be rank 5 but got rank ${i.rank}.`)),B("NDHWC"===s,(()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`)),Wa("maxPool3d",n,o);const u={x:i},c={filterSize:t,strides:r,pad:n,dimRoundingMode:o,dataFormat:s},d=uo.runKernel(Ut,u,c);return l?Ha(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}}),Gl=wo({maxPoolWithArgmax_:function(e,t,r,n,o=!1){const s={x:vo(e,"x","maxPoolWithArgmax")},a={filterSize:t,strides:r,pad:n,includeBatchInIndex:o},i=uo.runKernel(Vt,s,a);return{result:i[0],indexes:i[1]}}}),zl=wo({maximum_:function(e,t){let r=vo(e,"a","maximum"),n=vo(t,"b","maximum");[r,n]=ro(r,n),"bool"===r.dtype&&(r=Ss(r,"int32"),n=Ss(n,"int32")),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel($t,o)}}),Wl=wo({mean_:function(e,t=null,r=!1){const n={x:vo(e,"x","mean")},o={axis:t,keepDims:r};return uo.runKernel(Gt,n,o)}});function Hl(e,t="float32"){if("complex64"===t){const t=Hl(e,"float32"),r=Hl(e,"float32");return _o(t,r)}const r=de(z(e),t);return uo.makeTensor(r,e,t)}function ql(e,t="float32"){if("complex64"===t){const t=ql(e,"float32"),r=Hl(e,"float32");return _o(t,r)}const r=ce(z(e),t);return uo.makeTensor(r,e,t)}function Xl(e,t,{indexing:r="xy"}={}){if("xy"!==r&&"ij"!==r)throw new TypeError(`${r} is not a valid third argument to meshgrid`);if(void 0===e)return[];let n=vo(e,"x","meshgrid",e instanceof Hn?e.dtype:"float32");if(void 0===t)return[n];let o=vo(t,"y","meshgrid",t instanceof Hn?t.dtype:"float32");const s=z(n.shape),a=z(o.shape);return"xy"===r?(n=Ha(n,[1,-1]),o=Ha(o,[-1,1]),[Ka(ql([a,1],n.dtype),n),Ka(o,ql([1,s],o.dtype))]):(n=Ha(n,[-1,1]),o=Ha(o,[1,-1]),[Ka(n,ql([1,a],n.dtype)),Ka(ql([s,1],o.dtype),o)])}const Yl=wo({minimum_:function(e,t){let r=vo(e,"a","minimum"),n=vo(t,"b","minimum");[r,n]=ro(r,n),"bool"===r.dtype&&(r=Ss(r,"int32"),n=Ss(n,"int32")),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(zt,o)}}),Kl=wo({mirrorPad_:function(e,t,r){B("reflect"===r||"symmetric"===r,(()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${r}.`));const n=vo(e,"x","mirrorPad");if(0===n.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");B(t.length===n.rank,(()=>`Padding doesn't match input. Must be ${n.rank}. Got ${t.length}.`));const o="reflect"===r?1:0;for(let e=0;e<n.rank;e++)B(2===t[e].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),B(t[e][0]>=0&&t[e][0]<=n.shape[e]-o&&t[e][1]>=0&&t[e][1]<=n.shape[e]-o,(()=>`Padding in dimension ${e} cannot be greater than or equal to ${n.shape[e]-o} or less than 0 for input of shape ${n.shape}`));const s={paddings:t,mode:r},a={x:n};return uo.runKernel(Wt,a,s)}}),Zl=wo({mod_:function(e,t){let r=vo(e,"a","mod"),n=vo(t,"b","mod");[r,n]=ro(r,n);const o={a:r,b:n};return uo.runKernel("Mod",o)}}),Ql=wo({moments_:function(e,t=null,r=!1){const n=K(t,(e=vo(e,"x","moments")).shape),o=Wl(e,n,r);let s=o.shape;r||(s=Hi(o.shape,n));const a=rl(Al(Ss(e,"float32"),Ha(o,s)));return{mean:o,variance:Wl(a,n,r)}}}),Jl=wo({multiRNNCell_:function(e,t,r,n){const o=vo(t,"data","multiRNNCell"),s=bo(r,"c","multiRNNCell"),a=bo(n,"h","multiRNNCell");let i=o;const l=[];for(let t=0;t<e.length;t++){const r=e[t](i,s[t],a[t]);l.push(r[0]),l.push(r[1]),i=r[1]}const u=[],c=[];for(let e=0;e<l.length;e+=2)u.push(l[e]),c.push(l[e+1]);return[u,c]}}),eu=wo({multinomial_:function(e,t,r,n=!1){const o=vo(e,"logits","multinomial"),s=o.size,a=o.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);r=r||Math.random();const i={logits:1===a?Ha(o,[1,-1]):o},l={numSamples:t,seed:r,normalized:n},u=uo.runKernel(Ht,i,l);return 1===a?Ha(u,[u.size]):u}}),tu=wo({notEqual_:function(e,t){let r=vo(e,"a","notEqual","string_or_numeric"),n=vo(t,"b","notEqual","string_or_numeric");[r,n]=ro(r,n),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(Xt,o)}}),ru=wo({oneHot_:function(e,t,r=1,n=0,o="int32"){if(t<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${t}`);const s={indices:vo(e,"indices","oneHot","int32")},a={dtype:o,depth:t,onValue:r,offValue:n};return uo.runKernel(Jt,s,a)}}),nu=wo({onesLike_:function(e){const t={x:vo(e,"x","onesLike")};return uo.runKernel(Qt,t)}}),ou=wo({outerProduct_:function(e,t){const r=vo(e,"v1","outerProduct"),n=vo(t,"v2","outerProduct");B(1===r.rank&&1===n.rank,(()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${r.rank} and ${n.rank}.`));const o=Ha(r,[-1,1]),s=Ha(n,[1,-1]);return Ka(o,s)}}),su=wo({pad_:function(e,t,r=0){const n=vo(e,"x","pad");if(0===n.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const o={paddings:t,constantValue:r},s={x:n};return uo.runKernel(tr,s,o)}}),au=wo({pad1d_:function(e,t,r=0){return B(2===t.length,(()=>"Invalid number of paddings. Must be length of 2.")),su(e,[t],r)}}),iu=wo({pad2d_:function(e,t,r=0){return B(2===t.length&&2===t[0].length&&2===t[1].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),su(e,t,r)}}),lu=wo({pad3d_:function(e,t,r=0){return B(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),su(e,t,r)}}),uu=wo({pad4d_:function(e,t,r=0){return B(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(()=>"Invalid number of paddings. Must be length of 2 each.")),su(e,t,r)}}),cu=wo({spaceToBatchND_:function(e,t,r){const n=vo(e,"x","spaceToBatchND");B(n.rank>=1+t.length,(()=>`input rank ${n.rank} should be > than [blockShape] ${t.length}`)),B(r.length===t.length,(()=>`paddings.shape[0] ${r.length} must be equal to [blockShape] ${t.length}`)),B(n.shape.reduce(((e,n,o)=>o>0&&o<=t.length?e&&(n+r[o-1][0]+r[o-1][1])%t[o-1]==0:e),!0),(()=>`input spatial dimensions ${n.shape.slice(1)} with paddings ${r.toString()} must be divisible by blockShapes ${t.toString()}`));const o={x:n},s={blockShape:t,paddings:r};return uo.runKernel(jr,o,s)}}),du=wo({pool_:function(e,t,r,n,o,s,a){null==o&&(o=[1,1]),null==s&&(s=1),0===n&&(n="valid");const i=vo(e,"x","maxPool");let l=i,u=!1;3===i.rank&&(u=!0,l=Ha(i,[1,i.shape[0],i.shape[1],i.shape[2]])),B(Ga(s,o),(()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${o}'`));const c=Na(l.shape,t,s,o,n),d=[c.dilationHeight,c.dilationWidth];let h;h="same"===n?function(e,t){const r=e.map(((e,r)=>e+(e-1)*(t[r]-1))).map((e=>e-1)),n=r.map((e=>Math.floor(e/2))),o=r.map(((e,t)=>e-n[t]));return r.map(((e,t)=>[n[t],o[t]]))}([c.filterHeight,c.filterWidth],d):[[0,0],[0,0]];const p=1===d[0]&&1===d[1],[f,m]=function(e,t,r){const n=r.map((e=>e[0])),o=r.map((e=>e[1])),s=e.concat(n,o),a=t.map(((e,t)=>(e-s[t]%e)%e)),i=o.map(((e,t)=>e+a[t]));return[t.map(((e,t)=>[n[t],i[t]])),t.map(((e,t)=>[0,a[t]]))]}([c.inHeight,c.inWidth],d,h),y=p?n:"valid",g=p?l:cu(l,d,f),v=("avg"===r?()=>qa(g,t,s,y,a):()=>Ul(g,t,s,y,a))(),b=p?v:ri(v,d,m);return u?Ha(b,[b.shape[1],b.shape[2],b.shape[3]]):b}}),hu=wo({prelu_:function(e,t){const r={x:vo(e,"x","prelu"),alpha:vo(t,"alpha","prelu")};return uo.runKernel(rr,r)}}),pu=wo({prod_:function(e,t=null,r=!1){let n=vo(e,"x","prod");"bool"===n.dtype&&(n=Ss(n,"int32"));const o={x:n},s={axis:t,keepDims:r};return uo.runKernel(nr,o,s)}}),fu=wo({raggedGather_:function(e,t,r,n){const o={paramsNestedSplits:e.map(((e,t)=>vo(e,`tensors${t}`,"raggedGather","int32"))),paramsDenseValues:vo(t,"paramsDenseValues","raggedGather"),indices:vo(r,"indices","raggedGather","int32")},s={outputRaggedRank:n},a=uo.runKernel(or,o,s);return{outputNestedSplits:a.slice(0,a.length-1),outputDenseValues:a[a.length-1]}}}),mu=wo({raggedTensorToTensor_:function(e,t,r,n,o){const s=vo(e,"shape","raggedTensorToTensor","int32"),a=vo(t,"values","raggedTensorToTensor"),i={shape:s,values:a,defaultValue:vo(r,"defaultValue","raggedTensorToTensor",a.dtype),rowPartitionTensors:n.map(((e,t)=>vo(e,`tensors${t}`,"raggedTensorToTensor","int32")))},l={rowPartitionTypes:o};return uo.runKernel(sr,i,l)}}),yu=wo({rand_:function(e,t,r){const n=z(e);let o=null;if(null==r||"float32"===r)o=new Float32Array(n);else if("int32"===r)o=new Int32Array(n);else{if("bool"!==r)throw new Error(`Unknown data type ${r}`);o=new Uint8Array(n)}for(let e=0;e<n;e++)o[e]=t();return uo.makeTensor(o,e,r)}});var gu=n(377);class vu{constructor(e,t,r,n,o){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=n,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);const s=o||Math.random();this.random=gu.alea(s.toString())}nextValue(){if(!isNaN(this.nextVal)){const e=this.nextVal;return this.nextVal=NaN,e}let e,t,r=!1;for(;!r;){let n,o,s;do{n=2*this.random()-1,o=2*this.random()-1,s=n*n+o*o}while(s>=1||0===s);const a=Math.sqrt(-2*Math.log(s)/s);e=this.mean+this.stdDev*n*a,t=this.mean+this.stdDev*o*a,this.truncated&&!this.isValidTruncated(e)||(r=!0)}return this.truncated&&!this.isValidTruncated(t)||(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class bu{constructor(e,t,r,n){this.alpha=e,this.beta=1/t,this.dtype=r;const o=n||Math.random();this.randu=gu.alea(o.toString()),this.randn=new vu(0,1,r,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,r,n,o,s;for(;;){do{n=this.randn.nextValue(),s=1+this.c*n}while(s<=0);if(s*=s*s,e=n*n,t=1-.331*e*e,r=.5*e+this.d*(1-s+Math.log(s)),o=this.randu(),o<t||Math.log(o)<r)break}return s=1/this.beta*this.d*s,this.alpha<1&&(s*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(s)}convertValue(e){return"float32"===this.dtype?e:Math.round(e)}}class xu{constructor(e=0,t=1,r,n){if(this.canReturnFloat=()=>null==this.dtype||"float32"===this.dtype,this.min=e,this.range=t-e,this.dtype=r,null==n&&(n=Math.random()),"number"==typeof n&&(n=n.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=gu.alea(n)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}const wu=wo({randomGamma_:function(e,t,r=1,n="float32",o){if(null==r&&(r=1),null==n&&(n="float32"),"float32"!==n&&"int32"!==n)throw new Error(`Unsupported data type ${n}`);const s=new bu(t,r,n,o),a=_s(e,n);for(let e=0;e<a.values.length;e++)a.values[e]=s.nextValue();return a.toTensor()}}),_u=wo({randomNormal_:function(e,t=0,r=1,n,o){if(null!=n&&"bool"===n)throw new Error(`Unsupported data type ${n}`);const s=new vu(t,r,n,!1,o),a=_s(e,n);for(let e=0;e<a.values.length;e++)a.values[e]=s.nextValue();return a.toTensor()}}),Su=wo({randomStandardNormal_:function(e,t,r){if(null!=t&&"bool"===t)throw new Error(`Unsupported data type ${t}`);return _u(e,0,1,t,r)}}),ku=wo({randomUniform_:function(e,t=0,r=1,n="float32",o){const s=_s(e,n),a=new xu(t,r,null,o);for(let e=0;e<s.values.length;e++)s.values[e]=a.nextValue();return s.toTensor()}});function Tu(e,t,r=1,n="float32"){if(0===r)throw new Error("Cannot have a step of zero");const o={start:e,stop:t,step:r,dtype:n};return uo.runKernel(ar,{},o)}const Eu=wo({real_:function(e){const t={input:vo(e,"input","real")};return uo.runKernel(ir,t)}}),ju=wo({reciprocal_:function(e){const t={x:vo(e,"x","reciprocal")};return uo.runKernel(lr,t)}}),Cu=wo({relu_:function(e){const t={x:vo(e,"x","relu")};return uo.runKernel(ur,t)}}),Iu=wo({relu6_:function(e){const t={x:vo(e,"x","relu6")};return uo.runKernel(pr,t)}}),Ou=wo({reverse_:function(e,t){const r={x:vo(e,"x","reverse")},n={dims:t};return uo.runKernel(fr,r,n)}}),Au=wo({reverse1d_:function(e){const t=vo(e,"x","reverse");return B(1===t.rank,(()=>`Error in reverse1D: x must be rank 1 but got rank ${t.rank}.`)),Ou(t,0)}}),Ru=wo({reverse2d_:function(e,t){const r=vo(e,"x","reverse");return B(2===r.rank,(()=>`Error in reverse2D: x must be rank 2 but got rank ${r.rank}.`)),Ou(r,t)}}),Nu=wo({reverse3d_:function(e,t){const r=vo(e,"x","reverse");return B(3===r.rank,(()=>`Error in reverse3D: x must be rank 3 but got rank ${r.rank}.`)),Ou(r,t)}}),Mu=wo({reverse4d_:function(e,t){const r=vo(e,"x","reverse");return B(4===r.rank,(()=>`Error in reverse4D: x must be rank 4 but got rank ${r.rank}.`)),Ou(r,t)}}),Pu=wo({round_:function(e){const t={x:vo(e,"x","round")};return uo.runKernel(mr,t)}}),Lu=wo({rsqrt_:function(e){const t={x:vo(e,"x","rsqrt","float32")};return uo.runKernel(yr,t)}}),Du=wo({selu_:function(e){const t={x:vo(e,"x","selu")};return uo.runKernel(xr,t)}}),Fu=wo({separableConv2d_:function(e,t,r,n,o,s=[1,1],a="NHWC"){const i=vo(e,"x","separableConv2d"),l=vo(t,"depthwiseFilter","separableConv2d"),u=vo(r,"pointwiseFilter","separableConv2d");let c=i,d=!1;if(3===i.rank&&(d=!0,c=Ha(i,[1,i.shape[0],i.shape[1],i.shape[2]])),"NCHW"===a)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(4===c.rank,(()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`)),B(4===l.rank,(()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`)),B(4===u.rank,(()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`)),B(1===u.shape[0],(()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`)),B(1===u.shape[1],(()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`));const h=l.shape[2],p=l.shape[3];B(u.shape[2]===h*p,(()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*p}, but got ${u.shape[2]}.`));const f=Oi(c,l,n,o,a,s),m=gi(f,u,1,"valid",a);return d?Ha(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),$u=async function(e,t){const r=vo(e,"x","setdiff1d"),n=vo(t,"y","setdiff1d");B(r.dtype===n.dtype,(()=>`x and y should have the same dtype, but got x (${r.dtype}) and y (${n.dtype}).`)),B(1===r.rank,(()=>`x should be 1D tensor, but got x (${r.shape}).`)),B(1===n.rank,(()=>`y should be 1D tensor, but got y (${n.shape}).`));const o=await r.data(),s=await n.data(),a=new Set(s);let i=0;for(let e=0;e<o.length;e++)a.has(o[e])||i++;const l=new Vn([i],r.dtype),u=new Vn([i],"int32");for(let e=0,t=0;e<o.length;e++)a.has(o[e])||(l.values[t]=o[e],u.values[t]=e,t++);return[l.toTensor(),u.toTensor()]},Bu=wo({sign_:function(e){const t={x:vo(e,"x","sign")};return uo.runKernel(Sr,t)}}),Uu=wo({sin_:function(e){const t={x:vo(e,"x","sin","float32")};return uo.runKernel("Sin",t)}}),Vu=wo({sinh_:function(e){const t={x:vo(e,"x","sinh")};return uo.runKernel(_r,t)}}),Gu=wo({slice1d_:function(e,t,r){const n=vo(e,"x","slice1d");return B(1===n.rank,(()=>`slice1d expects a rank-1 tensor, but got a rank-${n.rank} tensor`)),Ja(n,[t],[r])}}),zu=wo({slice2d_:function(e,t,r){const n=vo(e,"x","slice2d");return B(2===n.rank,(()=>`slice2d expects a rank-2 tensor, but got a rank-${n.rank} tensor`)),Ja(n,t,r)}}),Wu=wo({slice3d_:function(e,t,r){const n=vo(e,"x","slice3d");return B(3===n.rank,(()=>`slice3d expects a rank-3 tensor, but got a rank-${n.rank} tensor`)),Ja(n,t,r)}}),Hu=wo({slice4d_:function(e,t,r){const n=vo(e,"x","slice4d");return B(4===n.rank,(()=>`slice4d expects a rank-4 tensor, but got a rank-${n.rank} tensor`)),Ja(n,t,r)}}),qu=wo({softmax_:function(e,t=-1){const r=vo(e,"logits","softmax","float32");if(-1===t&&(t=r.rank-1),t!==r.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${r.rank} and dim was ${t}`);const n={logits:r},o={dim:t};return uo.runKernel(Ir,n,o)}}),Xu=wo({fft_:function(e){B("complex64"===e.dtype,(()=>`The dtype for tf.spectral.fft() must be complex64 but got ${e.dtype}.`));const t={input:e};return uo.runKernel("FFT",t)}}),Yu=wo({ifft_:function(e){B("complex64"===e.dtype,(()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${e.dtype}.`));const t={input:e};return uo.runKernel(Tt,t)}}),Ku=wo({irfft_:function(e){const t=e.shape[e.shape.length-1],r=e.size/t;let n;if(t<=2){const o=Ha(e,[r,t]);n=Yu(o)}else{const o=[r,2*(t-1)],s=Ha(Eu(e),[r,t]),a=Ha(yl(e),[r,t]),i=Ou(Ja(s,[0,1],[r,t-2]),1),l=Za(Ou(Ja(a,[0,1],[r,t-2]),1),el(-1)),u=Ya([s,i],1),c=Ya([a,l],1),d=Ha(_o(u,c),[o[0],o[1]]);n=Yu(d)}if(n=Eu(n),3===e.rank&&0!==e.shape[0]){const t=n,r=e.shape[0];n=Ha(n,[r,n.shape[0]/r,n.shape[1]]),t.dispose()}return n}}),Zu=wo({split_:function(e,t,r=0){const n={x:vo(e,"x","split")},o={numOrSizeSplits:t,axis:r};return uo.runKernel(Cr,n,o)}}),Qu=wo({rfft_:function(e,t){B("float32"===e.dtype,(()=>`The dtype for rfft() must be real value but got ${e.dtype}`));let r=e.shape[e.shape.length-1];const n=e.size/r;let o;if(null!=t&&t<r){const n=e.shape.map((e=>0)),s=e.shape.map((e=>e));s[e.shape.length-1]=t,o=Ja(e,n,s),r=t}else if(null!=t&&t>r){const n=e.shape.map((e=>e));n[e.shape.length-1]=t-r,o=Ya([e,Hl(n)],e.shape.length-1),r=t}else o=e;const s=Di(o),a=Ha(_o(o,s),[n,r]),i=Xu(a),l=Math.floor(r/2)+1,u=Eu(i),c=yl(i),d=Zu(u,[l,r-l],u.shape.length-1),h=Zu(c,[l,r-l],c.shape.length-1),p=o.shape.slice();return p[o.shape.length-1]=l,Ha(_o(d[0],h[0]),p)}}),Ju=wo({squaredDifference_:function(e,t){let r=vo(e,"a","squaredDifference"),n=vo(t,"b","squaredDifference");[r,n]=ro(r,n),Xs(r.shape,n.shape);const o={a:r,b:n};return uo.runKernel(Pr,o,{})}}),ec=wo({squeeze_:function(e,t){const r=vo(e,"x","squeeze","string_or_numeric");return Ha(r,Z(r.shape,t).newShape)}}),tc=wo({stack_:function(e,t=0){const r=bo(e,"tensors","stack","string_or_numeric");B(r.length>=1,(()=>"Pass at least one tensor to tf.stack")),r.length>0&&B(t<=r[0].rank,(()=>"Axis must be <= rank of the tensor"));const n=r,o={axis:t};return uo.runKernel(er,n,o)}}),rc=wo({step_:function(e,t=0){const r={x:vo(e,"x","step")},n={alpha:t};return uo.runKernel(Kr,r,n)}}),nc=wo({stridedSlice_:function(e,t,r,n,o=0,s=0,a=0,i=0,l=0){const u={x:vo(e,"x","stridedSlice","string_or_numeric")},c={begin:t,end:r,strides:n,beginMask:o,endMask:s,ellipsisMask:a,newAxisMask:i,shrinkAxisMask:l};return uo.runKernel(Lr,u,c)}}),oc=wo({tan_:function(e){const t={x:vo(e,"x","tan","float32")};return uo.runKernel("Tan",t)}});function sc(e,t){V(e);const r=mo(e,t);if(1!==r.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return So(e,null,r,t)}function ac(e,t,r){if(V(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");const n=mo(e,r);if(2!==n.length&&1!==n.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===n.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return So(e,t,n,r)}function ic(e,t,r){if(V(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");const n=mo(e,r);if(4!==n.length&&1!==n.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===n.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return So(e,t,n,r)}function lc(e,t,r){if(V(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");const n=mo(e,r);if(5!==n.length&&1!==n.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===n.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return So(e,t,n,r)}function uc(e,t,r){if(V(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");const n=mo(e,r);if(6!==n.length&&1!==n.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===n.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return So(e,t=t||n,n,r)}const cc=wo({topk_:function(e,t=1,r=!0){const n=vo(e,"x","topk");if(0===n.rank)throw new Error("topk() expects the input to be of rank 1 or higher");const o=n.shape[n.shape.length-1];if(t<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${t}`);if(t>o)throw new Error(`'k' passed to topk() must be <= the last dimension (${o}) but got ${t}`);const s={x:n},a={k:t,sorted:r},[i,l]=uo.runKernel(Gr,s,a);return{values:i,indices:l}}}),dc=wo({truncatedNormal_:function(e,t=0,r=1,n,o){if(null!=n&&"bool"===n)throw new Error("Unsupported data type $ { dtype }");const s=new vu(t,r,n,!0,o),a=_s(e,n);for(let e=0;e<a.values.length;e++)a.values[e]=s.nextValue();return a.toTensor()}}),hc=wo({unique_:function(e,t=0){const r=vo(e,"x","unique","string_or_numeric");B(r.rank>0,(()=>"The input tensor must be at least 1D"));const n={x:r},o={axis:t},[s,a]=uo.runKernel(Hr,n,o);return{values:s,indices:a}}}),pc=wo({unsortedSegmentSum_:function(e,t,r){const n=vo(e,"x","unsortedSegmentSum"),o=vo(t,"segmentIds","unsortedSegmentSum","int32");B(H(r),(()=>"numSegments must be of dtype int"));const s={x:n,segmentIds:o},a={numSegments:r};return uo.runKernel(Xr,s,a)}}),fc=wo({unstack_:function(e,t=0){const r=vo(e,"x","unstack","string_or_numeric");B(t>=-r.shape.length&&t<r.shape.length,(()=>`Axis = ${t} is not in [-${r.shape.length}, ${r.shape.length})`));const n={value:r},o={axis:t};return uo.runKernel(qr,n,o)}});function mc(e,t){return $l(e,t,"right")}function yc(e,t=!0,r,n){return uo.makeVariable(e,t,r,n)}function gc(e,t){const r=[];for(let e=0;e<t.length;e++)t[e]&&r.push(e);const n=_s(e,"int32"),o=_s([r.length,e.length],"int32");for(let t=0;t<r.length;t++){const s=n.indexToLoc(r[t]),a=t*e.length;o.values.set(s,a)}return o.toTensor()}const vc=async function(e){const t=vo(e,"condition","whereAsync","bool"),r=await t.data(),n=gc(t.shape,r);return e!==t&&t.dispose(),n},bc=async function(e,t,r){const n=vo(e,"tensor","boolMask"),o=vo(t,"mask","boolMask","bool"),s=null==r?0:r,a=o.rank,i=n.shape;B(a>0,(()=>"mask cannot be scalar")),U(i.slice(s,s+a),o.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let e=s;e<s+a;e++)l*=i[e];const u=i.slice(0,s).concat([l],i.slice(s+a)),c=Ha(n,u),d=Ha(o,[-1]),h=await vc(d),p=ec(h,[1]),f=pl(c,p,s);return e!==n&&n.dispose(),t!==o&&o.dispose(),p.dispose(),c.dispose(),d.dispose(),h.dispose(),f};function xc(){return uo}function wc(e,t){return uo.tidy(e,t)}function _c(e){no(e).forEach((e=>e.dispose()))}function Sc(e){return uo.keep(e)}function kc(){return uo.backendName}Wn=function(e){be().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")};const Tc=wo({transpose_:function(e,t,r){const n=vo(e,"x","transpose");if(null==t&&(t=n.shape.map(((e,t)=>t)).reverse()),B(n.rank===t.length,(()=>`Error in transpose: rank of input ${n.rank} must match length of perm ${t}.`)),t.forEach((e=>{B(e>=0&&e<n.rank,(()=>"All entries in 'perm' must be between 0 and "+(n.rank-1)+` but got ${t}`))})),n.rank<=1)return n.clone();const o={x:n},s={perm:t};return"complex64"===n.dtype?wc((()=>{let e=Eu(n),t=yl(n);return e=uo.runKernel(Wr,{x:e},s),t=uo.runKernel(Wr,{x:t},s),r&&(t=Cl(t)),_o(e,t)})):uo.runKernel(Wr,o,s)}}),Ec=wo({movingAverage_:function(e,t,r,n,o=!0){const s=vo(e,"v","movingAverage"),a=vo(t,"x","movingAverage"),i=vo(r,"decay","movingAverage");var l,u;u=a,B((l=s).dtype===u.dtype,(()=>`The dtypes of the first(${l.dtype}) and second(${u.dtype}) input must match`)),B(W(s.shape,a.shape),(()=>"Shape mismatch in v and x"));const c=el(1),d=Al(c,i);let h=Za(Al(a,s),d);if(o){B(null!=n,(()=>"When using zeroDebias: true, step is required."));const e=vo(n,"step","movingAverage");h=Mi(h,Al(c,Ji(i,e)))}return wa(s,h)}});function jc(e,t,r){const n=t.rank>1?t.shape[t.rank-1]:1,o=t.rank>1?t.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${r.shape}, indices.shape: ${t.shape}, shape: ${e}, sliceDim: ${n}, and batchDim: ${o}.`;if(r.rank<o)throw new Error(s+` update.rank < ${o}. `);if(e.length<n+(r.rank-o))throw new Error(s+` Output shape length < ${n+(r.rank-o)}`);if(r.rank!==o+e.length-n)throw new Error(s+" update.rank != "+(o+e.length-n));for(let e=0;e<o;++e)if(r.shape[e]!==t.shape[e])throw new Error(s+` updates.shape[${e}] (${r.shape[e]}) != indices.shape[${e}] (${t.shape[e]}).`);for(let t=0;t<r.rank-o;++t)if(r.shape[t+o]!==e[t+n])throw new Error(s+` updates.shape[${t+o}] (${r.shape[t+o]}) != shape[${t+o}] (${e[t+o]})`)}function Cc(e,t,r){if(t.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${e.rank}.`);if("int32"!==t.dtype)throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${t.dtype}`);if(r.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${r}`);if(0===r.length){if(0===t.size)throw new Error(`Indices specified for empty output. indices shape: ${t.shape}`);if(0===e.size)throw new Error(`Updates specified for empty output. updates shape: ${e.shape}`)}jc(r,t,e)}function Ic(e,t,r){const n=t.shape.length,o=n>1?t.shape[n-1]:1,s=r.length;let a=1;for(let e=o;e<s;++e)a*=r[e];const i=o<1?1:o;return{sliceRank:o,numUpdates:z(t.shape)/i,sliceSize:a,strides:[...ie(r.slice(0,o)),1],outputSize:z(r)}}const Oc=wo({scatterND_:function(e,t,r){const n=vo(e,"indices","scatterND","int32"),o=vo(t,"updates","scatterND");Cc(o,n,r);const s={indices:n,updates:o},a={shape:r};return uo.runKernel(gr,s,a)}}),Ac=wo({sparseToDense_:function(e,t,r,n=0){const o=vo(e,"sparseIndices","sparseToDense","int32"),s=vo(t,"sparseValues","sparseToDense","string_or_numeric"),a=vo(n,"defaultValue","sparseToDense",s.dtype);!function(e,t,r,n){if("int32"!==e.dtype)throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${e.shape}.`);const o=e.rank>0?e.shape[0]:1,s=e.rank>1?e.shape[1]:1;if(r.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${r.length}, should be: ${s}.`);const a=t.size;if(0!==t.rank&&(1!==t.rank||a!==o))throw new Error(`sparseValues has incorrect shape ${t.shape}, should be [] or [${o}]`);if(t.dtype!==n.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(o,s,r,a);const i={sparseIndices:o,sparseValues:s,defaultValue:a},l={outputShape:r};return uo.runKernel(Mr,i,l)}}),Rc=wo({gatherND_:function(e,t){const r=vo(t,"indices","gatherND","int32"),n={params:vo(e,"x","gatherND","string_or_numeric"),indices:r};return uo.runKernel(wt,n)}}),Nc=wo({dropout_:function(e,t,r,n){const o=vo(e,"x","dropout");if(B("float32"===o.dtype,(()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${o.dtype} tensor instead.`)),B(t>=0&&t<1,(()=>`rate must be a float in the range [0, 1), but got ${t}.`)),0===t)return e instanceof Hn?o.clone():o;const s=function(e,t){if(null==t)return e.shape.slice();if(W(e.shape,t))return t;if(e.shape.length===t.length){const r=[];for(let n=0;n<e.shape.length;n++)null==t[n]&&null!=e.shape[n]?r.push(e.shape[n]):r.push(t[n]);return r}return t}(o,r),a=1-t,i=Mi(hl(wa(ku(s,0,1,"float32",n),a)),a);return Za(o,i)}});function Mc(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Pc(e,t,r){const n=1-e%2,o=new Float32Array(e);for(let s=0;s<e;++s){const a=2*Math.PI*s/(e+n-1);o[s]=t-r*Math.cos(a)}return sc(o,"float32")}const Lc=async function(e,t,r=1){const n=vo(e,"predictions","inTopK"),o=vo(t,"targets","inTopK");B(n.rank>1,(()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${n.rank}`)),B(n.rank-1===o.rank,(()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${n.rank} and targets rank ${o.rank}`)),U(n.shape.slice(0,n.shape.length-1),o.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=n.shape[n.shape.length-1];B(r>0&&r<=s,(()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${r}`));const a=await n.data(),i=await o.data(),[l,u]=[a.length/s,s],c=Q("bool",l);for(let e=0;e<l;e++){const t=e*u,n=a.subarray(t,t+u),o=[];for(let e=0;e<n.length;e++)o.push({value:n[e],index:e});o.sort(((e,t)=>t.value-e.value)),c[e]=0;for(let t=0;t<r;t++)if(o[t].index===i[e]){c[e]=1;break}}return e!==n&&n.dispose(),t!==o&&o.dispose(),ko(c,o.shape,"bool")},Dc=wo({conv2DBackpropFilter_:function(e,t,r,n,o,s="NHWC",a){let i=e;3===e.rank&&(i=Ha(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Ha(t,[1,t.shape[0],t.shape[1],t.shape[2]])),B(4===i.rank,(()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${i.shape}.`)),B(4===l.rank,(()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`)),B(4===r.length,(()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${r}.`));const u="NHWC"===s?i.shape[3]:i.shape[1],c="NHWC"===s?l.shape[3]:l.shape[1];B(u===r[2],(()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${r[2]}.`)),B(c===r[3],(()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${r[3]}).`)),Wa("conv2dDerFilter",o,a);const d={x:i,dy:l},h={strides:n,pad:o,dataFormat:s,dimRoundingMode:a,filterShape:r};return uo.runKernel(Xe,d,h)}});function Fc(e,t,r){if(null==r||"linear"===r)return e;if("relu"===r)return Za(e,rc(t));throw new Error(`Cannot compute gradient for fused activation ${r}.`)}function $c(e,t){let r=t;const n=qs(e.shape,t.shape);return n.length>0&&(r=nl(r,n)),Ha(r,e.shape)}function Bc(e,t,r,n){if("linear"===t)return e;if("relu"===t)return Cu(e);if("elu"===t)return Ui(e);if("relu6"===t)return Iu(e);if("prelu"===t)return hu(e,r);if("leakyrelu"===t)return xl(e,n);if("sigmoid"===t)return Qa(e);throw new Error(`Unknown fused activation ${t}.`)}const Uc=(e,t)=>!(e>0)||"linear"===t,Vc=wo({fusedConv2d_:function({x:e,filter:t,strides:r,pad:n,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",!1===Uc(uo.state.gradientDepth,l)){B("NHWC"===o,(()=>`Error in fused conv2d: got dataFormat of ${o} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`));let d=gi(e,t,r,n,o,s,a);return null!=i&&(d=wa(d,i)),Bc(d,l,u,c)}const d=vo(e,"x","conv2d","float32"),h=vo(t,"filter","conv2d","float32");let p=d,f=!1;3===d.rank&&(f=!0,p=Ha(d,[1,d.shape[0],d.shape[1],d.shape[2]])),B(4===p.rank,(()=>`Error in fused conv2d: input must be rank 4, but got rank ${p.rank}.`)),B(4===h.rank,(()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`)),Wa("fused conv2d",n,a);const m="NHWC"===o?p.shape[3]:p.shape[1];B(h.shape[2]===m,(()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`)),B(Ga(r,s),(()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`));const y=Pa(p.shape,h.shape,r,s,n,a);let g,v;if(null!=i&&(g=vo(i,"bias","fused conv2d"),[g]=ro(g,d),"NHWC"===o?Xs(y.outShape,g.shape):(B(g.shape.length<=1,(()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`)),B(0===g.shape.length||g.shape[0]===y.outChannels||1===g.shape[0],(()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${y.outChannels})`)))),null!=u){const e=u.shape;if(B(e.length<=1||3===e.length,(()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${e.length}.`)),1===e.length)B(1===e[0]||e[0]===y.outChannels,(()=>`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the number of output channels (${y.outChannels}).`));else if(3===e.length)try{Xs(e,y.outShape)}catch(t){const r=`Error in fused conv2d: PReLU activation weights (${e}) is not compatible with the output shape of the conv2d (${y.outShape}).`;throw Error(r)}v=vo(u,"prelu weights","fused conv2d")}const b=(e,t)=>{B("NHWC"===o,(()=>`Error in gradient of fused conv2D: got dataFormat of ${o} but only NHWC is currently supported.`));const[a,i,u,c]=t,d=Fc(e,u,l);B(Va(s),(()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`));const h=[bi(i.shape,d,a,r,n),Dc(i,d,a.shape,r,n)];if(null!=c){const e=$c(c,d);h.push(e)}return h},x={x:p,filter:h,bias:g,preluActivationWeights:v},w={strides:r,pad:n,dataFormat:o,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:c};if(null==i){const e=jl(((e,t,r)=>{let n=uo.runKernel(en,x,w);return r([t,e,n]),f&&(n=Ha(n,[n.shape[1],n.shape[2],n.shape[3]])),{value:n,gradFunc:b}}));return e(p,h)}{const e=jl(((e,t,r,n)=>{let o=uo.runKernel(en,x,w);return n([t,e,o,r]),f&&(o=Ha(o,[o.shape[1],o.shape[2],o.shape[3]])),{value:o,gradFunc:b}}));return e(p,h,g)}}}),Gc=wo({depthwiseConv2dNativeBackpropFilter_:function(e,t,r,n,o,s=[1,1],a){let i=e;3===e.rank&&(i=Ha(e,[1,e.shape[0],e.shape[1],e.shape[2]]));let l=t;3===l.rank&&(l=Ha(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={x:i,dy:l},c={strides:n,pad:o,dimRoundingMode:a,dilations:s,filterShape:r};return uo.runKernel(st,u,c)}}),zc=wo({depthwiseConv2dNativeBackpropInput_:function(e,t,r,n,o,s=[1,1],a){let i=t,l=!1;3===t.rank&&(l=!0,i=Ha(t,[1,t.shape[0],t.shape[1],t.shape[2]]));const u={dy:i,filter:r},c={strides:n,pad:o,dimRoundingMode:a,dilations:s,inputShape:e},d=uo.runKernel(at,u,c);return l?Ha(d,[d.shape[1],d.shape[2],d.shape[3]]):d}}),Wc=wo({fusedDepthwiseConv2d_:function({x:e,filter:t,strides:r,pad:n,dataFormat:o="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:i,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(!1===Uc(uo.state.gradientDepth,l)){let d=Oi(e,t,r,n,o,s,a);return null!=i&&(d=wa(d,i)),Bc(d,l,u,c)}const d=vo(e,"x","depthwiseConv2d","float32"),h=vo(t,"filter","depthwiseConv2d","float32");let p=d,f=!1;3===d.rank&&(f=!0,p=Ha(d,[1,d.shape[0],d.shape[1],d.shape[2]])),B(4===p.rank,(()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${p.rank}.`)),B(4===h.rank,(()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`)),B(p.shape[3]===h.shape[2],(()=>`Error in fused depthwiseConv2d: number of input channels (${p.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`)),null==s&&(s=[1,1]),B(Ga(r,s),(()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${r} and dilations '${s}'`)),Wa("fused depthwiseConv2d",n,a);const m=Pa(p.shape,h.shape,r,s,n,a,!0);let y,g;null!=i&&(y=vo(i,"bias","fused conv2d"),[y]=ro(y,d),Xs(m.outShape,y.shape)),null!=u&&(g=vo(u,"prelu weights","fused depthwiseConv2d"));const v=(e,t)=>{B(Va(s),(()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`));const[o,i,u,c]=t,d=Fc(e,u,l),h=zc(i.shape,d,o,r,n,s,a),p=Gc(i,d,o.shape,r,n,s,a);return null!=c?[h,p,$c(y,d)]:[h,p]},b={x:p,filter:h,bias:y,preluActivationWeights:g},x={strides:r,pad:n,dataFormat:o,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:c};if(null==i){const e=jl(((e,t,r)=>{let n=uo.runKernel(tn,b,x);return r([t,e,n]),f&&(n=Ha(n,[n.shape[1],n.shape[2],n.shape[3]])),{value:n,gradFunc:v}}));return e(p,h)}{const e=jl(((e,t,r,n)=>{let o=uo.runKernel(tn,b,x);return n([t,e,o,r]),f&&(o=Ha(o,[o.shape[1],o.shape[2],o.shape[3]])),{value:o,gradFunc:v}}));return e(p,h,y)}}}),Hc=wo({fusedMatMul_:function({a:e,b:t,transposeA:r=!1,transposeB:n=!1,bias:o,activation:s="linear",preluActivationWeights:a,leakyreluAlpha:i=.2}){if(!1===Uc(uo.state.gradientDepth,s)){let l=Ka(e,t,r,n);return null!=o&&(l=wa(l,o)),Bc(l,s,a,i)}let l=vo(e,"a","fused matMul"),u=vo(t,"b","fused matMul");[l,u]=ro(l,u);const c=r?l.shape[l.rank-2]:l.shape[l.rank-1],d=n?u.shape[u.rank-1]:u.shape[u.rank-2],h=r?l.shape[l.rank-1]:l.shape[l.rank-2],p=n?u.shape[u.rank-2]:u.shape[u.rank-1],f=l.shape.slice(0,-2),m=u.shape.slice(0,-2),y=z(f),g=z(m);B(c===d,(()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${r} and transposeB=${n} must match.`));const v=Xs(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([h,p]),b=Ha(l,r?[y,c,h]:[y,h,c]),x=Ha(u,n?[g,p,d]:[g,d,p]);let w,_;null!=o&&(w=vo(o,"bias","fused matMul"),[w]=ro(w,l),Xs(v,w.shape)),null!=a&&(_=vo(a,"prelu weights","fused matMul"));const S=(e,t)=>{const[a,i,l,u]=t,c=Fc(Ha(e,l.shape),l,s);let d,h;return r||n?!r&&n?(d=Ka(c,i,!1,!1),h=Ka(c,a,!0,!1)):r&&!n?(d=Ka(i,c,!1,!0),h=Ka(a,c,!1,!1)):(d=Ka(i,c,!0,!0),h=Ka(c,a,!0,!0)):(d=Ka(c,i,!1,!0),h=Ka(a,c,!0,!1)),null!=o?[d,h,$c(u,c)]:[d,h]},k={a:b,b:x,bias:w,preluActivationWeights:_},T={transposeA:r,transposeB:n,activation:s,leakyreluAlpha:i};if(null==o){const e=jl(((e,t,r)=>{const n=uo.runKernel(Jr,k,T);return r([e,t,n]),{value:Ha(n,v),gradFunc:S}}));return e(b,x)}{const e=jl(((e,t,r,n)=>{const o=uo.runKernel(Jr,k,T);return n([e,t,o,r]),{value:Ha(o,v),gradFunc:S}}));return e(b,x,w)}}}),qc=wo({hammingWindow_:function(e){return Pc(e,.54,.46)}}),Xc=wo({hannWindow_:function(e){return Pc(e,.5,.5)}}),Yc=wo({frame_:function(e,t,r,n=!1,o=0){let s=0;const a=[];for(;s+t<=e.size;)a.push(Ja(e,s,t)),s+=r;if(n)for(;s<e.size;){const n=s+t-e.size,i=Ya([Ja(e,s,t-n),di([n],o)]);a.push(i),s+=r}return 0===a.length?ac([],[0,t]):Ha(Ya(a),[a.length,t])}}),Kc=wo({stft_:function(e,t,r,n,o=Xc){null==n&&(n=Mc(t));const s=Yc(e,t,r),a=Za(s,o(t));return Qu(a,n)}}),Zc=wo({cropAndResize_:function(e,t,r,n,o="bilinear",s=0){const a=vo(e,"image","cropAndResize"),i=vo(t,"boxes","cropAndResize","float32"),l=vo(r,"boxInd","cropAndResize","int32"),u=i.shape[0];B(4===a.rank,(()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`)),B(2===i.rank&&4===i.shape[1],(()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${i.shape}.`)),B(1===l.rank&&l.shape[0]===u,(()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${i.shape}.`)),B(2===n.length,(()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${n.length}.`)),B(n[0]>=1&&n[1]>=1,(()=>`cropSize must be atleast [1,1], but was ${n}`)),B("bilinear"===o||"nearest"===o,(()=>`method must be bilinear or nearest, but was ${o}`));const c={image:a,boxes:i,boxInd:l},d={method:o,extrapolationValue:s,cropSize:n};return uo.runKernel(tt,c,d)}}),Qc=wo({flipLeftRight_:function(e){const t=vo(e,"image","flipLeftRight","float32");B(4===t.rank,(()=>`Error in flipLeftRight: image must be rank 4,but got rank ${t.rank}.`));const r={image:t};return uo.runKernel(yt,r,{})}}),Jc=wo({grayscaleToRGB_:function(e){const t=vo(e,"image","grayscaleToRGB"),r=t.rank-1,n=t.shape[r];B(t.rank>=2,(()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${t.rank}.`)),B(1===n,(()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${n}.`));const o=new Array(t.rank);return o.fill(1,0,r),o[r]=3,cl(t,o)}}),ed=wo({rotateWithOffset_:function(e,t,r=0,n=.5){const o=vo(e,"image","rotateWithOffset","float32");B(4===o.rank,(()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${o.rank}.`));const s={image:o},a={radians:t,fillValue:r,center:n};return uo.runKernel(Qr,s,a)}});function td(e,t,r,n,o,s){null==n&&(n=.5),null==o&&(o=Number.NEGATIVE_INFINITY),null==s&&(s=0);const a=e.shape[0];return r=Math.min(r,a),B(0<=n&&n<=1,(()=>`iouThreshold must be in [0, 1], but was '${n}'`)),B(2===e.rank,(()=>`boxes must be a 2D tensor, but was of rank '${e.rank}'`)),B(4===e.shape[1],(()=>`boxes must have 4 columns, but 2nd dimension was ${e.shape[1]}`)),B(1===t.rank,(()=>"scores must be a 1D tensor")),B(t.shape[0]===a,(()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${t.shape[0]}`)),B(0<=s&&s<=1,(()=>`softNmsSigma must be in [0, 1], but was '${s}'`)),{maxOutputSize:r,iouThreshold:n,scoreThreshold:o,softNmsSigma:s}}const rd=wo({nonMaxSuppression_:function(e,t,r,n=.5,o=Number.NEGATIVE_INFINITY){const s=vo(e,"boxes","nonMaxSuppression","float32"),a=vo(t,"scores","nonMaxSuppression","float32"),i=td(s,a,r,n,o),l={maxOutputSize:r=i.maxOutputSize,iouThreshold:n=i.iouThreshold,scoreThreshold:o=i.scoreThreshold};return uo.runKernel(Yt,{boxes:s,scores:a},l)}});function nd(e,t,r){const n=function(e,t,r){return function(e,t,r){let n=0,o=e.length,s=0,a=!1;for(;n<o;){s=n+(o-n>>>1);const i=r(t,e[s]);i>0?n=s+1:(o=s,a=!i)}return a?n:-n-1}(e,t,r||od)}(e,t,r),o=n<0?-(n+1):n;e.splice(o,0,t)}function od(e,t){return e>t?1:e<t?-1:0}function sd(e,t,r,n,o){return ld(e,t,r,n,o,0)}function ad(e,t,r,n,o,s){return ld(e,t,r,n,o,0,!1,s,!0)}function id(e,t,r,n,o,s){return ld(e,t,r,n,o,s,!0)}function ld(e,t,r,n,o,s,a=!1,i=!1,l=!1){const u=[];for(let e=0;e<t.length;e++)t[e]>o&&u.push({score:t[e],boxIndex:e,suppressBeginIndex:0});u.sort(dd);const c=s>0?-.5/s:0,d=[],h=[];for(;d.length<r&&u.length>0;){const t=u.pop(),{score:r,boxIndex:s,suppressBeginIndex:a}=t;if(r<o)break;let i=!1;for(let r=d.length-1;r>=a;--r){const a=ud(e,s,d[r]);if(a>=n){i=!0;break}if(t.score=t.score*cd(n,c,a),t.score<=o)break}t.suppressBeginIndex=d.length,i||(t.score===r?(d.push(s),h.push(t.score)):t.score>o&&nd(u,t,dd))}const p=d.length,f=r-p;i&&f>0&&(d.push(...new Array(f).fill(0)),h.push(...new Array(f).fill(0)));const m={selectedIndices:d};return a&&(m.selectedScores=h),l&&(m.validOutputs=p),m}function ud(e,t,r){const n=e.subarray(4*t,4*t+4),o=e.subarray(4*r,4*r+4),s=Math.min(n[0],n[2]),a=Math.min(n[1],n[3]),i=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]),u=Math.min(o[0],o[2]),c=Math.min(o[1],o[3]),d=Math.max(o[0],o[2]),h=Math.max(o[1],o[3]),p=(i-s)*(l-a),f=(d-u)*(h-c);if(p<=0||f<=0)return 0;const m=Math.max(s,u),y=Math.max(a,c),g=Math.min(i,d),v=Math.min(l,h),b=Math.max(g-m,0)*Math.max(v-y,0);return b/(p+f-b)}function cd(e,t,r){const n=Math.exp(t*r*r);return r<=e?n:0}function dd(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}const hd=wo({nonMaxSuppressionWithScore_:function(e,t,r,n=.5,o=Number.NEGATIVE_INFINITY,s=0){const a=vo(e,"boxes","nonMaxSuppression"),i=vo(t,"scores","nonMaxSuppression"),l=td(a,i,r,n,o,s),u={boxes:a,scores:i},c={maxOutputSize:r=l.maxOutputSize,iouThreshold:n=l.iouThreshold,scoreThreshold:o=l.scoreThreshold,softNmsSigma:s=l.softNmsSigma},d=uo.runKernel(Zt,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}}),pd=wo({nonMaxSuppressionPadded_:function(e,t,r,n=.5,o=Number.NEGATIVE_INFINITY,s=!1){const a=vo(e,"boxes","nonMaxSuppression"),i=vo(t,"scores","nonMaxSuppression"),l=td(a,i,r,n,o,null),u={boxes:a,scores:i},c={maxOutputSize:l.maxOutputSize,iouThreshold:l.iouThreshold,scoreThreshold:l.scoreThreshold,padToMaxOutputSize:s},d=uo.runKernel(Kt,u,c);return{selectedIndices:d[0],validOutputs:d[1]}}}),fd=wo({resizeBilinear_:function(e,t,r=!1,n=!1){const o=vo(e,"images","resizeBilinear");B(3===o.rank||4===o.rank,(()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${o.rank}.`)),B(2===t.length,(()=>`Error in resizeBilinear: new shape must 2D, but got shape ${t}.`)),B(!1===n||!1===r,(()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."));let s=o,a=!1;3===o.rank&&(a=!0,s=Ha(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const[]=t,i={images:s},l={alignCorners:r,halfPixelCenters:n,size:t},u=uo.runKernel(hr,i,l);return a?Ha(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),md=wo({resizeNearestNeighbor_:function(e,t,r=!1,n=!1){const o=vo(e,"images","resizeNearestNeighbor");B(3===o.rank||4===o.rank,(()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${o.rank}.`)),B(2===t.length,(()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${t}.`)),B("float32"===o.dtype||"int32"===o.dtype,(()=>"`images` must have `int32` or `float32` as dtype")),B(!1===n||!1===r,(()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."));let s=o,a=!1;3===o.rank&&(a=!0,s=Ha(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const[]=t,i={images:s},l={alignCorners:r,halfPixelCenters:n,size:t},u=uo.runKernel(dr,i,l);return a?Ha(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),yd=wo({threshold_:function(e,t="binary",r=!1,n=.5){const o=vo(e,"image","threshold"),s=o.shape[0]*o.shape[1];let a,i,l,u,c=Za(sc([n]),255);if(B(3===o.rank,(()=>`Error in threshold: image must be rank 3,but got rank ${o.rank}.`)),B(3===o.shape[2]||1===o.shape[2],(()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${o.shape[2]}.`)),B("int32"===o.dtype||"float32"===o.dtype,(()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${o.dtype}.`)),B("otsu"===t||"binary"===t,(()=>`Method must be binary or otsu, but was ${t}`)),3===o.shape[2]){[a,i,l]=Zu(o,[1,1,1],-1);const e=Za(a,.2989),t=Za(i,.587),r=Za(l,.114);u=wa(wa(e,t),r)}else u=e;"otsu"===t&&(c=function(e,t){let r,n,o,s,a,i,l=sc([-1]),u=sc([0]),c=sc([0]);for(let d=0;d<e.size-1;d++){r=Ja(e,0,d+1),n=Ja(e,d+1),a=Mi(nl(r),t),i=Mi(nl(n),t);const h=nl(Za(r,Tu(0,r.size)));o=Mi(h,nl(r));const p=di(n.shape,r.size),f=wa(Tu(0,n.size),p),m=Za(n,f);s=Mi(nl(m),nl(n));const y=Al(o,s),g=Al(o,s),v=Za(a,i);c=Za(Za(v,y),g);const b=fl(c,u);u=Li(b,c,u),l=Li(b,sc([d]),l)}return l}(ii(Ss(Pu(u),"int32"),ko([]),256),s));const d=r?_l(u,c):fl(u,c);return Ss(Za(d,255),"int32")}}),gd=wo({transform_:function(e,t,r="nearest",n="constant",o=0,s){const a=vo(e,"image","transform","float32"),i=vo(t,"transforms","transform","float32");B(4===a.rank,(()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`)),B(2===i.rank&&(i.shape[0]===a.shape[0]||1===i.shape[0])&&8===i.shape[1],(()=>"Error in transform: Input transform should be batch x 8 or 1 x 8")),B(null==s||2===s.length,(()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`));const l={image:a,transforms:i},u={interpolation:r,fillMode:n,fillValue:o,outputShape:s};return uo.runKernel(zr,l,u)}}),vd=wo({bandPart_:function(e,t,r){B(t%1==0,(()=>`bandPart(): numLower must be an integer, got ${t}.`)),B(r%1==0,(()=>`bandPart(): numUpper must be an integer, got ${r}.`));const n=vo(e,"a","bandPart");B(n.rank>=2,(()=>`bandPart(): Rank must be at least 2, got ${n.rank}.`));const o=n.shape,[s,a]=n.shape.slice(-2);if(!(t<=s))throw new Error(`bandPart(): numLower (${t}) must not be greater than the number of rows (${s}).`);if(!(r<=a))throw new Error(`bandPart(): numUpper (${r}) must not be greater than the number of columns (${a}).`);t<0&&(t=s),r<0&&(r=a);const i=Ha(Tu(0,s,1,"int32"),[-1,1]),l=Tu(0,a,1,"int32"),u=Al(i,l),c=Ml(_l(u,el(+t,"int32")),ml(u,el(-r,"int32"))),d=Hl([s,a],n.dtype);return Ha(tc(fc(Ha(n,[-1,s,a])).map((e=>Li(c,e,d)))),o)}}),bd=wo({gramSchmidt_:function(e){let t;if(Array.isArray(e)){t=!1,B(null!=e&&e.length>0,(()=>"Gram-Schmidt process: input must not be null, undefined, or empty"));const r=e[0].shape[0];for(let t=1;t<e.length;++t)B(e[t].shape[0]===r,(()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${e[t].shape[0]} vs. ${r})`))}else t=!0,e=Zu(e,e.shape[0],0).map((e=>ec(e,[0])));B(e.length<=e[0].shape[0],(()=>`Gram-Schmidt: Number of vectors (${e.length}) exceeds number of dimensions (${e[0].shape[0]}).`));const r=[],n=e;for(let t=0;t<e.length;++t)r.push(uo.tidy((()=>{let e=n[t];if(t>0)for(let n=0;n<t;++n){const t=Za(nl(Za(r[n],e)),r[n]);e=Al(e,t)}return Mi(e,sl(e,"euclidean"))})));return t?tc(r,0):r}});function xd(e,t=!1){return uo.tidy((()=>{B(2===e.shape.length,(()=>`qr2d() requires a 2D Tensor, but got a ${e.shape.length}D Tensor.`));const r=e.shape[0],n=e.shape[1];let o=dl(r),s=ks(e);const a=ac([[1]],[1,1]);let i=ks(a);const l=r>=n?n:r;for(let e=0;e<l;++e){const t=s,l=i,u=o;[i,s,o]=uo.tidy((()=>{const t=Ja(s,[e,e],[r-e,1]),l=sl(t),u=Ja(s,[e,e],[1,1]),c=Li(fl(u,0),ac([[-1]]),ac([[1]])),d=Al(u,Za(c,l)),h=Mi(t,d);i=1===h.shape[0]?ks(a):Ya([a,Ja(h,[1,0],[h.shape[0]-1,h.shape[1]])],0);const p=Cl(Mi(Ka(c,d),l)),f=Ja(s,[e,0],[r-e,n]),m=Za(p,i),y=Tc(i);if(0===e)s=Al(f,Ka(m,Ka(y,f)));else{const t=Al(f,Ka(m,Ka(y,f)));s=Ya([Ja(s,[0,0],[e,n]),t],0)}const g=Tc(m),v=Ja(o,[0,e],[r,o.shape[1]-e]);if(0===e)o=Al(v,Ka(Ka(v,i),g));else{const t=Al(v,Ka(Ka(v,i),g));o=Ya([Ja(o,[0,0],[r,e]),t],1)}return[i,s,o]})),_c([t,l,u])}return!t&&r>n&&(o=Ja(o,[0,0],[r,n]),s=Ja(s,[0,0],[n,n])),[o,s]}))}const wd=wo({qr_:function(e,t=!1){if(B(e.rank>=2,(()=>`qr() requires input tensor to have a rank >= 2, but got rank ${e.rank}`)),2===e.rank)return xd(e,t);{const r=e.shape.slice(0,e.shape.length-2).reduce(((e,t)=>e*t)),n=fc(Ha(e,[r,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),o=[],s=[];return n.forEach((e=>{const[r,n]=xd(e,t);o.push(r),s.push(n)})),[Ha(tc(o,0),e.shape),Ha(tc(s,0),e.shape)]}}});var _d;!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(_d||(_d={}));const Sd=wo({computeWeightedLoss_:function(e,t,r=_d.SUM_BY_NONZERO_WEIGHTS){const n=vo(e,"losses","computeWeightedLoss");let o=null;null!=t&&(o=vo(t,"weights","computeWeightedLoss"));const s=null==o?n:Za(n,o);if(r===_d.NONE)return s;if(r===_d.SUM)return nl(s);if(r===_d.MEAN){if(null==o)return Wl(s);{const e=n.size/o.size,t=Mi(nl(s),nl(o));return e>1?Mi(t,el(e)):t}}if(r===_d.SUM_BY_NONZERO_WEIGHTS){if(null==o)return Mi(nl(s),el(n.size));{const e=Za(o,ql(n.shape)),t=Ss(nl(tu(e,el(0))),"float32");return Mi(nl(s),t)}}throw Error(`Unknown reduction: ${r}`)}}),kd=wo({absoluteDifference_:function(e,t,r,n=_d.SUM_BY_NONZERO_WEIGHTS){const o=vo(e,"labels","absoluteDifference"),s=vo(t,"predictions","absoluteDifference");let a=null;null!=r&&(a=vo(r,"weights","absoluteDifference")),U(o.shape,s.shape,"Error in absoluteDifference: ");const i=va(Al(o,s));return Sd(i,a,n)}}),Td=wo({cosineDistance_:function(e,t,r,n,o=_d.SUM_BY_NONZERO_WEIGHTS){const s=vo(e,"labels","cosineDistance"),a=vo(t,"predictions","cosineDistance");let i=null;null!=n&&(i=vo(n,"weights","cosineDistance")),U(s.shape,a.shape,"Error in cosineDistance: ");const l=el(1),u=Al(l,nl(Za(s,a),r,!0));return Sd(u,i,o)}}),Ed=wo({hingeLoss_:function(e,t,r,n=_d.SUM_BY_NONZERO_WEIGHTS){let o=vo(e,"labels","hingeLoss");const s=vo(t,"predictions","hingeLoss");let a=null;null!=r&&(a=vo(r,"weights","hingeLoss")),U(o.shape,s.shape,"Error in hingeLoss: ");const i=el(1);o=Al(Za(el(2),o),i);const l=Cu(Al(i,Za(o,s)));return Sd(l,a,n)}}),jd=wo({huberLoss_:function(e,t,r,n=1,o=_d.SUM_BY_NONZERO_WEIGHTS){const s=vo(e,"labels","huberLoss"),a=vo(t,"predictions","huberLoss");let i=null;null!=r&&(i=vo(r,"weights","huberLoss")),U(s.shape,a.shape,"Error in huberLoss: ");const l=el(n),u=va(Al(a,s)),c=Yl(u,l),d=Al(u,c),h=wa(Za(el(.5),rl(c)),Za(l,d));return Sd(h,i,o)}}),Cd=wo({logLoss_:function(e,t,r,n=1e-7,o=_d.SUM_BY_NONZERO_WEIGHTS){const s=vo(e,"labels","logLoss"),a=vo(t,"predictions","logLoss");let i=null;null!=r&&(i=vo(r,"weights","logLoss")),U(s.shape,a.shape,"Error in logLoss: ");const l=el(1),u=el(n),c=Cl(Za(s,Tl(wa(a,u)))),d=Za(Al(l,s),Tl(wa(Al(l,a),u))),h=Al(c,d);return Sd(h,i,o)}}),Id=wo({meanSquaredError_:function(e,t,r,n=_d.SUM_BY_NONZERO_WEIGHTS){const o=vo(e,"labels","meanSquaredError"),s=vo(t,"predictions","meanSquaredError");let a=null;null!=r&&(a=vo(r,"weights","meanSquaredError")),U(o.shape,s.shape,"Error in meanSquaredError: ");const i=Ju(o,s);return Sd(i,a,n)}}),Od=wo({sigmoidCrossEntropy_:function(e,t,r,n=0,o=_d.SUM_BY_NONZERO_WEIGHTS){let s=vo(e,"multiClassLabels","sigmoidCrossEntropy");const a=vo(t,"logits","sigmoidCrossEntropy");let i=null;if(null!=r&&(i=vo(r,"weights","sigmoidCrossEntropy")),U(s.shape,a.shape,"Error in sigmoidCrossEntropy: "),n>0){const e=el(n),t=el(1),r=el(.5);s=wa(Za(s,Al(t,e)),Za(r,e))}const l=function(e,t){const r=vo(e,"labels","sigmoidCrossEntropyWithLogits"),n=vo(t,"logits","sigmoidCrossEntropyWithLogits");U(r.shape,n.shape,"Error in sigmoidCrossEntropyWithLogits: ");const o=Cu(n),s=Za(n,r),a=El(il(Cl(va(n))));return wa(Al(o,s),a)}(s,a);return Sd(l,i,o)}}),Ad=wo({softmaxCrossEntropy_:function(e,t,r,n=0,o=_d.SUM_BY_NONZERO_WEIGHTS){let s=vo(e,"onehotLabels","softmaxCrossEntropy");const a=vo(t,"logits","softmaxCrossEntropy");let i=null;if(null!=r&&(i=vo(r,"weights","softmaxCrossEntropy")),U(s.shape,a.shape,"Error in softmaxCrossEntropy: "),n>0){const e=el(n),t=el(1),r=el(s.shape[1]);s=wa(Za(s,Al(t,e)),Mi(e,r))}const l=function(e,t,r=-1){if(-1===r&&(r=t.rank-1),r!==t.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${t.rank} and dim was ${r}`);const n=jl(((e,t,n)=>{const o=Nl(t,[r],!0),s=Al(Ss(t,"float32"),o);n([e,s]);const a=Cl(Za(s,e));return{value:nl(a,[r]),gradFunc:(e,t)=>{const[n,o]=t,s=Hi(e.shape,[r]);return[Za(Ha(e,s),Al(Ss(n,"float32"),il(o))),Za(Ha(e,s),Al(il(o),Ss(n,"float32")))]}}}));return n(e,t)}(s,a);return Sd(l,i,o)}}),Rd=wo({sparseFillEmptyRows_:function(e,t,r,n){const o=vo(e,"indices","sparseFillEmptyRows","int32"),s=vo(t,"values","sparseFillEmptyRows"),a=vo(r,"denseShape","sparseFillEmptyRows","int32"),i=vo(n,"defaultValue","sparseFillEmptyRows",s.dtype);if(2!==o.rank)throw new Error(`Indices should be Tensor2D but received shape\n        ${o.shape}`);if(1!==s.rank)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(1!==a.rank)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(0!==i.rank)throw new Error(`Default value should be a scalar but received shape ${i.shape}`);const l={indices:o,values:s,denseShape:a,defaultValue:i},u=uo.runKernel(Or,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}}),Nd=wo({sparseReshape_:function(e,t,r){const n=vo(e,"inputIndices","sparseReshape","int32"),o=vo(t,"inputShape","sparseReshape","int32"),s=vo(r,"newShape","sparseReshape","int32");if(2!==n.rank)throw new Error(`Input indices should be Tensor2D but received shape\n        ${n.shape}`);if(1!==o.rank)throw new Error(`Input shape should be Tensor1D but received shape ${o.shape}`);if(1!==s.rank)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const a={inputIndices:n,inputShape:o,newShape:s},i=uo.runKernel(Ar,a);return{outputIndices:i[0],outputShape:i[1]}}}),Md=wo({sparseSegmentMean_:function(e,t,r){const n=vo(e,"data","sparseSegmentMean"),o=vo(t,"indices","sparseSegmentMean","int32"),s=vo(r,"segmentIds","sparseSegmentMean","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.rank)throw new Error(`Indices should be Tensor1D but received shape\n          ${o.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n          ${s.shape}`);const a={data:n,indices:o,segmentIds:s};return uo.runKernel(Rr,a)}}),Pd=wo({sparseSegmentSum_:function(e,t,r){const n=vo(e,"data","sparseSegmentSum"),o=vo(t,"indices","sparseSegmentSum","int32"),s=vo(r,"segmentIds","sparseSegmentSum","int32");if(n.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.rank)throw new Error(`Indices should be Tensor1D but received shape\n         ${o.shape}`);if(1!==s.rank)throw new Error(`Segment ids should be Tensor1D but received shape\n         ${s.shape}`);const a={data:n,indices:o,segmentIds:s};return uo.runKernel(Nr,a)}}),Ld=wo({stringNGrams_:function(e,t,r,n,o,s,a,i){const l=vo(e,"data","stringNGrams","string");if("string"!==l.dtype)throw new Error("Data must be of datatype string");if(1!==l.shape.length)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=vo(t,"dataSplits","stringNGrams");if("int32"!==u.dtype)throw new Error("Data splits must be of datatype int32");const c={separator:r,nGramWidths:n,leftPad:o,rightPad:s,padWidth:a,preserveShortSequences:i},d={data:l,dataSplits:u},h=uo.runKernel(Dr,d,c);return{nGrams:h[0],nGramsSplits:h[1]}}}),Dd=wo({stringSplit_:function(e,t,r=!0){const n=vo(e,"input","stringSplit","string"),o=vo(t,"delimiter","stringSplit","string");if(1!==n.rank)throw new Error(`Input should be Tensor1D but received shape ${n.shape}`);if(0!==o.rank)throw new Error(`Delimiter should be a scalar but received shape ${o.shape}`);const s={skipEmpty:r},a={input:n,delimiter:o},i=uo.runKernel(Fr,a,s);return{indices:i[0],values:i[1],shape:i[2]}}}),Fd=wo({stringToHashBucketFast_:function(e,t){const r=vo(e,"input","stringToHashBucketFast","string"),n={numBuckets:t};if(t<=0)throw new Error("Number of buckets must be at least 1");const o={input:r};return uo.runKernel($r,o,n)}}),$d={fft:Xu,ifft:Yu,rfft:Qu,irfft:Ku},Bd={hammingWindow:qc,hannWindow:Xc,frame:Yc,stft:Kc},Ud={flipLeftRight:Qc,grayscaleToRGB:Jc,resizeNearestNeighbor:md,resizeBilinear:fd,rotateWithOffset:ed,cropAndResize:Zc,nonMaxSuppression:rd,nonMaxSuppressionAsync:async function(e,t,r,n=.5,o=Number.NEGATIVE_INFINITY){const s=vo(e,"boxes","nonMaxSuppressionAsync"),a=vo(t,"scores","nonMaxSuppressionAsync"),i=td(s,a,r,n,o);r=i.maxOutputSize,n=i.iouThreshold,o=i.scoreThreshold;const l=await Promise.all([s.data(),a.data()]),u=l[0],c=l[1],{selectedIndices:d}=sd(u,c,r,n,o);return s!==e&&s.dispose(),a!==t&&a.dispose(),sc(d,"int32")},nonMaxSuppressionWithScore:hd,nonMaxSuppressionWithScoreAsync:async function(e,t,r,n=.5,o=Number.NEGATIVE_INFINITY,s=0){const a=vo(e,"boxes","nonMaxSuppressionAsync"),i=vo(t,"scores","nonMaxSuppressionAsync"),l=td(a,i,r,n,o,s);r=l.maxOutputSize,n=l.iouThreshold,o=l.scoreThreshold,s=l.softNmsSigma;const u=await Promise.all([a.data(),i.data()]),c=u[0],d=u[1],{selectedIndices:h,selectedScores:p}=id(c,d,r,n,o,s);return a!==e&&a.dispose(),i!==t&&i.dispose(),{selectedIndices:sc(h,"int32"),selectedScores:sc(p)}},nonMaxSuppressionPadded:pd,nonMaxSuppressionPaddedAsync:async function(e,t,r,n=.5,o=Number.NEGATIVE_INFINITY,s=!1){const a=vo(e,"boxes","nonMaxSuppressionAsync"),i=vo(t,"scores","nonMaxSuppressionAsync"),l=td(a,i,r,n,o,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[h,p]=await Promise.all([a.data(),i.data()]),{selectedIndices:f,validOutputs:m}=ad(h,p,u,c,d,s);return a!==e&&a.dispose(),i!==t&&i.dispose(),{selectedIndices:sc(f,"int32"),validOutputs:el(m,"int32")}},threshold:yd,transform:gd},Vd={bandPart:vd,gramSchmidt:bd,qr:wd},Gd={absoluteDifference:kd,computeWeightedLoss:Sd,cosineDistance:Td,hingeLoss:Ed,huberLoss:jd,logLoss:Cd,meanSquaredError:Id,sigmoidCrossEntropy:Od,softmaxCrossEntropy:Ad},zd={sparseFillEmptyRows:Rd,sparseReshape:Nd,sparseSegmentMean:Md,sparseSegmentSum:Pd},Wd={stringNGrams:Ld,stringSplit:Dd,stringToHashBucketFast:Fd},Hd="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:e=>e();function qd(e,t){const r=e[0].length;e.forEach(((e,t)=>{B(e.length===r,(()=>`Error in concat${r}D: rank of tensors[${t}] must be the same as the rank of the rest (${r})`))})),B(t>=0&&t<r,(()=>`Error in concat${r}D: axis must be between 0 and ${r-1}.`));const n=e[0];e.forEach(((e,o)=>{for(let s=0;s<r;s++)B(s===t||e[s]===n[s],(()=>`Error in concat${r}D: Shape of tensors[${o}] (${e}) does not match the shape of the rest (${n}) along the non-concatenated axis ${o}.`))}))}function Xd(e,t){const r=e[0].slice();for(let n=1;n<e.length;n++)r[t]+=e[n][t];return r}var Yd;function Kd(e,t,r){let n=new Array;if(null==r&&null==t)return n;if(null==t)for(;n.length<e+r.length;)n.push(-1);else n=t.slice();if(null==r)return n;if(e+r.length!==n.length)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.rank = ${e+r.length}, but shape.rank = ${n.length}`);for(let o=1;o<r.length;++o){const s=r[o],a=n[n.length-r.length+o],i=n[a];if(s>=0)if(i>=0){if(i!==s)throw new Error(`rt input.shape and shape=${t} are incompatible: rt input.shape[${o+e}] = ${s} but shape[${o+e}] = ${i}`)}else n[a]=s}return n}function Zd(e){const t={FIRST_DIM_SIZE:Yd.FIRST_DIM_SIZE,VALUE_ROWIDS:Yd.VALUE_ROWIDS,ROW_LENGTHS:Yd.ROW_LENGTHS,ROW_SPLITS:Yd.ROW_SPLITS,ROW_LIMITS:Yd.ROW_LIMITS,ROW_STARTS:Yd.ROW_STARTS},r=[];for(const n of e){if(!(n in t))break;r.push(t[n])}return r}function Qd(e){return 0===e.length?0:e[0]===Yd.FIRST_DIM_SIZE?e.length-1:e.length}function Jd(e,t){if(null==e||null==t)return;const r=e.length,n=t.length;if(r>=n)throw new Error(`defaultValue.shape=${e} and ragged tensor flatValues.shape=${t}, are incompatible: defaultValue.rank = ${r} must be less than ragged tensor input flatValues.rank = ${n})`);for(let o=0;o<Math.min(r,n-1);++o){const r=e[o],n=t[o+1];if(r>=0&&n>=0&&1!==r&&r!==n)throw new Error(`defaultValue.shape=${e}, and ragged tensor input flatValues.shape=${t} are incompatible: defaultValue.shape[${o-e.length}] = ${r} but ragged tensor input.flatValues.shape[${o-e.length}] = ${n}`)}}!function(e){e[e.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",e[e.VALUE_ROWIDS=1]="VALUE_ROWIDS",e[e.ROW_LENGTHS=2]="ROW_LENGTHS",e[e.ROW_SPLITS=3]="ROW_SPLITS",e[e.ROW_LIMITS=4]="ROW_LIMITS",e[e.ROW_STARTS=5]="ROW_STARTS"}(Yd||(Yd={}));const eh=30;function th(e){return e<=eh?e:ae(e,Math.floor(Math.sqrt(e)))}function rh(e,t,r){return[r*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}function nh(e,t,r,n=!0){let o=[];if(n)o=o.concat(t.slice(0)),o.push(e[0]/r),o=o.concat(e.slice(1));else{o=o.concat(e[0]);const r=t.length;for(let n=0;n<r;++n)o=o.concat([e[n+1]/t[n],t[n]]);o=o.concat(e.slice(r+1))}return o}function oh(e,t,r=!0){const n=[];if(r){n.push(t);for(let r=t+1;r<e;++r)r<=2*t?(n.push(r),n.push(r-(t+1))):n.push(r)}else{const r=[],o=[];for(let n=1;n<e;++n)n>=2*t+1||n%2==1?o.push(n):r.push(n);n.push(...r),n.push(0),n.push(...o)}return n}function sh(e,t,r,n=!0){const o=[];n?o.push(e[0]/r):o.push(e[0]*r);for(let r=1;r<e.length;++r)r<=t.length?n?o.push(t[r-1]*e[r]):o.push(e[r]/t[r-1]):o.push(e[r]);return o}function ah(e,t){const r=[0];for(let n=0;n<t;++n)r.push(e[n][0]);return r}function ih(e,t,r){const n=e.slice(0,1);for(let o=0;o<r;++o)n.push(e[o+1]-t[o][0]-t[o][1]);return n}function lh(e,t){const r=e.shape.length,n=t.shape.length;if(r<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${r}.`);if(n<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${n}.`);if("int32"!==t.dtype)throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.shape[n-1]>r)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${t.shape[n-1]} vs. ${r}`);if(0===z(e.shape))throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${e.shape}.`);const o=t.shape,s=o[o.length-1];let a=1;for(let e=0;e<o.length-1;++e)a*=o[e];const i=e.shape,l=o.slice();l.pop();let u=1;for(let e=s;e<r;++e)u*=i[e],l.push(i[e]);const c=[...ie(e.shape).map((e=>e/u)),1].slice(0,s);return[l,a,u,c]}const uh=1.7580993408473768,ch=1.0507009873554805,dh=.3275911,hh=.254829592,ph=-.284496736,fh=1.421413741,mh=-1.453152027,yh=1.061405429;function gh(e,t){if(e.length!==t.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${e.length}, imag: ${t.length}.`);const r=new Float32Array(2*e.length);for(let n=0;n<r.length;n+=2)r[n]=e[n/2],r[n+1]=t[n/2];return r}function vh(e){const t=new Float32Array(e.length/2),r=new Float32Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=e[n],r[n/2]=e[n+1];return{real:t,imag:r}}function bh(e){const t=Math.ceil(e.length/4),r=new Float32Array(t),n=new Float32Array(t);for(let t=0;t<e.length;t+=4)r[Math.floor(t/4)]=e[t],n[Math.floor(t/4)]=e[t+1];return{real:r,imag:n}}function xh(e){const t=Math.floor(e.length/4),r=new Float32Array(t),n=new Float32Array(t);for(let t=2;t<e.length;t+=4)r[Math.floor(t/4)]=e[t],n[Math.floor(t/4)]=e[t+1];return{real:r,imag:n}}function wh(e,t){return{real:e[2*t],imag:e[2*t+1]}}function _h(e,t,r,n){e[2*n]=t,e[2*n+1]=r}function Sh(e,t){const r=new Float32Array(e/2),n=new Float32Array(e/2);for(let o=0;o<Math.ceil(e/2);o++){const s=(t?2:-2)*Math.PI*(o/e);r[o]=Math.cos(s),n[o]=Math.sin(s)}return{real:r,imag:n}}function kh(e,t,r){const n=(r?2:-2)*Math.PI*(e/t);return{real:Math.cos(n),imag:Math.sin(n)}}const Th="->",Eh=/->/g,jh=",",Ch="...";function Ih(e,t){const r=((e=e.replace(/\s/g,"")).length-e.replace(Eh,"").length)/Th.length;if(r<1)throw new Error("Equations without an arrow are not supported.");if(r>1)throw new Error(`Equation must contain exactly one arrow ("${Th}").`);const[n,o]=e.split(Th);B(-1===n.indexOf(Ch),(()=>`The ellipsis notation ("${Ch}") is not supported yet.`));const s=n.split(jh),a=s.length;if(t!==a)throw new Error(`Expected ${a} input tensors, received ${t}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const i=[];for(let e=0;e<o.length;++e){const t=o[e];if(!s.some((e=>-1!==e.indexOf(t))))throw new Error(`Output subscripts contain the label ${t} not present in the input subscripts.`);-1===i.indexOf(t)&&i.push(t)}for(let e=0;e<n.length;++e){const t=n[e];-1===i.indexOf(t)&&t!==jh&&i.push(t)}const l=new Array(s.length);for(let e=0;e<a;++e){if(new Set(s[e].split("")).size!==s[e].length)throw new Error(`Found duplicate axes in input component ${s[e]}. Support for duplicate axes in input is not implemented yet.`);l[e]=[];for(let t=0;t<s[e].length;++t)l[e].push(i.indexOf(s[e][t]))}const u=i.length,c=[];for(let e=o.length;e<u;++e)c.push(e);return{allDims:i,summedDims:c,idDims:l}}function Oh(e,t){let r=new Array(e);r.fill(-1);for(let e=0;e<t.length;++e)r[t[e]]=e;const n=[];for(let t=0;t<e;++t)-1===r[t]&&n.push(t);return r=r.filter((e=>-1!==e)),{permutationIndices:r,expandDims:n}}function Ah(e,t,r){const n=new Array(e);for(let e=0;e<r.length;++e){const o=r[e].shape;for(let r=0;r<t[e].length;++r)void 0===n[t[e][r]]?n[t[e][r]]=o[r]:B(n[t[e][r]]===o[r],(()=>`Expected dimension ${n[t[e][r]]} at axis ${r} of input shaped ${JSON.stringify(o)}, but got dimension ${o[r]}`))}}function Rh(e,t){const r=e,n=[];let o=0;0===e.length&&r.push(-1),o=e.length+1;for(let e=0;e<o;++e)n.push([]);const s=[];for(let e=0;e<r.length;++e){const o=Mh(t,r[e]);for(const t of o)-1===s.indexOf(t)&&(n[e].push(t),s.push(t))}return{path:r,steps:n}}function Nh(e){return e.every(((e,t)=>e===t))}function Mh(e,t){const r=[];for(let n=0;n<e.length;++n)0!==e[n].length&&-1===e[n].indexOf(t)&&-1!==t||r.push(n);return r}function Ph(e,t,r=0){let n=[];if("number"==typeof t)B(e.shape[r]%t==0,(()=>"Number of splits must evenly divide the axis.")),n=new Array(t).fill(e.shape[r]/t);else{B(t.reduce(((e,t)=>(-1===t&&(e+=1),e)),0)<=1,(()=>"There should be only one negative value in split array."));const o=t.indexOf(-1);if(-1!==o){const n=t.reduce(((e,t)=>t>0?e+t:e));t[o]=e.shape[r]-n}B(e.shape[r]===t.reduce(((e,t)=>e+t)),(()=>"The sum of sizes must match the size of the axis dimension.")),n=t}return n}function Lh(e){return`Received SparseTensor with denseShape[0] = 0 but\n  indices.shape[0] = ${e}`}function Dh(e,t){return`indices(${e}, 0) is invalid: ${t} < 0`}function Fh(e,t,r){return`indices(${e}, 0) is invalid: ${t} >= ${r}`}function $h(e,t){return`only one output dimension may be -1, not both ${e} and ${t}`}function Bh(e,t){return`size ${e} must be non-negative, not ${t}`}function Uh(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Vh(e,t){return`Input to reshape is a SparseTensor with ${z(e)}\n  dense values, but the requested shape requires a multiple of ${z(t)}. inputShape=${e} outputShape= ${t}`}function Gh(e,t){return`Input to reshape is a tensor with ${z(e)} dense values, but the requested shape has ${z(t)}. inputShape=${e} outputShape=${t}`}function zh(){return"segment ids must be >= 0"}function Wh(){return"segment ids are not increasing"}function Hh(e,t){return`Segment id ${e} out of range [0, ${t}), possibly because segmentIds input is not sorted.`}function qh(e,t,r){return`Bad: indices[${e}] == ${t} out of range [0, ${r})`}function Xh(e,t){let r,n=!1;for(e<=eh?(r=e,n=!0):r=ae(e,Math.floor(Math.sqrt(e)));!n;)r>t||r===e?n=!0:r=ae(e,r+1);return r}function Yh(e,t,r){const n=[],o=e.length;for(let s=0;s<o;s++)s!==t?n.push(e[s]):n.push(r);return n}function Kh(e,t,r,n){const o=t.shape.length,s=e.shape.length;if(0!==n&&(n<-o||n>o))throw new Error(`Expect batchDims in the range of [-${o}, ${o}], but got ${n}`);if(n<0&&(n+=o),n>s)throw new Error(`batchDims (${n}) must be less than rank(x) (\n    ${s}).`);if(r<n)throw new Error(`batchDims (${n}) must be less than or equal to axis (${r}).`);for(let r=0;r<n;++r)if(e.shape[r]!==t.shape[r])throw new Error(`x.shape[${r}]: ${e.shape[r]} should be equal to indices.shape[${r}]: ${t.shape[r]}.`);const a=e.shape[r],i=[];let l=1,u=1,c=1;for(let t=0;t<n;++t)i.push(e.shape[t]),l*=e.shape[t];for(let t=n;t<r;t++)i.push(e.shape[t]),u*=e.shape[t];for(let e=n;e<o;e++)i.push(t.shape[e]);for(let t=r+1;t<s;t++)i.push(e.shape[t]),c*=e.shape[t];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:a,outputShape:i}}function Zh(e){try{return e.map((e=>On(e)))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Qh(e){return e.map((e=>In(e)))}var Jh,ep;be().registerFlag("KEEP_INTERMEDIATE_TENSORS",(()=>!1),(e=>{e&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_QINT16=15]="DT_QINT16",e[e.DT_QUINT16=16]="DT_QUINT16",e[e.DT_UINT16=17]="DT_UINT16",e[e.DT_COMPLEX128=18]="DT_COMPLEX128",e[e.DT_HALF=19]="DT_HALF",e[e.DT_RESOURCE=20]="DT_RESOURCE",e[e.DT_VARIANT=21]="DT_VARIANT",e[e.DT_UINT32=22]="DT_UINT32",e[e.DT_UINT64=23]="DT_UINT64",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",e[e.DT_QINT16_REF=115]="DT_QINT16_REF",e[e.DT_QUINT16_REF=116]="DT_QUINT16_REF",e[e.DT_UINT16_REF=117]="DT_UINT16_REF",e[e.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",e[e.DT_HALF_REF=119]="DT_HALF_REF",e[e.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",e[e.DT_VARIANT_REF=121]="DT_VARIANT_REF",e[e.DT_UINT32_REF=122]="DT_UINT32_REF",e[e.DT_UINT64_REF=123]="DT_UINT64_REF"}(Jh||(Jh={})),function(e){let t;!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(ep||(ep={}));const tp={};function rp(e){return tp[e]}function np(e,t,r,n,o){const s=t.inputParams[e];if(s&&void 0!==s.inputIndexStart){const e=s.inputIndexStart,a=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?e+1:s.inputIndexEnd;if("tensor"===s.type)return op(t.inputNames[s.inputIndexStart],r,n,o);if("tensors"===s.type)return t.inputNames.slice(e,a).map((e=>op(e,r,n,o)));const i=op(t.inputNames.slice(e)[0],r,n,o),l=i.dataSync();return"number"===s.type?l[0]:ue(i.shape,l)}const a=t.attrParams[e];return a&&a.value}function op(e,t,r,n){const[o,s]=ip(e);if(null!=n){const e=n.getHashTableHandleByName(o);if(null!=e)return e}const a=r.currentContextIds.find((e=>!!t[ap(o,e)]));return void 0!==a?t[ap(o,a)][s]:void 0}function sp(e,t){const[r,n,o]=ip(e);return[ap(r,t&&t.currentContextId),n,o]}function ap(e,t){return t?`${e}-${t}`:e}function ip(e){const t=e.split(":");if(1===t.length)return[e,0,void 0];const r=t[0],n=3===t.length?t[1]:void 0;return[r,Number(t[t.length-1]),n]}function lp(e,t,r){let n=np("pad",e,t,r);if("explicit"===n){n=np("explicitPaddings",e,t,r);const o=[[0,0],[0,0],[0,0],[0,0]];for(let e=0;e<4;e++)o[e][0]=n[2*e],o[e][1]=n[2*e+1];return o}return n}function up(e){return e.kept?e:ks(e)}const cp=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],dp=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],hp=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],pp=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],fp=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],mp=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],yp=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],gp=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],vp=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],bp=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],xp=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],wp=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],_p=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],Sp=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],kp=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Tp=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Ep=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],jp=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Cp=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}];class Ip{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[].concat(...[i,l,u,c,d,h,p,f,m,y,g,v,b,x,w,_,S,k,T].map((e=>e.json)));this.opMappers=e.reduce(((e,t)=>(e[t.tfOpName]=t,e)),{})}transformGraph(e,t={}){const r=e.node,n=[],o=[],s=[],a=r.reduce(((e,t)=>(e[t.name]=this.mapNode(t),t.op.startsWith("Placeholder")?n.push(e[t.name]):"Const"===t.op?o.push(e[t.name]):null!=t.input&&0!==t.input.length||s.push(e[t.name]),e)),{});let i=[];const l=[];let u={},c={};null!=t&&(u=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));const d=Object.keys(a);d.forEach((e=>{const t=a[e];t.inputNames.forEach(((e,r)=>{const[n,,o]=sp(e),s=a[n];if(null!=s.outputs){const e=s.outputs.indexOf(o);if(-1!==e){const o=`${n}:${e}`;t.inputNames[r]=o}}t.inputs.push(s),s.children.push(t)}))})),0===Object.keys(c).length?d.forEach((e=>{const t=a[e];0===t.children.length&&l.push(t)})):Object.keys(c).forEach((e=>{const[t]=sp(e),r=a[t];null!=r&&(r.signatureKey=c[e],l.push(r))})),Object.keys(u).length>0?Object.keys(u).forEach((e=>{const[t]=sp(e),r=a[t];r&&(r.signatureKey=u[e],i.push(r))})):i=n;let h={};null!=e.library&&null!=e.library.function&&(h=e.library.function.reduce(((e,t)=>(e[t.signature.name]=this.mapFunction(t),e)),{}));const p={nodes:a,inputs:i,outputs:l,weights:o,placeholders:n,signature:t,functions:h};return s.length>0&&(p.initNodes=s),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce(((t,r)=>(t[e[r].name]=r,t)),{})}mapNode(e){const t=rp(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});const r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((e=>e.startsWith("^")?e.slice(1):e)),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return null!=t.inputs&&(r.inputParams=t.inputs.reduce(((e,t)=>(e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e)),{})),null!=t.attrs&&(r.attrParams=t.attrs.reduce(((t,r)=>{const n=r.type;let o;switch(r.type){case"string":o=Ap(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Ap(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"string[]":o=Up(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Up(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number":o=Np(e.attr,r.tfName,r.defaultValue||0),void 0===o&&r.tfDeprecatedName&&(o=Np(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"number[]":o=Bp(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Bp(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool":o=Rp(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Rp(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"bool[]":o=Gp(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Gp(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape":o=$p(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=$p(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"shape[]":o=Vp(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Vp(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype":o=Lp(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Lp(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"dtype[]":o=Dp(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Dp(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"func":o=Pp(e.attr,r.tfName,r.defaultValue),void 0===o&&r.tfDeprecatedName&&(o=Pp(e.attr,r.tfDeprecatedName,r.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${r.type} for op: ${e.op}`)}return t[r.name]={value:o,type:n},t}),{})),r}mapFunction(e){const t=e.nodeDef,r=[];let n={};null!=t&&(n=t.reduce(((e,t)=>(e[t.name]=this.mapNode(t),"Const"===t.op&&r.push(e[t.name]),e)),{}));const o=[],s=[];e.signature.inputArg.forEach((e=>{const[t]=sp(e.name),r={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Mp(e.type),type:"dtype"}},children:[]};r.signatureKey=e.name,o.push(r),n[t]=r})),Object.keys(n).forEach((e=>{const t=n[e];t.inputNames.forEach(((e,r)=>{const[o,,s]=sp(e),a=n[o];if(null!=a.outputs){const e=a.outputs.indexOf(s);if(-1!==e){const n=`${o}:${e}`;t.inputNames[r]=n}}t.inputs.push(a),a.children.push(t)}))}));const a=e.ret;e.signature.outputArg.forEach((e=>{const[t,r]=sp(a[e.name]),o=n[t];null!=o&&(o.defaultOutput=r,s.push(o))}));const i=this.mapArgsToSignature(e);return{nodes:n,inputs:o,outputs:s,weights:r,placeholders:[],signature:i}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce(((e,t)=>(e[t.name]=this.mapArgToTensorInfo(t),e)),{}),outputs:e.signature.outputArg.reduce(((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r,e.ret),t)),{})}}mapArgToTensorInfo(e,t){let r=e.name;return null!=t&&(r=t[r]),{name:r,dtype:e.type}}}function Op(e,t){const r=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){const t=be().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?r:r.toLowerCase()}function Ap(e,t,r,n=!1){const o=e[t];return null!=o?Op(o.s,n):r}function Rp(e,t,r){const n=e[t];return n?n.b:r}function Np(e,t,r){const n=e[t]||{},o=null!=n.i?n.i:null!=n.f?n.f:r;return"number"==typeof o?o:parseInt(o,10)}function Mp(e){switch("string"==typeof e&&(e=Jh[e]),e){case Jh.DT_FLOAT:case Jh.DT_HALF:return"float32";case Jh.DT_INT32:case Jh.DT_INT64:case Jh.DT_INT8:case Jh.DT_UINT8:return"int32";case Jh.DT_BOOL:return"bool";case Jh.DT_DOUBLE:return"float32";case Jh.DT_STRING:return"string";default:return null}}function Pp(e,t,r){const n=e[t];return n&&n.func?n.func.name:r}function Lp(e,t,r){const n=e[t];return n&&n.type?Mp(n.type):r}function Dp(e,t,r){const n=e[t];return n&&n.list&&n.list.type?n.list.type.map((e=>Mp(e))):r}function Fp(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((e=>"number"==typeof e.size?e.size:parseInt(e.size,10))):[]}function $p(e,t,r){const n=e[t];return n&&n.shape?Fp(n.shape):r}function Bp(e,t,r){const n=e[t];return n?((n.list.f&&n.list.f.length?n.list.f:n.list.i)||[]).map((e=>"number"==typeof e?e:parseInt(e,10))):r}function Up(e,t,r,n=!1){const o=e[t];return o&&o.list&&o.list.s?o.list.s.map((e=>Op(e,n))):r}function Vp(e,t,r){const n=e[t];return n&&n.list&&n.list.shape?n.list.shape.map((e=>Fp(e))):r}function Gp(e,t,r){const n=e[t];return n&&n.list&&n.list.b?n.list.b:r}class zp{constructor(e,t,r){this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((e=>this.getInput(e))),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce(((e,t)=>(e[t]=this.getAttr(t),e)),{}))}getInput(e){return op(e,this.tensorMap,this.context)}getAttr(e,t){const r=this.node.rawAttrs[e];if(null!=r.tensor)return op(e,this.tensorMap,this.context);if(null!=r.i||null!=r.f)return Np(this.node.rawAttrs,e,t);if(null!=r.s)return Ap(this.node.rawAttrs,e,t);if(null!=r.b)return Rp(this.node.rawAttrs,e,t);if(null!=r.shape)return $p(this.node.rawAttrs,e,t);if(null!=r.type)return Lp(this.node.rawAttrs,e,t);if(null!=r.list){if(null!=r.list.i||null!=r.list.f)return Bp(this.node.rawAttrs,e,t);if(null!=r.list.s)return Up(this.node.rawAttrs,e,t);if(null!=r.list.shape)return Vp(this.node.rawAttrs,e,t);if(null!=r.list.b)return Gp(this.node.rawAttrs,e,t);if(null!=r.list.type)return Dp(this.node.rawAttrs,e,t)}return t}}function Wp(e,t,r=""){if("number"!=typeof e&&"number"!=typeof t){B(e.length===t.length,(()=>r+` Shapes ${e} and ${t} must match`));for(let n=0;n<e.length;n++){const o=e[n],s=t[n];B(o<0||s<0||o===s,(()=>r+` Shapes ${e} and ${t} must match`))}}}function Hp(e){return"number"!=typeof e&&!e.some((e=>e<0))}function qp(e,t,r){let n=Xp(e,r);const o=!Hp(n);if(o&&0===t.length)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${n}`);if(o&&t.forEach((e=>{n=Xp(e.shape,n)})),!Hp(n))throw new Error(`Non-fully-defined elementShape: ${n}`);return n}function Xp(e,t){if("number"==typeof e)return t;if("number"==typeof t)return e;if(e.length!==t.length)throw new Error(`Incompatible ranks during merge: ${e} vs. ${t}`);const r=[];for(let n=0;n<e.length;++n){const o=e[n],s=t[n];if(o>=0&&s>=0&&o!==s)throw new Error(`Incompatible shape during merge: ${e} vs. ${t}`);r[n]=o>=0?o:s}return r}class Yp{constructor(e,t,r,n,o,s,a){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=n,this.identicalElementShapes=o,this.dynamicSize=s,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=el(0),Sc(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map((e=>this.read(e)))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},\n          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),Wp(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=t,Sc(t),r.written=!0,this.tensors[e]=r}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach(((e,r)=>this.write(e,t[r])))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let t=0;t<this.size();t++)e.push(t)}if(0===e.length)return ko([],[0].concat(this.elementShape));const r=this.readMany(e);return Wp(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),tc(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(0===this.size())return ko([],[0].concat(this.elementShape));const t=[];for(let e=0;e<this.size();e++)t.push(e);const r=this.readMany(t);return Wp(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Ya(r,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,fc(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let r=0;const n=e.map((e=>(r+=e,r)));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${r}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=0===r?0:t.size/r,s=[];wc((()=>{t=Ha(t,[1,r,o]);for(let r=0;r<e.length;++r){const a=[0,0===r?0:n[r-1],0],i=[1,e[r],o];s[r]=Ha(Ja(t,a,i),this.elementShape)}return s}));const a=[];for(let t=0;t<e.length;t++)a[t]=t;this.writeMany(a,s)}}class Kp{constructor(e,t,r,n=-1){this.tensors=e,this.elementShape=t,this.elementDtype=r,null!=e&&e.forEach((e=>{if(r!==e.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${e.dtype}`);Wp(t,e.shape,"TensorList shape mismatch: "),Sc(e)})),this.idTensor=el(0),this.maxNumElements=n,Sc(this.idTensor)}get id(){return this.idTensor.id}copy(){return new Kp([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach((t=>{null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,r=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(-1!==r&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);Wp(e,this.elementShape,"TensorList shape mismatch: ");const n=qp(this.elementShape,this.tensors,e);return wc((()=>{const e=this.tensors.map((e=>Ha(e,n)));return tc(e,0)}))}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(0===this.size())throw new Error("Trying to pop from an empty list.");const r=qp(this.elementShape,this.tensors,e),n=this.tensors.pop();return n.kept=!1,Wp(n.shape,e,"TensorList shape mismatch: "),Ha(n,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Wp(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Sc(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Kp([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)t.tensors[r]=this.tensors[r];return t}getItem(e,t,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(null==this.tensors[e])throw new Error(`element at index ${e} is null.`);Wp(this.tensors[e].shape,t,"TensorList shape mismatch: ");const n=qp(this.elementShape,this.tensors,t);return Ha(this.tensors[e],n)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Wp(this.elementShape,t.shape,"TensorList shape mismatch: "),Sc(t),null!=this.tensors[e]&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,r){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Wp(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const n=qp(this.elementShape,this.tensors,r);return 0===e.length?ko([],[0].concat(n)):wc((()=>{const t=e.map((e=>Ha(this.tensors[e],n)));return tc(t,0)}))}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Wp(this.elementShape,t,"TensorList shape mismatch: ");const r=qp(this.elementShape,this.tensors,t);return 0===this.size()?ko([],[0].concat(r)):wc((()=>{const e=this.tensors.map((e=>Ha(e,r)));return Ya(e,0)}))}}function Zp(e,t,r){const[n,o]=np("fusedOps",e,t,r),s="biasadd"===n,a=!s,i="prelu"===o,l="fusedbatchnorm"===n,u=np("numArgs",e,t,r);if(s){if(i&&2!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&s&&1!==u)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=np("strides",e,t,r),d=lp(e,t,r),h=np("dataFormat",e,t,r).toUpperCase(),p=np("dilations",e,t,r);let[f,m]=np("args",e,t,r);return a&&(m=f,f=void 0),{stride:c,pad:d,dataFormat:h,dilations:p,biasArg:f,preluArg:m,activationFunc:o,leakyreluAlpha:np("leakyreluAlpha",e,t,r)}}function Qp(e,t,r){return{boxes:np("boxes",e,t,r),scores:np("scores",e,t,r),maxOutputSize:np("maxOutputSize",e,t,r),iouThreshold:np("iouThreshold",e,t,r),scoreThreshold:np("scoreThreshold",e,t,r),softNmsSigma:np("softNmsSigma",e,t,r)}}class Jp{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=el(0),this.tensorMap=new Map,Sc(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return el(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return this.tensorMap.forEach((e=>e.dispose())),this.tensorMap.clear(),wc((()=>{const e=fc(t),n=r.length,o=e.length;B(n===o,(()=>`The number of elements doesn't match, keys has ${n} elements, the values has ${o} elements.`));for(let t=0;t<n;t++){const n=r[t],o=e[t];Sc(o),this.tensorMap.set(n,o)}return this.handle}))}async find(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return wc((()=>{const e=[];for(let n=0;n<r.length;n++){const o=r[n],s=this.findWithDefault(o,t);e.push(s)}return tc(e)}))}findWithDefault(e,t){const r=this.tensorMap.get(e);return null!=r?r:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}function ef(e,t,r,n,o=wc){const s=((e,t,r)=>{switch(e.category){case"arithmetic":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[n.add(np("a",e,t,r),np("b",e,t,r))];case"AddN":return[n.addN(np("tensors",e,t,r))];case"FloorMod":case"Mod":return[n.mod(np("a",e,t,r),np("b",e,t,r))];case"Mul":return[n.mul(np("a",e,t,r),np("b",e,t,r))];case"RealDiv":case"Div":return[n.div(np("a",e,t,r),np("b",e,t,r))];case"DivNoNan":return[n.divNoNan(np("a",e,t,r),np("b",e,t,r))];case"FloorDiv":return[n.floorDiv(np("a",e,t,r),np("b",e,t,r))];case"Sub":return[n.sub(np("a",e,t,r),np("b",e,t,r))];case"Minimum":return[n.minimum(np("a",e,t,r),np("b",e,t,r))];case"Maximum":return[n.maximum(np("a",e,t,r),np("b",e,t,r))];case"Pow":return[n.pow(np("a",e,t,r),np("b",e,t,r))];case"SquaredDifference":return[n.squaredDifference(np("a",e,t,r),np("b",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"basic_math":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"Abs":case"ComplexAbs":return[n.abs(np("x",e,t,r))];case"Acos":return[n.acos(np("x",e,t,r))];case"Acosh":return[n.acosh(np("x",e,t,r))];case"Asin":return[n.asin(np("x",e,t,r))];case"Asinh":return[n.asinh(np("x",e,t,r))];case"Atan":return[n.atan(np("x",e,t,r))];case"Atan2":return[n.atan2(np("x",e,t,r),np("y",e,t,r))];case"Atanh":return[n.atanh(np("x",e,t,r))];case"Ceil":return[n.ceil(np("x",e,t,r))];case"Complex":return[n.complex(np("real",e,t,r),np("imag",e,t,r))];case"Cos":return[n.cos(np("x",e,t,r))];case"Cosh":return[n.cosh(np("x",e,t,r))];case"Elu":return[n.elu(np("x",e,t,r))];case"Erf":return[n.erf(np("x",e,t,r))];case"Exp":return[n.exp(np("x",e,t,r))];case"Expm1":return[n.expm1(np("x",e,t,r))];case"Floor":return[n.floor(np("x",e,t,r))];case"Log":return[n.log(np("x",e,t,r))];case"Log1p":return[n.log1p(np("x",e,t,r))];case"Imag":return[n.imag(np("x",e,t,r))];case"Neg":return[n.neg(np("x",e,t,r))];case"Reciprocal":return[n.reciprocal(np("x",e,t,r))];case"Real":return[n.real(np("x",e,t,r))];case"Relu":return[n.relu(np("x",e,t,r))];case"Round":return[n.round(np("x",e,t,r))];case"Selu":return[n.selu(np("x",e,t,r))];case"Sigmoid":return[n.sigmoid(np("x",e,t,r))];case"Sin":return[n.sin(np("x",e,t,r))];case"Sign":return[n.sign(np("x",e,t,r))];case"Sinh":return[n.sinh(np("x",e,t,r))];case"Softplus":return[n.softplus(np("x",e,t,r))];case"Sqrt":return[n.sqrt(np("x",e,t,r))];case"Square":return[n.square(np("x",e,t,r))];case"Tanh":return[n.tanh(np("x",e,t,r))];case"Tan":return[n.tan(np("x",e,t,r))];case"ClipByValue":return[n.clipByValue(np("x",e,t,r),np("clipValueMin",e,t,r),np("clipValueMax",e,t,r))];case"Relu6":return[n.relu6(np("x",e,t,r))];case"Rsqrt":return[n.rsqrt(op(e.inputNames[0],t,r))];case"Prod":return[n.prod(np("x",e,t,r),np("axes",e,t,r))];case"LeakyRelu":return[n.leakyRelu(np("x",e,t,r),np("alpha",e,t,r))];case"Prelu":return[n.prelu(np("x",e,t,r),np("alpha",e,t,r))];case"IsNan":return[n.isNaN(op(e.inputNames[0],t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"control":return(async(e,t,r)=>{switch(e.op){case"If":case"StatelessIf":{const n=np("thenBranch",e,t,r),o=np("elseBranch",e,t,r),s=np("cond",e,t,r),a=np("args",e,t,r);return(await s.data())[0]?r.functionMap[n].executeFunctionAsync(a,r.tensorArrayMap,r.tensorListMap):r.functionMap[o].executeFunctionAsync(a,r.tensorArrayMap,r.tensorListMap)}case"While":case"StatelessWhile":{const n=np("body",e,t,r),o=np("cond",e,t,r),s=np("args",e,t,r),a=await r.functionMap[o].executeFunctionAsync(s,r.tensorArrayMap,r.tensorListMap),i=s.map((e=>e.id));let l=await a[0].data();a.forEach((e=>{e.kept||-1!==i.indexOf(e.id)||e.dispose()}));let u=s;for(;l[0];){const e=u;u=await r.functionMap[n].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap);const t=u.map((e=>e.id));e.forEach((e=>{e.kept||-1!==i.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}));const s=await r.functionMap[o].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap);l=await s[0].data(),s.forEach((e=>{e.kept||-1!==i.indexOf(e.id)||-1!==t.indexOf(e.id)||e.dispose()}))}return u}case"LoopCond":return[up(np("pred",e,t,r))];case"Switch":{const n=np("pred",e,t,r);let o=np("data",e,t,r);return o.kept||(o=up(o)),(await n.data())[0]?[void 0,o]:[o,void 0]}case"Merge":{const n=e.inputNames.find((e=>void 0!==op(e,t,r)));return n?[up(op(n,t,r))]:void 0}case"Enter":{const n=np("frameName",e,t,r),o=np("tensor",e,t,r);return r.enterFrame(n),[up(o)]}case"Exit":{const n=np("tensor",e,t,r);return r.exitFrame(),[up(n)]}case"NextIteration":{const n=np("tensor",e,t,r);return r.nextIteration(),[up(n)]}case"TensorArrayV3":{const n=np("size",e,t,r),o=np("dtype",e,t,r),s=np("elementShape",e,t,r),a=np("dynamicSize",e,t,r),i=np("clearAfterRead",e,t,r),l=np("identicalElementShapes",e,t,r),u=np("name",e,t,r),c=new Yp(u,o,n,s,l,a,i);return r.addTensorArray(c),[c.idTensor,el(1)]}case"TensorArrayWriteV3":{const n=np("tensorArrayId",e,t,r),o=np("index",e,t,r),s=np("tensor",e,t,r),a=r.getTensorArray(n.id);return a.write(o,s),[a.idTensor]}case"TensorArrayReadV3":{const n=np("tensorArrayId",e,t,r),o=np("index",e,t,r);return[r.getTensorArray(n.id).read(o)]}case"TensorArrayGatherV3":{const n=np("tensorArrayId",e,t,r),o=np("indices",e,t,r),s=np("dtype",e,t,r);return[r.getTensorArray(n.id).gather(o,s)]}case"TensorArrayScatterV3":{const n=np("tensorArrayId",e,t,r),o=np("indices",e,t,r),s=np("tensor",e,t,r),a=r.getTensorArray(n.id);return a.scatter(o,s),[a.idTensor]}case"TensorArrayConcatV3":{const n=np("tensorArrayId",e,t,r),o=r.getTensorArray(n.id),s=np("dtype",e,t,r);return[o.concat(s)]}case"TensorArraySplitV3":{const n=np("tensorArrayId",e,t,r),o=np("tensor",e,t,r),s=np("lengths",e,t,r),a=r.getTensorArray(n.id);return a.split(s,o),[a.idTensor]}case"TensorArraySizeV3":{const n=np("tensorArrayId",e,t,r);return[el(r.getTensorArray(n.id).size(),"int32")]}case"TensorArrayCloseV3":{const n=np("tensorArrayId",e,t,r),o=r.getTensorArray(n.id);return o.clearAndClose(),[o.idTensor]}case"TensorListSetItem":{const n=np("tensorListId",e,t,r),o=np("index",e,t,r),s=np("tensor",e,t,r),a=r.getTensorList(n.id);return a.setItem(o,s),[a.idTensor]}case"TensorListGetItem":{const n=np("tensorListId",e,t,r),o=np("index",e,t,r),s=np("elementShape",e,t,r),a=np("elementDType",e,t,r);return[r.getTensorList(n.id).getItem(o,s,a)]}case"TensorListScatterV2":case"TensorListScatter":{const n=np("indices",e,t,r),o=function(e,t,r,n){if(t.length!==e.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${t.length} vs. ${e.shape[0]}`);const o=Math.max(...t);if(null!=n&&-1!==n&&o>=n)throw new Error(`Max index must be < array size (${o}  vs. ${n})`);const s=new Kp([],r,e.dtype,n),a=fc(e,0);return t.forEach(((e,t)=>{s.setItem(e,a[t])})),s}(np("tensor",e,t,r),n,np("elementShape",e,t,r),np("numElements",e,t,r));return r.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const n=np("elementShape",e,t,r),o=np("elementDType",e,t,r);let s;s="TensorListReserve"===e.op?"numElements":"maxNumElements";const a=np(s,e,t,r),i=function(e,t,r,n){return new Kp([],e,t,n)}(n,o,0,"TensorListReserve"===e.op?-1:a);return r.addTensorList(i),[i.idTensor]}case"TensorListGather":{const n=np("tensorListId",e,t,r),o=np("indices",e,t,r),s=np("elementShape",e,t,r),a=np("elementDType",e,t,r);return[r.getTensorList(n.id).gather(o,a,s)]}case"TensorListStack":{const n=np("tensorListId",e,t,r),o=np("elementShape",e,t,r),s=np("elementDType",e,t,r),a=np("numElements",e,t,r);return[r.getTensorList(n.id).stack(o,s,a)]}case"TensorListFromTensor":{const n=function(e,t,r){const n=e.dtype;if(e.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${e.shape}`);if(e.dtype!==r)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${r}`);Wp(e.shape.slice(1),t,"TensorList shape mismatch: ");const o=fc(e);return new Kp(o,t,n)}(np("tensor",e,t,r),np("elementShape",e,t,r),np("elementDType",e,t,r));return r.addTensorList(n),[n.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const n=np("tensorListId",e,t,r),o=r.getTensorList(n.id),s=np("dtype",e,t,r),a=np("elementShape",e,t,r);return[o.concat(s,a)]}case"TensorListPushBack":{const n=np("tensorListId",e,t,r),o=np("tensor",e,t,r),s=r.getTensorList(n.id);return s.pushBack(o),[s.idTensor]}case"TensorListPopBack":{const n=np("tensorListId",e,t,r),o=np("elementShape",e,t,r),s=np("elementDType",e,t,r);return[r.getTensorList(n.id).popBack(o,s)]}case"TensorListSplit":{const n=np("tensor",e,t,r),o=np("elementShape",e,t,r),s=function(e,t,r){let n=0;const o=t.map((e=>(n+=e,n)));if(n!==e.shape[0])throw new Error(`Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ${n}, and tensor's shape is: ${e.shape}`);const s=Xp(e.shape.slice(1),r),a=0===n?0:e.size/n,i=wc((()=>{const r=[];e=Ha(e,[1,n,a]);for(let n=0;n<t.length;++n){const i=[0,0===n?0:o[n-1],0],l=[1,t[n],a];r[n]=Ha(Ja(e,i,l),s)}return e.dispose(),r})),l=new Kp([],r,e.dtype,t.length);for(let e=0;e<i.length;e++)l.setItem(e,i[e]);return l}(n,np("lengths",e,t,r),o);return r.addTensorList(s),[s.idTensor]}case"TensorListLength":{const n=np("tensorListId",e,t,r);return[el(r.getTensorList(n.id).size(),"int32")]}case"TensorListResize":{const n=np("tensorListId",e,t,r),o=np("size",e,t,r),s=r.getTensorList(n.id).resize(o);return r.addTensorList(s),[s.idTensor]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r);case"convolution":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"Conv1D":{const o=np("stride",e,t,r),s=np("pad",e,t,r),a=np("dataFormat",e,t,r).toUpperCase(),i=np("dilation",e,t,r);return[n.conv1d(np("x",e,t,r),np("filter",e,t,r),o,s,a,i)]}case"Conv2D":{const o=np("strides",e,t,r),s=lp(e,t,r),a=np("dataFormat",e,t,r).toUpperCase(),i=np("dilations",e,t,r);return[n.conv2d(np("x",e,t,r),np("filter",e,t,r),[o[1],o[2]],s,a,[i[1],i[2]])]}case"_FusedConv2D":{const{stride:o,pad:s,dataFormat:a,dilations:i,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=Zp(e,t,r);return[n.fused.conv2d({x:np("x",e,t,r),filter:np("filter",e,t,r),strides:[o[1],o[2]],pad:s,dataFormat:a,dilations:[i[1],i[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:o,pad:s,dataFormat:a,dilations:i,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=Zp(e,t,r);return[n.fused.depthwiseConv2d({x:np("x",e,t,r),filter:np("filter",e,t,r),strides:[o[1],o[2]],pad:s,dataFormat:a,dilations:[i[1],i[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const o=np("outputShape",e,t,r),s=np("strides",e,t,r),a=lp(e,t,r);return[n.conv2dTranspose(np("x",e,t,r),np("filter",e,t,r),o,[s[1],s[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const o=np("strides",e,t,r),s=lp(e,t,r),a=np("dilations",e,t,r),i=np("dataFormat",e,t,r).toUpperCase();return[n.depthwiseConv2d(np("input",e,t,r),np("filter",e,t,r),[o[1],o[2]],s,i,[a[1],a[2]])]}case"Conv3D":{const o=np("strides",e,t,r),s=np("pad",e,t,r),a=np("dataFormat",e,t,r).toUpperCase(),i=np("dilations",e,t,r);return[n.conv3d(np("x",e,t,r),np("filter",e,t,r),[o[1],o[2],o[3]],s,a,[i[1],i[2],i[3]])]}case"AvgPool":{const o=np("strides",e,t,r),s=np("pad",e,t,r),a=np("kernelSize",e,t,r);return[n.avgPool(np("x",e,t,r),[a[1],a[2]],[o[1],o[2]],s)]}case"MaxPool":{const o=np("strides",e,t,r),s=np("pad",e,t,r),a=np("kernelSize",e,t,r);return[n.maxPool(np("x",e,t,r),[a[1],a[2]],[o[1],o[2]],s)]}case"MaxPoolWithArgmax":{const o=np("strides",e,t,r),s=np("pad",e,t,r),a=np("kernelSize",e,t,r),i=np("includeBatchInIndex",e,t,r),{result:l,indexes:u}=n.maxPoolWithArgmax(np("x",e,t,r),[a[1],a[2]],[o[1],o[2]],s,i);return[l,u]}case"AvgPool3D":{const o=np("strides",e,t,r),s=np("pad",e,t,r),a=np("kernelSize",e,t,r);return[n.avgPool3d(np("x",e,t,r),[a[1],a[2],a[3]],[o[1],o[2],o[3]],s)]}case"MaxPool3D":{const o=np("strides",e,t,r),s=np("pad",e,t,r),a=np("kernelSize",e,t,r);return[n.maxPool3d(np("x",e,t,r),[a[1],a[2],a[3]],[o[1],o[2],o[3]],s)]}case"Dilation2D":{const o=np("strides",e,t,r),s=np("pad",e,t,r),a=np("dilations",e,t,r),i=o[1],l=o[2],u=a[1],c=a[2];return[n.dilation2d(np("x",e,t,r),np("filter",e,t,r),[i,l],s,[u,c],"NHWC")]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"creation":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"Fill":{const o=np("shape",e,t,r),s=np("dtype",e,t,r),a=np("value",e,t,r);return[n.fill(o,a,s)]}case"LinSpace":{const o=np("start",e,t,r),s=np("stop",e,t,r),a=np("num",e,t,r);return[n.linspace(o,s,a)]}case"Multinomial":{const o=np("logits",e,t,r),s=np("numSamples",e,t,r),a=np("seed",e,t,r);return[n.multinomial(o,s,a)]}case"OneHot":{const o=np("indices",e,t,r),s=np("depth",e,t,r),a=np("onValue",e,t,r),i=np("offValue",e,t,r),l=np("dtype",e,t,r);return[n.oneHot(o,s,a,i,l)]}case"Ones":return[n.ones(np("shape",e,t,r),np("dtype",e,t,r))];case"OnesLike":return[n.onesLike(np("x",e,t,r))];case"RandomStandardNormal":return[n.randomStandardNormal(np("shape",e,t,r),np("dtype",e,t,r),np("seed",e,t,r))];case"RandomUniform":return[n.randomUniform(np("shape",e,t,r),np("minval",e,t,r),np("maxval",e,t,r),np("dtype",e,t,r))];case"Range":{const o=np("start",e,t,r),s=np("stop",e,t,r),a=np("step",e,t,r);return[n.range(o,s,a,np("dtype",e,t,r))]}case"TruncatedNormal":{const o=np("shape",e,t,r),s=np("mean",e,t,r),a=np("stdDev",e,t,r),i=np("seed",e,t,r);return[n.truncatedNormal(o,s,a,np("dtype",e,t,r),i)]}case"Zeros":return[n.zeros(np("shape",e,t,r),np("dtype",e,t,r))];case"ZerosLike":return[n.zerosLike(np("x",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"dynamic":return(async(e,t,r,n,o=E)=>{switch(e.op){case"NonMaxSuppressionV5":{const{boxes:n,scores:s,maxOutputSize:a,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}=Qp(e,t,r),c=await o.image.nonMaxSuppressionWithScoreAsync(n,s,a,i,l,u);return[c.selectedIndices,c.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:n,scores:s,maxOutputSize:a,iouThreshold:i,scoreThreshold:l}=Qp(e,t,r),u=np("padToMaxOutputSize",e,t,r),c=await o.image.nonMaxSuppressionPaddedAsync(n,s,a,i,l,u);return[c.selectedIndices,c.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:n,scores:s,maxOutputSize:a,iouThreshold:i,scoreThreshold:l}=Qp(e,t,r);return[await o.image.nonMaxSuppressionAsync(n,s,a,i,l)]}case"Where":{const n=o.cast(np("condition",e,t,r),"bool"),s=[await o.whereAsync(n)];return n.dispose(),s}case"ListDiff":return o.setdiff1dAsync(np("x",e,t,r),np("y",e,t,r));default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r);case"evaluation":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"LowerBound":{const o=np("sortedSequence",e,t,r),s=np("values",e,t,r);return[n.lowerBound(o,s)]}case"TopKV2":{const o=np("x",e,t,r),s=np("k",e,t,r),a=np("sorted",e,t,r),i=n.topk(o,s,a);return[i.values,i.indices]}case"UpperBound":{const o=np("sortedSequence",e,t,r),s=np("values",e,t,r);return[n.upperBound(o,s)]}case"Unique":{const o=np("x",e,t,r),s=n.unique(o);return[s.values,s.indices]}case"UniqueV2":{const o=np("x",e,t,r),s=np("axis",e,t,r),a=n.unique(o,s);return[a.values,a.indices]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"image":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"ResizeBilinear":{const o=np("images",e,t,r),s=np("size",e,t,r),a=np("alignCorners",e,t,r),i=np("halfPixelCenters",e,t,r);return[n.image.resizeBilinear(o,[s[0],s[1]],a,i)]}case"ResizeNearestNeighbor":{const o=np("images",e,t,r),s=np("size",e,t,r),a=np("alignCorners",e,t,r),i=np("halfPixelCenters",e,t,r);return[n.image.resizeNearestNeighbor(o,[s[0],s[1]],a,i)]}case"CropAndResize":{const o=np("image",e,t,r),s=np("boxes",e,t,r),a=np("boxInd",e,t,r),i=np("cropSize",e,t,r),l=np("method",e,t,r),u=np("extrapolationValue",e,t,r);return[n.image.cropAndResize(o,s,a,i,l,u)]}case"ImageProjectiveTransformV3":{const o=np("images",e,t,r),s=np("transforms",e,t,r),a=np("outputShape",e,t,r),i=np("fillValue",e,t,r),l=np("interpolation",e,t,r),u=np("fillMode",e,t,r);return[n.image.transform(o,s,l.toLowerCase(),u.toLowerCase(),i,a)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"graph":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":const o=np("default",e,t,r);return[op(e.name,t,r)||o];case"Placeholder":return[op(e.name,t,r)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[up(np("x",e,t,r))];case"IdentityN":return np("x",e,t,r).map((e=>up(e)));case"Shape":return[n.tensor1d(np("x",e,t,r).shape,"int32")];case"ShapeN":return np("x",e,t,r).map((e=>n.tensor1d(e.shape)));case"Size":return[n.scalar(np("x",e,t,r).size,"int32")];case"Rank":return[n.scalar(np("x",e,t,r).rank,"int32")];case"NoOp":return[n.scalar(1)];case"Print":const s=np("x",e,t,r),a=np("data",e,t,r),i=np("message",e,t,r),l=np("summarize",e,t,r);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(i);for(let e=0;e<a.length;e++)console.log(Array.prototype.slice.call(a[e].dataSync()).slice(0,l));return[s];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"logical":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"Equal":return[n.equal(np("a",e,t,r),np("b",e,t,r))];case"NotEqual":return[n.notEqual(np("a",e,t,r),np("b",e,t,r))];case"Greater":return[n.greater(np("a",e,t,r),np("b",e,t,r))];case"GreaterEqual":return[n.greaterEqual(np("a",e,t,r),np("b",e,t,r))];case"Less":return[n.less(np("a",e,t,r),np("b",e,t,r))];case"LessEqual":return[n.lessEqual(np("a",e,t,r),np("b",e,t,r))];case"LogicalAnd":return[n.logicalAnd(np("a",e,t,r),np("b",e,t,r))];case"LogicalNot":return[n.logicalNot(np("a",e,t,r))];case"LogicalOr":return[n.logicalOr(np("a",e,t,r),np("b",e,t,r))];case"Select":case"SelectV2":return[n.where(np("condition",e,t,r),np("a",e,t,r),np("b",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"matrices":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[n.matMul(np("a",e,t,r),np("b",e,t,r),np("transposeA",e,t,r),np("transposeB",e,t,r))];case"Einsum":return[n.einsum(np("equation",e,t,r),...np("tensors",e,t,r))];case"Transpose":return[n.transpose(np("x",e,t,r),np("perm",e,t,r))];case"_FusedMatMul":const[o,s]=np("fusedOps",e,t,r),a="biasadd"===o,i="prelu"===s,l=np("numArgs",e,t,r),u=np("leakyreluAlpha",e,t,r);if(a){if(i&&2!==l)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!i&&1!==l)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=np("args",e,t,r);return[n.fused.matMul({a:np("a",e,t,r),b:np("b",e,t,r),transposeA:np("transposeA",e,t,r),transposeB:np("transposeB",e,t,r),bias:c,activation:s,preluActivationWeights:d,leakyreluAlpha:u})];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"normalization":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"EuclideanNorm":return[n.euclideanNorm(np("x",e,t,r),np("axis",e,t,r),np("keepDims",e,t,r))];case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[n.batchNorm(np("x",e,t,r),np("mean",e,t,r),np("variance",e,t,r),np("offset",e,t,r),np("scale",e,t,r),np("epsilon",e,t,r))];case"LRN":return[n.localResponseNormalization(np("x",e,t,r),np("radius",e,t,r),np("bias",e,t,r),np("alpha",e,t,r),np("beta",e,t,r))];case"Softmax":return[n.softmax(np("x",e,t,r))];case"LogSoftmax":return[n.logSoftmax(np("x",e,t,r))];case"SparseToDense":return[n.sparseToDense(np("sparseIndices",e,t,r),np("outputShape",e,t,r),np("sparseValues",e,t,r),np("defaultValue",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"reduction":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"Max":{const o=np("axis",e,t,r),s=np("keepDims",e,t,r);return[n.max(np("x",e,t,r),o,s)]}case"Mean":{const o=np("axis",e,t,r),s=np("keepDims",e,t,r);return[n.mean(np("x",e,t,r),o,s)]}case"Min":{const o=np("axis",e,t,r),s=np("keepDims",e,t,r);return[n.min(np("x",e,t,r),o,s)]}case"Sum":{const o=np("axis",e,t,r),s=np("keepDims",e,t,r);return[n.sum(np("x",e,t,r),o,s)]}case"All":{const o=np("axis",e,t,r),s=np("keepDims",e,t,r);return[n.all(np("x",e,t,r),o,s)]}case"Any":{const o=np("axis",e,t,r),s=np("keepDims",e,t,r);return[n.any(np("x",e,t,r),o,s)]}case"ArgMax":{const o=np("axis",e,t,r);return[n.argMax(np("x",e,t,r),o)]}case"ArgMin":{const o=np("axis",e,t,r);return[n.argMin(np("x",e,t,r),o)]}case"Prod":{const o=np("axis",e,t,r),s=np("keepDims",e,t,r);return[n.prod(np("x",e,t,r),o,s)]}case"Cumprod":{const o=np("axis",e,t,r),s=np("exclusive",e,t,r),a=np("reverse",e,t,r);return[n.cumprod(np("x",e,t,r),o,s,a)]}case"Cumsum":{const o=np("axis",e,t,r),s=np("exclusive",e,t,r),a=np("reverse",e,t,r);return[n.cumsum(np("x",e,t,r),o,s,a)]}case"Bincount":const o=np("x",e,t,r),s=np("weights",e,t,r),a=np("size",e,t,r);return[n.bincount(o,s,a)];case"DenseBincount":{const o=np("x",e,t,r),s=np("weights",e,t,r),a=np("size",e,t,r),i=np("binaryOutput",e,t,r);return[n.denseBincount(o,s,a,i)]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"slice_join":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"ConcatV2":case"Concat":{const o=np("n",e,t,r),s=np("axis",e,t,r);let a=np("tensors",e,t,r);return a=a.slice(0,o),[n.concat(a,s)]}case"Gather":{const o=np("x",e,t,r),s=np("indices",e,t,r);return[n.gather(o,n.cast(s,"int32"),0)]}case"GatherV2":{const o=np("axis",e,t,r),s=np("batchDims",e,t,r),a=np("x",e,t,r),i=np("indices",e,t,r);return[n.gather(a,n.cast(i,"int32"),o,s)]}case"Reverse":{const o=np("dims",e,t,r),s=[];for(let e=0;e<o.length;e++)o[e]&&s.push(e);const a=np("x",e,t,r);return[n.reverse(a,s)]}case"ReverseV2":{const o=np("axis",e,t,r),s=np("x",e,t,r);return[n.reverse(s,o)]}case"Slice":{const o=np("begin",e,t,r),s=np("size",e,t,r);return[n.slice(np("x",e,t,r),o,s)]}case"StridedSlice":{const o=np("begin",e,t,r),s=np("end",e,t,r),a=np("strides",e,t,r),i=np("beginMask",e,t,r),l=np("endMask",e,t,r),u=np("ellipsisMask",e,t,r),c=np("newAxisMask",e,t,r),d=np("shrinkAxisMask",e,t,r),h=np("x",e,t,r);return[n.stridedSlice(h,o,s,a,i,l,u,c,d)]}case"Pack":return wc((()=>{const o=np("axis",e,t,r),s=np("tensors",e,t,r),a=s[0].shape,i=n.squeeze(s[0]).shape,l=s.map((e=>{const t=W(e.shape,a);if(!t&&!W(n.squeeze(e).shape,i))throw new Error("the input tensors shape does not match");return t?e:n.reshape(e,a)}));return[n.stack(l,o)]}));case"Unpack":{const o=np("axis",e,t,r),s=np("tensor",e,t,r);return n.unstack(s,o)}case"Tile":{const o=np("reps",e,t,r);return[n.tile(np("x",e,t,r),o)]}case"Split":case"SplitV":{const o=np("axis",e,t,r),s=np("numOrSizeSplits",e,t,r),a=np("x",e,t,r);return n.split(a,s,o)}case"ScatterNd":{const o=np("indices",e,t,r),s=np("values",e,t,r),a=np("shape",e,t,r);return[n.scatterND(o,s,a)]}case"GatherNd":{const o=np("x",e,t,r),s=np("indices",e,t,r);return[n.gatherND(o,s)]}case"SparseToDense":{const o=np("sparseIndices",e,t,r),s=np("outputShape",e,t,r),a=np("sparseValues",e,t,r),i=np("defaultValue",e,t,r);return[n.sparseToDense(o,a,s,a.dtype===i.dtype?i:n.cast(i,a.dtype))]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"sparse":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"SparseFillEmptyRows":{const{outputIndices:o,outputValues:s,emptyRowIndicator:a,reverseIndexMap:i}=n.sparse.sparseFillEmptyRows(np("indices",e,t,r),np("values",e,t,r),np("denseShape",e,t,r),np("defaultValue",e,t,r));return[o,s,a,i]}case"SparseReshape":{const{outputIndices:o,outputShape:s}=n.sparse.sparseReshape(np("inputIndices",e,t,r),np("inputShape",e,t,r),np("newShape",e,t,r));return[o,s]}case"SparseSegmentMean":return[n.sparse.sparseSegmentMean(np("data",e,t,r),np("indices",e,t,r),np("segmentIds",e,t,r))];case"SparseSegmentSum":return[n.sparse.sparseSegmentSum(np("data",e,t,r),np("indices",e,t,r),np("segmentIds",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"spectral":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"FFT":return[n.fft(np("x",e,t,r))];case"IFFT":return[n.ifft(np("x",e,t,r))];case"RFFT":return[n.rfft(np("x",e,t,r))];case"IRFFT":return[n.irfft(np("x",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"string":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"StringNGrams":{const{nGrams:o,nGramsSplits:s}=n.string.stringNGrams(np("data",e,t,r),np("dataSplits",e,t,r),np("separator",e,t,r),np("nGramWidths",e,t,r),np("leftPad",e,t,r),np("rightPad",e,t,r),np("padWidth",e,t,r),np("preserveShortSequences",e,t,r));return[o,s]}case"StringSplit":{const{indices:o,values:s,shape:a}=n.string.stringSplit(np("input",e,t,r),np("delimiter",e,t,r),np("skipEmpty",e,t,r));return[o,s,a]}case"StringToHashBucketFast":return[n.string.stringToHashBucketFast(np("input",e,t,r),np("numBuckets",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"transformation":return o((()=>((e,t,r,n=E)=>{switch(e.op){case"Cast":return[n.cast(np("x",e,t,r),np("dtype",e,t,r))];case"ExpandDims":{const o=np("axis",e,t,r);return[n.expandDims(np("x",e,t,r),o)]}case"Squeeze":{const o=np("axis",e,t,r);return[n.squeeze(np("x",e,t,r),o)]}case"Reshape":return[n.reshape(np("x",e,t,r),np("shape",e,t,r))];case"MirrorPad":return[n.mirrorPad(np("x",e,t,r),np("padding",e,t,r),np("mode",e,t,r))];case"PadV2":case"Pad":return[n.pad(np("x",e,t,r),np("padding",e,t,r),np("constantValue",e,t,r))];case"SpaceToBatchND":{const o=np("blockShape",e,t,r),s=np("paddings",e,t,r);return[n.spaceToBatchND(np("x",e,t,r),o,s)]}case"BatchToSpaceND":{const o=np("blockShape",e,t,r),s=np("crops",e,t,r);return[n.batchToSpaceND(np("x",e,t,r),o,s)]}case"DepthToSpace":{const o=np("blockSize",e,t,r),s=np("dataFormat",e,t,r).toUpperCase();return[n.depthToSpace(np("x",e,t,r),o,s)]}case"BroadcastTo":return[n.broadcastTo(np("x",e,t,r),np("shape",e,t,r))];case"BroadcastArgs":return[n.broadcastArgs(np("s0",e,t,r),np("s1",e,t,r))];default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r)));case"hash_table":return(async(e,t,r,n)=>{switch(e.op){case"HashTable":case"HashTableV2":{const o=np("keyDType",e,t,r),s=np("valueDType",e,t,r),a=new Jp(o,s);return n.addHashTable(e.name,a),[a.handle]}case"LookupTableImport":case"LookupTableImportV2":{const o=np("tableHandle",e,t,r,n),s=np("keys",e,t,r),a=np("values",e,t,r),i=n.getHashTableById(o.id);return[await i.import(s,a)]}case"LookupTableFind":case"LookupTableFindV2":{const o=np("tableHandle",e,t,r,n),s=np("keys",e,t,r),a=np("defaultValue",e,t,r),i=n.getHashTableById(o.id);return[await i.find(s,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const o=np("tableHandle",e,t,r,n);return[n.getHashTableById(o.id).tensorSize()]}default:throw TypeError(`Node type ${e.op} is not implemented`)}})(e,t,r,n);case"custom":const s=rp(e.op);if(s&&s.customExecutor)return s.customExecutor(new zp(e,t,r));throw TypeError(`Custom op ${e.op} is not registered.`);default:throw TypeError(`Unknown op '${e.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(e,t,r);return me(s)?s.then((e=>[].concat(e))):[].concat(s)}class tf{constructor(e={},t={},r={},n={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=r,this.functionMap=n,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map((e=>0===e.id&&0===e.iterationId?"":`${e.frameName}-${e.iterationId}`)).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}nextIteration(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");{this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}function rf(e,t,r,n){const o=new Set,s=[];let a=null,i=null;const l=new Set,u=Object.keys(e).map((e=>ip(e)[0]));let c=[];null!=n&&(c=n.map((e=>ip(e.name)[0])));const d=[...t];for(;d.length>0;){const e=d.pop();(af(e)||lf(e)||uf(e))&&null==a&&(a=e,i=a.children.map((e=>e.name)).filter((e=>o.has(e)))),o.add(e.name),null==r[e.name]&&-1===u.indexOf(e.name)&&-1===c.indexOf(e.name)&&(0!==e.inputs.length?e.inputs.forEach((e=>{l.has(e.name)||(l.add(e.name),d.push(e))})):s.push(e.name))}return{inputs:e,outputs:t,usedNodes:o,missingInputs:s,dynamicNode:a,syncInputs:i}}const nf=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],of=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],sf=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function af(e){return nf.indexOf(e.op)>=0}function lf(e){return of.indexOf(e.op)>=0}function uf(e){return sf.indexOf(e.op)>=0}class cf{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,null!=e.functions&&Object.keys(e.functions).forEach((t=>{this._functionExecutorMap[t]=new cf(e.functions[t],this)}))}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map((t=>e[t].map((e=>e.id))));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get outputs(){return this._outputs.map((e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0})))}get inputNodes(){return this._inputs.map((e=>e.signatureKey||e.name))}get outputNodes(){return this._outputs.map((e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t}))}get functions(){return Object.keys(this._functions).reduce(((e,t)=>(e[t]=this._functions[t].signature,e)),{})}getCompilationKey(e,t){const r=e.map((e=>e.name)).sort(),n=t.map((e=>e.name)).sort();return r.join(this.SEPERATOR)+"--"+n.join(this.SEPERATOR)}compile(e,t){const r=rf(e,t,this.weightMap,this._initNodes),{missingInputs:n,dynamicNode:o,syncInputs:s}=r;if(null!=o)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${s}]`);if(n.length>0){const r=t.map((e=>e.name)),o=Object.keys(e);throw new Error(`Cannot compute the outputs [${r}] from the provided inputs [${o}]. Missing the following inputs: [${n}]`)}return function(e,t,r){const{usedNodes:n,inputs:o}=r,s=[],a=Object.keys(o).map((e=>ip(e)[0])).map((t=>e.nodes[t])),i=e.initNodes;a.forEach((e=>{n.has(e.name)&&s.push(e)})),e.weights.forEach((e=>{n.has(e.name)&&s.push(e)})),null!=i&&i.forEach((e=>{n.has(e.name)&&s.push(e)}));const l=new Set,u=[];for(;s.length>0;){const e=s.pop();l.add(e.name),t[e.name]||u.push(e),e.children.forEach((e=>{!l.has(e.name)&&n.has(e.name)&&e.inputs.every((e=>l.has(e.name)))&&s.push(e)}))}return u}(this.graph,this.weightMap,r)}execute(e,t){e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const n=r.map((e=>this.graph.nodes[ip(e)[0]])),o=t.map((e=>ip(e)[0]));let s=o.map((e=>this.graph.nodes[e]));this.resetIntermediateTensors(),0===s.length&&(s=this._outputs);const a=this.getCompilationKey(n,s);let i=this.compiledMap.get(a);null==i&&(i=this.compile(e,s),this.compiledMap.set(a,i));const l={},u={};return wc((()=>{const r=new tf(this.weightMap,l,u,this.functionExecutorMap),n=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[r,o]=ip(t),s=[];s[o]=e[t],n[r]=s}));const s=this.getFrozenTensorIds(n),a={};for(let e=0;e<i.length;e++){const t=i[e];if(!n[t.name]){const e=ef(t,n,r,this._resourceManager);if(me(e))throw new Error(`The execution of the op '${t.op}' returned a promise. Please use model.executeAsync() instead.`);n[t.name]=e,this.checkTensorForDisposal(t.name,t,n,r,s,o,a)}}return null==this.parent&&r.dispose(s),t.map((e=>op(e,n,r)))}))}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map((t=>e[t])).map((e=>e.map((e=>e.id)))));return new Set(t)}checkTensorForDisposal(e,t,r,n,o,s,a){"control"!==t.category&&-1===s.indexOf(e)&&(r[e].forEach((e=>{null!=e&&(a[e.id]=(a[e.id]||0)+t.children.length)})),t.inputs.forEach((e=>{if("control"!==e.category){const s=function(e,t,r){return t[ap(e,r.currentContextId)]}(e.name,r,n);null!=s&&s.forEach((e=>{if(e&&!e.kept&&!o.has(e.id)){const r=a[e.id];if(1===r){if(this.keepTensorForDebug){const[r,o]=sp(t.name,n);this.intermediateTensors[r]||(this.intermediateTensors[r]=[]),this.intermediateTensors[r][o]=e}else e.dispose();delete a[e.id]}else null!=r&&a[e.id]--}}))}})))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach((e=>this.intermediateTensors[e].forEach((e=>e.dispose())))),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach((e=>{this.tensorsMap[e].forEach((e=>{!e||e.kept||e.isDisposed||this.keepIds.has(e.id)||e.dispose()}))}))}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach((e=>e.dispose())),delete this.intermediateTensors[e]}async _executeAsync(e,t,r=!1,n={},o={}){r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=be().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(e){console.warn(e.message)}this.resetIntermediateTensors();const s=new tf(this.weightMap,n,o,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,s,t,r);const a=t.map((e=>op(e,this.tensorsMap,s))),i=a.map((e=>e.id)),l=Object.keys(e).map((t=>e[t].id));return this.keepIds=new Set([...i,...l,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),null==this.parent&&s.dispose(this.keepIds),a}async executeFunctionAsync(e,t,r){const n=e.reduce(((e,t,r)=>(e[this.inputs[r].name]=t,e)),{});return this._executeAsync(n,this.outputNodes,!0,t,r)}async executeWithControlFlow(e,t,r,n){const o=Object.keys(e),s=o.map((e=>this.graph.nodes[ip(e)[0]])),a=r.map((e=>ip(e)[0]));let i=a.map((e=>this.graph.nodes[e]));0===i.length&&(i=this._outputs);const{usedNodes:l,missingInputs:u,dynamicNode:c,syncInputs:d}=rf(e,i,this.weightMap,this._initNodes),h=[...s,...this.graph.weights,...this._initNodes||[]].map((e=>({node:e,contexts:t.currentContext}))),p=Object.assign({},this.weightMap);Object.keys(e).forEach((t=>{const[r,n]=ip(t),o=[];o[n]=e[t],p[r]=o}));const f={},m=this.getFrozenTensorIds(p),y={};for(;h.length>0;){const e=this.processStack(s,h,t,p,y,m,a,f,l);await Promise.all(e)}null!=c||n||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const g=i.filter((e=>!af(e)&&!op(e.name,p,t))).map((e=>e.name));if(g.length>0){let e="";throw null!=c&&(e=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${d}]`),new Error(`Cannot compute the outputs [${g}] from the provided inputs [${o}]. Consider providing the following inputs: [${u}]. ${e}`)}return p}processStack(e,t,r,n,o,s,a,i,l){const u=[];for(;t.length>0;){const e=t.pop();r.currentContext=e.contexts;let c="";if("Enter"===e.node.op&&np("isConstant",e.node,n,r)&&([c]=sp(e.node.name,r)),null==n[e.node.name]){const d=ef(e.node,n,r,this._resourceManager);c||([c]=sp(e.node.name,r));const h=r.currentContext;me(d)?u.push(d.then((u=>(n[c]=u,r.currentContext=h,this.checkTensorForDisposal(c,e.node,n,r,s,a,i),this.processChildNodes(e.node,t,r,n,o,l),u)))):(n[c]=d,this.checkTensorForDisposal(c,e.node,n,r,s,a,i),this.processChildNodes(e.node,t,r,n,o,l))}else this.processChildNodes(e.node,t,r,n,o,l)}return u}processChildNodes(e,t,r,n,o,s){e.children.forEach((e=>{const[a]=sp(e.name,r);!o[a]&&s.has(e.name)&&("Merge"===e.op?e.inputNames.some((e=>!!op(e,n,r)))&&(o[a]=!0,t.push({contexts:r.currentContext,node:e})):e.inputNames.every((e=>!!op(e,n,r)))&&(o[a]=!0,t.push({contexts:r.currentContext,node:e})))}))}dispose(){Object.keys(this.weightMap).forEach((e=>this.weightMap[e].forEach((e=>e.dispose()))))}checkInputShapeAndType(e){Object.keys(e).forEach((t=>{const r=e[t],[n]=ip(t),o=this.graph.nodes[n];if(o.attrParams.shape&&o.attrParams.shape.value){const e=o.attrParams.shape.value;B(e.length===r.shape.length&&r.shape.every(((t,r)=>-1===e[r]||e[r]===t)),(()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${e}], but was [${r.shape}]`))}o.attrParams.dtype&&o.attrParams.dtype.value&&B(r.dtype===o.attrParams.dtype.value,(()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${r.dtype}`))}))}mapInputs(e){const t={};for(const r in e)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[r]?t[this._signature.inputs[r].name]=e[r]:t[r]=e[r];return t}checkInputs(e){const t=Object.keys(e).filter((e=>{const[t]=ip(e);return null==this.graph.nodes[t]}));if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map((e=>null!=this._signature&&null!=this._signature.outputs&&null!=this._signature.outputs[e]?this._signature.outputs[e].name:e),{})}checkOutputs(e){e.forEach((e=>{const[t]=ip(e);if(!this.graph.nodes[t])throw new Error(`The output '${e}' is not found in the graph`)}))}}class df{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}const hf="?tfjs-format=file",pf="model.json";class ff{constructor(t,r={},n=e){this.modelUrl=t,this.loadOptions=r,this.version="n/a",this.io=n,null==r&&(this.loadOptions={}),this.resourceManager=new df}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return me(e)?e.then((e=>this.loadSync(e))):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let r=this.artifacts.signature;if(null!=this.artifacts.userDefinedMetadata){const e=this.artifacts.userDefinedMetadata;null!=e.signature&&(r=e.signature),null!=e.structuredOutputKeys&&(this.structuredOutputKeys=e.structuredOutputKeys)}this.signature=r,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const n=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new cf(Ip.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){const t=Ip.Instance.transformGraph(e.modelInitializer);this.initializer=new cf(t),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if("string"==typeof e){const t=this.io.getSaveHandlers(e);if(0===t.length)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(t.length>1)throw new Error(`Found more than one (${t.length}) save handlers for URL '${e}'`);e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){const r=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const e={};return(r instanceof Hn?[r]:r).forEach(((t,r)=>e[this.structuredOutputKeys[r]]=t)),e}return r}normalizeInputs(e){if(!(e instanceof Hn||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce(((t,r,n)=>(t[r]=e[n],t)),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=this.executor.execute(e,t);return r.length>1?r:r[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=await this.executor.executeAsync(e,t);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce(((t,r)=>(t[r]=[e[r]],t)),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function mf(t,r={},n=e){if(null==t)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");null==r&&(r={}),r.fromTFHub&&"string"==typeof t&&(t=function(e){return e.endsWith("/")||(e+="/"),`${e}${pf}${hf}`}(t));const o=new ff(t,r,n);return await o.load(),o}var yf=function(e,t){return(yf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function gf(e,t){function r(){this.constructor=e}yf(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var vf=function(){return(vf=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function bf(e,t,r,n){return new(r||(r=Promise))((function(o,s){function a(e){try{l(n.next(e))}catch(e){s(e)}}function i(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,i)}l((n=n.apply(e,t||[])).next())}))}function xf(e,t){var r,n,o,s,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function i(s){return function(i){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,i])}}}function wf(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var s=arguments[t],a=0,i=s.length;a<i;a++,o++)n[o]=s[a];return n}var _f=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],Sf=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"],kf={left:[1,2,3,7,9,11,13,15,17,19,21,23,25,27,29,31],right:[4,5,6,8,10,12,14,16,18,20,22,24,26,28,30,32],middle:[0]},Tf={left:[1,3,5,7,9,11,13,15],right:[2,4,6,8,10,12,14,16],middle:[0]},Ef=[[0,1],[0,2],[1,3],[2,4],[5,6],[5,7],[5,11],[6,8],[6,12],[7,9],[8,10],[11,12],[11,13],[12,14],[13,15],[14,16]],jf=[[0,1],[0,4],[1,2],[2,3],[3,7],[4,5],[5,6],[6,8],[9,10],[11,12],[11,13],[11,23],[12,14],[14,16],[12,24],[13,15],[15,17],[16,18],[16,20],[15,17],[15,19],[15,21],[16,22],[17,19],[18,20],[23,25],[23,24],[24,26],[25,27],[26,28],[27,29],[28,30],[27,31],[28,32],[29,31],[30,32]];function Cf(e){return e instanceof SVGAnimatedLength?e.baseVal.value:e}function If(e){return bf(this,void 0,void 0,(function(){var t,r;return xf(this,(function(n){switch(n.label){case 0:return t=document.createElement("canvas"),e instanceof Hn?[4,Zs(e,t)]:[3,2];case 1:return n.sent(),[3,3];case 2:t.width=Cf(e.width),t.height=Cf(e.height),r=t.getContext("2d"),e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0),n.label=3;case 3:return[2,t]}}))}))}function Of(e){return bf(this,void 0,void 0,(function(){var t,r,n,o,s,a;return xf(this,(function(i){switch(i.label){case 0:return e instanceof Hn?(t=e.shape.slice(0,2),r=t[0],n=t[1],o=ImageData.bind,[4,Zs(e)]):[3,2];case 1:return[2,new(o.apply(ImageData,[void 0,i.sent(),n,r]))];case 2:return s=document.createElement("canvas"),a=s.getContext("2d"),s.width=Cf(e.width),s.height=Cf(e.height),a.drawImage(e,0,0),[2,a.getImageData(0,0,s.width,s.height)]}}))}))}function Af(e){return bf(this,void 0,void 0,(function(){var t;return xf(this,(function(r){switch(r.label){case 0:return e instanceof SVGImageElement||e instanceof OffscreenCanvas?[4,If(e)]:[3,2];case 1:return t=r.sent(),[3,3];case 2:t=e,r.label=3;case 3:return[2,Qs(t,4)]}}))}))}function Rf(e){if(e<0||e>=256)throw new Error("Mask value must be in range [0, 255] but got "+e);if(!Number.isInteger(e))throw new Error("Mask value must be an integer but got "+e)}var Nf={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},Mf=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return bf(this,void 0,void 0,(function(){return xf(this,(function(e){return[2,this.mask]}))}))},e.prototype.toImageData=function(){return bf(this,void 0,void 0,(function(){return xf(this,(function(e){return[2,Of(this.mask)]}))}))},e.prototype.toTensor=function(){return bf(this,void 0,void 0,(function(){return xf(this,(function(e){return[2,Af(this.mask)]}))}))},e.prototype.getUnderlyingType=function(){return"canvasimagesource"},e}();function Pf(e){return Rf(e),"person"}var Lf=function(){function e(e){var t,r=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new N.Pose({locateFile:function(t,r){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+t:r+"/"+t}}),e.modelType){case"lite":t=0;break;case"heavy":t=2;break;default:t=1}this.poseSolution.setOptions({modelComplexity:t,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults((function(e){if(r.height=e.image.height,r.width=e.image.width,null==e.poseLandmarks)r.poses=[];else{var t=r.translateOutput(e.poseLandmarks,e.poseWorldLandmarks);e.segmentationMask&&(t.segmentation={maskValueToLabel:Pf,mask:new Mf(e.segmentationMask)}),r.poses=[t]}}))}return e.prototype.translateOutput=function(e,t){var r=this,n={keypoints:e.map((function(e,t){return{x:e.x*r.width,y:e.y*r.height,z:e.z,score:e.visibility,name:Sf[t]}}))};return null!=t&&(n.keypoints3D=t.map((function(e,t){return{x:e.x,y:e.y,z:e.z,score:e.visibility,name:Sf[t]}}))),n},e.prototype.estimatePoses=function(e,t,r){return bf(this,void 0,void 0,(function(){var n,o;return xf(this,(function(s){switch(s.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof Hn?(o=ImageData.bind,[4,Zs(e)]):[3,2];case 1:return n=new(o.apply(ImageData,[void 0,s.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:n=e,s.label=3;case 3:return e=n,[4,this.poseSolution.send({image:e},r)];case 4:return s.sent(),[2,this.poses]}}))}))},e.prototype.dispose=function(){this.poseSolution.close()},e.prototype.reset=function(){this.poseSolution.reset()},e.prototype.initialize=function(){return this.poseSolution.initialize()},e}();function Df(e){return bf(this,void 0,void 0,(function(){var t,r;return xf(this,(function(n){switch(n.label){case 0:return t=function(e){if(null==e)return vf({},Nf);var t=vf({},e);return t.runtime="mediapipe",null==t.enableSegmentation&&(t.enableSegmentation=Nf.enableSegmentation),null==t.enableSmoothing&&(t.enableSmoothing=Nf.enableSmoothing),null==t.smoothSegmentation&&(t.smoothSegmentation=Nf.smoothSegmentation),null==t.modelType&&(t.modelType=Nf.modelType),t}(e),[4,(r=new Lf(t)).initialize()];case 1:return n.sent(),[2,r]}}))}))}function Ff(e){return e instanceof Hn?{height:e.shape[0],width:e.shape[1]}:{height:e.height,width:e.width}}function $f(e){return e-2*Math.PI*Math.floor((e+Math.PI)/(2*Math.PI))}function Bf(e){return e instanceof Hn?e:Qs(e)}function Uf(e,t,r){return Vf(r,"inputResolution"),[1/r.width*e[0][0]*t.width,1/r.height*e[0][1]*t.width,e[0][3]*t.width,1/r.width*e[1][0]*t.height,1/r.height*e[1][1]*t.height,e[1][3]*t.height,0,0]}function Vf(e,t){B(0!==e.width,(function(){return t+" width cannot be 0."})),B(0!==e.height,(function(){return t+" height cannot be 0."}))}function Gf(e,t,r){var n=r.rotationVectorStartKeypointIndex,o=r.rotationVectorEndKeypointIndex,s=e.locationData,a=s.relativeKeypoints[n].x*t.width,i=s.relativeKeypoints[n].y*t.height,l=s.relativeKeypoints[o].x*t.width,u=s.relativeKeypoints[o].y*t.height,c=2*Math.sqrt((l-a)*(l-a)+(u-i)*(u-i)),d=function(e,t,r){var n,o=e.locationData,s=r.rotationVectorStartKeypointIndex,a=r.rotationVectorEndKeypointIndex;n=r.rotationVectorTargetAngle?r.rotationVectorTargetAngle:Math.PI*r.rotationVectorTargetAngleDegree/180;var i=o.relativeKeypoints[s].x*t.width,l=o.relativeKeypoints[s].y*t.height,u=o.relativeKeypoints[a].x*t.width,c=o.relativeKeypoints[a].y*t.height;return $f(n-Math.atan2(-(c-l),u-i))}(e,t,r);return{xCenter:a/t.width,yCenter:i/t.height,width:c/t.width,height:c/t.height,rotation:d}}function zf(e){if(16!==e.length)throw new Error("Array length must be 16 but got "+e.length);return[[e[0],e[1],e[2],e[3]],[e[4],e[5],e[6],e[7]],[e[8],e[9],e[10],e[11]],[e[12],e[13],e[14],e[15]]]}function Wf(e,t,r,n,o,s,a){return e[t][o]*(e[r][s]*e[n][a]-e[r][a]*e[n][s])}function Hf(e,t,r){var n=(t+1)%4,o=(t+2)%4,s=(t+3)%4,a=(r+1)%4,i=(r+2)%4,l=(r+3)%4;return Wf(e,n,o,s,a,i,l)+Wf(e,o,s,n,a,i,l)+Wf(e,s,n,o,a,i,l)}function qf(e,t,r){void 0===r&&(r={ignoreRotation:!1});for(var n=[],o=0,s=e;o<s.length;o++){var a=s[o],i=a.x-.5,l=a.y-.5,u=r.ignoreRotation?0:t.rotation,c=Math.cos(u)*i-Math.sin(u)*l,d=Math.sin(u)*i+Math.cos(u)*l;c=c*t.width+t.xCenter,d=d*t.height+t.yCenter;var h=a.z*t.width,p=vf({},a);p.x=c,p.y=d,p.z=h,n.push(p)}return n}function Xf(e,t){var r=function(e,t,r,n){var o=(n-r)/255;return{scale:o,offset:r-0*o}}(0,0,t[0],t[1]);return wc((function(){return wa(Za(e,r.scale),r.offset)}))}function Yf(e,t,r){var n,o,s,a,i,l,u,c,d,h,p,f,m=t.outputTensorSize,y=t.keepAspectRatio,g=t.borderMode,v=t.outputTensorFloatRange,b=Ff(e),x=function(e,t){return t?{xCenter:t.xCenter*e.width,yCenter:t.yCenter*e.height,width:t.width*e.width,height:t.height*e.height,rotation:t.rotation}:{xCenter:.5*e.width,yCenter:.5*e.height,width:e.width,height:e.height,rotation:0}}(b,r),w=function(e,t,r){if(void 0===r&&(r=!1),!r)return{top:0,left:0,right:0,bottom:0};var n=t.height,o=t.width;Vf(t,"targetSize"),Vf(e,"roi");var s,a,i=n/o,l=e.height/e.width,u=0,c=0;return i>l?(s=e.width,a=e.width*i,c=(1-l/i)/2):(s=e.height/i,a=e.height,u=(1-i/l)/2),e.width=s,e.height=a,{top:c,left:u,right:u,bottom:c}}(x,m,y),_=(n=x,o=b.width,s=b.height,a=n.width,i=n.height,l=Math.cos(n.rotation),u=Math.sin(n.rotation),c=n.xCenter,d=n.yCenter,h=1/o,p=1/s,(f=new Array(16))[0]=a*l*1*h,f[1]=-i*u*h,f[2]=0,f[3]=(-.5*a*l*1+.5*i*u+c)*h,f[4]=a*u*1*p,f[5]=i*l*p,f[6]=0,f[7]=(-.5*i*l-.5*a*u*1+d)*p,f[8]=0,f[9]=0,f[10]=a*h,f[11]=0,f[12]=0,f[13]=0,f[14]=0,f[15]=1,zf(f));return{imageTensor:wc((function(){var t=Bf(e),r=ac(Uf(_,b,m),[1,8]),n="zero"===g?"constant":"nearest",o=Ud.transform(ll(Ss(t,"float32")),r,"bilinear",n,0,[m.height,m.width]);return null!=v?Xf(o,v):o})),padding:w,transformationMatrix:_}}function Kf(e,t,r,n){return 1===n?.5*(e+t):e+(t-e)*r/(n-1)}function Zf(e){return null!=e&&null!=e.currentTime}function Qf(e){for(var t={locationData:{relativeKeypoints:[]}},r=Number.MAX_SAFE_INTEGER,n=Number.MIN_SAFE_INTEGER,o=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,a=0;a<e.length;++a){var i=e[a];r=Math.min(r,i.x),n=Math.max(n,i.x),o=Math.min(o,i.y),s=Math.max(s,i.y),t.locationData.relativeKeypoints.push({x:i.x,y:i.y})}return t.locationData.relativeBoundingBox={xMin:r,yMin:o,xMax:n,yMax:s,width:n-r,height:s-o},t}function Jf(e,t,r,n){return bf(this,void 0,void 0,(function(){var n,o,s,a,i;return xf(this,(function(l){switch(l.label){case 0:return e.sort((function(e,t){return Math.max.apply(Math,t.score)-Math.max.apply(Math,e.score)})),n=ac(e.map((function(e){return[e.locationData.relativeBoundingBox.yMin,e.locationData.relativeBoundingBox.xMin,e.locationData.relativeBoundingBox.yMax,e.locationData.relativeBoundingBox.xMax]}))),o=sc(e.map((function(e){return e.score[0]}))),[4,Ud.nonMaxSuppressionAsync(n,o,t,r)];case 1:return[4,(s=l.sent()).array()];case 2:return a=l.sent(),i=e.filter((function(e,t){return a.indexOf(t)>-1})),_c([n,o,s]),[2,i]}}))}))}function em(e,t){return e.map((function(e){var r=vf(vf({},e),{x:e.x*t.width,y:e.y*t.height});return null!=e.z&&(r.z=e.z*t.width),r}))}function tm(e,t,r){return bf(this,void 0,void 0,(function(){var n,o,s,a,i,l,u,c,d,h,p,f,m,y,g,v,b,x,w,_,S,k,T,E;return xf(this,(function(j){switch(j.label){case 0:if(n=ec(t,[0]),o=n.shape,s=o[0],a=o[1],i=o[2],e.length!==i)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+e.length+", heatmap length: "+i);return l=[],[4,n.buffer()];case 1:for(u=j.sent(),c=0;c<e.length;c++)if(d=e[c],h=vf({},d),l.push(h),p=Math.trunc(h.x*a),f=Math.trunc(h.y*s),!(p<0||p>=a||f<0||p>=s)){for(m=Math.trunc((r.kernelSize-1)/2),y=Math.max(0,p-m),g=Math.min(a,p+m+1),v=Math.max(0,f-m),b=Math.min(s,f+m+1),x=0,w=0,_=0,S=0,k=v;k<b;++k)for(T=y;T<g;++T)E=u.get(k,T,c),x+=E,S=Math.max(S,E),w+=T*E,_+=k*E;S>=r.minConfidenceToRefine&&x>0&&(h.x=w/a/x,h.y=_/s/x)}return n.dispose(),[2,l]}}))}))}function rm(e,t){var r=t.left,n=t.top,o=t.left+t.right,s=t.top+t.bottom;return e.map((function(e){return vf(vf({},e),{x:(e.x-r)/(1-o),y:(e.y-n)/(1-s),z:e.z/(1-o)})}))}function nm(e,t,r){return bf(this,void 0,void 0,(function(){var n,o,s,a,i;return xf(this,(function(l){switch(l.label){case 0:return n=e[0],o=e[1],s=function(e,t,r){return wc((function(){var n,o,s,a;r.reverseOutputOrder?(o=ec(Ja(e,[0,r.boxCoordOffset+0],[-1,1])),n=ec(Ja(e,[0,r.boxCoordOffset+1],[-1,1])),a=ec(Ja(e,[0,r.boxCoordOffset+2],[-1,1])),s=ec(Ja(e,[0,r.boxCoordOffset+3],[-1,1]))):(n=ec(Ja(e,[0,r.boxCoordOffset+0],[-1,1])),o=ec(Ja(e,[0,r.boxCoordOffset+1],[-1,1])),s=ec(Ja(e,[0,r.boxCoordOffset+2],[-1,1])),a=ec(Ja(e,[0,r.boxCoordOffset+3],[-1,1]))),o=wa(Za(Mi(o,r.xScale),t.w),t.x),n=wa(Za(Mi(n,r.yScale),t.h),t.y),r.applyExponentialOnBoxSize?(s=Za(il(Mi(s,r.hScale)),t.h),a=Za(il(Mi(a,r.wScale)),t.w)):(s=Za(Mi(s,r.hScale),t.h),a=Za(Mi(a,r.wScale),t.h));var i=Al(n,Mi(s,2)),l=Al(o,Mi(a,2)),u=wa(n,Mi(s,2)),c=wa(o,Mi(a,2)),d=Ya([Ha(i,[r.numBoxes,1]),Ha(l,[r.numBoxes,1]),Ha(u,[r.numBoxes,1]),Ha(c,[r.numBoxes,1])],1);if(r.numKeypoints)for(var h=0;h<r.numKeypoints;++h){var p=r.keypointCoordOffset+h*r.numValuesPerKeypoint,f=void 0,m=void 0;r.reverseOutputOrder?(f=ec(Ja(e,[0,p],[-1,1])),m=ec(Ja(e,[0,p+1],[-1,1]))):(m=ec(Ja(e,[0,p],[-1,1])),f=ec(Ja(e,[0,p+1],[-1,1])));var y=wa(Za(Mi(f,r.xScale),t.w),t.x),g=wa(Za(Mi(m,r.yScale),t.h),t.y);d=Ya([d,Ha(y,[r.numBoxes,1]),Ha(g,[r.numBoxes,1])],1)}return d}))}(o,t,r),a=wc((function(){var e=n;return r.sigmoidScore?(null!=r.scoreClippingThresh&&(e=hi(n,-r.scoreClippingThresh,r.scoreClippingThresh)),e=Qa(e)):e})),[4,om(s,a,r)];case 1:return i=l.sent(),_c([s,a]),[2,i]}}))}))}function om(e,t,r){return bf(this,void 0,void 0,(function(){var n,o,s,a,i,l,u,c,d,h,p,f;return xf(this,(function(m){switch(m.label){case 0:return n=[],[4,e.data()];case 1:return o=m.sent(),[4,t.data()];case 2:for(s=m.sent(),a=0;a<r.numBoxes;++a)if(!(null!=r.minScoreThresh&&s[a]<r.minScoreThresh||(i=a*r.numCoords,l=sm(o[i+0],o[i+1],o[i+2],o[i+3],s[a],r.flipVertically,a),(u=l.locationData.relativeBoundingBox).width<0||u.height<0))){if(r.numKeypoints>0)for((c=l.locationData).relativeKeypoints=[],d=r.numKeypoints*r.numValuesPerKeypoint,h=0;h<d;h+=r.numValuesPerKeypoint)p=i+r.keypointCoordOffset+h,f={x:o[p+0],y:r.flipVertically?1-o[p+1]:o[p+1]},c.relativeKeypoints.push(f);n.push(l)}return[2,n]}}))}))}function sm(e,t,r,n,o,s,a){return{score:[o],ind:a,locationData:{relativeBoundingBox:{xMin:t,yMin:s?1-r:e,xMax:n,yMax:s?1-e:r,width:n-t,height:r-e}}}}function am(e,t){return"none"===e?t:function(e){return 1/(1+Math.exp(-e))}(t)}function im(e,t,r,n){return bf(this,void 0,void 0,(function(){var o,s,a,i,l,u,c,d;return xf(this,(function(h){switch(h.label){case 0:return r=r||t.flipHorizontally||!1,n=n||t.flipVertically||!1,o=e.size,s=o/t.numLandmarks,[4,e.data()];case 1:for(a=h.sent(),i=[],l=0;l<t.numLandmarks;++l)u=l*s,(d={x:0,y:0}).x=r?t.inputImageWidth-a[u]:a[u],s>1&&(d.y=n?t.inputImageHeight-a[u+1]:a[u+1]),s>2&&(d.z=a[u+2]),s>3&&(d.score=am(t.visibilityActivation,a[u+3])),i.push(d);for(c=0;c<i.length;++c)(d=i[c]).x=d.x/t.inputImageWidth,d.y=d.y/t.inputImageHeight,d.z=d.z/t.inputImageWidth/(t.normalizeZ||1);return[2,i]}}))}))}function lm(e,t,r){var n=e.width,o=e.height,s=e.rotation;if(null==r.rotation&&null==r.rotationDegree||(s=function(e,t){return null!=t.rotation?e+=t.rotation:null!=t.rotationDegree&&(e+=Math.PI*t.rotationDegree/180),$f(e)}(s,r)),0===s)e.xCenter=e.xCenter+n*r.shiftX,e.yCenter=e.yCenter+o*r.shiftY;else{var a=(t.width*n*r.shiftX*Math.cos(s)-t.height*o*r.shiftY*Math.sin(s))/t.width,i=(t.width*n*r.shiftX*Math.sin(s)+t.height*o*r.shiftY*Math.cos(s))/t.height;e.xCenter=e.xCenter+a,e.yCenter=e.yCenter+i}if(r.squareLong){var l=Math.max(n*t.width,o*t.height);n=l/t.width,o=l/t.height}else if(r.squareShort){var u=Math.min(n*t.width,o*t.height);n=u/t.width,o=u/t.height}return e.width=n*r.scaleX,e.height=o*r.scaleY,e}function um(e,t){return e.map((function(e){var r=vf(vf({},e),{x:e.x/t.width,y:e.y/t.height});return null!=e.z&&(e.z=e.z/t.width),r}))}var cm=function(){function e(e){this.alpha=e,this.initialized=!1}return e.prototype.apply=function(e,t){var r;return this.initialized?r=null==t?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*t*Math.asinh((e-this.storedValue)/t):(r=e,this.initialized=!0),this.rawValue=e,this.storedValue=r,r},e.prototype.applyWithAlpha=function(e,t,r){return this.alpha=t,this.apply(e,r)},e.prototype.hasLastRawValue=function(){return this.initialized},e.prototype.lastRawValue=function(){return this.rawValue},e.prototype.reset=function(){this.initialized=!1},e}(),dm=function(){function e(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new cm(this.getAlpha(this.minCutOff)),this.dx=new cm(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return e.prototype.apply=function(e,t,r){if(null==e)return e;var n=Math.trunc(t);if(this.lastTimestamp>=n)return e;0!==this.lastTimestamp&&0!==n&&(this.frequency=1/(1e-6*(n-this.lastTimestamp))),this.lastTimestamp=n;var o=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*r*this.frequency:0,s=this.dx.applyWithAlpha(o,this.getAlpha(this.derivateCutOff)),a=this.minCutOff+this.beta*Math.abs(s),i=null!=this.thresholdCutOff?this.thresholdCutOff+this.thresholdBeta*Math.abs(s):null;return this.x.applyWithAlpha(e,this.getAlpha(a),i)},e.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},e}(),hm=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,r){var n=this;if(null==e)return this.reset(),null;this.initializeFiltersIfEmpty(e);var o=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return wf(e);o=1/r}return e.map((function(e,r){var s=vf(vf({},e),{x:n.xFilters[r].apply(e.x,t,o),y:n.yFilters[r].apply(e.y,t,o)});return null!=e.z&&(s.z=n.zFilters[r].apply(e.z,t,o)),s}))},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map((function(e){return new dm(t.config)})),this.yFilters=e.map((function(e){return new dm(t.config)})),this.zFilters=e.map((function(e){return new dm(t.config)})))},e}(),pm=function(){function e(e){this.config=e,this.window=[],this.lowPassFilter=new cm(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return e.prototype.apply=function(e,t,r){if(null==e)return e;var n,o=Math.trunc(t);if(this.lastTimestamp>=o)return e;if(-1===this.lastTimestamp)n=1;else{for(var s=e*r-this.lastValue*this.lastValueScale,a=o-this.lastTimestamp,i=s,l=a,u=(1+this.window.length)*(1e6/30),c=0,d=this.window;c<d.length;c++){var h=d[c];if(l+h.duration>u)break;i+=h.distance,l+=h.duration}var p=i/(1e-6*l);n=1-1/(1+this.config.velocityScale*Math.abs(p)),this.window.unshift({distance:s,duration:a}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=r,this.lastTimestamp=o,this.lowPassFilter.applyWithAlpha(e,n)},e}(),fm=function(){function e(e){this.config=e}return e.prototype.apply=function(e,t,r){var n=this;if(null==e)return this.reset(),null;var o=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return wf(e);o=1/r}return this.initializeFiltersIfEmpty(e),e.map((function(e,r){var s=vf(vf({},e),{x:n.xFilters[r].apply(e.x,t,o),y:n.yFilters[r].apply(e.y,t,o)});return null!=e.z&&(s.z=n.zFilters[r].apply(e.z,t,o)),s}))},e.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},e.prototype.initializeFiltersIfEmpty=function(e){var t=this;null!=this.xFilters&&this.xFilters.length===e.length||(this.xFilters=e.map((function(e){return new pm(t.config)})),this.yFilters=e.map((function(e){return new pm(t.config)})),this.zFilters=e.map((function(e){return new pm(t.config)})))},e}(),mm=function(){function e(e){if(null!=e.velocityFilter)this.keypointsFilter=new fm(e.velocityFilter);else{if(null==e.oneEuroFilter)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+e+".");this.keypointsFilter=new hm(e.oneEuroFilter)}}return e.prototype.apply=function(e,t,r,n,o){if(void 0===n&&(n=!1),null==e)return this.keypointsFilter.reset(),null;var s=null!=o?function(e,t){return(e.width*t.width+e.height*t.height)/2}(o,r):1,a=n?em(e,r):e,i=this.keypointsFilter.apply(a,t,s);return n?um(i,r):i},e}(),ym=function(){function e(e){this.alpha=e.alpha}return e.prototype.apply=function(e){var t=this;if(null==e)return this.visibilityFilters=null,null;null!=this.visibilityFilters&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map((function(e){return new cm(t.alpha)})));for(var r=[],n=0;n<e.length;++n){var o=e[n],s=vf({},o);s.score=this.visibilityFilters[n].apply(o.score),r.push(s)}return r},e}(),gm={reduceBoxesInLowestlayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},vm={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},bm={maxPoses:1,flipHorizontal:!1},xm={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},wm={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25,squareLong:!0},_m={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},Sm={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},km={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},Tm={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},Em={kernelSize:7,minConfidenceToRefine:.5},jm={alpha:.1},Cm={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},Im={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},Om={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},Am={activation:"none"},Rm={combineWithPreviousRatio:.7},Nm=function(){function e(e){this.mask=e}return e.prototype.toCanvasImageSource=function(){return bf(this,void 0,void 0,(function(){return xf(this,(function(e){return[2,If(this.mask)]}))}))},e.prototype.toImageData=function(){return bf(this,void 0,void 0,(function(){return xf(this,(function(e){return[2,Of(this.mask)]}))}))},e.prototype.toTensor=function(){return bf(this,void 0,void 0,(function(){return xf(this,(function(e){return[2,this.mask]}))}))},e.prototype.getUnderlyingType=function(){return"tensor"},e}();function Mm(e){return Rf(e),"person"}var Pm=function(){function e(e,t,r,n,o,s){this.detectorModel=e,this.landmarkModel=t,this.enableSmoothing=r,this.enableSegmentation=n,this.smoothSegmentation=o,this.modelType=s,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(e){null==e.reduceBoxesInLowestLayer&&(e.reduceBoxesInLowestLayer=!1),null==e.interpolatedScaleAspectRatio&&(e.interpolatedScaleAspectRatio=1),null==e.fixedAnchorSize&&(e.fixedAnchorSize=!1);for(var t=[],r=0;r<e.numLayers;){for(var n=[],o=[],s=[],a=[],i=r;i<e.strides.length&&e.strides[i]===e.strides[r];){var l=Kf(e.minScale,e.maxScale,i,e.strides.length);if(0===i&&e.reduceBoxesInLowestLayer)s.push(1),s.push(2),s.push(.5),a.push(.1),a.push(l),a.push(l);else{for(var u=0;u<e.aspectRatios.length;++u)s.push(e.aspectRatios[u]),a.push(l);if(e.interpolatedScaleAspectRatio>0){var c=i===e.strides.length-1?1:Kf(e.minScale,e.maxScale,i+1,e.strides.length);a.push(Math.sqrt(l*c)),s.push(e.interpolatedScaleAspectRatio)}}i++}for(var d=0;d<s.length;++d){var h=Math.sqrt(s[d]);n.push(a[d]/h),o.push(a[d]*h)}var p=0,f=0;if(e.featureMapHeight.length>0)p=e.featureMapHeight[r],f=e.featureMapWidth[r];else{var m=e.strides[r];p=Math.ceil(e.inputSizeHeight/m),f=Math.ceil(e.inputSizeWidth/m)}for(var y=0;y<p;++y)for(var g=0;g<f;++g)for(var v=0;v<n.length;++v){var b={xCenter:(g+e.anchorOffsetX)/f,yCenter:(y+e.anchorOffsetY)/p,width:0,height:0};e.fixedAnchorSize?(b.width=1,b.height=1):(b.width=o[v],b.height=n[v]),t.push(b)}r=i}return t}(gm);var a=sc(this.anchors.map((function(e){return e.width}))),i=sc(this.anchors.map((function(e){return e.height}))),l=sc(this.anchors.map((function(e){return e.xCenter}))),u=sc(this.anchors.map((function(e){return e.yCenter})));this.anchorTensor={x:l,y:u,w:a,h:i},this.prevFilteredSegmentationMask=this.enableSegmentation?ac([],[0,0]):null}return e.prototype.estimatePoses=function(e,t,r){return bf(this,void 0,void 0,(function(){var n,o,s,a,i,l,u,c,d,h,p,f,m,y,g,v,b,x,w,_,S,k,T;return xf(this,(function(E){switch(E.label){case 0:return n=function(e){var t;if(null==(t=null==e?bm:vf({},e)).maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses "+t.maxPoses+". Should be > 0.");if(t.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return t}(t),null==e?(this.reset(),[2,[]]):(this.maxPoses=n.maxPoses,this.timestamp=null!=r?1e3*r:Zf(e)?1e6*e.currentTime:null,o=Ff(e),s=wc((function(){return Ss(Bf(e),"float32")})),null!=(a=this.regionOfInterest)?[3,2]:[4,this.detectPose(s)]);case 1:if(0===(i=E.sent()).length)return this.reset(),s.dispose(),[2,[]];l=i[0],a=this.poseDetectionToRoi(l,o),E.label=2;case 2:return[4,this.poseLandmarksByRoi(a,s)];case 3:return u=E.sent(),s.dispose(),null==u?(this.reset(),[2,[]]):(c=u.landmarks,d=u.auxiliaryLandmarks,h=u.poseScore,p=u.worldLandmarks,f=u.segmentationMask,m=this.poseLandmarkFiltering(c,d,p,o),y=m.actualLandmarksFiltered,g=m.auxiliaryLandmarksFiltered,v=m.actualWorldLandmarksFiltered,b=this.poseLandmarksToRoi(g,o),this.regionOfInterest=b,x=this.smoothSegmentation&&null!=f?this.poseSegmentationFiltering(f):f,null!=(w=null!=y?em(y,o):null)&&w.forEach((function(e,t){e.name=Sf[t]})),null!=(_=v)&&_.forEach((function(e,t){e.name=Sf[t]})),S={score:h,keypoints:w,keypoints3D:_},null!==x&&(k=wc((function(){var e=ll(x,2),t=su(e,[[0,0],[0,0],[0,1]]);return Kl(t,[[0,0],[0,0],[0,2]],"symmetric")})),this.smoothSegmentation||_c(x),T={maskValueToLabel:Mm,mask:new Nm(k)},S.segmentation=T),[2,[S]])}}))}))},e.prototype.poseSegmentationFiltering=function(e){var t=this.prevFilteredSegmentationMask;return 0===t.size?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=function(e,t,r){return"webgl"===kc()?function(e,t,r){var n=r.combineWithPreviousRatio.toFixed(2),o={variableNames:["prevMask","newMask"],outputShape:e.shape,userCode:"\n  void main() {\n      ivec2 coords = getOutputCoords();\n      int height = coords[0];\n      int width = coords[1];\n\n      float prevMaskValue = getPrevMask(height, width);\n      float newMaskValue = getNewMask(height, width);\n\n      /*\n      * Assume p := newMaskValue\n      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)\n      * uncertainty alpha(p) =\n      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the\n      * uncertainty]\n      *\n      * The following polynomial approximates uncertainty alpha as a\n      * function of (p + 0.5):\n      */\n      const float c1 = 5.68842;\n      const float c2 = -0.748699;\n      const float c3 = -57.8051;\n      const float c4 = 291.309;\n      const float c5 = -624.717;\n      float t = newMaskValue - 0.5;\n      float x = t * t;\n\n      float uncertainty =\n        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));\n\n      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *\n                             (uncertainty * "+n+");\n\n      setOutput(outputValue);\n    }\n"},s=uo.backend;return wc((function(){var r=s.compileAndRun(o,[e,t]);return xc().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}))}(e,t,r):wc((function(){var n=Al(t,.5),o=rl(n),s=Al(1,Yl(1,Za(o,wa(5.68842,Za(o,wa(-.748699,Za(o,wa(-57.8051,Za(o,wa(291.309,Za(o,-624.717)))))))))));return wa(t,Za(Al(e,t),Za(s,r.combineWithPreviousRatio)))}))}(t,e,Rm),_c(e)),_c(t),this.prevFilteredSegmentationMask},e.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),_c([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},e.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(_c(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=ac([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},e.prototype.detectPose=function(e){return bf(this,void 0,void 0,(function(){var t,r,n,o,s,a,i,l,u,c;return xf(this,(function(d){switch(d.label){case 0:return t=Yf(e,_m),r=t.imageTensor,n=t.padding,o=this.detectorModel.predict(r),s=function(e){return wc((function(){var t=function(e){return wc((function(){return[Ja(e,[0,0,0],[1,-1,1]),Ja(e,[0,0,1],[1,-1,-1])]}))}(e),r=t[0],n=t[1];return{boxes:ec(n),logits:ec(r)}}))}(o),a=s.boxes,[4,nm([i=s.logits,a],this.anchorTensor,xm)];case 1:return 0===(l=d.sent()).length?(_c([r,o,i,a]),[2,l]):[4,Jf(l,this.maxPoses,.3)];case 2:return u=d.sent(),c=function(e,t){void 0===e&&(e=[]);for(var r=t.left,n=t.top,o=t.left+t.right,s=t.top+t.bottom,a=0;a<e.length;a++){var i=e[a],l=i.locationData.relativeBoundingBox,u=(l.xMin-r)/(1-o),c=(l.yMin-n)/(1-s),d=l.width/(1-o),h=l.height/(1-s);l.xMin=u,l.yMin=c,l.width=d,l.height=h,l.xMax=u+d,l.yMax=c+h;var p=i.locationData.relativeKeypoints;p&&p.forEach((function(e){var t=(e.x-r)/(1-o),a=(e.y-n)/(1-s);e.x=t,e.y=a}))}return e}(u,n),_c([r,o,i,a]),[2,c]}}))}))},e.prototype.poseDetectionToRoi=function(e,t){return lm(Gf(e,t,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),t,wm)},e.prototype.poseLandmarksByRoi=function(e,t){return bf(this,void 0,void 0,(function(){var r,n,o,s,a,i,l,u,c,d,h,p,f,m;return xf(this,(function(y){switch(y.label){case 0:if(r=Ff(t),n=Yf(t,Sm,e),o=n.imageTensor,s=n.padding,a=n.transformationMatrix,"lite"!==this.modelType&&"full"!==this.modelType&&"heavy"!==this.modelType)throw new Error("Model type must be one of lite, full or heavy,but got "+this.modelType);return i=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&i.push("activation_segmentation"),l=this.landmarkModel.execute(o,i),[4,this.tensorsToPoseLandmarksAndSegmentation(l)];case 1:return null==(u=y.sent())?(_c(l),_c(o),[2,null]):(c=u.landmarks,d=u.auxiliaryLandmarks,h=u.poseScore,p=u.worldLandmarks,f=u.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(r,e,s,a,c,d,p,f)]);case 2:return m=y.sent(),_c(l),_c(o),[2,vf({poseScore:h},m)]}}))}))},e.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,t,r,n,o,s,a,i){return bf(this,void 0,void 0,(function(){var l,u,c,d,h,p;return xf(this,(function(f){return l=rm(o,r),u=rm(s,r),c=qf(l,t),d=qf(u,t),h=function(e,t){for(var r=[],n=0,o=e;n<o.length;n++){var s=o[n],a=s.x,i=s.y,l=t.rotation,u=Math.cos(l)*a-Math.sin(l)*i,c=Math.sin(l)*a+Math.cos(l)*i,d=vf({},s);d.x=u,d.y=c,r.push(d)}return r}(a,t),p=null,this.enableSegmentation&&(p=wc((function(){var t=i.shape,r=t[0],o=t[1],s=function(e){var t=zf(new Array(16).fill(0));t[0][0]=Hf(e,0,0),t[1][0]=-Hf(e,0,1),t[2][0]=Hf(e,0,2),t[3][0]=-Hf(e,0,3),t[0][2]=Hf(e,2,0),t[1][2]=-Hf(e,2,1),t[2][2]=Hf(e,2,2),t[3][2]=-Hf(e,2,3),t[0][1]=-Hf(e,1,0),t[1][1]=Hf(e,1,1),t[2][1]=-Hf(e,1,2),t[3][1]=Hf(e,1,3),t[0][3]=-Hf(e,3,0),t[1][3]=Hf(e,3,1),t[2][3]=-Hf(e,3,2),t[3][3]=Hf(e,3,3);for(var r=e[0][0]*t[0][0]+e[1][0]*t[0][1]+e[2][0]*t[0][2]+e[3][0]*t[0][3],n=0;n<t.length;n++)for(var o=0;o<t.length;o++)t[n][o]/=r;return t}(n),a=ac(Uf(s,{width:o,height:r},e),[1,8]),l=[1,r,o,1];return ec(Ud.transform(Ha(i,l),a,"bilinear","constant",0,[e.height,e.width]),[0,3])})),_c(i)),[2,{landmarks:c,auxiliaryLandmarks:d,worldLandmarks:h,segmentationMask:p}]}))}))},e.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return bf(this,void 0,void 0,(function(){var t,r,n,o,s,a,i,l,u,c,d,h,p;return xf(this,(function(f){switch(f.label){case 0:return t=e[0],r=e[1],n=e[2],o=e[3],s=this.enableSegmentation?e[4]:null,[4,r.data()];case 1:return(a=f.sent()[0])<.5?[2,null]:[4,im(t,km)];case 2:return[4,tm(f.sent(),n,Em)];case 3:return i=f.sent(),l=i.slice(0,33),u=i.slice(33,35),[4,im(o,Tm)];case 4:return c=f.sent(),d=c.slice(0,33),h=function(e,t,r){void 0===r&&(r=!0);for(var n=[],o=0;o<e.length;o++){var s=vf({},t[o]);r&&(s.score=e[o].score),n.push(s)}return n}(l,d,!0),p=this.enableSegmentation?function(e,t,r){return wc((function(){var r=ec(e,[0]),n=r.shape[2];if(1===n){var o=r;switch(t.activation){case"none":break;case"sigmoid":o=Qa(o);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported ("+t.activation+")")}return ec(o,[2])}throw new Error("Unsupported number of tensor channels "+n)}))}(s,Am):null,[2,{landmarks:l,auxiliaryLandmarks:u,poseScore:a,worldLandmarks:h,segmentationMask:p}]}}))}))},e.prototype.poseLandmarksToRoi=function(e,t){return lm(Gf(Qf(e),t,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),t,wm)},e.prototype.poseLandmarkFiltering=function(e,t,r,n){var o,s,a;if(null!=this.timestamp&&this.enableSmoothing){var i=Gf(Qf(t),n,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});null==this.visibilitySmoothingFilterActual&&(this.visibilitySmoothingFilterActual=new ym(jm)),o=this.visibilitySmoothingFilterActual.apply(e),null==this.visibilitySmoothingFilterAuxiliary&&(this.visibilitySmoothingFilterAuxiliary=new ym(jm)),s=this.visibilitySmoothingFilterAuxiliary.apply(t),a=this.visibilitySmoothingFilterActual.apply(r),null==this.landmarksSmoothingFilterActual&&(this.landmarksSmoothingFilterActual=new mm(Cm)),o=this.landmarksSmoothingFilterActual.apply(o,this.timestamp,n,!0,i),null==this.landmarksSmoothingFilterAuxiliary&&(this.landmarksSmoothingFilterAuxiliary=new mm(Im)),s=this.landmarksSmoothingFilterAuxiliary.apply(s,this.timestamp,n,!0,i),null==this.worldLandmarksSmoothingFilterActual&&(this.worldLandmarksSmoothingFilterActual=new mm(Om)),a=this.worldLandmarksSmoothingFilterActual.apply(r,this.timestamp)}else o=e,s=t,a=r;return{actualLandmarksFiltered:o,auxiliaryLandmarksFiltered:s,actualWorldLandmarksFiltered:a}},e}();function Lm(e){return bf(this,void 0,void 0,(function(){var t,r,n,o,s,a;return xf(this,(function(i){switch(i.label){case 0:return t=function(e){var t=vf({},null==e?vm:e);if(null==t.enableSmoothing&&(t.enableSmoothing=vm.enableSmoothing),null==t.enableSegmentation&&(t.enableSegmentation=vm.enableSegmentation),null==t.smoothSegmentation&&(t.smoothSegmentation=vm.smoothSegmentation),null==t.modelType&&(t.modelType=vm.modelType),null==t.detectorModelUrl&&(t.detectorModelUrl=vm.detectorModelUrl),null==t.landmarkModelUrl)switch(t.modelType){case"lite":t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;default:t.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return t}(e),r="string"==typeof t.detectorModelUrl&&t.detectorModelUrl.indexOf("https://tfhub.dev")>-1,n="string"==typeof t.landmarkModelUrl&&t.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([mf(t.detectorModelUrl,{fromTFHub:r}),mf(t.landmarkModelUrl,{fromTFHub:n})])];case 1:return o=i.sent(),s=o[0],a=o[1],[2,new Pm(s,a,t.enableSmoothing,t.enableSegmentation,t.smoothSegmentation,t.modelType)]}}))}))}var Dm,Fm,$m,Bm=function(){function e(e){!function(e){if(e.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but encountered "+e.maxTracks);if(e.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but encountered "+e.maxAge);if(void 0!==e.keypointTrackerParams){if(e.keypointTrackerParams.keypointConfidenceThreshold<0||e.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+e.keypointTrackerParams.keypointConfidenceThreshold);if(e.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but encountered "+e.keypointTrackerParams.minNumberOfKeypoints);for(var t=0,r=e.keypointTrackerParams.keypointFalloff;t<r.length;t++){var n=r[t];if(n<=0)throw new Error("Must specify each keypoint falloff parameterto be positive but encountered "+n)}}}(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return e.prototype.apply=function(e,t){this.filterOldTracks(t);var r=this.computeSimilarity(e);return this.assignTracks(e,r,t),this.updateTracks(t),e},e.prototype.getTracks=function(){return this.tracks.slice()},e.prototype.getTrackIDs=function(){return new Set(this.tracks.map((function(e){return e.id})))},e.prototype.filterOldTracks=function(e){var t=this;this.tracks=this.tracks.filter((function(r){return e-r.lastTimestamp<=t.maxAge}))},e.prototype.assignTracks=function(e,t,r){for(var n=Array.from(Array(t[0].length).keys()),o=[],s=0,a=Array.from(Array(e.length).keys());s<a.length;s++){var i=a[s];if(0!==n.length){for(var l=-1,u=-1,c=0,d=n;c<d.length;c++){var h=d[c],p=t[i][h];p>=this.minSimilarity&&p>u&&(l=h,u=p)}if(l>=0){var f=this.tracks[l];f=Object.assign(f,this.createTrack(e[i],r,f.id)),e[i].id=f.id;var m=n.indexOf(l);n.splice(m,1)}else o.push(i)}else o.push(i)}for(var y=0,g=o;y<g.length;y++){i=g[y];var v=this.createTrack(e[i],r);this.tracks.push(v),e[i].id=v.id}},e.prototype.updateTracks=function(e){this.tracks.sort((function(e,t){return t.lastTimestamp-e.lastTimestamp})),this.tracks=this.tracks.slice(0,this.maxTracks)},e.prototype.createTrack=function(e,t,r){var n={id:r||this.nextTrackID(),lastTimestamp:t,keypoints:wf(e.keypoints).map((function(e){return vf({},e)}))};return void 0!==e.box&&(n.box=vf({},e.box)),n},e.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},e.prototype.remove=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.tracks=this.tracks.filter((function(t){return!e.includes(t.id)}))},e.prototype.reset=function(){this.tracks=[]},e}(),Um=function(e){function t(t){return e.call(this,t)||this}return gf(t,e),t.prototype.computeSimilarity=function(e){var t=this;return 0===e.length||0===this.tracks.length?[[]]:e.map((function(e){return t.tracks.map((function(r){return t.iou(e,r)}))}))},t.prototype.iou=function(e,t){var r=Math.max(e.box.xMin,t.box.xMin),n=Math.max(e.box.yMin,t.box.yMin),o=Math.min(e.box.xMax,t.box.xMax),s=Math.min(e.box.yMax,t.box.yMax);if(r>=o||n>=s)return 0;var a=(o-r)*(s-n);return a/(e.box.width*e.box.height+t.box.width*t.box.height-a)},t}(Bm),Vm=function(e){function t(t){var r=e.call(this,t)||this;return r.keypointThreshold=t.keypointTrackerParams.keypointConfidenceThreshold,r.keypointFalloff=t.keypointTrackerParams.keypointFalloff,r.minNumKeyoints=t.keypointTrackerParams.minNumberOfKeypoints,r}return gf(t,e),t.prototype.computeSimilarity=function(e){if(0===e.length||0===this.tracks.length)return[[]];for(var t=[],r=0,n=e;r<n.length;r++){for(var o=n[r],s=[],a=0,i=this.tracks;a<i.length;a++){var l=i[a];s.push(this.oks(o,l))}t.push(s)}return t},t.prototype.oks=function(e,t){for(var r=this.area(t.keypoints)+1e-6,n=0,o=0,s=0;s<e.keypoints.length;++s){var a=e.keypoints[s],i=t.keypoints[s];if(!(a.score<this.keypointThreshold||i.score<this.keypointThreshold)){o+=1;var l=Math.pow(a.x-i.x,2)+Math.pow(a.y-i.y,2),u=2*this.keypointFalloff[s];n+=Math.exp(-1*l/(2*r*Math.pow(u,2)))}}return o<this.minNumKeyoints?0:n/o},t.prototype.area=function(e){var t=this,r=e.filter((function(e){return e.score>t.keypointThreshold})),n=Math.min.apply(Math,wf([1],r.map((function(e){return e.x})))),o=Math.max.apply(Math,wf([0],r.map((function(e){return e.x})))),s=Math.min.apply(Math,wf([1],r.map((function(e){return e.y}))));return(o-n)*(Math.max.apply(Math,wf([0],r.map((function(e){return e.y}))))-s)},t}(Bm);function Gm(e){switch(e){case Fm.BlazePose:return Sf.reduce((function(e,t,r){return e[t]=r,e}),{});case Fm.PoseNet:case Fm.MoveNet:return _f.reduce((function(e,t,r){return e[t]=r,e}),{});default:throw new Error("Model "+e+" is not supported.")}}($m=Dm||(Dm={})).Keypoint="keypoint",$m.BoundingBox="boundingBox",function(e){e.MoveNet="MoveNet",e.BlazePose="BlazePose",e.PoseNet="PoseNet"}(Fm||(Fm={})),Object.freeze({__proto__:null,getKeypointIndexBySide:function(e){switch(e){case Fm.BlazePose:return kf;case Fm.PoseNet:case Fm.MoveNet:return Tf;default:throw new Error("Model "+e+" is not supported.")}},getAdjacentPairs:function(e){switch(e){case Fm.BlazePose:return jf;case Fm.PoseNet:case Fm.MoveNet:return Ef;default:throw new Error("Model "+e+" is not supported.")}},getKeypointIndexByName:Gm});var zm=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],Wm={modelType:"SinglePose.Lightning",enableSmoothing:!0},Hm={},qm={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},Xm={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},Ym={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function Km(e,t){var r,n,o,s;return e?t.width>t.height?(r=1,n=t.height/t.width,o=0,s=(t.width/2-t.height/2)/t.width):(r=t.width/t.height,n=1,o=(t.height/2-t.width/2)/t.height,s=0):t.width>t.height?(r=t.width/t.height,n=1,o=(t.height/2-t.width/2)/t.height,s=0):(r=1,n=t.height/t.width,o=0,s=(t.width/2-t.height/2)/t.width),{yMin:o,xMin:s,yMax:o+r,xMax:s+n,height:r,width:n}}function Zm(e,t){var r={maxTracks:e.maxTracks,maxAge:e.maxAge,minSimilarity:e.minSimilarity};return null!=t.maxTracks&&(r.maxTracks=t.maxTracks),null!=t.maxAge&&(r.maxAge=t.maxAge),null!=t.minSimilarity&&(r.minSimilarity=t.minSimilarity),r}var Qm=function(){function e(e,t){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=Gm(Fm.MoveNet),"SinglePose.Lightning"===t.modelType?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):"SinglePose.Thunder"===t.modelType&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel="MultiPose.Lightning"===t.modelType,this.multiPoseModel||(this.keypointFilter=new hm(qm),this.cropRegionFilterYMin=new cm(.9),this.cropRegionFilterXMin=new cm(.9),this.cropRegionFilterYMax=new cm(.9),this.cropRegionFilterXMax=new cm(.9)),this.enableSmoothing=t.enableSmoothing,t.minPoseScore?this.minPoseScore=t.minPoseScore:this.minPoseScore=.25,t.multiPoseMaxDimension?this.multiPoseMaxDimension=t.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=t.enableTracking,this.multiPoseModel&&this.enableTracking&&(t.trackerType===Dm.Keypoint?this.tracker=new Vm(t.trackerConfig):t.trackerType===Dm.BoundingBox&&(this.tracker=new Um(t.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return e.prototype.runSinglePersonPoseModel=function(e){return bf(this,void 0,void 0,(function(){var t,r,n,o,s;return xf(this,(function(a){switch(a.label){case 0:if(4!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||1!==t.shape[1]||17!==t.shape[2]||3!==t.shape[3])throw t.dispose(),new Error("Unexpected output shape from model: ["+t.shape+"]");return"webgpu"===kc()?[3,1]:(r=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:r=a.sent(),a.label=3;case 3:for(t.dispose(),n={keypoints:[],score:0},o=0,s=0;s<17;++s)n.keypoints[s]={y:r[3*s],x:r[3*s+1],score:r[3*s+2]},n.keypoints[s].score>.2&&(++o,n.score+=n.keypoints[s].score);return o>0&&(n.score/=o),[2,n]}}))}))},e.prototype.runMultiPersonPoseModel=function(e){return bf(this,void 0,void 0,(function(){var t,r,n,o,s,a,i,l;return xf(this,(function(u){switch(u.label){case 0:if(3!==(t=this.moveNetModel.execute(e)).shape.length||1!==t.shape[0]||56!==t.shape[2])throw t.dispose(),new Error("Unexpected output shape from model: ["+t.shape+"]");return"webgpu"===kc()?[3,1]:(r=t.dataSync(),[3,3]);case 1:return[4,t.data()];case 2:r=u.sent(),u.label=3;case 3:for(t.dispose(),n=[],o=r.length/56,s=0;s<o;++s)for(n[s]={keypoints:[]},a=56*s+51,n[s].box={yMin:r[a],xMin:r[a+1],yMax:r[a+2],xMax:r[a+3],width:r[a+3]-r[a+1],height:r[a+2]-r[a]},i=56*s+55,n[s].score=r[i],n[s].keypoints=[],l=0;l<17;++l)n[s].keypoints[l]={y:r[56*s+3*l],x:r[56*s+3*l+1],score:r[56*s+3*l+2]};return[2,n]}}))}))},e.prototype.estimatePoses=function(e,t,r){return void 0===t&&(t=Hm),bf(this,void 0,void 0,(function(){var n,o,s,a,i,l;return xf(this,(function(u){switch(u.label){case 0:return t=function(e){return null==e?Hm:vf({},e)}(t),null==e?(this.reset(),[2,[]]):(null==r?Zf(e)&&(r=1e6*e.currentTime):r*=1e3,n=Bf(e),o=Ff(n),s=ll(n,0),e instanceof Hn||n.dispose(),a=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(s,o,r)]);case 1:return a=u.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(s,o,r)];case 3:a=u.sent(),u.label=4;case 4:for(i=0;i<a.length;++i)for(l=0;l<a[i].keypoints.length;++l)a[i].keypoints[l].name=_f[l],a[i].keypoints[l].y*=o.height,a[i].keypoints[l].x*=o.width;return[2,a]}}))}))},e.prototype.estimateSinglePose=function(e,t,r){return bf(this,void 0,void 0,(function(){var n,o,s,a,i=this;return xf(this,(function(l){switch(l.label){case 0:return this.cropRegion||(this.cropRegion=Km(null==this.cropRegion,t)),n=wc((function(){var t=ac([[i.cropRegion.yMin,i.cropRegion.xMin,i.cropRegion.yMax,i.cropRegion.xMax]]),r=Hl([1],"int32"),n=[i.modelInputResolution.height,i.modelInputResolution.width];return Ss(Ud.cropAndResize(e,t,r,n,"bilinear",0),"int32")})),e.dispose(),[4,this.runSinglePersonPoseModel(n)];case 1:if(o=l.sent(),n.dispose(),o.score<this.minPoseScore)return this.reset(),[2,[]];for(s=0;s<o.keypoints.length;++s)o.keypoints[s].y=this.cropRegion.yMin+o.keypoints[s].y*this.cropRegion.height,o.keypoints[s].x=this.cropRegion.xMin+o.keypoints[s].x*this.cropRegion.width;return null!=r&&this.enableSmoothing&&(o.keypoints=this.keypointFilter.apply(o.keypoints,r,1)),a=function(e,t,r,n){for(var o={},s=0,a=_f;s<a.length;s++){var i=a[s];o[i]=[t[r[i]].y*n.height,t[r[i]].x*n.width]}if(function(e,t){return(e[t.left_hip].score>.2||e[t.right_hip].score>.2)&&(e[t.left_shoulder].score>.2||e[t.right_shoulder].score>.2)}(t,r)){var l=(o.left_hip[0]+o.right_hip[0])/2,u=(o.left_hip[1]+o.right_hip[1])/2,c=function(e,t,r,n,o){for(var s=["left_shoulder","right_shoulder","left_hip","right_hip"],a=0,i=0,l=0;l<s.length;l++)(p=Math.abs(n-r[s[l]][0]))>a&&(a=p),(f=Math.abs(o-r[s[l]][1]))>i&&(i=f);for(var u=0,c=0,d=0,h=Object.keys(r);d<h.length;d++){var p,f,m=h[d];e[t[m]].score<.2||((p=Math.abs(n-r[m][0]))>u&&(u=p),(f=Math.abs(o-r[m][1]))>c&&(c=f))}return[a,i,u,c]}(t,r,o,l,u),d=c[0],h=c[1],p=c[2],f=c[3],m=Math.max(1.9*h,1.9*d,1.2*p,1.2*f),y=[l-(m=Math.min(m,Math.max(u,n.width-u,l,n.height-l))),u-m];if(m>Math.max(n.width,n.height)/2)return Km(null==e,n);var g=2*m;return{yMin:y[0]/n.height,xMin:y[1]/n.width,yMax:(y[0]+g)/n.height,xMax:(y[1]+g)/n.width,height:(y[0]+g)/n.height-y[0]/n.height,width:(y[1]+g)/n.width-y[1]/n.width}}return Km(null==e,n)}(this.cropRegion,o.keypoints,this.keypointIndexByName,t),this.cropRegion=this.filterCropRegion(a),[2,[o]]}}))}))},e.prototype.estimateMultiplePoses=function(e,t,r){return bf(this,void 0,void 0,(function(){var n,o,s,a,i,l,u,c,d,h,p,f=this;return xf(this,(function(m){switch(m.label){case 0:return t.width>t.height?(o=this.multiPoseMaxDimension,s=Math.round(this.multiPoseMaxDimension*t.height/t.width),n=Ud.resizeBilinear(e,[s,o]),i=o,l=32*Math.ceil(s/32),a=su(n,[[0,0],[0,l-s],[0,0],[0,0]])):(o=Math.round(this.multiPoseMaxDimension*t.width/t.height),s=this.multiPoseMaxDimension,n=Ud.resizeBilinear(e,[s,o]),i=32*Math.ceil(o/32),l=s,a=su(n,[[0,0],[0,0],[0,i-o],[0,0]])),n.dispose(),e.dispose(),u=Ss(a,"int32"),a.dispose(),[4,this.runMultiPersonPoseModel(u)];case 1:for(c=m.sent(),u.dispose(),c=c.filter((function(e){return e.score>=f.minPoseScore})),h=0;h<c.length;++h)for(d=0;d<c[h].keypoints.length;++d)c[h].keypoints[d].y*=l/s,c[h].keypoints[d].x*=i/o;if(this.enableTracking&&(this.tracker.apply(c,r),this.enableSmoothing)){for(h=0;h<c.length;++h)this.keypointFilterMap.has(c[h].id)||this.keypointFilterMap.set(c[h].id,new hm(qm)),c[h].keypoints=this.keypointFilterMap.get(c[h].id).apply(c[h].keypoints,r,1);p=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach((function(e,t){p.has(t)||f.keypointFilterMap.delete(t)}))}return[2,c]}}))}))},e.prototype.filterCropRegion=function(e){if(e){var t=this.cropRegionFilterYMin.apply(e.yMin),r=this.cropRegionFilterXMin.apply(e.xMin),n=this.cropRegionFilterYMax.apply(e.yMax),o=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:t,xMin:r,yMax:n,xMax:o,height:n-t,width:o-r}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},e.prototype.dispose=function(){this.moveNetModel.dispose()},e.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},e.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},e}();function Jm(e){return void 0===e&&(e=Wm),bf(this,void 0,void 0,(function(){var t,r,n,o;return xf(this,(function(s){switch(s.label){case 0:return t=function(e){var t,r=null==e?Wm:vf({},e);if(null==r.modelType)r.modelType="SinglePose.Lightning";else if(zm.indexOf(r.modelType)<0)throw new Error("Invalid architecture "+r.modelType+". Should be one of "+zm);if(null==r.enableSmoothing&&(r.enableSmoothing=!0),null!=r.minPoseScore&&(r.minPoseScore<0||r.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(null!=r.multiPoseMaxDimension&&(r.multiPoseMaxDimension%32!=0||r.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if("MultiPose.Lightning"===r.modelType&&null==r.enableTracking&&(r.enableTracking=!0),"MultiPose.Lightning"===r.modelType&&!0===r.enableTracking)if(null==r.trackerType&&(r.trackerType=Dm.BoundingBox),r.trackerType===Dm.Keypoint)null!=r.trackerConfig?r.trackerConfig=function(e){var t=Zm(Xm,e);return t.keypointTrackerParams=vf({},Xm.keypointTrackerParams),null!=e.keypointTrackerParams&&(null!=e.keypointTrackerParams.keypointConfidenceThreshold&&(t.keypointTrackerParams.keypointConfidenceThreshold=e.keypointTrackerParams.keypointConfidenceThreshold),null!=e.keypointTrackerParams.keypointFalloff&&(t.keypointTrackerParams.keypointFalloff=e.keypointTrackerParams.keypointFalloff),null!=e.keypointTrackerParams.minNumberOfKeypoints&&(t.keypointTrackerParams.minNumberOfKeypoints=e.keypointTrackerParams.minNumberOfKeypoints)),t}(r.trackerConfig):r.trackerConfig=Xm;else{if(r.trackerType!==Dm.BoundingBox)throw new Error("Tracker type not supported by MoveNet");null!=r.trackerConfig?r.trackerConfig=(t=r.trackerConfig,Zm(Ym,t)):r.trackerConfig=Ym}return r}(e),n=!0,t.modelUrl?(n="string"==typeof t.modelUrl&&t.modelUrl.indexOf("https://tfhub.dev")>-1,[4,mf(t.modelUrl,{fromTFHub:n})]):[3,2];case 1:return r=s.sent(),[3,4];case 2:return o=void 0,"SinglePose.Lightning"===t.modelType?o="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":"SinglePose.Thunder"===t.modelType?o="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":"MultiPose.Lightning"===t.modelType&&(o="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,mf(o,{fromTFHub:n})];case 3:r=s.sent(),s.label=4;case 4:return"webgl"===kc()&&be().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new Qm(r,t)]}}))}))}var ey={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},ty=["MobileNetV1","ResNet50"],ry={MobileNetV1:[8,16],ResNet50:[16]},ny=[8,16,32],oy={MobileNetV1:[.5,.75,1],ResNet50:[1]},sy=[1,2,4],ay={maxPoses:1,flipHorizontal:!1},iy={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},ly=[-123.15,-115.9,-103.06];function uy(e){return Math.floor(e/2)}var cy=function(){function e(e,t){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=t}return e.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},e.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},e.prototype.empty=function(){return-1===this.numberOfElements},e.prototype.size=function(){return this.numberOfElements+1},e.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},e.prototype.max=function(){return this.priorityQueue[0]},e.prototype.swim=function(e){for(;e>0&&this.less(uy(e),e);)this.exchange(e,uy(e)),e=uy(e)},e.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var t=2*e;if(t<this.numberOfElements&&this.less(t,t+1)&&t++,!this.less(e,t))break;this.exchange(e,t),e=t}},e.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},e.prototype.less=function(e,t){return this.getValueAt(e)<this.getValueAt(t)},e.prototype.exchange=function(e,t){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[t],this.priorityQueue[t]=r},e}();function dy(e,t,r,n,o,s){for(var a=s.shape,i=a[0],l=a[1],u=!0,c=Math.max(r-o,0),d=Math.min(r+o+1,i),h=c;h<d;++h){for(var p=Math.max(n-o,0),f=Math.min(n+o+1,l),m=p;m<f;++m)if(s.get(h,m,e)>t){u=!1;break}if(!u)break}return u}function hy(e){return bf(this,void 0,void 0,(function(){return xf(this,(function(t){return[2,Promise.all(e.map((function(e){return e.buffer()})))]}))}))}function py(e,t,r,n){return{y:n.get(e,t,r),x:n.get(e,t,r+17)}}function fy(e,t,r){var n=py(e.heatmapY,e.heatmapX,e.id,r),o=n.y,s=n.x;return{x:e.heatmapX*t+s,y:e.heatmapY*t+o}}function my(e,t,r,n){var o=r.x,s=r.y;return e.some((function(e){var r,a,i,l,u=e.keypoints;return r=s,a=o,(i=u[n].y-r)*i+(l=u[n].x-a)*l<=t}))}var yy=_f.reduce((function(e,t,r){return e[t]=r,e}),{}),gy=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map((function(e){var t=e[0],r=e[1];return[yy[t],yy[r]]})),vy=gy.map((function(e){return e[1]})),by=gy.map((function(e){return e[0]}));function xy(e,t,r){return e<t?t:e>r?r:e}function wy(e,t,r,n){return{y:xy(Math.round(e.y/t),0,r-1),x:xy(Math.round(e.x/t),0,n-1)}}function _y(e,t){return{x:e.x+t.x,y:e.y+t.y}}function Sy(e,t,r,n,o,s,a,i){void 0===i&&(i=2);for(var l=n.shape,u=l[0],c=l[1],d={y:t.y,x:t.x},h=_y(d,function(e,t,r){var n=r.shape[2]/2;return{y:r.get(t.y,t.x,e),x:r.get(t.y,t.x,n+e)}}(e,wy(d,s,u,c),a)),p=0;p<i;p++){var f=wy(h,s,u,c),m=py(f.y,f.x,r,o);h=_y({x:f.x*s,y:f.y*s},{x:m.x,y:m.y})}var y=wy(h,s,u,c),g=n.get(y.y,y.x,r);return{y:h.y,x:h.x,name:_f[r],score:g}}function ky(e,t,r,n,o,s){var a=t.shape[2],i=vy.length,l=new Array(a),u=e.part,c=e.score,d=fy(u,n,r);l[u.id]={score:c,name:_f[u.id],y:d.y,x:d.x};for(var h=i-1;h>=0;--h){var p=vy[h],f=by[h];l[p]&&!l[f]&&(l[f]=Sy(h,l[p],f,t,r,n,s))}for(h=0;h<i;++h)p=by[h],f=vy[h],l[p]&&!l[f]&&(l[f]=Sy(h,l[p],f,t,r,n,o));return l}function Ty(e,t,r){return r.reduce((function(r,n,o){var s=n.y,a=n.x,i=n.score;return my(e,t,{y:s,x:a},o)||(r+=i),r}),0)/r.length}function Ey(e,t,r,n,o,s,a,i){return void 0===a&&(a=.5),void 0===i&&(i=20),bf(this,void 0,void 0,(function(){var l,u,c,d,h,p,f,m,y,g,v,b;return xf(this,(function(x){switch(x.label){case 0:return[4,hy([e,t,r,n])];case 1:for(l=x.sent(),u=l[0],c=l[1],d=l[2],h=l[3],p=[],f=function(e,t,r){for(var n=r.shape,o=n[0],s=n[1],a=n[2],i=new cy(o*s*a,(function(e){return e.score})),l=0;l<o;++l)for(var u=0;u<s;++u)for(var c=0;c<a;++c){var d=r.get(l,u,c);d<e||dy(c,d,l,u,1,r)&&i.enqueue({score:d,part:{heatmapY:l,heatmapX:u,id:c}})}return i}(a,0,u),m=i*i;p.length<s&&!f.empty();)y=f.dequeue(),g=fy(y.part,o,c),my(p,m,g,y.part.id)||(v=ky(y,u,c,o,d,h),b=Ty(p,m,v),p.push({keypoints:v,score:b}));return[2,p]}}))}))}function jy(e,t,r){return wc((function(){var n=function(e,t){for(var r=[],n=0;n<_f.length;n++){var o=Cy(e.get(n,0).valueOf(),e.get(n,1).valueOf(),n,t),s=o.x,a=o.y;r.push(a),r.push(s)}return ac(r,[_f.length,2])}(e,r);return wa(Ss(Za(e.toTensor(),el(t,"int32")),"float32"),n)}))}function Cy(e,t,r,n){return{y:n.get(e,t,r),x:n.get(e,t,r+_f.length)}}function Iy(e,t,r){return bf(this,void 0,void 0,(function(){var n,o,s,a,i,l,u,c,d,h;return xf(this,(function(p){switch(p.label){case 0:return n=0,o=function(e){var t=e.shape,r=t[0],n=t[1],o=t[2];return wc((function(){var t,s,a=Ha(e,[r*n,o]),i=Ta(a,0),l=ll(Mi(i,el(n,"int32")),1),u=ll((t=i,s=n,wc((function(){var e=Mi(t,el(s,"int32"));return Al(t,Za(e,el(s,"int32")))}))),1);return Ya([l,u],1)}))}(e),[4,Promise.all([e.buffer(),t.buffer(),o.buffer()])];case 1:return s=p.sent(),a=s[0],i=s[1],l=s[2],[4,(u=jy(l,r,i)).buffer()];case 2:return c=p.sent(),d=Array.from(function(e,t){for(var r=t.shape[0],n=new Float32Array(r),o=0;o<r;o++){var s=t.get(o,0),a=t.get(o,1);n[o]=e.get(s,a,o)}return n}(a,l)),h=d.map((function(e,t){return n+=e,{y:c.get(t,0),x:c.get(t,1),score:e,name:_f[t]}})),o.dispose(),u.dispose(),[2,{keypoints:h,score:n/h.length}]}}))}))}function Oy(e,t){return(e-1)%t==0}var Ay="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",Ry="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function Ny(e,t){return function(e,t){return(e-1)%t==0}(e,t)?e:Math.floor(e/t)*t+1}var My=function(){function e(e,t){this.posenetModel=e;var r=this.posenetModel.inputs[0].shape;B(-1===r[1]&&-1===r[2],(function(){return"Input shape ["+r[1]+", "+r[2]+"] must both be equal to or -1"}));var n,o,s=(n=t.inputResolution,o=t.outputStride,{height:Ny(n.height,o),width:Ny(n.width,o)});!function(e){B(ny.indexOf(e)>=0,(function(){return"outputStride of "+e+" is invalid. It must be either 8 or 16."}))}(t.outputStride),function(e,t){B(Oy(e.height,t),(function(){return"height of "+e.height+" is invalid for output stride "+t+"."})),B(Oy(e.width,t),(function(){return"width of "+e.width+" is invalid for output stride "+t+"."}))}(s,t.outputStride),this.inputResolution=s,this.outputStride=t.outputStride,this.architecture=t.architecture}return e.prototype.estimatePoses=function(e,t){return void 0===t&&(t=ay),bf(this,void 0,void 0,(function(){var r,n,o,s,a,i,l,u,c,d,h,p,f,m,y;return xf(this,(function(g){switch(g.label){case 0:return r=function(e){var t=e;if(null==t.maxPoses&&(t.maxPoses=1),t.maxPoses<=0)throw new Error("Invalid maxPoses "+t.maxPoses+". Should be > 0.");if(t.maxPoses>1){if((t=vf(vf({},iy),t)).scoreThreshold<0||t.scoreThreshold>1)throw new Error("Invalid scoreThreshold "+t.scoreThreshold+". Should be in range [0.0, 1.0]");if(t.nmsRadius<=0)throw new Error("Invalid nmsRadius "+t.nmsRadius+".")}return t}(t),null==e?[2,[]]:(this.maxPoses=r.maxPoses,n=Yf(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),o=n.imageTensor,s=n.padding,a="ResNet50"===this.architecture?wa(o,ly):Xf(o,[-1,1]),i=this.posenetModel.predict(a),"ResNet50"===this.architecture?(l=ec(i[2],[0]),u=ec(i[3],[0]),c=ec(i[0],[0]),d=ec(i[1],[0])):(l=ec(i[0],[0]),u=ec(i[1],[0]),c=ec(i[2],[0]),d=ec(i[3],[0])),h=Qa(u),1!==this.maxPoses?[3,2]:[4,Iy(h,l,this.outputStride)]);case 1:return f=g.sent(),p=[f],[3,4];case 2:return[4,Ey(h,l,c,d,this.outputStride,this.maxPoses,r.scoreThreshold,r.nmsRadius)];case 3:p=g.sent(),g.label=4;case 4:return m=Ff(e),y=function(e,t,r,n){var o=t.height,s=t.width,a=o/(r.height*(1-n.top-n.bottom)),i=s/(r.width*(1-n.left-n.right)),l=-n.top*r.height,u=-n.left*r.width;if(1===i&&1===a&&0===l&&0===u)return e;for(var c=0,d=e;c<d.length;c++)for(var h=0,p=d[c].keypoints;h<p.length;h++){var f=p[h];f.x=(f.x+u)*i,f.y=(f.y+l)*a}return e}(p,m,this.inputResolution,s),r.flipHorizontal&&(y=function(e,t){for(var r=0,n=e;r<n.length;r++)for(var o=0,s=n[r].keypoints;o<s.length;o++){var a=s[o];a.x=t.width-1-a.x}return e}(y,m)),o.dispose(),a.dispose(),_c(i),l.dispose(),u.dispose(),c.dispose(),d.dispose(),h.dispose(),[2,y]}}))}))},e.prototype.dispose=function(){this.posenetModel.dispose()},e.prototype.reset=function(){},e}();function Py(e){return void 0===e&&(e=ey),bf(this,void 0,void 0,(function(){var t,r,n,o,s;return xf(this,(function(a){switch(a.label){case 0:return"ResNet50"!==(t=function(e){var t=e||ey;if(null==t.architecture&&(t.architecture="MobileNetV1"),ty.indexOf(t.architecture)<0)throw new Error("Invalid architecture "+t.architecture+". Should be one of "+ty);if(null==t.inputResolution&&(t.inputResolution={height:257,width:257}),null==t.outputStride&&(t.outputStride=16),ry[t.architecture].indexOf(t.outputStride)<0)throw new Error("Invalid outputStride "+t.outputStride+". Should be one of "+ry[t.architecture]+" for architecture "+t.architecture+".");if(null==t.multiplier&&(t.multiplier=1),oy[t.architecture].indexOf(t.multiplier)<0)throw new Error("Invalid multiplier "+t.multiplier+". Should be one of "+oy[t.architecture]+" for architecture "+t.architecture+".");if(null==t.quantBytes&&(t.quantBytes=4),sy.indexOf(t.quantBytes)<0)throw new Error("Invalid quantBytes "+t.quantBytes+". Should be one of "+sy+" for architecture "+t.architecture+".");if("MobileNetV1"===t.architecture&&32===t.outputStride&&1!==t.multiplier)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return t}(e)).architecture?[3,2]:(i=t.outputStride,l=t.quantBytes,u="model-stride"+i+".json",r=4===l?Ry+"float/"+u:Ry+"quant"+l+"/"+u,[4,mf(t.modelUrl||r)]);case 1:return n=a.sent(),[2,new My(n,t)];case 2:return o=function(e,t,r){var n={1:"100",.75:"075",.5:"050"},o="model-stride"+e+".json";return 4===r?Ay+"float/"+n[t]+"/"+o:Ay+"quant"+r+"/"+n[t]+"/"+o}(t.outputStride,t.multiplier,t.quantBytes),[4,mf(t.modelUrl||o)];case 3:return s=a.sent(),[2,new My(s,t)]}var i,l,u}))}))}var Ly={keypointsToNormalizedKeypoints:um};const Dy={},Fy={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function $y(e,t){if(!(e in Dy)||null!=t){const r=function(e,t){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const r=null==t?function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e):t;return r.addEventListener("webglcontextlost",(t=>{t.preventDefault(),delete Dy[e]}),!1),be().getBool("SOFTWARE_WEBGL_ENABLED")&&(Fy.failIfMajorPerformanceCaveat=!1),1===e?r.getContext("webgl",Fy)||r.getContext("experimental-webgl",Fy):r.getContext("webgl2",Fy)}(e,t);if(null===r)return console.log("Could not get context for WebGL version",e),null;Dy[e]=r}const r=Dy[e];return null==r||r.isContextLost()?(delete Dy[e],$y(e)):(r.disable(r.DEPTH_TEST),r.disable(r.STENCIL_TEST),r.disable(r.BLEND),r.disable(r.DITHER),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SAMPLE_COVERAGE),r.enable(r.SCISSOR_TEST),r.enable(r.CULL_FACE),r.cullFace(r.BACK),Dy[e])}var By,Uy,Vy;function Gy(e,t){return[t,e]}function zy(e){const t=z(e);return q(Math.ceil(t/4))}function Wy(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function Hy(e,t){const r=e;let n,o,s,a,i,l,u,c,d,h;return 2===be().getNumber("WEBGL_VERSION")?(n=r.R32F,o=r.R16F,s=r.RGBA16F,a=r.RGBA32F,i=r.RED,u=4,c=1,d=r.HALF_FLOAT,h=r.FLOAT,l=r.RGBA8):(n=e.RGBA,o=e.RGBA,s=e.RGBA,a=r.RGBA,i=e.RGBA,u=4,c=4,d=null!=t?t.HALF_FLOAT_OES:null,h=e.FLOAT,l=e.RGBA),{internalFormatFloat:n,internalFormatHalfFloat:o,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:a,textureFormatFloat:i,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:h}}function qy(e,t){const r=t();return be().getBool("DEBUG")&&function(e){const t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${t}`}}(e,t))}(e),r}function Xy(e){return!!(be().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function Yy(e,t){return og(e,(()=>e.getExtension(t)),'Extension "'+t+'" not supported on this browser.')}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(By||(By={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Uy||(Uy={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Vy||(Vy={}));const Ky=/ERROR: [0-9]+:([0-9]+):/g;function Zy(e,t){const r=Ky.exec(t);if(null==r)return console.log(`Couldn't parse line number in error: ${t}`),void console.log(e);const n=+r[1],o=e.split("\n"),s=o.length.toString().length+2,a=o.map(((e,t)=>X((t+1).toString(),s)+e));let i=0;for(let e=0;e<a.length;e++)i=Math.max(a[e].length,i);const l=a.slice(0,n-1),u=a.slice(n-1,n),c=a.slice(n);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log(`%c ${X(u[0],i)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join("\n"))}function Qy(e,t){if(qy(e,(()=>e.validateProgram(t))),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function Jy(e,t,r,n,o,s,a){const i=e.getAttribLocation(t,r);return-1!==i&&(qy(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,n))),qy(e,(()=>e.vertexAttribPointer(i,o,e.FLOAT,!1,s,a))),qy(e,(()=>e.enableVertexAttribArray(i))),!0)}function eg(e,t,r,n){qy(e,(()=>function(e,t,r){(function(e,t){const r=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,n=t+e.TEXTURE0;if(n<e.TEXTURE0||n>r)throw new Error(`textureUnit must be in [gl.TEXTURE0, gl.TEXTURE${r}].`)})(e,r),qy(e,(()=>e.activeTexture(e.TEXTURE0+r))),qy(e,(()=>e.bindTexture(e.TEXTURE_2D,t)))}(e,t,n))),qy(e,(()=>e.uniform1i(r,n)))}function tg(e,t,r){qy(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,r))),qy(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)))}function rg(e,t){qy(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,t))),qy(e,(()=>e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)))}function ng(e){const t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${t}`}}(e,t))}function og(e,t,r){const n=qy(e,(()=>t()));if(null==n)throw new Error(r);return n}function sg(e,t=2){return z(e.slice(0,e.length-t))}function ag(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function ig(e){let t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[sg(e),...ag(e)]),t}function lg(e){return e%2==0}function ug(e,t){if(W(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){const r=e.slice(-1)[0],n=t.slice(-1)[0];if(r===n)return!0;if(lg(r)&&lg(n)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&lg(e[0])&&lg(t[0])}let cg,dg;function hg(e,t){return null!=e.getExtension(t)}function pg(e){try{if(null!=$y(e))return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function fg(e){const t=Hy(e),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);const n=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,n),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);const o=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(n),o}function mg(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&B("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the WebGL backend.`))}))}const yg=be();function gg(){let e,t,r,n,o,s,a,i,l,u;return 2===be().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",r="out",n="in",o="texture",s="outputColor",a="out vec4 outputColor;",i=be().getBool("WEBGL2_ISNAN_CUSTOM")?"\n      bool isnan_custom(float val) {\n        uint floatToUint = floatBitsToUint(val);\n        return (floatToUint & 0x7fffffffu) > 0x7f800000u;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ":"",l="",u="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",r="varying",n="varying",o="texture2D",s="gl_FragColor",a="",i="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",l="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",u="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:r,varyingFs:n,texture2D:o,output:s,defineOutput:a,defineSpecialNaN:i,defineSpecialInf:l,defineRound:u}}function vg(e,t,r="index"){const n=ie(t);return n.map(((t,o)=>`int ${e[o]} = ${r} / ${t}; ${o===n.length-1?`int ${e[o+1]} = ${r} - ${e[o]} * ${t}`:`index -= ${e[o]} * ${t}`};`)).join("")}function bg(e,t,r="index"){const n=ie(t);return n.map(((t,o)=>`int ${e[o]} = ${r} / outShapeStrides[${o}]; ${o===n.length-1?`int ${e[o+1]} = ${r} - ${e[o]} * outShapeStrides[${o}]`:`index -= ${e[o]} * outShapeStrides[${o}]`};`)).join("")}function xg(e){const t=ie(e).map((e=>e.toString()));return`\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ${t[0]} + coords.y * ${t[1]} + coords.z;\n  }\n`}yg.registerFlag("HAS_WEBGL",(()=>yg.getNumber("WEBGL_VERSION")>0)),yg.registerFlag("WEBGL_VERSION",(()=>pg(2)?2:pg(1)?1:0)),yg.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(()=>!1)),yg.registerFlag("WEBGL_BUFFER_SUPPORTED",(()=>2===yg.get("WEBGL_VERSION"))),yg.registerFlag("WEBGL_CPU_FORWARD",(()=>!0)),yg.registerFlag("WEBGL_FORCE_F16_TEXTURES",(()=>!1)),yg.registerFlag("WEBGL_PACK",(()=>yg.getBool("HAS_WEBGL"))),yg.registerFlag("WEBGL_PACK_NORMALIZATION",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_PACK_CLIP",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_PACK_DEPTHWISECONV",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_PACK_REDUCE",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_LAZILY_UNPACK",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_CONV_IM2COL",(()=>yg.getBool("WEBGL_PACK"))),yg.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(()=>function(e){if(null==cg){const t=$y(e);cg=t.getParameter(t.MAX_TEXTURE_SIZE)}return cg}(yg.getNumber("WEBGL_VERSION")))),yg.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(()=>function(e){if(null==dg){const t=$y(e);dg=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,dg)}(yg.getNumber("WEBGL_VERSION")))),yg.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(()=>{const e=yg.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;let t;const r=$y(e);return t=hg(r,"EXT_disjoint_timer_query_webgl2")&&2===e?2:hg(r,"EXT_disjoint_timer_query")?1:0,t}(e)})),yg.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(()=>yg.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!ho())),yg.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(()=>function(e){if(0===e)return!1;const t=$y(e);if(1===e){if(!hg(t,"OES_texture_float"))return!1}else if(!hg(t,"EXT_color_buffer_float"))return!1;return fg(t)}(yg.getNumber("WEBGL_VERSION")))),yg.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(()=>!yg.getBool("WEBGL_FORCE_F16_TEXTURES")&&yg.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))),yg.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(()=>function(e){if(0===e)return!1;const t=$y(e);if(1!==e){if(hg(t,"EXT_color_buffer_float"))return fg(t);const e="EXT_color_buffer_half_float";if(hg(t,e)){const r=t.getExtension(e);return function(e,t){const r=Hy(e,t),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,r.internalFormatHalfFloat,1,1,0,r.textureFormatFloat,r.textureTypeHalfFloat,null);const o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);const s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!hg(t,"OES_texture_float")&&!!hg(t,"WEBGL_color_buffer_float")&&fg(t)}(yg.getNumber("WEBGL_VERSION")))),yg.registerFlag("WEBGL_FENCE_API_ENABLED",(()=>{return 2===(e=yg.getNumber("WEBGL_VERSION"))&&null!=$y(e).fenceSync;var e})),yg.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(()=>yg.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0)),yg.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(()=>-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${e}.`)})),yg.registerFlag("WEBGL_FLUSH_THRESHOLD",(()=>ho()?1:-1),(e=>{if(e<0&&-1!==e)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${e}.`)})),yg.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",(()=>128)),yg.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",(()=>!1)),yg.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",(()=>1e5)),yg.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",(()=>128)),yg.registerFlag("WEBGL_EXP_CONV",(()=>!1)),yg.registerFlag("SOFTWARE_WEBGL_ENABLED",(()=>yg.getBool("IS_TEST"))),yg.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",(()=>1/0)),yg.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",(()=>!1)),yg.registerFlag("WEBGL2_ISNAN_CUSTOM",(()=>!1));const wg="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",{getBroadcastDims:_g}=a;function Sg(e,t,r){const n=[];if(e.forEach((e=>{const t=z(e.shapeInfo.logicalShape);if(e.shapeInfo.isUniform?n.push(`uniform float ${e.name}${t>1?`[${t}]`:""};`):(n.push(`uniform sampler2D ${e.name};`),n.push(`uniform int offset${e.name};`)),r.enableShapeUniforms){const{uniformShape:t}=Ng(r.packedInputs,e.shapeInfo.logicalShape,e.shapeInfo.texShape);switch(t.length){case 1:n.push(`uniform int ${e.name}Shape;`);break;case 2:n.push(`uniform ivec2 ${e.name}Shape;`);break;case 3:n.push(`uniform ivec3 ${e.name}Shape;`);break;case 4:n.push(`uniform ivec4 ${e.name}Shape;`)}n.push(`uniform ivec2 ${e.name}TexShape;`)}})),r.enableShapeUniforms){switch(t.logicalShape.length){case 1:n.push("uniform int outShape;");break;case 2:n.push("uniform ivec2 outShape;"),n.push("uniform int outShapeStrides;");break;case 3:n.push("uniform ivec3 outShape;"),n.push("uniform ivec2 outShapeStrides;");break;case 4:n.push("uniform ivec4 outShape;"),n.push("uniform ivec3 outShapeStrides;")}n.push("uniform ivec2 outTexShape;")}r.customUniforms&&r.customUniforms.forEach((e=>{n.push(`uniform ${e.type} ${e.name}${e.arrayIndex?`[${e.arrayIndex}]`:""};`)}));const o=n.join("\n"),s=e.map((e=>function(e,t,r=!1,n){let o="";o+=r?Tg(e,n):kg(e,n);const s=e.shapeInfo.logicalShape,a=t.logicalShape;return s.length<=a.length&&(o+=r?function(e,t){const r=e.name,n=r.charAt(0).toUpperCase()+r.slice(1),o="get"+n+"AtOutCoords",s=e.shapeInfo.logicalShape.length,a=t.logicalShape.length,i=_g(e.shapeInfo.logicalShape,t.logicalShape),l=Rg(a),u=a-s;let c;const d=["x","y","z","w","u","v"];c=0===s?"":a<2&&i.length>=1?"coords = 0;":i.map((e=>`coords.${d[e+u]} = 0;`)).join("\n");let h="";h=a<2&&s>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${d[t+u]}`)).join(", ");let p="return outputValue;";const f=1===z(e.shapeInfo.logicalShape),m=1===z(t.logicalShape);if(1!==s||f||m){if(f&&!m)p=1===a?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(i.length){const e=s-2,t=s-1;i.indexOf(e)>-1&&i.indexOf(t)>-1?p="return vec4(outputValue.x);":i.indexOf(e)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":i.indexOf(t)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return`\n    vec4 ${o}() {\n      ${l} coords = getOutputCoords();\n      ${c}\n      vec4 outputValue = get${n}(${h});\n      ${p}\n    }\n  `}(e,t):function(e,t){const r=e.name,n=r.charAt(0).toUpperCase()+r.slice(1),o="get"+n+"AtOutCoords",s=t.texShape,a=e.shapeInfo.texShape,i=e.shapeInfo.logicalShape.length,l=t.logicalShape.length;if(!e.shapeInfo.isUniform&&i===l&&null==e.shapeInfo.flatOffset&&W(a,s))return`\n      float ${o}() {\n        return sampleTexture(${r}, resultUV);\n      }\n    `;const u=Rg(l),c=_g(e.shapeInfo.logicalShape,t.logicalShape),d=l-i;let h;const p=["x","y","z","w","u","v"];h=0===i?"":l<2&&c.length>=1?"coords = 0;":c.map((e=>`coords.${p[e+d]} = 0;`)).join("\n");let f="";return f=l<2&&i>0?"coords":e.shapeInfo.logicalShape.map(((e,t)=>`coords.${p[t+d]}`)).join(", "),`\n    float ${o}() {\n      ${u} coords = getOutputCoords();\n      ${h}\n      return get${n}(${f});\n    }\n  `}(e,t)),o}(e,t,r.packedInputs,r.enableShapeUniforms))).join("\n"),a=t.texShape,i=gg(),l=function(e){return`\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ${e.texture2D}(textureSampler, uv).r;\n    }\n  `}(i);let u,c,d=function(e){return`${e.version}\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ${e.varyingFs} vec2 resultUV;\n    ${e.defineOutput}\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ${e.defineSpecialNaN}\n    ${e.defineSpecialInf}\n    ${e.defineRound}\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ${Eg}\n    ${jg}\n    ${Cg}\n  `}(i);return t.isPacked?(u=function(e,t,r){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,r){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?r?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ${n[1]}.0);\n      }\n    `:1===n[1]?r?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));\n      }\n    ":`\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ${n[0]}.0);\n      }\n    `:r?"\n    int getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      return 2 * (resTexRC.x * ${n[1]} + resTexRC.y);\n    }\n  `}(0,t,r);case 2:return function(e,t,r){const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(W(e,t))return r?"\n      ivec2 getOutputCoords() {\n        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(${n[0]}, ${n[1]}));\n      }\n    `;const o=Math.ceil(e[1]/2);return r?"\n    ivec2 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n      int r = 2 * (index / ${o});\n      int c = imod(index, ${o}) * 2;\n\n      return ivec2(r, c);\n    }\n  `}(e,t,r);case 3:return function(e,t,r){if(r)return"\n    ivec3 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(e[2]/2),s=o*Math.ceil(e[1]/2);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${o});\n      int c = imod(index, ${o}) * 2;\n\n      return ivec3(b, r, c);\n    }\n  `}(e,t,r);default:return function(e,t,r){if(r)return"\n    ivec4 getOutputCoords() {\n      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(packedTexShape[0], packedTexShape[1]));\n      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;\n\n      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));\n      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));\n      int texelsInBatchN = texelsInBatch * outShape[1];\n\n      int b2 = index / texelsInBatchN;\n      index -= b2 * texelsInBatchN;\n\n      int b = index / texelsInBatch;\n      index -= b * texelsInBatch;\n\n      int r = 2 * (index / texelsInLogicalRow);\n      int c = imod(index, texelsInLogicalRow) * 2;\n\n      return ivec4(b2, b, r, c);\n    }\n  ";const n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],o=Math.ceil(e[e.length-1]/2),s=o*Math.ceil(e[e.length-2]/2);let a=s,i="",l="b, r, c";for(let t=2;t<e.length-1;t++)a*=e[e.length-t-1],i=`\n      int b${t} = index / ${a};\n      index -= b${t} * ${a};\n    `+i,l=`b${t}, `+l;return`\n    ivec${e.length} getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${n[0]}, ${n[1]}));\n      int index = resTexRC.x * ${n[1]} + resTexRC.y;\n\n      ${i}\n\n      int b = index / ${s};\n      index -= b * ${s};\n\n      int r = 2 * (index / ${o});\n      int c = imod(index, ${o}) * 2;\n\n      return ivec${e.length}(${l});\n    }\n  `}(e,t,r)}}(t.logicalShape,a,r.enableShapeUniforms),c=function(e){return`\n    void setOutput(vec4 val) {\n      ${e.output} = val;\n    }\n  `}(i)):(u=function(e,t,r){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t,r){return 1===t[0]?r?"\n      int getOutputCoords() {\n        return int(resultUV.x * float(outTexShape[1]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.x * ${t[1]}.0);\n      }\n    `:1===t[1]?r?"\n      int getOutputCoords() {\n        return int(resultUV.y * float(outTexShape[0]));\n      }\n    ":`\n      int getOutputCoords() {\n        return int(resultUV.y * ${t[0]}.0);\n      }\n    `:r?"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      return resTexRC.x * outTexShape[1] + resTexRC.y;\n    }\n  ":`\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      return resTexRC.x * ${t[1]} + resTexRC.y;\n    }\n  `}(0,t,r);case 2:return function(e,t,r){return W(e,t)?r?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(${t[0]}, ${t[1]}));\n      }\n    `:1===e[1]?r?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    `:1===e[0]?r?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(outTexShape[0], outTexShape[1]));\n        int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":`\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(${t[0]}, ${t[1]}));\n        int index = resTexRC.x * ${t[1]} + resTexRC.y;\n        return ivec2(0, index);\n      }\n    `:r?"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      int r = index / outShape[1];\n      int c = index - r * outShape[1];\n      return ivec2(r, c);\n    }\n  ":`\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      int r = index / ${e[1]};\n      int c = index - r * ${e[1]};\n      return ivec2(r, c);\n    }\n  `}(e,t,r);case 3:return function(e,t,r){if(r)return`\n  ivec3 getOutputCoords() {\n    ivec2 resTexRC = ivec2(resultUV.yx *\n                           vec2(outTexShape[0], outTexShape[1]));\n    int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n    ${bg(["r","c","d"],e)}\n    return ivec3(r, c, d);\n  }\n`;const n=vg(["r","c","d"],e);return`\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${n}\n      return ivec3(r, c, d);\n    }\n  `}(e,t,r);case 4:return function(e,t,r){if(r)return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(outTexShape[0], outTexShape[1]));\n      int index = resTexRC.x * outTexShape[1] + resTexRC.y;\n      ${bg(["r","c","d","d2"],e)}\n      return ivec4(r, c, d, d2);\n    }\n  `;const n=vg(["r","c","d","d2"],e);return`\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n      ${n}\n      return ivec4(r, c, d, d2);\n    }\n  `}(e,t,r);case 5:return function(e,t){const r=vg(["r","c","d","d2","d3"],e);return`\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${t[0]},\n                             ${t[1]}));\n\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${r}\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  `}(e,t);case 6:return function(e,t){const r=vg(["r","c","d","d2","d3","d4"],e);return`\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(${t[0]}, ${t[1]}));\n      int index = resTexRC.x * ${t[1]} + resTexRC.y;\n\n      ${r}\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  `}(e,t);default:throw new Error(`${e.length}-D output sampling is not yet supported`)}}(t.logicalShape,a,r.enableShapeUniforms),c=function(e){return`\n    void setOutput(float val) {\n      ${e.output} = vec4(val, 0, 0, 0);\n    }\n  `}(i)),r.packedInputs&&(d+=Ig),[d,l,c,o,u,s,r.userCode].join("\n")}function kg(e,t=!1){const r=e.shapeInfo.logicalShape;switch(r.length){case 0:return function(e,t){const r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`float ${n}() {return ${r};}`;const[o,s]=e.shapeInfo.texShape;if(1===o&&1===s)return`\n      float ${n}() {\n        return sampleTexture(${r}, halfCR);\n      }\n    `;const a=Og(r);if(t)return`\n    float ${n}() {\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], ${a});\n      return sampleTexture(${r}, uv);\n    }\n  `;const[i,l]=e.shapeInfo.texShape;return`\n    float ${n}() {\n      vec2 uv = uvFromFlat(${i}, ${l}, ${a});\n      return sampleTexture(${r}, uv);\n    }\n  `}(e,t);case 1:return function(e,t){const r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1);if(e.shapeInfo.isUniform)return`\n      float ${n}(int index) {\n        ${Ag(e)}\n      }\n    `;const o=e.shapeInfo.texShape,s=o[0],a=o[1];if(1===a&&1===s)return`\n      float ${n}(int index) {\n        return sampleTexture(${r}, halfCR);\n      }\n    `;const i=Og(r);return 1===a?t?`\n      float ${n}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / float(${r}TexShape[0]));\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${n}(int index) {\n        vec2 uv = vec2(0.5, (float(index + ${i}) + 0.5) / ${s}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `:1===s?t?`\n      float ${n}(int index) {\n        vec2 uv = vec2((float(index + ${i}) + 0.5) / float(${r}TexShape[1]), 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:`\n      float ${n}(int index) {\n        vec2 uv = vec2((float(index + ${i}) + 0.5) / ${a}.0, 0.5);\n        return sampleTexture(${r}, uv);\n      }\n    `:t?`\n    float ${n}(int index) {\n      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${i});\n      return sampleTexture(${r}, uv);\n    }\n  `:`\n    float ${n}(int index) {\n      vec2 uv = uvFromFlat(${s}, ${a}, index + ${i});\n      return sampleTexture(${r}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const r=e.shapeInfo.logicalShape,n=e.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape;if(null!=s&&W(r,s)){if(t)return`\n      float ${o}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);\n        return sampleTexture(${n}, uv);\n      }\n    `;const e=s[0];return`\n    float ${o}(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(${s[1]}.0, ${e}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `}const{newShape:a,keptDims:i}=Z(r),l=a;if(l.length<r.length){const r=["row","col"];return`\n      ${kg(Mg(e,l),t)}\n      float ${o}(int row, int col) {\n        return ${o}(${Pg(r,i)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${o}(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(${r[1]}, 1)));\n        ${Ag(e)}\n      }\n    `;const u=s[0],c=s[1],d=Og(n);return 1===c?t?`\n      float ${o}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${n}Shape[1], 1, 1));\n        vec2 uv = vec2(0.5, (index + 0.5) / float(${n}TexShape[0]));\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${o}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${r[1]}, 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `:1===u?t?`\n      float ${o}(int row, int col) {\n        float index = dot(vec3(row, col, ${d}), vec3(${n}Shape[1], 1, 1));\n        vec2 uv = vec2((index + 0.5) / float(${n}TexShape[1]), 0.5);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${o}(int row, int col) {\n      float index = dot(vec3(row, col, ${d}), vec3(${r[1]}, 1, 1));\n      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);\n      return sampleTexture(${n}, uv);\n    }\n  `:t?`\n      float ${o}(int row, int col) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${n}Shape[1] + col + ${d};\n        vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n  float ${o}(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ${r[1]} + col + ${d};\n    vec2 uv = uvFromFlat(${u}, ${c}, index);\n    return sampleTexture(${n}, uv);\n  }\n`}(e,t);case 3:return function(e,t){const r=e.shapeInfo.logicalShape,n=e.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),s=r[1]*r[2],a=r[2],{newShape:i,keptDims:l}=Z(r),u=i;if(u.length<r.length){const r=["row","col","depth"];return`\n        ${kg(Mg(e,u),t)}\n        float ${o}(int row, int col, int depth) {\n          return ${o}(${Pg(r,l)});\n        }\n      `}if(e.shapeInfo.isUniform)return`\n      float ${o}(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(${s}, ${a}, 1)));\n        ${Ag(e)}\n      }\n    `;const c=e.shapeInfo.texShape,d=c[0],h=c[1],p=e.shapeInfo.flatOffset;if(h===s&&null==p)return t?`\n      float ${o}(int row, int col, int depth) {\n        int stride1 = ${n}Shape[2];\n        float texR = float(row);\n        float texC = dot(vec2(col, depth), vec2(stride1, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${n}TexShape[1], ${n}TexShape[0]);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n        float ${o}(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(${a}, 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(${h}.0, ${d}.0);\n          return sampleTexture(${n}, uv);\n        }\n      `;if(h===a&&null==p)return t?`\n      float ${o}(int row, int col, int depth) {\n        float texR = dot(vec2(row, col), vec2(${n}Shape[1], 1));\n        float texC = float(depth);\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n    float ${o}(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(${r[1]}, 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);\n      return sampleTexture(${n}, uv);\n    }\n  `;const f=Og(n);return t?`\n    float ${o}(int row, int col, int depth) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int stride0 = ${n}Shape[1] * ${n}Shape[2];\n      int stride1 = ${n}Shape[2];\n      int index = row * stride0 + col * stride1 + depth + ${f};\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index);\n      return sampleTexture(${n}, uv);\n    }\n    `:`\n      float ${o}(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ${s} + col * ${a} + depth + ${f};\n        vec2 uv = uvFromFlat(${d}, ${h}, index);\n        return sampleTexture(${n}, uv);\n      }\n  `}(e,t);case 4:return function(e,t){const r=e.shapeInfo.logicalShape,n=e.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),s=r[3],a=r[2]*s,i=r[1]*a,{newShape:l,keptDims:u}=Z(r);if(l.length<r.length){const r=["row","col","depth","depth2"];return`\n      ${kg(Mg(e,l),t)}\n      float ${o}(int row, int col, int depth, int depth2) {\n        return ${o}(${Pg(r,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${o}(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(${i}, ${a}, ${s}, 1)));\n        ${Ag(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1],f=`int stride2 = ${n}Shape[3];`,m=`int stride1 = ${n}Shape[2] * stride2;`,y=`int stride0 = ${n}Shape[1] * stride1;`;if(p===i&&null==c)return t?`\n      float ${o}(int row, int col, int depth, int depth2) {\n        ${f}\n        ${m}\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(stride1, stride2, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${n}TexShape[1], ${n}TexShape[0]);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${o}(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(${a}, ${s}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;if(p===s&&null==c)return t?`\n      float ${o}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${n}Shape[1] * ${n}Shape[2], ${n}Shape[2], 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${n}TexShape[1], ${n}TexShape[0]);\n        return sampleTexture(${n}, uv);\n      }\n    `:`\n      float ${o}(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(${r[1]*r[2]}, ${r[2]}, 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${h}.0);\n        return sampleTexture(${n}, uv);\n      }\n    `;const g=Og(n);return t?`\n    float ${o}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      ${f}\n      ${m}\n      ${y}\n      int index = row * stride0 + col * stride1 +\n          depth * stride2 + depth2;\n      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${g});\n      return sampleTexture(${n}, uv);\n    }\n  `:`\n    float ${o}(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${i} + col * ${a} +\n          depth * ${s} + depth2;\n      vec2 uv = uvFromFlat(${h}, ${p}, index + ${g});\n      return sampleTexture(${n}, uv);\n    }\n  `}(e,t);case 5:return function(e){const t=e.shapeInfo.logicalShape,r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t[4],s=t[3]*o,a=t[2]*s,i=t[1]*a,{newShape:l,keptDims:u}=Z(t);if(l.length<t.length){const t=["row","col","depth","depth2","depth3"];return`\n      ${kg(Mg(e,l))}\n      float ${n}(int row, int col, int depth, int depth2, int depth3) {\n        return ${n}(${Pg(t,u)});\n      }\n    `}if(e.shapeInfo.isUniform)return`\n      float ${n}(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${i}, ${a}, ${s}, ${o})) +\n          depth3;\n        ${Ag(e)}\n      }\n    `;const c=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],p=d[1];if(p===i&&null==c)return`\n      float ${n}(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(${a}, ${s}, ${o}, 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${p}.0, ${h}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(p===o&&null==c)return`\n      float ${n}(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]},\n               ${t[2]*t[3]}, ${t[3]}, 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${p}.0, ${h}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;return`\n    float ${n}(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${i} + col * ${a} + depth * ${s} +\n          depth2 * ${o} + depth3 + ${Og(r)};\n      vec2 uv = uvFromFlat(${h}, ${p}, index);\n      return sampleTexture(${r}, uv);\n    }\n  `}(e);case 6:return function(e){const t=e.shapeInfo.logicalShape,r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),{newShape:o,keptDims:s}=Z(t);if(o.length<t.length){const t=["row","col","depth","depth2","depth3","depth4"];return`\n      ${kg(Mg(e,o))}\n      float ${n}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ${n}(${Pg(t,s)});\n      }\n    `}const a=t[5],i=t[4]*a,l=t[3]*i,u=t[2]*l,c=t[1]*u;if(e.shapeInfo.isUniform)return`\n      float ${n}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(${c}, ${u}, ${l}, ${i})) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(${a}, 1)));\n        ${Ag(e)}\n      }\n    `;const d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],f=h[1];if(f===c&&null==d)return`\n      float ${n}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(${u}, ${l}, ${i}, ${a})) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(${f}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;if(f===a&&null==d)return`\n      float ${n}(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(${t[1]*t[2]*t[3]*t[4]},\n               ${t[2]*t[3]*t[4]},\n               ${t[3]*t[4]},\n               ${t[4]})) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(${f}.0, ${p}.0);\n        return sampleTexture(${r}, uv);\n      }\n    `;return`\n    float ${n}(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ${c} + col * ${u} + depth * ${l} +\n          depth2 * ${i} + depth3 * ${a} + depth4 + ${Og(r)};\n      vec2 uv = uvFromFlat(${p}, ${f}, index);\n      return sampleTexture(${r}, uv);\n    }\n  `}(e);default:throw new Error(`${r.length}-D input sampling is not yet supported`)}}function Tg(e,t){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){const t=e.name;return`\n    vec4 ${"get"+t.charAt(0).toUpperCase()+t.slice(1)}() {\n      return ${gg().texture2D}(${t}, halfCR);\n    }\n  `}(e);case 1:return function(e,t){const r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,s=gg();if(t)return`\n    vec4 ${n}(int index) {\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      vec2 uv = packedUVfrom1D(\n        packedTexShape[0], packedTexShape[1], index);\n      return ${s.texture2D}(${r}, uv);\n    }\n  `;const a=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];return`\n    vec4 ${n}(int index) {\n      vec2 uv = packedUVfrom1D(\n        ${a[0]}, ${a[1]}, index);\n      return ${s.texture2D}(${r}, uv);\n    }\n  `}(e,t);case 2:return function(e,t){const r=e.shapeInfo.logicalShape,n=e.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape,a=s[0],i=s[1],l=gg();if(null!=s&&W(r,s))return t?`\n      vec4 ${o}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${n}TexShape[1], ${n}TexShape[0]);\n\n        return ${l.texture2D}(${n}, uv);\n      }\n    `:`\n      vec4 ${o}(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(${i}.0, ${a}.0);\n\n        return ${l.texture2D}(${n}, uv);\n      }\n    `;if(t)return`\n    vec4 ${o}(int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${n}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);\n      return ${l.texture2D}(${n}, uv);\n    }\n  `;const u=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`\n    vec4 ${o}(int row, int col) {\n      vec2 uv = packedUVfrom2D(${Math.ceil(r[1]/2)}, ${u[0]}, ${u[1]}, row, col);\n      return ${l.texture2D}(${n}, uv);\n    }\n  `}(e,t);case 3:return function(e,t){const r=e.shapeInfo.logicalShape,n=e.name,o="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e.shapeInfo.texShape,a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(1===r[0]){const n=[1,2],s=["b","row","col"];return`\n        ${Tg(Mg(e,r.slice(1)),t)}\n        vec4 ${o}(int b, int row, int col) {\n          return ${o}(${Pg(s,n)});\n        }\n      `}const i=gg();if(t)return`\n    vec4 ${o}(int b, int row, int col) {\n      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));\n      int valuesPerRow = int(ceil(float(${n}Shape[2]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[1]) / 2.0));\n      vec2 uv = packedUVfrom3D(\n        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);\n      return ${i.texture2D}(${n}, uv);\n    }\n  `;const l=a[0],u=a[1],c=Math.ceil(r[2]/2);return`\n    vec4 ${o}(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ${l}, ${u}, ${c*Math.ceil(r[1]/2)}, ${c}, b, row, col);\n      return ${i.texture2D}(${n}, uv);\n    }\n  `}(e,t);default:return function(e,t){const r=e.name,n="get"+r.charAt(0).toUpperCase()+r.slice(1),o=gg();if(t)return`\n    vec4 ${n}(int b2, int b, int row, int col) {\n      int valuesPerRow = int(ceil(float(${r}Shape[3]) / 2.0));\n      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[2]) / 2.0));\n      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);\n      texelsInBatch *= ${r}Shape[1];\n      index = b2 * texelsInBatch + index;\n      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));\n      int texR = index / packedTexShape[1];\n      int texC = index - texR * packedTexShape[1];\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${o.texture2D}(${r}, uv);\n    }\n  `;const s=e.shapeInfo.logicalShape,a=s.length,i=e.shapeInfo.texShape,l=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=l[0],c=l[1],d=Math.ceil(s[a-1]/2);let h=d*Math.ceil(s[a-2]/2),p="int b, int row, int col",f=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let e=2;e<a-1;e++)p=`int b${e}, `+p,h*=s[a-e-1],f=`b${e} * ${h} + `+f;return`\n    vec4 ${n}(${p}) {\n      int index = ${f};\n      int texR = index / ${c};\n      int texC = index - texR * ${c};\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});\n      return ${o.texture2D}(${r}, uv);\n    }\n  `}(e,t)}}const Eg="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",jg="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Cg="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ig="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Og(e){return`offset${e}`}function Ag(e){const t=e.name,r=z(e.shapeInfo.logicalShape);return r<2?`return ${t};`:`\n    for (int i = 0; i < ${r}; i++) {\n      if (i == index) {\n        return ${t}[i];\n      }\n    }\n  `}function Rg(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error(`GPU for rank ${e} is not yet supported`)}function Ng(e,t,r){const{newShape:n,keptDims:o}=Z(t),s=t.length,a=e&&3===s&&1===t[0],i=a?t.slice(1):n,l=!e&&s>1&&!W(t,r)&&n.length<s||a;return{useSqueezeShape:l,uniformShape:l?i:t,keptDims:o}}function Mg(e,t){const r=JSON.parse(JSON.stringify(e));return r.shapeInfo.logicalShape=t,r}function Pg(e,t){return t.map((t=>e[t])).join(", ")}function Lg(e,t,r){const n={},o={},s={},a=[];let i,l,u,c=null,d=null;d=e.getUniformLocation(r,"NAN",!1),1===be().getNumber("WEBGL_VERSION")&&(c=e.getUniformLocation(r,"INFINITY",!1));const h=!1;for(let a=0;a<t.variableNames.length;a++){const i=t.variableNames[a];n[i]=e.getUniformLocation(r,i,h),n[`offset${i}`]=e.getUniformLocation(r,`offset${i}`,h),t.enableShapeUniforms&&(o[`${i}Shape`]=e.getUniformLocation(r,`${i}Shape`,h),s[`${i}TexShape`]=e.getUniformLocation(r,`${i}TexShape`,h))}return t.enableShapeUniforms&&(i=e.getUniformLocation(r,"outShape",h),u=e.getUniformLocation(r,"outShapeStrides",h),l=e.getUniformLocation(r,"outTexShape",h)),t.customUniforms&&t.customUniforms.forEach(((t,n)=>{a[n]=e.getUniformLocation(r,t.name,h)})),{uniformLocations:n,customUniformLocations:a,infLoc:c,nanLoc:d,inShapesLocations:o,inTexShapesLocations:s,outShapeLocation:i,outShapeStridesLocation:u,outTexShapeLocation:l}}function Dg(e,t){if(e.length!==t.length)throw Error(`Binary was compiled with ${e.length} inputs, but was executed with ${t.length} inputs`);e.forEach(((e,r)=>{const n=e.logicalShape,o=t[r],s=o.shape;if(!W(n,s))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${n} and ${s} must match`);if(e.isUniform&&o.isUniform)return;const a=e.texShape,i=o.isUniform?null:o.texData.texShape;if(!W(a,i))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${i} must match`)}))}function Fg(e){return be().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&e<=4}class $g{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=By.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=gg();this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?bg(["r","c","d"],e):vg(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ${t.output} = result;\n      }\n    `}}class Bg{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=By.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=gg();this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length),this.userCode=`\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ${this.enableShapeUniforms?bg(["r","c","d"],e):vg(["r","c","d"],e)}\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));\n        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ${t.output} = result;\n      }\n    `}}class Ug{constructor(e){this.variableNames=["A"],this.outTexUsage=Uy.DOWNLOAD;const t=gg();this.outputShape=e,this.userCode=`\n      ${wg}\n\n      void main() {\n        float x = getAAtOutCoords();\n        ${t.output} = encode_float(x);\n      }\n    `}}class Vg{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Uy.DOWNLOAD;const t=gg();this.outputShape=e,this.userCode=`\n      ${wg}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ${t.output} = encode_float(x);\n      }\n    `}}class Gg{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=gg();this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length);let n="result";t&&(n="floor(result * 255. + 0.5)"),this.userCode=`\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":xg(e)}\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / texShape[1];\n        int c = imod(flatIndex, texShape[1]);\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n        vec4 values = ${r.texture2D}(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ${r.output} = vec4(${n}, 0., 0., 0.);\n      }\n    `}}class zg{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=gg();this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length);let n="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let t=0;t<=1;t++)for(let o=0;o<=1;o++){const s=2*t+o;n+=`\n          localCoords = coords;\n          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {\n          localCoords[2] += ${o};\n          if (localCoords[1] + ${t} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {\n            localCoords[1] += ${t};\n\n            flatIndex = getFlatIndex(localCoords);\n            offset = imod(flatIndex, 4);\n\n            flatIndex = idiv(flatIndex, 4, 1.);\n\n            int r = flatIndex / texShape[1];\n            int c = imod(flatIndex, texShape[1]);\n            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);\n            values = ${r.texture2D}(A, uv);\n\n            if (offset == 0) {\n              result[${s}] = values[0];\n            } else if (offset == 1) {\n              result[${s}] = values[1];\n            } else if (offset == 2) {\n              result[${s}] = values[2];\n            } else {\n              result[${s}] = values[3];\n            }\n          }\n        }\n        `}this.userCode=`\n        ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":xg(e)}\n\n        void main() {\n          ivec3 coords = getOutputCoords();\n\n          vec4 result = vec4(0.);\n          int flatIndex, r, c, offset;\n          ivec3 localCoords;\n          vec2 uv;\n          vec4 values;\n\n          ${n}\n\n          ${r.output} = ${o};\n        }\n    `}}function Wg(e,t,r,n,o,s){!function(e,t){const r=be().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0)throw new Error(`Requested texture size [${e}x${t}] is invalid.`);if(e>r||t>r)throw new Error(`Requested texture size [${e}x${t}] greater than WebGL maximum on this browser / GPU [${r}x${r}].`)}(t,r);const a=function(e){return og(e,(()=>e.createTexture()),"Unable to create WebGLTexture.")}(e),i=e.TEXTURE_2D;return qy(e,(()=>e.bindTexture(i,a))),qy(e,(()=>e.texParameteri(i,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE))),qy(e,(()=>e.texParameteri(i,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))),qy(e,(()=>e.texParameteri(i,e.TEXTURE_MIN_FILTER,e.NEAREST))),qy(e,(()=>e.texParameteri(i,e.TEXTURE_MAG_FILTER,e.NEAREST))),1===be().getNumber("WEBGL_VERSION")?qy(e,(()=>e.texImage2D(i,0,n,t,r,0,o,s,null))):qy(e,(()=>e.texStorage2D(i,1,n,t,r))),qy(e,(()=>e.bindTexture(e.TEXTURE_2D,null))),{texture:a,texShape:[r,t]}}function Hg(e){return e.internalFormatFloat}function qg(e){return e.internalFormatHalfFloat}function Xg(e){return e.downloadTextureFormat}function Yg(e){return e.internalFormatPackedFloat}function Kg(e){return e.internalFormatPackedHalfFloat}class Zg{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const t=be().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,function(e,t){Dy[e]=t}(t,e)):this.gl=$y(t);let r="WEBGL_color_buffer_float";const n="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),1===be().getNumber("WEBGL_VERSION")){const e="OES_texture_float",t="OES_texture_half_float";if(this.textureFloatExtension=Yy(this.gl,e),hg(this.gl,t))this.textureHalfFloatExtension=Yy(this.gl,t);else if(be().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),hg(this.gl,n))this.colorBufferHalfFloatExtension=Yy(this.gl,n);else if(be().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",hg(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!hg(this.gl,n))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(n)}this.vertexBuffer=function(e){return function(e,t){const r=og(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return qy(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),qy(e,(()=>e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW))),r}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}(this.gl),this.indexBuffer=function(e){return function(e,t){const r=og(e,(()=>e.createBuffer()),"Unable to create WebGLBuffer");return qy(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r))),qy(e,(()=>e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW))),r}(e,new Uint16Array([0,1,2,2,1,3]))}(this.gl),this.framebuffer=function(e){return og(e,(()=>e.createFramebuffer()),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=Hy(this.gl,this.textureHalfFloatExtension)}get debug(){return be().getBool("DEBUG")}dispose(){if(this.disposed)return;null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;qy(e,(()=>e.finish())),qy(e,(()=>e.bindFramebuffer(e.FRAMEBUFFER,null))),qy(e,(()=>e.deleteFramebuffer(this.framebuffer))),qy(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,null))),qy(e,(()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null))),qy(e,(()=>e.deleteBuffer(this.indexBuffer))),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,r,n){const[o,s]=Gy(t,r);return Wg(e,o,s,Hg(n),n.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,r,n){const[o,s]=Gy(t,r);return Wg(e,o,s,qg(n),n.textureFormatFloat,n.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,r,n){const[o,s]=Gy(t,r);return Wg(e,o,s,Xg(n),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),function(e,t,r){qy(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),r.data instanceof Uint8Array?2===be().getNumber("WEBGL_VERSION")?qy(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,r.width,r.height,e.RGBA,e.UNSIGNED_BYTE,r.data))):qy(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data))):2===be().getNumber("WEBGL_VERSION")?qy(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,r))):qy(e,(()=>e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r))),qy(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,n){this.throwIfDisposed(),function(e,t,r,n,o,s){let a,i,l;qy(e,(()=>e.bindTexture(e.TEXTURE_2D,t))),o instanceof Uint8Array?(a=new Uint8Array(r*n*4),i=e.UNSIGNED_BYTE,l=e.RGBA):(a=new Float32Array(r*n*4),i=e.FLOAT,l=s.internalFormatPackedFloat),a.set(o),2===be().getNumber("WEBGL_VERSION")?qy(e,(()=>e.texSubImage2D(e.TEXTURE_2D,0,0,0,r,n,e.RGBA,i,a))):qy(e,(()=>e.texImage2D(e.TEXTURE_2D,0,l,r,n,0,e.RGBA,i,a))),qy(e,(()=>e.bindTexture(e.TEXTURE_2D,null)))}(this.gl,e,t,r,n,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,r,n){const[o,s]=Wy(t,r);return Wg(e,o,s,Kg(n),e.RGBA,n.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),function(e,t,r,n){const[o,s]=Wy(t,r);return Wg(e,o,s,Yg(n),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(rg(this.gl,this.framebuffer),this.outputTexture=null),qy(this.gl,(()=>this.gl.deleteTexture(e)))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,(()=>function(e,t,r,n){const[o,s]=Gy(t,r),a=new Uint8Array(t*r*4);return qy(e,(()=>e.readPixels(0,0,o,s,n.downloadTextureFormat,e.UNSIGNED_BYTE,a))),new Float32Array(a.buffer)}(this.gl,t,r,this.textureConfig)))}downloadPackedMatrixFromBuffer(e,t,r,n,o,s){return function(e,t,r,n,o,s,a,i){const l=e,u=new Float32Array(function(e,t){const[r,n]=Wy(e,t);return r*n*4}(s,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,t),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}(this.gl,e,0,0,0,o,s,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return function(e,t,r){const n=e,o=new Float32Array(r);return n.bindBuffer(n.PIXEL_PACK_BUFFER,t),n.getBufferSubData(n.PIXEL_PACK_BUFFER,0,o),n.bindBuffer(n.PIXEL_PACK_BUFFER,null),o}(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const n=function(e,t,r,n){const o=e.createBuffer();qy(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,o)));const s=16*t*r;return qy(e,(()=>e.bufferData(e.PIXEL_PACK_BUFFER,s,e.STREAM_READ))),qy(e,(()=>e.readPixels(0,0,r,t,e.RGBA,e.FLOAT,0))),qy(e,(()=>e.bindBuffer(e.PIXEL_PACK_BUFFER,null))),o}(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),n}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(be().getBool("WEBGL_FENCE_API_ENABLED")){const n=e,o=n.fenceSync(n.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const e=n.clientWaitSync(o,0,0);return e===n.ALREADY_SIGNALED||e===n.CONDITION_SATISFIED},t=o}else be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,(()=>function(e,t,r){const n=new Float32Array(t*r*4);return qy(e,(()=>e.readPixels(0,0,r,t,e.RGBA,e.FLOAT,n))),n}(this.gl,t,r)))}createProgram(e){this.throwIfDisposed();const t=this.gl;null==this.vertexShader&&(this.vertexShader=function(e){const t=gg();return function(e,t){const r=og(e,(()=>e.createShader(e.VERTEX_SHADER)),"Unable to create vertex WebGLShader.");if(qy(e,(()=>e.shaderSource(r,t))),qy(e,(()=>e.compileShader(r))),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}(e,`${t.version}\n    precision highp float;\n    ${t.attribute} vec3 clipSpacePos;\n    ${t.attribute} vec2 uv;\n    ${t.varyingVs} vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }`)}(t));const r=function(e){return og(e,(()=>e.createProgram()),"Unable to create WebGLProgram.")}(t);return qy(t,(()=>t.attachShader(r,this.vertexShader))),qy(t,(()=>t.attachShader(r,e))),function(e,t){if(qy(e,(()=>e.linkProgram(t))),!be().get("ENGINE_COMPILE_ONLY")&&!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,r),this.debug&&Qy(t,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=function(e,t,r){return qy(e,(()=>e.bindBuffer(e.ARRAY_BUFFER,r))),Jy(e,t,"clipSpacePos",r,3,20,0)&&Jy(e,t,"uv",r,2,20,12)}(t,this.program,this.vertexBuffer)),r}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&qy(this.gl,(()=>this.gl.deleteProgram(e)))}setProgram(e){this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&Qy(this.gl,this.program),qy(this.gl,(()=>this.gl.useProgram(e)))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?function(e,t,r){return og(e,(()=>e.getUniformLocation(t,r)),'uniform "'+r+'" not present in program.')}(this.gl,e,t):function(e,t,r){return e.getUniformLocation(t,r)}(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),qy(this.gl,(()=>this.gl.getAttribLocation(e,t)))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),eg(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[n,o]=Wy(t,r);this.setOutputMatrixTextureDriver(e,n,o)}setOutputMatrixWriteRegion(e,t,r,n){this.setOutputMatrixWriteRegionDriver(r,e,n,t)}setOutputPackedMatrixWriteRegion(e,t,r,n){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){null!=this.program&&Qy(this.gl,this.program),ng(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),qy(e,(()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),qy(this.gl,(()=>this.gl.finish()))}getQueryTimerExtension(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=Yy(this.gl,2===be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(2===be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2(),r=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,r),r}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(2===be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){const e=this.gl,t=this.getQueryTimerExtensionWebGL2();return void e.endQuery(t.TIME_ELAPSED_EXT)}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await Y((()=>this.disposed||this.isQueryAvailable(e,be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")))),this.getQueryTime(e,be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(0===t)return null;if(2===t){const t=this.gl;return t.getQueryParameter(e,t.QUERY_RESULT)/1e6}{const t=this.getQueryTimerExtensionWebGL1();return t.getQueryObjectEXT(e,t.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(0===t)return!0;if(2===t){const t=this.gl,r=this.getQueryTimerExtensionWebGL2(),n=t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),n&&!this.disjoint}{const t=this.getQueryTimerExtensionWebGL1(),r=t.getQueryObjectEXT(e,t.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(t.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise((t=>{this.addItemToPoll((()=>e.isFencePassed()),(()=>t()))}))}pollItems(){const e=function(e){let t=0;for(;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((e=>e.isDoneFn)));for(let t=0;t<=e;++t){const{resolveFn:e}=this.itemsToPoll[t];e()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in be().platform&&(r=be().platform.setTimeoutCustom.bind(be().platform)),Y((()=>(this.pollItems(),0===this.itemsToPoll.length)),(()=>0),null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),tg(this.gl,e,this.framebuffer),this.debug&&ng(this.gl)}unbindTextureToFrameBuffer(){null!=this.outputTexture?(tg(this.gl,this.outputTexture,this.framebuffer),this.debug&&ng(this.gl)):rg(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const n=this.gl;tg(n,e,this.framebuffer),this.debug&&ng(n),this.outputTexture=e,qy(n,(()=>n.viewport(0,0,t,r))),qy(n,(()=>n.scissor(0,0,t,r)))}setOutputMatrixWriteRegionDriver(e,t,r,n){this.throwIfDisposed(),qy(this.gl,(()=>this.gl.scissor(e,t,r,n)))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(null==this.program)throw new Error("No GPU program is currently set.")}}function Qg(e,t){Array.isArray(e)||(e=[e]),e.forEach((e=>{null!=e&&B("complex64"!==e.dtype,(()=>`${t} does not support complex64 tensors in the CPU backend.`))}))}function Jg(e){const t=new Float32Array(e.length);for(let r=0;r<e.length;++r)t[r]=Math.abs(e[r]);return t}function ev(e){return(t,r,n,o,s)=>{const a=Xs(t,r),i=a.length,l=ie(a),u=Q(s,z(a)),c=t.length,d=r.length,h=ie(t),p=ie(r),f=Hs(t,a),m=Hs(r,a);if(f.length+m.length===0)for(let t=0;t<u.length;++t)u[t]=e(n[t%n.length],o[t%o.length]);else for(let t=0;t<u.length;++t){const r=fe(t,i,l),s=r.slice(-c);f.forEach((e=>s[e]=0));const a=pe(s,c,h),y=r.slice(-d);m.forEach((e=>y[e]=0));const g=pe(y,d,p);u[t]=e(n[a],o[g])}return[u,a]}}function tv(e){const{inputs:t,backend:r}=e,{real:n,imag:o}=t,s=r.data.get(n.dataId).values,a=r.data.get(o.dataId).values,i=r.makeTensorInfo(n.shape,"complex64");return r.data.get(i.dataId).complexTensorInfos={real:r.makeTensorInfo(n.shape,"float32",s),imag:r.makeTensorInfo(o.shape,"float32",a)},i}function rv(e,t,r="float32"){if("complex64"===r)return tv({inputs:{real:rv(e,t,"float32"),imag:rv(e,t,"float32")},backend:e});const n=de(z(t),r);return e.makeTensorInfo(t,r,n)}function nv(e){const{inputs:t,backend:r}=e,{x:n}=t;return r.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}function ov(e,t,r,n){if("int32"===n)return[t,"int32",Int32Array.from(e)];if("bool"===n){const n=jn([0],r),[o,s]=ev(((e,t)=>e!==t?1:0))(t,[],e,n,"bool");return[s,"bool",o]}throw new Error(`Error in Cast: failed to cast ${r} to ${n}`)}function sv(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{dtype:s}=n;if("complex64"===s){if("complex64"===o.dtype)return nv({inputs:{x:o},backend:r});const e=rv(r,o.shape,o.dtype),t=sv({inputs:{x:o},backend:r,attrs:{dtype:"float32"}}),n=tv({inputs:{real:t,imag:e},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(t),n}if("complex64"===o.dtype){const e=function(e){const{inputs:t,backend:r}=e,{input:n}=t,o=r.data.get(n.dataId).complexTensorInfos.real,s=r.data.get(o.dataId).values;return r.makeTensorInfo(o.shape,o.dtype,s)}({inputs:{input:o},backend:r}),t=sv({inputs:{x:e},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(e),t}if(!ee(o.dtype,s)){const e=nv({inputs:{x:o},backend:r});return{dataId:e.dataId,shape:e.shape,dtype:s}}const a=r.data.get(o.dataId).values,[i,l,u]=ov(a,o.shape,o.dtype,s);return r.makeTensorInfo(i,l,u)}function av(e,t,r,n){return null==r?({inputs:r,backend:o})=>{const{a:s,b:a}=r,i=o;Qg([s,a],e);const l=i.data.get(s.dataId).values,u=i.data.get(a.dataId).values,c="string"===s.dtype?Zh(l):l,d="string"===s.dtype?Zh(u):u,h=n||s.dtype,[p,f]=t(s.shape,a.shape,c,d,h);return i.makeTensorInfo(f,h,p)}:({inputs:e,backend:o})=>{const{a:s,b:a}=e,i=o;if("complex64"===s.dtype||"complex64"===a.dtype){const e=sv({inputs:{x:s},backend:i,attrs:{dtype:"complex64"}}),t=i.data.get(e.dataId),n=t.complexTensorInfos.real,o=t.complexTensorInfos.imag,l=i.data.get(n.dataId).values,u=i.data.get(o.dataId).values,c=sv({inputs:{x:a},backend:i,attrs:{dtype:"complex64"}}),d=i.data.get(c.dataId),h=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,f=i.data.get(h.dataId).values,m=i.data.get(p.dataId).values,[y,g,v]=r(s.shape,a.shape,l,u,f,m),b=i.makeTensorInfo(v,"float32",y),x=i.makeTensorInfo(v,"float32",g),w=tv({inputs:{real:b,imag:x},backend:i});return i.disposeIntermediateTensorInfo(e),i.disposeIntermediateTensorInfo(c),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(x),w}{const e=i.data.get(s.dataId).values,r=i.data.get(a.dataId).values,o=n||s.dtype,[l,u]=t(s.shape,a.shape,e,r,o);return i.makeTensorInfo(u,o,l)}}}function iv(e){return(t,r,n,o,s,a)=>{const i=Xs(t,r),l=z(i),u=i.length,c=ie(i),d=Q("float32",l),h=Q("float32",l),p=Hs(t,i),f=Hs(r,i),m=gh(n,o),y=gh(s,a),g=t.length,v=ie(t),b=r.length,x=ie(r);if(p.length+f.length===0)for(let t=0;t<d.length;t++){const r=t%m.length,n=t%y.length,o=e(m[2*r],m[2*r+1],y[2*n],y[2*n+1]);d[t]=o.real,h[t]=o.imag}else for(let t=0;t<d.length;t++){const r=fe(t,u,c),n=r.slice(-g);p.forEach((e=>n[e]=0));const o=pe(n,g,v),s=r.slice(-b);f.forEach((e=>s[e]=0));const a=pe(s,b,x),i=e(m[2*o],m[2*o+1],y[2*a],y[2*a+1]);d[t]=i.real,h[t]=i.imag}return[d,h,i]}}const lv=ev(((e,t)=>e+t)),uv=iv(((e,t,r,n)=>({real:e+r,imag:t+n})));function cv(e,t,r,n,o){const s=z(n),a=de(o,r);for(let r=0;r<e.length;r++){const n=e[r];if(n<0)throw new Error("Input x must be non-negative!");n>=o||(a[n]+=s>0?t[r]:1)}return a}function dv(e,t,r,n=!1){const o=e.shape[0],s=e.shape[1],a=_s([o,r],t.dtype);for(let i=0;i<o;i++)for(let o=0;o<s;o++){const s=e.get(i,o);if(s<0)throw new Error("Input x must be non-negative!");s>=r||(n?a.set(1,i,s):t.size>0?a.set(a.get(i,s)+t.get(i,o),i,s):a.set(a.get(i,s)+1,i,s))}return a}function hv(e){return(t,r,n)=>{const o=Q(r,t.length);for(let r=0;r<t.length;++r)o[r]=e(t[r],n);return o}}function pv(e,t,r){return({inputs:n,attrs:o,backend:s})=>{const{x:a}=n;if(Qg(a,e),"string"===a.dtype||"string"===r)throw new Error("unaryKernelFunc does not support string input/output");const i=s,l=i.data.get(a.dataId).values,u=z(a.shape),c=r||a.dtype,d=J(c,u);for(let e=0;e<u;++e)d[e]=t(l[e],o);return i.makeTensorInfo(a.shape,c,d)}}function fv(e,t,r){return({inputs:n,attrs:o,backend:s})=>{const{x:a}=n;if(Qg(a,e),"string"===a.dtype||"string"===r)throw new Error("unaryKernelFunc does not support string input/output");const i=s,l=i.data.get(a.dataId).values,u=r||a.dtype,c=t(l,u,o);return i.makeTensorInfo(a.shape,u,c)}}av(Ee,lv,uv);const mv=hv((e=>Math.ceil(e)));function yv(e,t,r,n){const o=J(r,z(t));if(n&&"string"!==r){let t=0;e.forEach((e=>{const r=z(e.shape);o.set(e.vals,t),t+=r}))}else{let n=0;e.forEach((e=>{const s="string"===r?Zh(e.vals):e.vals;let a=0;for(let r=0;r<e.shape[0];++r){const i=r*t[1]+n;for(let t=0;t<e.shape[1];++t)o[i+t]=s[a++]}n+=e.shape[1]}))}return o}fv(Ve,mv);const gv=ev(((e,t)=>e===t?1:0)),vv=(av(dt,gv,null,"bool"),hv((e=>Math.exp(e)))),bv=(fv(ht,vv,"float32"),hv((e=>Math.expm1(e)))),xv=(fv(ft,bv),hv((e=>Math.floor(e))));function wv(e,t,r,n,o,s,a,i,l){const u=_s([n,s],r);for(let r=0;r<n;r++){const n=[];let c=0;for(let t=0;t<o;t++){const s=e[r*o+t];c+=s*a[t],n.push(s)}if(c<0||c>=l/s)throw new Error(`Invalid indices: ${n} does not index into ${i}`);for(let e=0;e<s;e++)u.values[r*s+e]=t.get(...t.indexToLoc(c*s+e))}return u}function _v(e,t,r){const n=_s(r,e.dtype);for(let r=0;r<n.size;++r){const o=n.indexToLoc(r).slice(),s=o[0],a=o[2],i=t.locToIndex([s,a]);o[2]=t.values[i];const l=e.locToIndex(o);0<=l&&l<e.values.length&&(n.values[r]=e.values[l])}return n}fv(gt,xv);const Sv=ev(((e,t)=>e>t?1:0)),kv=(av(_t,Sv,null,"bool"),ev(((e,t)=>e>=t?1:0))),Tv=(av(St,kv,null,"bool"),ev(((e,t)=>e<t?1:0))),Ev=(av(At,Tv,null,"bool"),ev(((e,t)=>e<=t?1:0)));function jv(e,t,r){const n=(t-e)/(r-1),o=de(r,"float32");o[0]=e;for(let e=1;e<o.length;e++)o[e]=o[e-1]+n;return o}av(Rt,Ev,null,"bool");const Cv=hv((e=>Math.log(e)));function Iv(e,t,r,n){const o=Q(n,z(r));for(let r=0;r<o.length;++r){const n=r*t;let s=e[n];for(let r=0;r<t;++r){const t=e[n+r];(Number.isNaN(t)||t>s)&&(s=t)}o[r]=s}return o}fv(Mt,Cv);const Ov=ev(((e,t)=>Math.max(e,t))),Av=(av($t,Ov),ev(((e,t)=>Math.min(e,t)))),Rv=(av(zt,Av),ev(((e,t)=>e*t))),Nv=iv(((e,t,r,n)=>({real:e*r-t*n,imag:e*n+t*r})));function Mv(e,t,r){const n=En(-1,r);return Rv([],t,n,e,r)}av(qt,Rv,Nv);const Pv=ev(((e,t)=>e!==t?1:0));function Lv(e,t,r,n,o){const s=t.length,a=z(t),i=ie(t),l=ie(o),u=Q(r,z(o));for(let t=0;t<a;++t){const r=fe(t,s,i),o=new Array(r.length);for(let e=0;e<o.length;e++)o[e]=r[n[e]];u[pe(o,s,l)]=e[t]}return u}function Dv(e,t,r,n){const[o,s]=Wi(e,n),a=eo(t,"int32"),i=de(z(o),a),l=z(s);for(let e=0;e<i.length;++e){const t=e*l;let n=1;for(let e=0;e<l;++e)n*=r[t+e];i[e]=n}return{outVals:i,outShape:o,outDtype:a}}function Fv(e,t){const r=e.slice(0,t);for(;r.length<t;)r.push(1);for(let n=t;n<e.length;n++)r[t-1]*=e[n];return r}function $v(e,t,r,n,o,s,a,i){if(0===e.length)throw new Error("paramsNestedSplits must be non empty");if(0===t[0].length)throw new Error("Split tensors must not be scalars");if(function(e,t,r){e.forEach(((e,n)=>{if(e<0||e>=r){const o=fe(n,t.length,ie(t)).join(",");throw new Error(`indices[${o}] = ${e} is not in [0, ${r})`)}}))}(s,a,t[0][0]-1),0===n.length)throw new Error("params.rank must be nonzero");const l=n[0],{outSplits:u,valueSlices:c,numValues:d}=function(e,t,r,n){const o=[];let s=0;const a=t.length-1+r.length,i=new Array(a).fill(null).map((()=>[0]));!function(e,t){for(let r=0;r<e.length;++r){const n=e[r],o=r===e.length-1?t:e[r+1].length;if(0===n.length)throw new Error("Ragged splits may not be empty");if(n[0]<0)throw new Error("Ragged splits must be non-negative");if(n[n.length-1]>o)throw new Error("Ragged splits must not point past values");for(let e=1;e<n.length;++e)if(n[e-1]>n[e])throw new Error("Ragged splits must be sorted in ascending order")}}(r,n);let l=1;for(let e=0;e<t.length-1;++e){l*=t[e];const r=t[e+1];for(let t=1;t<l+1;++t)i[e].push(t*r)}for(let n=0;n<e.length;++n){let a=e[n],l=e[n]+1;for(let e=0;e<r.length;++e){const n=r[e],o=e+t.length-1;if(o>=0){const e=i[o],t=e[e.length-1]-n[a];for(let e=a;e<l;++e)i[o].push(n[e+1]+t)}a=n[a],l=n[l]}l!==a&&(o.push([a,l]),s+=l-a)}return{outSplits:i,valueSlices:o,numValues:s}}(s,a,e,l),h=function(e){const t=[];for(let r=0;r<e.length;++r){const n=J("int32",e[r].length);t.push(n),e[r].forEach(((e,t)=>n[t]=e))}return t}(u),p=function(e,t,r,n,o){const s=t.slice();s[0]=o;const a=J(r,z(s)),i=e.length;return function(e,t,r,n,o,s){const a=Fv(t,2)[1],i=Fv(s,2)[1];let l=0;for(const t of r)for(let r=t[0];r<t[1];++r){for(let t=0;t<n;++t)o[l*i+t]=e[r*a+t];++l}}(e,t,n,0===i?0:i/t[0],a,s),[a,s]}(r,n,o,c,d);return[h,p[0],p[1]]}av(Xt,Pv,null,"bool");var Bv=Yd;class Uv{constructor(e,t,r,n,o,s,a,i,l,u){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=n,this.valuesDType=o,this.defaultValue=s,this.defaultValueShape=a,this.rowPartitionValues=i,this.rowPartitionValuesShapes=l,this.rowPartitionTypes=Zd(u),this.raggedRank=Qd(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Bv.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Bv.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Bv.VALUE_ROWIDS:return Uv.getMaxWidthValueRowID(t);case Bv.ROW_SPLITS:return Uv.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Bv[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(0===t||1===t)return 0;let r=0;for(let n=0;n<t-1;++n){const t=e[n+1]-e[n];t>r&&(r=t)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(0===t)return 0;let r=0,n=e[0],o=0;for(let s=1;s<t;++s){const t=e[s];t!==n&&(n=t,o=Math.max(s-r,o),r=s)}return Math.max(t-r,o)}tensorShapeFromTensor(e,t,r=!0){if(0===t.length){if(-1===e[0])return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return Gv(e,r)}calculateOutputSize(e){const t=this.valuesShape;Jd(this.defaultValueShape,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),n=Kd(this.raggedRank,r,t);n[0]<0&&(n[0]=e);for(let e=1;e<=this.raggedRank;++e)n[e]<0&&(n[e]=this.getMaxWidth(e));return n}calculateFirstParentOutputIndex(e,t,r){const n=Math.min(e,r),o=[];let s=0;for(let e=0;e<n;++e,s+=t)o.push(s);for(let t=n;t<e;++t)o.push(-1);return B(o.length===e,(()=>"Final length of result must be equal to firstDimension.")),o}calculateOutputIndexRowSplit(e,t,r,n){const o=e.length,s=[];for(let a=0;a<o-1;++a){const o=e[a+1]-e[a];let i=Math.min(n,o),l=t[a];-1===l&&(i=0);for(let e=0;e<i;++e)s.push(l),l+=r;for(let e=0;e<o-i;++e)s.push(-1)}if(o>0&&s.length!==e[o-1])throw new Error("Invalid row split size.");return s}calculateOutputIndexValueRowID(e,t,r,n){const o=e.length,s=[];if(0===o)return[];let a=0,i=e[0];if(i>=t.length)throw new Error(`Got currentValueRowId=${i}, which is not less than ${t.length}`);let l=t[i];s.push(l);for(let u=1;u<o;++u){const o=e[u];if(o===i)l>=0&&(++a,a<n?l+=r:l=-1);else{if(a=0,i=o,o>=t.length)throw new Error(`Got nextValueRowId=${o} which is not less than ${t.length}`);l=t[o]}s.push(l)}if(s.length!==e.length)throw new Error("Invalid row ids.");return s}calculateOutputIndex(e,t,r,n){const o=this.getRowPartitionTensor(e),s=this.getRowPartitionTypeByDimension(e);switch(s){case Bv.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,r,n);case Bv.ROW_SPLITS:if(o.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(o,t,r,n);default:throw new Error(`Unsupported partition type: ${Bv[s]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(0===this.rowPartitionTypes.length)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Bv.FIRST_DIM_SIZE:return e[0];case Bv.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Bv.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Bv[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const e=this.getFirstDimensionSize(),t=this.calculateOutputSize(e),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let e=r.length-2;e>=0;--e)r[e]=r[e+1]*t[e+1];const n=Gv(t,!1),o=J(this.valuesDType,z(n));if(r[0]*t[0]>0){let s=this.calculateFirstParentOutputIndex(e,r[0],t[0]);for(let e=1;e<=this.raggedRank;++e)s=this.calculateOutputIndex(e-1,s,r[e],t[e]);this.setOutput(this.raggedRank,s,o,n)}return[n,o]}setOutput(e,t,r,n){if(0===r.length)return;const o=this.values,s=r;let a=n.slice();a=a.slice(e+1);const i=z(a),l=t.length;let u=this.defaultValue;if(u.length!==i&&1!==u.length){const e=this.defaultValueShape;wc((()=>{const t=Ha(u,e),r=ui(t,a);u=r.dataSync()}))}let c=0,d=0,h=0;for(let e=0;e<=l;++e){let n=e<l?t[e]:-1;if(n!==h){if(d<h){const e=o.subarray(c*i);Vv(s.subarray(d*i),e,(h-d)*i)}if(e>=l){const e=r.length;n=Math.floor(e/i)}if(n>h)if(1===this.defaultValue.length)s.subarray(h*i,n*i).fill(this.defaultValue[0]),h=n;else for(;n>h;)Vv(s.slice(h*i),u,i),++h;n<0?(c=e+1,d=h):(c=e,d=h,h=d+1)}else++h}}}function Vv(e,t,r){for(let n=0;n<r;n++)e[n]=t[n]}function Gv(e,t){const r=[];for(let n of e){if(n<0){if(!t)throw new Error(`Dimension ${n} must be >= 0`);if(n<-1)throw new Error(`Dimension ${n} must be >= -1`);n=-1}r.push(n)}return r}function zv(e,t,r,n,o,s,a,i,l,u){return new Uv(e,t,r,n,o,s,a,i,l,u).compute()}function Wv(e,t,r,n){if(e===t||e<t&&r<0||t<e&&r>1)return de(0,n);const o=de(Math.abs(Math.ceil((t-e)/r)),n);t<e&&1===r&&(r=-1),o[0]=e;for(let e=1;e<o.length;e++)o[e]=o[e-1]+r;return o}const Hv=hv((e=>1/Math.sqrt(e)));function qv(e,t,r,n,o,s,a,i,l,u){const c=[n/o,o],d=e.values,h=t.values;if(0===n)return _s(r,t.dtype);const p=_s(c,t.dtype);"string"==typeof l||"number"==typeof l?p.values.fill(l):"boolean"==typeof l&&p.values.fill(+l);for(let e=0;e<s;e++){const s=[];let l=0;for(let t=0;t<a;t++){const r=d[e*a+t];s.push(r),l+=r*i[t]}if(l<0||l>=n/o)throw new Error(`Invalid indices: ${s} does not index into ${r}`);for(let r=0;r<o;r++)u?p.values[l*o+r]+=h[e*o+r]:p.values[l*o+r]=0===t.rank?h[0]:h[e*o+r]}return p}fv(yr,Hv);const Xv=hv((e=>1/(1+Math.exp(-e))));function Yv(e,t,r,n,o){const s=pa(n,t,r),a=z(r),i=ie(n);if(s){const r=fa(t,i);return"string"===o?e.slice(r,r+a):e.subarray(r,r+a)}const l=_s(n,o,"string"===o?Zh(e):e),u=_s(r,o);for(let e=0;e<u.size;++e){const r=u.indexToLoc(e),n=r.map(((e,r)=>e+t[r]));u.set(l.get(...n),...r)}return"string"===o?Qh(u.values):u.values}function Kv(e,t,r,n,o,s,a){const i=t[0],l=s[0],u=new Array(l),c=new Array(i),d=t[1];if(0===l){if(0!==i)throw new Error(Lh(i));return[J(r,0),[0,d],J(o,0),u,c]}let h=!0,p=0;const f=new Array(l).fill(0);for(let t=0;t<i;++t){const r=e[t*d];if(r<0)throw new Error(Dh(t,r));if(r>=l)throw new Error(Fh(t,r,l));++f[r],h=h&&r>=p,p=r}let m=!0;for(let e=0;e<l;++e){const t=0===f[e];u[e]=t,m=m&&!t,f[e]=Math.max(f[e],1),e>0&&(f[e]+=f[e-1])}if(m&&h){const t=e,r=n;for(let e=0;e<i;++e)c[e]=e;return[t,[i,d],r,u,c]}{const t=f[l-1],s=J(r,t*d),h=J(o,t),p=new Array(l).fill(0);for(let t=0;t<i;++t){const r=e[t*d],o=p[r],a=(0===r?0:f[r-1])+o;p[r]++;for(let r=0;r<d;++r)s[a*d+r]=e[t*d+r];h[a]=n[t],c[t]=a}for(let e=0;e<l;++e)if(0===p[e]){const t=0===e?0:f[e-1];s[t*d+0]=e;for(let e=1;e<d;++e)s[t*d+e]=0;h[t]=a}return[s,[t,d],h,u,c]}}function Zv(e,t,r,n,o){const s=z(n),a=t[0],i=o.length,l=[];let u=1,c=-1;for(let e=0;e<i;++e){const t=o[e];if(-1===t){if(-1!==c)throw new Error($h(c,e));c=e,l.push(1)}else{if(t<0)throw new Error(Bh(e,t));u*=t,l.push(t)}}if(-1!==c){if(u<=0)throw new Error("reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero");const e=Math.trunc(s/u);if(u*e!==s)throw new Error(Vh(n,l));l[c]=e}if(z(l)!==s)throw new Error(Gh(n,l));const d=n.length,h=[];if(d>0){h[d-1]=1;for(let e=d-2;e>=0;--e)h[e]=h[e+1]*n[e+1]}const p=[];if(i>0){p[i-1]=1;for(let e=i-2;e>=0;--e)p[e]=p[e+1]*l[e+1]}const f=J(r,a*i);for(let t=0;t<a;++t){let r=0;for(let n=0;n<d;++n)r+=e[t*d+n]*h[n];for(let e=0;e<i;++e)f[t*i+e]=Math.trunc(r/p[e]),r%=p[e]}return[f,[a,i],l]}function Qv(e,t,r,n,o,s=!1,a=0){const i=n.length,l=[t[0],e.length/t[0]],u=l[1],c=i>0?o[i-1]+1:0;if(c<0)throw new Error("segment ids must be >= 0");const d=t.slice();d[0]=c;const h=J(r,d.reduce(((e,t)=>e*t),1));if(0===i)return c>0&&h.fill(a),[h,d];if(c<=0)throw new Error("segment ids must be >= 0");let p=0,f=1,m=0,y=o[p];for(;;){let t=0;if(f<i){if(t=o[f],y===t){++f;continue}if(y>=t)throw new Error("segment ids are not increasing")}if(y<0||y>=c)throw new Error(Hh(y,c));y>m&&h.fill(a,m*u,y*u);for(let t=p;t<f;++t){const r=n[t];if(r<0||r>=l[0])throw new Error(qh(t,n[t],l[0]));for(let t=0;t<u;t++)h[y*u+t]+=e[r*u+t]}if(s)for(let e=0;e<u;e++)h[y*u+e]/=f-p;if(p=f,++f,m=y+1,y=t,f>i)break}return m<c&&h.fill(a,m*u,c*u),[h,d]}pv(kr,(e=>1/(1+Math.exp(-e))));const Jv=hv((e=>Math.sqrt(e)));function eb(e,t,r,n){const o=_s(e,t.dtype);for(let e=0;e<o.size;e++){const s=o.indexToLoc(e),a=new Array(s.length);for(let e=0;e<a.length;e++)a[e]=s[e]*r[e]+n[e];o.set(t.get(...a),...s)}return o}pv(Er,(e=>Math.sqrt(e)));class tb{constructor(e,t,r,n,o,s){this.separator=In(e),this.nGramWidths=t,this.leftPad=In(r),this.rightPad=In(n),this.padWidth=o,this.preserveShort=s}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,n,o,s){for(let a=0;a<o;++a){const i=this.getPadWidth(s),l=Math.max(0,i-a),u=Math.max(0,i-(o-(a+1))),c=s-(l+u),d=t+(l>0?0:a-i);let h=0;h+=l*this.leftPad.length;for(let t=0;t<c;++t)h+=e[d+t].length;h+=u*this.rightPad.length,h+=(l+u+c-1)*this.separator.length,r[n+a]=new Uint8Array(h);const p=r[n+a];let f=0;const m=e=>e.forEach((e=>p[f++]=e));for(let e=0;e<l;++e)m(this.leftPad),m(this.separator);for(let t=0;t<c-1;++t)m(e[d+t]),m(this.separator);if(c>0){m(e[d+c-1]);for(let e=0;e<u;++e)m(this.separator),m(this.rightPad)}else{for(let e=0;e<u-1;++e)m(this.rightPad),m(this.separator);m(this.rightPad)}}}compute(e,t){const r=e.length,n=t.length;if(n>0){let e=t[0];if(0!==e)throw new Error(`First split value must be 0, got ${e}`);for(let o=1;o<n;++o){let n=t[o]>=e;if(n=n&&t[o]<=r,!n)throw new Error(`Invalid split value ${t[o]}, must be in [${e}, ${r}]`);e=t[o]}if(e!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${e}`)}const o=n-1,s=J("int32",n);if(0===r||0===n){const e=new Array(r);for(let e=0;e<=o;++e)s[e]=0;return[e,s]}s[0]=0;for(let e=1;e<=o;++e){const r=t[e]-t[e-1];let n=0;this.nGramWidths.forEach((e=>{n+=this.getNumNGrams(r,e)})),this.preserveShort&&r>0&&0===n&&(n=1),s[e]=s[e-1]+n}const a=new Array(s[o]);for(let r=0;r<o;++r){const n=t[r];let o=s[r];if(this.nGramWidths.forEach((s=>{const i=t[r+1]-t[r],l=this.getNumNGrams(i,s);this.createNGrams(e,n,a,o,l,s),o+=l})),this.preserveShort&&o===s[r]){const s=t[r+1]-t[r];if(0===s)continue;const i=s+2*this.padWidth,l=1;this.createNGrams(e,n,a,o,l,i)}}return[a,s]}}function rb(e,t,r,n,o,s,a,i){return new tb(r,n,o,s,a,i).compute(e,t)}function nb(e,t,r,n){if(!e.length)return;if(0===t.length){for(let t=0;t<e.length;++t)n.push(e.subarray(t,t+1));return}if(1===t.length){const o=t[0];let s=e.indexOf(o);for(;-1!==s;){const t=e.subarray(0,s);r&&0===t.length||n.push(t),s=(e=e.subarray(s+1)).indexOf(o)}return void(r&&0===e.length||n.push(e))}let o=0;for(let s=0;s<e.length+1;s++)if(s===e.length||-1!==t.indexOf(e[s])){const t=e.subarray(o,s);r&&0===t.length||n.push(t),o=s+1}}function ob(e,t,r){const n=e.length,o=[];let s=0,a=0;const i=new Array(n);for(let l=0;l<n;++l){const n=o.length;nb(e[l],t,r,o);const u=o.length-n;i[l]=u,s+=u,a=Math.max(a,u)}const l=J("int32",2*s),u=new Array(s),c=[n,a];let d=0;for(let e=0;e<n;++e)for(let t=0;t<i[e];++t)l[2*d]=e,l[2*d+1]=t,u[d]=o[d],++d;return[l,u,c]}function sb(e,t){const r=J("int32",e.length);for(let n=0;n<e.length;++n)r[n]=Tn(e[n]).modulo(t).getLowBitsUnsigned();return r}const ab=ev(((e,t)=>e-t)),ib=iv(((e,t,r,n)=>({real:e-r,imag:t-n})));function lb(e,t){const r=new Array(e.rank);for(let n=0;n<r.length;n++)r[n]=e.shape[n]*t[n];const n=_s(r,e.dtype);for(let t=0;t<n.values.length;++t){const r=n.indexToLoc(t),o=new Array(e.rank);for(let t=0;t<o.length;t++)o[t]=r[t]%e.shape[t];const s=e.locToIndex(o);n.values[t]=e.values[s]}return n}av(Br,ab,ib);const ub=(e,t)=>{const r=t.value-e.value;return 0===r?e.index-t.index:r};function cb(e,t,r=0,n=e.length-1){for(;n>r;){if(n-r>600){const o=n-r+1,s=t-r+1,a=Math.log(o),i=.5*Math.exp(2*a/3),l=.5*Math.sqrt(a*i*(o-i)/o)*Math.sign(s-o/2);cb(e,t,Math.max(r,Math.floor(t-s*i/o+l)),Math.min(n,Math.floor(t+(o-s)*i/o+l)))}const o=e[t];let s=r,a=n;for($(e,r,t),ub(e[n],o)>0&&$(e,r,n);s<a;){for($(e,s,a),s++,a--;ub(e[s],o)<0;)s+=1;for(;ub(e[a],o)>0;)a-=1}0===ub(e[r],o)?$(e,r,a):(a+=1,$(e,a,n)),a<=t&&(r=a+1),t<=a&&(n=a-1)}}function db(e,t,r,n,o){const s=t[t.length-1],[a,i]=[e.length/s,s],l=Q(r,a*n),u=Q("int32",a*n);for(let t=0;t<a;t++){const r=t*i,s=e.subarray(r,r+i);let a=new Array(s.length);s.forEach(((e,t)=>a[t]={value:e,index:t})),n<a.length&&(cb(a,n),a=a.slice(0,n)),o&&a.sort(ub);const c=t*n,d=l.subarray(c,c+n),h=u.subarray(c,c+n);for(let e=0;e<n;e++)d[e]=a[e].value,h[e]=a[e].index}const c=t.slice();return c[c.length-1]=n,[_s(c,r,l),_s(c,"int32",u)]}function hb(e,t,r,n){const o=K(t,r)[0],s=[1,r[0],1];for(let e=0;e<o;e++)s[0]*=r[e];s[1]=r[o];for(let e=o+1;e<r.length;e++)s[2]*=r[e];const a={},i=new Int32Array(r[o]),l=new Vn(s,n,e),u=[],c=1===s[0]&&1===s[2];for(let t=0;t<r[o];t++){let r;if(c)r=e[t].toString();else{const e=[];for(let r=0;r<s[0];r++)for(let n=0;n<s[2];n++)e.push(l.get(r,t,n));r=e.join(",")}if(void 0!==a[r])i[t]=a[r];else{const e=Object.keys(a).length;a[r]=e,i[t]=e,u.push(t)}}const d=s.slice();d[1]=Object.keys(a).length;const h=new Vn(d,n);u.forEach(((e,t)=>{for(let r=0;r<s[0];r++)for(let n=0;n<s[2];n++)h.set(l.get(r,e,n),r,t,n)}));const p=r.slice();return p[o]=d[1],{outputValues:h.values,outputShape:p,indices:i}}const{addImpl:pb,bincountImpl:fb,bincountReduceImpl:mb,castImpl:yb,ceilImpl:gb,concatImpl:vb,equalImpl:bb,expImpl:xb,expm1Impl:wb,floorImpl:_b,gatherNdImpl:Sb,gatherV2Impl:kb,greaterImpl:Tb,greaterEqualImpl:Eb,lessImpl:jb,lessEqualImpl:Cb,linSpaceImpl:Ib,logImpl:Ob,maxImpl:Ab,maximumImpl:Rb,minimumImpl:Nb,multiplyImpl:Mb,negImpl:Pb,notEqualImpl:Lb,prodImpl:Db,raggedGatherImpl:Fb,raggedTensorToTensorImpl:$b,rangeImpl:Bb,rsqrtImpl:Ub,scatterImpl:Vb,sigmoidImpl:Gb,simpleAbsImpl:zb,sliceImpl:Wb,sparseFillEmptyRowsImpl:Hb,sparseReshapeImpl:qb,sparseSegmentReductionImpl:Xb,sqrtImpl:Yb,stridedSliceImpl:Kb,stringNGramsImpl:Zb,stringSplitImpl:Qb,stringToHashBucketFastImpl:Jb,subImpl:ex,tileImpl:tx,topKImpl:rx,transposeImpl:nx,uniqueImpl:ox}=j;function sx(e,t){return["x","y","z","w","u","v"].slice(0,t).map((t=>`${e}.${t}`))}function ax(e,t){return 1===t?[e]:sx(e,t)}class ix{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Fg(this.outputShape.length),0===this.rank)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{const e=ax("rc",this.rank),t=Rg(this.rank),r=this.getOutOfBoundsCondition(e),n=this.getSetup(e),o=this.getOutput(e);this.userCode=`\n        void main() {\n          ${t} rc = getOutputCoords();\n\n          if(${r}) {\n            setOutput(vec4(0));\n          } else {\n            ${n}\n\n            setOutput(vec4(${o}));\n          }\n        }\n      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let n=0;n<=1;n++){let o=`${0===r?"r":"rp1"}, ${0===n?"c":"cp1"}`;for(let t=2;t<this.rank;t++)o=`${e[e.length-1-t]},`+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(1===this.rank)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(1===this.rank)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],n=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`\n      int r = ${t[0]};\n      int c = ${t[1]};\n      int rp1 = r + 1;\n      int cp1 = c + 1;\n\n      bool cEdge = cp1 >= ${r};\n      bool rEdge = rp1 >= ${n};\n    `}getOutput(e){const t=this.getSourceCoordsArr(e);return 1===this.rank?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),\n            cEdge ? 0. : getA(${t[1]}),\n            rEdge ? 0. : getA(${t[2]}),\n            rEdge || cEdge ? 0. : getA(${t[3]})`}}class lx{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length);let r="";for(let e=0;e<4;e++){let t="thisRC = rc;";e%2==1&&(t+="thisRC.z += 1;"),e>1&&(t+="thisRC.y += 1;"),r+=`\n        ${t}\n        ${e>0?"if(thisRC.y < rows && thisRC.z < cols){":""}\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[${e}] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ${e>0?"}":""}\n      `}var n,o;this.userCode=`\n      ${n=t,o=this.enableShapeUniforms,`\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ${o?function(e,t,r="index"){const n=function(e,t){const r=e.length,n=e.map((e=>`${t}[${e}]`)),o=new Array(r-1);o[r-2]=n[r-1];for(let e=r-3;e>=0;--e)o[e]=`(${o[e+1]} * ${n[e+1]})`;return o}(e.map(((e,t)=>t)),t);return n.map(((t,o)=>`int ${e[o]} = ${r} / ${n[o]}; ${o===n.length-1?`int ${e[o+1]} = ${r} - ${e[o]} * ${n[o]}`:`index -= ${e[o]} * ${n[o]}`};`)).join("")}(["r","c","d"],"inputShape"):vg(["r","c","d"],n)}\n      return ivec3(r, c, d);\n    }\n  `}\n      ${this.enableShapeUniforms?"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;\n  }\n":xg(e)}\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};\n        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};\n\n        ${r}\n\n        setOutput(result);\n      }\n    `}}class ux{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,r){const n=dx(t,r),o=hx(e,n,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const s=cx(e,n,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();const e=this.freeTextures[o].shift();return this.usedTextures[o].push(e),e}let a;return n===Vy.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):n===Vy.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):n===Vy.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):n===Vy.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):n===Vy.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),a}releaseTexture(e,t,r,n){if(null==this.freeTextures)return;const o=dx(r,n),s=hx(t,o,n);s in this.freeTextures||(this.freeTextures[s]=[]);const a=cx(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,n),i=be().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==i&&this._numBytesAllocated>i?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[s].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const l=this.usedTextures[s],u=l.indexOf(e);if(u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");l.splice(u,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(null!=this.freeTextures){for(const e in this.freeTextures)this.freeTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));for(const e in this.usedTextures)this.usedTextures[e].forEach((e=>{this.gpgpu.deleteMatrixTexture(e.texture)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function cx(e,t,r,n,o){const s=function(e,t){switch(e){case Vy.PACKED_2X2_FLOAT32:return Yg(t);case Vy.PACKED_2X2_FLOAT16:return Kg(t);case Vy.UNPACKED_FLOAT32:return Hg(t);case Vy.UNPACKED_FLOAT16:return qg(t);case Vy.PACKED_4X1_UNSIGNED_BYTE:return Xg(t);default:throw new Error(`Unknown physical texture type ${e}`)}}(t,n);let a;if(o){const[t,r]=Wy(e[0],e[1]);a=t*r}else{const[t,r]=Gy(e[0],e[1]);a=t*r}const i=function(e,t){const r=e;if(t===r.R32F)return 4;if(t===r.R16F)return 2;if(t===r.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===r.RGBA16F)return 8;if(t===r.RGBA8)return 4;throw new Error(`Unknown internal format ${t}`)}(r,s);return a*i}function dx(e,t){if(e===Uy.UPLOAD)return Vy.PACKED_2X2_FLOAT32;if(e===Uy.RENDER||null==e)return function(e){return be().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Vy.PACKED_2X2_FLOAT32:Vy.UNPACKED_FLOAT32:e?Vy.PACKED_2X2_FLOAT16:Vy.UNPACKED_FLOAT16}(t);if(e===Uy.DOWNLOAD||e===Uy.PIXELS)return Vy.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${e}`)}function hx(e,t,r){return`${e[0]}_${e[1]}_${t}_${r}`}class px{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length),this.userCode=`\n      float unaryOperation(float x) {\n        ${t}\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}const fx="if (isnan(x)) return x;",mx="return x;",yx="return abs(x);",gx="return (x >= 0.0) ? x : (exp(x) - 1.0);",vx=fx+"\n  return (x < 0.0) ? 0.0 : x;\n",bx=fx+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",xx="return x;",wx="return 1.0 / (1.0 + exp(-1.0 * x));",_x="return x;",Sx="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",kx="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Tx="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",Ex="return 1.0 / (1.0 + exp(-1.0 * x));";class jx{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length),this.userCode=`\n      vec4 unaryOperation(vec4 x) {\n        ${t}\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    `}}class Cx{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length);const t=e.length,r=ax("rc",t),n=Rg(t),o=function(e,t){if(1===e)return"rc";let r="";for(let n=0;n<e;n++)r+=t[n],n<e-1&&(r+=",");return r}(t,r),s=r.slice(-2),a=t<=1?"rc":`vec2(${s.join(",")})`;this.userCode=`\n      void main() {\n        ${n} rc = getOutputCoords();\n        vec4 packedInput = getA(${o});\n\n        setOutput(getChannel(packedInput, ${a}));\n      }\n    `}}const Ix=gc,Ox={},Ax=be().getNumber("CPU_HANDOFF_SIZE_THRESHOLD");class Rx extends P{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!be().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(null!=e){if(e instanceof Zg)t=e;else{const r=$y(be().getNumber("WEBGL_VERSION"),e);t=new Zg(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const e=$y(be().getNumber("WEBGL_VERSION"));t=new Zg(e),this.binaryCache=((r=be().getNumber("WEBGL_VERSION"))in Ox||(Ox[r]={}),Ox[r]),this.gpgpuCreatedLocally=!0}var r;this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new ux(this.gpgpu),this.numMBBeforeWarning=null==be().global.screen?1024:be().global.screen.height*be().global.screen.width*window.devicePixelRatio*600/1024/1024,this.texData=new M(this,xc())}nextDataId(){return Rx.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,r){if((be().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||be().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===r&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const n={id:this.nextDataId()};return this.texData.set(n,{shape:t,dtype:r,values:e,usage:Uy.UPLOAD,refCount:1}),n}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){this.texData.get(e).refCount++}decRef(e){this.texData.has(e)&&this.texData.get(e).refCount--}move(e,t,r,n,o){if(be().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===n)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:n,values:t,usage:Uy.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:n,complexTensorInfos:o,slice:s,shape:a,isPacked:i}=t;if(null!=s){let t;t=i?new jx(a,xx):new px(a,xx);const r=this.runWebGLProgram(t,[{dataId:e,shape:a,dtype:n}],n),o=this.readSync(r.dataId);return this.disposeIntermediateTensorInfo(r),o}if(null!=r)return this.convertAndCacheOnCPU(e);if("string"===n)return r;const l=null!=this.activeTimers;let u,c;return l&&(u=Cn()),c="complex64"===n?gh(this.readSync(o.real.dataId),this.readSync(o.imag.dataId)):this.getValuesFromTexture(e),l&&(this.downloadWaitMs+=Cn()-u),this.convertAndCacheOnCPU(e,c)}async read(e){if(this.pendingRead.has(e)){const t=this.pendingRead.get(e);return new Promise((e=>t.push(e)))}const t=this.texData.get(e),{values:r,shape:n,slice:o,dtype:s,complexTensorInfos:a,isPacked:i}=t;if(null!=o){let t;t=i?new jx(n,xx):new px(n,xx);const r=this.runWebGLProgram(t,[{dataId:e,shape:n,dtype:s}],s),o=this.read(r.dataId);return this.disposeIntermediateTensorInfo(r),o}if(null!=r)return this.convertAndCacheOnCPU(e);if(be().getBool("DEBUG")&&!be().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===be().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let l,u,c=null;if("complex64"!==s&&be().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);const t=this.texData.get(l.dataId);c=this.gpgpu.createBufferFromTexture(t.texture.texture,...zy(n))}if(this.pendingRead.set(e,[]),"complex64"!==s&&await this.gpgpu.createAndWaitForFence(),"complex64"===s){const e=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]);u=gh(e[0],e[1])}else if(null==c)u=this.getValuesFromTexture(e);else{const e=z(n);u=this.gpgpu.downloadFloat32MatrixFromBuffer(c,e)}if(null!=l&&this.disposeIntermediateTensorInfo(l),null!=c){const e=this.gpgpu.gl;qy(e,(()=>e.deleteBuffer(c)))}const d=this.convertAndCacheOnCPU(e,u),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach((e=>e(d))),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&xc().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,t={}){const r=this.texData.get(e),{values:n,shape:o,slice:s,dtype:a,isPacked:i,texture:l}=r;if("complex64"===a)throw new Error("Does not support reading texture for complex64 dtype.");if(null!=s){let r;r=i?new jx(o,xx):new px(o,xx);const n=this.runWebGLProgram(r,[{dataId:e,shape:o,dtype:a}],a),s=this.readToGPU(n,t);return this.disposeIntermediateTensorInfo(n),s}if(null==l)throw null!=n?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,t.customTexShape),c=xc().makeTensorFromTensorInfo(u),d=this.texData.get(u.dataId);return Object.assign({tensorRef:c},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if("string"===e.dtype)try{const r=t.map((e=>On(e)));return _s(e.shape,e.dtype,r)}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return _s(e.shape,e.dtype,t)}checkNumericalProblems(e){if(null!=e)for(let t=0;t<e.length;t++){const r=e[t];if(!Xy(r)){if(be().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`);throw Error(`The value ${r} cannot be represented on this device.`)}}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:n}=this.texData.get(e),o=z(t);if(be().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const r=this.decode(e),n=this.texData.get(r.dataId),s=this.gpgpu.downloadMatrixFromPackedTexture(n.texture.texture,...zy(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(r),s}const s=be().getBool("WEBGL_PACK")&&!0===n,a=s?ig(t):t,i=s?new Vg(a):new Ug(a),l=this.runWebGLProgram(i,[{shape:a,dtype:r,dataId:e}],"float32"),u=this.texData.get(l.dataId),c=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(l),c}timerAvailable(){return be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let n=!1;null==this.programTimersStack?(this.programTimersStack=r,n=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=G(this.activeTimers.map((e=>e.query))).filter((e=>null!=e)),s=G(this.activeTimers.map((e=>e.name))).filter((e=>null!=e));this.activeTimers=t,n&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const e=await Promise.all(o);a.kernelMs=function(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}(e),a.getExtraProfileInfo=()=>e.map(((e,t)=>({name:s[t],ms:e}))).map((e=>`${e.name}: ${e.ms}`)).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Cn(),endMs:null}}endTimer(e){return be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Cn(),e)}async getQueryTime(e){if(be().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return null!=r&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:n,usage:o,isPacked:s,slice:a}=this.texData.get(e),i=a&&a.origDataId||e,l=this.dataRefCount.get(i);l>1?this.dataRefCount.set(i,l-1):(this.dataRefCount.delete(i),null!=t&&(this.numBytesInGPU-=this.computeBytes(n,r),this.textureManager.releaseTexture(t,n,o,s)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Ax){return be().getBool("WEBGL_CPU_FORWARD")&&e.every((e=>null==this.texData.get(e.dataId).texture&&z(e.shape)<t))}getGPGPUContext(){return this.gpgpu}where(e){rn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Ix(e.shape,t)}packedUnaryOp(e,t,r){const n=new jx(e.shape,t),o=this.compileAndRun(n,[e],r);return xc().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){const t=zb(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(be().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,yx,e.dtype);const t=new px(e.shape,yx),r=this.compileAndRun(t,[e]);return xc().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let n;if("string"===t&&null!=r&&r.length>0&&ne(r[0])){const o=r.map((e=>In(e)));n=this.write(o,e,t)}else n=this.write(r,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}}makeOutput(e,t,r){return xc().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new Cx(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new ix(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const r=[sg(e.shape),...ag(e.shape)],n={dtype:e.dtype,shape:r,dataId:e.dataId},o=[sg(t),...ag(t)],s=new lx(o,r),a=[r],i=this.runWebGLProgram(s,[n],e.dtype,a,!0);return{dataId:i.dataId,shape:t,dtype:i.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:n,shape:o,dtype:s}=r;null!=t&&B(z(o)<=t[0]*t[1]*4,(()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data."));const a=ig(o);let i;i=n?new Bg(a):new $g(a);const l=[null!=t?t:zy(a)];return{dtype:s,shape:o,dataId:this.runWebGLProgram(i,[{shape:a,dtype:s,dataId:e}],s,l,!0,t).dataId}}runWebGLProgram(e,t,r,n,o=!1,s){const a=this.makeTensorInfo(e.outputShape,r),i=this.texData.get(a.dataId);if(e.packedOutput&&(i.isPacked=!0),e.outPackingScheme===By.DENSE){const t=null!=s?s:zy(e.outputShape);i.texShape=t.map((e=>2*e))}if(null!=e.outTexUsage&&(i.usage=e.outTexUsage),0===z(a.shape))return i.values=Q(a.dtype,0),a;const l=[],u=t.map((t=>{if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let r=this.texData.get(t.dataId);if(null==r.texture){if(!e.packedInputs&&z(t.shape)<=be().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:r.values};e.packedInputs&&(r.isPacked=!0,r.shape=t.shape)}if(this.uploadToGPU(t.dataId),!!r.isPacked!=!!e.packedInputs)t=r.isPacked?this.unpackTensor(t):this.packTensor(t),l.push(t),r=this.texData.get(t.dataId);else if(r.isPacked&&!ug(r.shape,t.shape)){const e=t,n=t.shape;t.shape=r.shape,t=this.packedReshape(t,n),l.push(t),r=this.texData.get(t.dataId),e.shape=n}return{shape:t.shape,texData:r,isUniform:!1}}));this.uploadToGPU(a.dataId);const c={shape:a.shape,texData:i,isUniform:!1},d=function(e,t,r){let n="";t.concat(r).forEach((t=>{const o=null!=t.texData&&null!=t.texData.slice&&t.texData.slice.flatOffset>0;if(e.enableShapeUniforms&&!t.isUniform){const s=t.texData.texShape,{useSqueezeShape:a,uniformShape:i,keptDims:l}=Ng(e.packedInputs,t.shape,s);let u="",c="",d="";if(1===i.length&&e.packedInputs){const e=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];u=`${e[0]>1}_${e[1]>1}`}else if(2!==i.length||e.packedInputs){if(i.length>2&&!e.packedInputs){const e=ie(i);d=`${e[0]===s[1]}_${e[e.length-1]===s[1]}`}}else c=`${i[0]>1}_${i[1]>1}`;const h=t.shape.length,p=2===i.length&&W(t.shape,s),f=1===z(t.shape),m=Hs(t.shape,r.shape),y=!e.packedInputs&&h===r.shape.length&&W(s,r.texData.texShape),g=e.packedInputs||i.length>2?"":`${s[0]>1}_${s[1]>1}`;n+=`${h}_${y}_${a?l:""}_${i.length}_${f}_${m}_${p}_${u}_${c}_${d}_${g}_${o}`}else{const e=t.isUniform?"uniform":t.texData.texShape;n+=`${t.shape}_${e}_${o}`}}));const o=e.userCode;let s=e.constructor.name;return s+="_"+n+"_"+o+`${be().getNumber("WEBGL_VERSION")}`,s}(e,u,c),h=this.getAndSaveBinary(d,(()=>function(e,t,r,n){const o=r.map(((e,r)=>{const n={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(n.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[r],shapeInfo:n}})),s=o.map((e=>e.shapeInfo)),a={logicalShape:n.shape,texShape:n.texData.texShape,isUniform:!1,isPacked:n.texData.isPacked,flatOffset:null},i=Sg(o,a,t),l=function(e,t){const r=og(e,(()=>e.createShader(e.FRAGMENT_SHADER)),"Unable to create fragment WebGLShader.");if(qy(e,(()=>e.shaderSource(r,t))),qy(e,(()=>e.compileShader(r))),be().get("ENGINE_COMPILE_ONLY"))return r;if(!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw Zy(t,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}(e.gl,i),u=e.createProgram(l);return be().get("ENGINE_COMPILE_ONLY")?{program:t,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:s,outShapeInfo:a,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:t,fragmentShader:l,source:i,webGLProgram:u,inShapeInfos:s,outShapeInfo:a},Lg(e,t,u))}(this.gpgpu,e,u,c))),p=null!=this.activeTimers;let f;p&&(f=this.startTimer()),be().get("ENGINE_COMPILE_ONLY")||function(e,t,r,n,o){t.program.enableShapeUniforms||(Dg(t.inShapeInfos,r),Dg([t.outShapeInfo],[n]));const s=n.texData.texture,a=n.texData.texShape;n.texData.isPacked?e.setOutputPackedMatrixTexture(s.texture,a[0],a[1]):e.setOutputMatrixTexture(s.texture,a[0],a[1]),e.setProgram(t.webGLProgram),1===be().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),r.forEach(((r,n)=>{const o=t.program.variableNames[n],s=t.uniformLocations[o],a=t.uniformLocations[`offset${o}`],i=t.inShapesLocations[`${o}Shape`],l=t.inTexShapesLocations[`${o}TexShape`];if(i){const{uniformShape:n}=Ng(t.program.packedInputs,r.shape,r.texData.texShape);switch(n.length){case 1:e.gl.uniform1iv(i,new Int32Array(n));break;case 2:e.gl.uniform2iv(i,new Int32Array(n));break;case 3:e.gl.uniform3iv(i,new Int32Array(n));break;case 4:e.gl.uniform4iv(i,new Int32Array(n))}}if(l&&e.gl.uniform2i(l,r.texData.texShape[0],r.texData.texShape[1]),null!=s)if(r.isUniform)if(z(r.shape)<2)e.gl.uniform1f(s,r.uniformValues[0]);else{let t=r.uniformValues;t instanceof Float32Array||(t=new Float32Array(t)),e.gl.uniform1fv(s,t)}else null!=r.texData.slice&&null!=a&&e.gl.uniform1i(a,r.texData.slice.flatOffset),e.setInputMatrixTexture(r.texData.texture.texture,s,n)}));const i=t.outShapeLocation;if(i)switch(n.shape.length){case 1:e.gl.uniform1iv(i,new Int32Array(n.shape));break;case 2:e.gl.uniform2iv(i,new Int32Array(n.shape));break;case 3:e.gl.uniform3iv(i,new Int32Array(n.shape));break;case 4:e.gl.uniform4iv(i,new Int32Array(n.shape))}if(t.outShapeStridesLocation){const r=ie(n.shape);switch(n.shape.length){case 2:e.gl.uniform1iv(t.outShapeStridesLocation,new Int32Array(r));break;case 3:e.gl.uniform2iv(t.outShapeStridesLocation,new Int32Array(r));break;case 4:e.gl.uniform3iv(t.outShapeStridesLocation,new Int32Array(r))}}t.outTexShapeLocation&&e.gl.uniform2i(t.outTexShapeLocation,n.texData.texShape[0],n.texData.texShape[1]),t.program.customUniforms&&o&&t.program.customUniforms.forEach(((r,n)=>{const s=t.customUniformLocations[n],a=o[n];if("float"===r.type)e.gl.uniform1fv(s,a);else if("vec2"===r.type)e.gl.uniform2fv(s,a);else if("vec3"===r.type)e.gl.uniform3fv(s,a);else if("vec4"===r.type)e.gl.uniform4fv(s,a);else if("int"===r.type)e.gl.uniform1iv(s,a);else if("ivec2"===r.type)e.gl.uniform2iv(s,a);else if("ivec3"===r.type)e.gl.uniform3iv(s,a);else{if("ivec4"!==r.type)throw Error(`uniform type ${r.type} is not supported yet.`);e.gl.uniform4iv(s,a)}})),e.executeProgram()}(this.gpgpu,h,u,c,n),l.forEach((e=>this.disposeIntermediateTensorInfo(e))),p&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));const m=be().get("WEBGL_FLUSH_THRESHOLD");if(m>0){const e=Cn();e-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=e)}if(!be().getBool("WEBGL_LAZILY_UNPACK")&&i.isPacked&&!1===o){const e=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),e}return a}compileAndRun(e,t,r,n,o=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,n,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(be().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((e=>{this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram),delete this.binaryCache[e]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return null==this.floatPrecisionValue&&(this.floatPrecisionValue=wc((()=>{if(!be().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=be().getBool("DEBUG");be().set("DEBUG",!1);const t=this.abs(el(1e-8)).dataSync()[0];if(be().set("DEBUG",e),t>0)return 32}return 16}))),this.floatPrecisionValue}epsilon(){return 32===this.floatPrecision()?1e-7:1e-4}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:n,values:o,texture:s,usage:a,isPacked:i}=t;if(null!=s)return;const l=null!=this.activeTimers;let u;l&&(u=Cn());let c=t.texShape;if(null==c&&(c=function(e,t=!1){let r=be().getNumber("WEBGL_MAX_TEXTURE_SIZE"),n=be().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");if(n===1/0&&be().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(n=r/2),t&&(r*=2,n*=2,1===(e=e.map(((t,r)=>r>=e.length-2?F(e[r]):e[r]))).length&&(e=[2,e[0]])),2!==e.length){const t=Z(e);e=t.newShape}let o=z(e),s=null;e.length<=1&&o<=r?s=[1,o]:2===e.length&&e[0]<=r&&e[1]<=r?s=e:3===e.length&&e[0]*e[1]<=r&&e[2]<=r?s=[e[0]*e[1],e[2]]:3===e.length&&e[0]<=r&&e[1]*e[2]<=r?s=[e[0],e[1]*e[2]]:4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r?s=[e[0]*e[1]*e[2],e[3]]:4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r&&(s=[e[0],e[1]*e[2]*e[3]]);const a=null!=s&&Math.max(...s)>n&&Math.min(...s)<=(t?2:1)&&Math.min(...s)>0;if(null==s||a)if(t){const t=sg(e);let r=2,n=2;e.length&&([r,n]=ag(e)),o=t*(r/2)*(n/2),s=q(o).map((e=>2*e))}else s=q(o);return s}(r,i),t.texShape=c),null!=o){const e=ig(r);let s,a=c[1],d=c[0];const h=o instanceof Uint8Array||o instanceof Uint8ClampedArray;!i&&h||([a,d]=Wy(c[0],c[1])),s=i?new zg(e,h):new Gg(e,h);const p=h?[d,a]:c,f=this.makeTensorInfo(p,n),m=this.texData.get(f.dataId);m.usage=h?Uy.PIXELS:Uy.UPLOAD,m.texShape=p,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(f.dataId),a,d,o);const y=[[d,a]],g=!0,v=this.runWebGLProgram(s,[f],n,y,g),b=this.texData.get(v.dataId);t.texShape=b.texShape,t.isPacked=b.isPacked,t.usage=b.usage,be().get("ENGINE_COMPILE_ONLY")?this.disposeData(v.dataId):(t.texture=b.texture,t.values=null,this.texData.delete(v.dataId)),this.disposeIntermediateTensorInfo(f),l&&(this.uploadWaitMs+=Cn()-u)}else{const e=this.acquireTexture(c,a,n,i);t.texture=e}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:n}=r;return this.releaseGPUData(e),null!=t&&(r.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){const r="int32"===t?new Int32Array(e.length):new Uint8Array(e.length);for(let t=0;t<r.length;++t)r[t]=Math.round(e[t]);return r}throw new Error(`Unknown dtype ${t}`)}(t,n)),r.values}acquireTexture(e,t,r,n){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){const e=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${e} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,n)}computeBytes(e,t){return e[0]*e[1]*re(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise((e=>{try{this.checkCompletion_(t),e(!0)}catch(e){throw e}}));e.push(r)}return Promise.all(e)}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await new Promise((e=>Hd((()=>e())))),this.checkCompletionAsync_(e))}checkCompletion_(e){if(!1===this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)){if(console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),!1===this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS))throw Zy(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.");throw new Error("Failed to link vertex and fragment shaders.")}return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:t,customUniformLocations:r,infLoc:n,nanLoc:o,inShapesLocations:s,inTexShapesLocations:a,outShapeLocation:i,outShapeStridesLocation:l,outTexShapeLocation:u}=Lg(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=t,e.customUniformLocations=r,e.infLoc=n,e.nanLoc=o,e.inShapesLocations=s,e.inTexShapesLocations=a,e.outShapeLocation=i,e.outShapeStridesLocation=l,e.outTexShapeLocation=u}}}Rx.nextDataId=0,po()&&function(e,t,r=1){uo.registerBackend(e,t,r)}("webgl",(()=>new Rx),2);const Nx="\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n";class Mx{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=Xs(t,r),this.enableShapeUniforms=Fg(this.outputShape.length),this.userCode=`\n      float binaryOperation(float a, float b) {\n        ${e}\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    `}}const Px="\n  result.r = isNaN.r ? NAN : result.r;\n  result.g = isNaN.g ? NAN : result.g;\n  result.b = isNaN.b ? NAN : result.b;\n  result.a = isNaN.a ? NAN : result.a;\n";class Lx{constructor(e,t,r,n=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Xs(t,r);const o=this.outputShape.length;this.enableShapeUniforms=Fg(o);let s="";if(n)if(0===o||1===z(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(s=`\n          ${Rg(o)} coords = getOutputCoords();\n        `,1===o)this.enableShapeUniforms?s+="\n            result.y = (coords + 1) >= outShape ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ":s+=`\n            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          `;else{const e=ax("coords",o);this.enableShapeUniforms?s+=`\n            bool nextRowOutOfBounds =\n              (${e[o-2]} + 1) >= outShape[${o} - 2];\n            bool nextColOutOfBounds =\n              (${e[o-1]} + 1) >= outShape[${o} - 1];\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `:s+=`\n            bool nextRowOutOfBounds =\n              (${e[o-2]} + 1) >= ${this.outputShape[o-2]};\n            bool nextColOutOfBounds =\n              (${e[o-1]} + 1) >= ${this.outputShape[o-1]};\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          `}this.userCode=`\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ${e}\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ${s}\n\n        setOutput(result);\n      }\n    `}}function Dx(e){const{inputs:t,backend:r}=e,{x:n}=t;return r.incRef(n.dataId),{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}const Fx={kernelName:kt,backendName:"webgl",kernelFunc:Dx};function $x(e){const{inputs:t,backend:r}=e,{real:n,imag:o}=t,s=r.makeTensorInfo(n.shape,"complex64"),a=r.texData.get(s.dataId),i=Dx({inputs:{x:n},backend:r}),l=Dx({inputs:{x:o},backend:r});return a.complexTensorInfos={real:i,imag:l},s}const Bx={kernelName:ze,backendName:"webgl",kernelFunc:$x},Ux="return (a < 0.) ? b * a : a;",Vx="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Gx={kernelName:Ot,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{alpha:s}=n,a=r.makeTensorInfo([],"float32",En(s,"float32")),i=be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Lx(Vx,o.shape,a.shape):new Mx(Ux,o.shape,a.shape),l=r.runWebGLProgram(i,[o,a],"float32");return r.disposeIntermediateTensorInfo(a),l}},zx="return (a < 0.) ? b * a : a;",Wx="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Hx={kernelName:rr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{x:n,alpha:o}=t,s=be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Lx(Wx,n.shape,o.shape):new Mx(zx,n.shape,o.shape);return r.runWebGLProgram(s,[n,o],"float32")}},qx="if (isnan(x)) return x;";function Xx({opSnippet:e,packedOpSnippet:t,cpuKernelImpl:r,dtype:n}){return({inputs:o,backend:s})=>{const{x:a}=o,i=s,l=n||a.dtype;if(i.shouldExecuteOnCPU([a])&&null!=r){const e=i.texData.get(a.dataId),t=r(e.values,l);return i.makeTensorInfo(a.shape,l,t)}let u;return u=be().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=t?new jx(a.shape,t):new px(a.shape,e),i.runWebGLProgram(u,[a],l)}}function Yx({opSnippet:e,packedOpSnippet:t,checkOutOfBounds:r=!1,supportsComplex:n=!1,cpuKernelImpl:o,dtype:s}){return({inputs:a,backend:i})=>{const{a:l,b:u}=a,c=i;if(n&&"complex64"===l.dtype){const t=c.texData.get(l.dataId),r=c.texData.get(u.dataId),[n,o]=[[t.complexTensorInfos.real,r.complexTensorInfos.real],[t.complexTensorInfos.imag,r.complexTensorInfos.imag]].map((t=>{const[r,n]=t,o={dataId:r.dataId,dtype:r.dtype,shape:l.shape},s={dataId:n.dataId,dtype:n.dtype,shape:u.shape},a=new Mx(e,l.shape,u.shape);return c.runWebGLProgram(a,[o,s],eo(r.dtype,n.dtype))})),s=$x({inputs:{real:n,imag:o},backend:c});return c.disposeIntermediateTensorInfo(n),c.disposeIntermediateTensorInfo(o),s}const d=s||eo(l.dtype,u.dtype);if(("string"===l.dtype||"string"===u.dtype||c.shouldExecuteOnCPU([l,u]))&&null!=o){const e=c.texData.get(l.dataId).values,t=c.texData.get(u.dataId).values,r="string"===l.dtype?Zh(e):e,n="string"===l.dtype?Zh(t):t,[s,a]=o(l.shape,u.shape,r,n,d),i=c.makeTensorInfo(a,d);return c.texData.get(i.dataId).values=s,i}let h;return h=be().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=t?new Lx(t,l.shape,u.shape,r):new Mx(e,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function Kx(e,t=!1){if("linear"===e)return t?_x:mx;if("relu"===e)return t?kx:vx;if("elu"===e)return t?Sx:gx;if("relu6"===e)return t?Tx:bx;if("prelu"===e)return t?Wx:zx;if("leakyrelu"===e)return t?Vx:Ux;if("sigmoid"===e)return t?Ex:wx;throw new Error(`Activation ${e} has not been implemented for the WebGL backend.`)}class Zx{constructor(e,t,r,n=!1,o=!1,s=!1,a=null,i=!1,l=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Fg(this.outputShape.length);const u=n?e[1]:e[2],c=Math.ceil(u/2),d=n?"i * 2, rc.y":"rc.y, i * 2",h=o?"rc.z, i * 2":"i * 2, rc.z",p=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],f=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",y="";a&&(m=i?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${a}\n        }`:l?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${a}\n        }`:`vec4 activation(vec4 x) {\n          ${a}\n        }`,y="result = activation(result);");const g=s?"result += getBiasAtOutCoords();":"";s&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),l&&this.variableNames.push("leakyreluAlpha");let v="rc.x",b="rc.x";e[0]<t[0]?v=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(b=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`\n      ${m}\n      // Don't use uniform for sharedDimensionPacked for performance.\n      const float sharedDimension = ${c}.0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ${c}; i++) {\n          int batchA = ${v};\n          int batchB = ${b};\n          vec4 a = getMatrixA(batchA, ${d});\n          vec4 b = getMatrixB(batchB, ${h});\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (${p[0]} * ${f[0]});\n          result += (${p[1]} * ${f[1]});\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ${g}\n\n        ${y}\n\n        setOutput(result);\n      }\n    `}}const Qx={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Jx{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Xs(t,r),this.userCode=`\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ${e}\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    `}}const ew="return a * b;";function tw(e){const{inputs:t,backend:r}=e,{a:n,b:o}=t,s=eo(n.dtype,o.dtype);if("complex64"===n.dtype){const e=r.texData.get(n.dataId),t=r.texData.get(o.dataId),s=new Jx(Qx.REAL,n.shape,o.shape),a=new Jx(Qx.IMAG,n.shape,o.shape),i=[{dataId:e.complexTensorInfos.real.dataId,dtype:e.complexTensorInfos.real.dtype,shape:n.shape},{dataId:e.complexTensorInfos.imag.dataId,dtype:e.complexTensorInfos.imag.dtype,shape:n.shape},{dataId:t.complexTensorInfos.real.dataId,dtype:t.complexTensorInfos.real.dtype,shape:o.shape},{dataId:t.complexTensorInfos.imag.dataId,dtype:t.complexTensorInfos.imag.dtype,shape:o.shape}],l=r.runWebGLProgram(s,i,"float32"),u=r.runWebGLProgram(a,i,"float32"),c=$x({inputs:{real:l,imag:u},backend:r});return r.disposeIntermediateTensorInfo(l),r.disposeIntermediateTensorInfo(u),c}if(r.shouldExecuteOnCPU([n,o])){const e=r.texData.get(n.dataId),t=r.texData.get(o.dataId),[a,i]=Mb(n.shape,o.shape,e.values,t.values,s),l=r.makeTensorInfo(i,s);return r.texData.get(l.dataId).values=a,l}let a;return a=be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Lx(ew,n.shape,o.shape):new Mx(ew,n.shape,o.shape),r.runWebGLProgram(a,[n,o],s)}const rw={kernelName:qt,backendName:"webgl",kernelFunc:tw};function nw(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{shape:s}=n,a=r,i=z(o.shape),l=function(e,t){let r=1,n=-1;for(let t=0;t<e.length;++t)if(e[t]>=0)r*=e[t];else if(-1===e[t]){if(-1!==n)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${n} and dim ${t}`);n=t}else if(e[t]<0)throw Error(`Shapes can not be < 0. Found ${e[t]} at dim ${t}`);if(-1===n){if(t>0&&t!==r)throw Error(`Size(${t}) must match the product of shape ${e}`);return e}if(0===r)throw Error(`Cannot infer the missing size in [${e}] when there are 0 elements`);if(t%r!=0)throw Error(`The implicit shape can't be a fractional number. Got ${t} / ${r}`);const o=e.slice();return o[n]=t/r,o}(s,i),u=z(l);B(i===u,(()=>`The new shape (${l}) has ${u} elements and the old shape (${o.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`));const c=a.texData.get(o.dataId);return!c.isPacked||ug(o.shape,l)||null!==c.texture&&ug(c.shape,l)?(a.incRef(o.dataId),{dataId:o.dataId,shape:l,dtype:o.dtype}):function(e,t,r){const n=[sg(e.shape),...ag(e.shape)],o={dtype:e.dtype,shape:n,dataId:e.dataId},s=[sg(t),...ag(t)],a=new lx(s,n),i=[n],l=r.runWebGLProgram(a,[o],e.dtype,i,!0);return{dataId:l.dataId,shape:t,dtype:l.dtype}}(o,l,a)}const ow={kernelName:cr,backendName:"webgl",kernelFunc:nw};class sw{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:n,inSize:o,outSize:s}=e;this.outputShape=[n,s];const a=4*Math.floor(r/4),i=r%4;let l="sumValue += dot(values, ones);";if(null!=t){const e=1/t;l=`sumValue += dot(values * ${H(e)?e.toPrecision(2):e}, ones);`}let u="";o%r>0&&(u=`\n        if (inIdx < 0 || inIdx >= ${o}) {\n          return 0.0;\n        }\n      `),this.userCode=`\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${u}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${a}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${l}\n        }\n\n        int inIdx = inOffset + ${a};\n        if (${1===i}) {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ${l}\n        } else if (${2===i}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ${l}\n        } else if (${3===i}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ${l}\n        }\n        setOutput(sumValue);\n      }\n    `}}class aw{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:n,inSize:o,outSize:s}=e;this.outputShape=[n,s];let a="0.0",i="";"prod"===t?a="1.0":"min"===t?(a="1.0 / 1e-20",i="min"):"max"===t&&(a="-1.0 / 1e-20",i="max");let l=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"sum"===t?l="sumValue":"prod"===t?l="prodValue":"all"===t?l="allValue":"any"===t&&(l="anyValue");const u=4*Math.floor(r/4),c=r%4;let d=`\n      if (${"sum"===t}) {\n        sumValue += dot(values, ones);\n      } else if (${"prod"===t}) {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ${i}(values, minMaxValue);\n        if (${"min"===t} || ${"max"===t}) {\n          minMaxValue = ${i}(values, minMaxValue);\n          bvec4 isNaN = isnan(values);\n          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {\n            minMaxValue = vec4(NAN);\n          }\n        }\n      }\n    `,h="vec4";"all"===t?(a="1.0",d="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(a="0.0",d="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");let p="";o%r>0&&(p=`\n        if (inIdx < 0 || inIdx >= ${o}) {\n          return initializationValue;\n        }\n      `),this.userCode=`\n      const float initializationValue = ${a};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ${p}\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${r};\n\n        vec4 minMaxValue = vec4(${a});\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ${u}; i += 4) {\n          int inIdx = inOffset + i;\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ${d}\n        }\n\n        int inIdx = inOffset + ${u};\n        if (${1===c}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${2===c}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ${d}\n        } else if (${3===c}) {\n          ${h} values = ${h}(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ${d}\n        }\n        setOutput(${l});\n      }\n    `}}function iw(e,t,r,n){const o=function(e){const t=[];for(;0===t.length||1!==t[t.length-1].outSize;){const r=t.length?t[t.length-1].outSize:e[1],n=th(r);t.push({inSize:r,windowSize:n,outSize:Math.ceil(r/n)})}return t}(e.shape);let s=e;for(let a=0;a<o.length;a++){const{inSize:i,windowSize:l,outSize:u}=o[a];let c,d;c="mean"===r?0===a?new sw({windowSize:l,inSize:i,batchSize:e.shape[0],outSize:u},i):new sw({windowSize:l,inSize:i,batchSize:e.shape[0],outSize:u}):new aw({windowSize:l,inSize:i,batchSize:e.shape[0],outSize:u},r),d=s,s=n.runWebGLProgram(c,[s],t),d.dataId!==e.dataId&&n.disposeIntermediateTensorInfo(d)}return s}class lw{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let n=0;n<r.length;n++)r[n]=e[t[n]];this.outputShape=r,this.rank=r.length;const n=Rg(this.rank),o=function(e){const t=e.length;if(t>6)throw Error(`Transpose for rank ${t} is not yet supported`);const r=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],n=new Array(t);for(let t=0;t<e.length;t++)n[e[t]]=r[t];return n.join()}(t);this.userCode=`\n    void main() {\n      ${n} resRC = getOutputCoords();\n      setOutput(getA(${o}));\n    }\n    `}}class uw{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let n=0;n<r.length;n++)r[n]=e[t[n]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const n=Rg(this.rank),o=sx("rc",this.rank),s=new Array(this.rank);for(let e=0;e<t.length;e++)s[t[e]]=o[e];const a=`vec2(${s.slice(-2).join()})`,i=`++${o[this.rank-1]} < ${r[this.rank-1]}`,l=`getChannel(getA(${s.join()}), ${a})`;this.userCode=`\n    void main() {\n      ${n} rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ${l};\n      if(${i}) {\n        result[1] = ${l};\n      }\n      --${o[this.rank-1]};\n      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {\n        result[2] = ${l};\n        if(${i}) {\n          result[3] = ${l};\n        }\n      }\n      setOutput(result);\n    }\n    `}}function cw(e,t,r){const n=be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uw(e.shape,t):new lw(e.shape,t);return r.runWebGLProgram(n,[e],e.dtype)}function dw(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s,keepDims:a}=n;return function(e,t,r,n){const o=t,s=e.shape.length,a=K(o,e.shape);let i=a;const l=Xi(i,s),u=null!=l;let c=e;u&&(c=cw(e,l,n),i=Ki(i.length,s)),qi("sum",i,s);const[d,h]=Wi(c.shape,i);let p=d;r&&(p=Hi(d,a));const f=z(h),m=nw({inputs:{x:c},attrs:{shape:[z(e.shape)/f,f]},backend:n}),y=iw(m,to(e.dtype),"sum",n),g=nw({inputs:{x:y},attrs:{shape:p},backend:n});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),u&&n.disposeIntermediateTensorInfo(c),g}(o,s,a,r)}const hw={kernelName:"Sum",backendName:"webgl",kernelFunc:dw};function pw(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{perm:s}=n,a=r,i=o.shape.length,l=new Array(i);for(let e=0;e<l.length;e++)l[e]=o.shape[s[e]];let u;if(a.shouldExecuteOnCPU([o])){const e=a.texData.get(o.dataId).values,t=nx(e,o.shape,o.dtype,s,l);u=a.makeTensorInfo(l,o.dtype),a.texData.get(u.dataId).values=t}else u=cw(o,s,a);return u}const fw={kernelName:Wr,backendName:"webgl",kernelFunc:pw},mw=1e3;function yw({a:e,b:t,transposeA:r,transposeB:n,backend:o,bias:s=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:l=null}){const u=e.shape.length,c=t.shape.length,d=r?e.shape[u-2]:e.shape[u-1],h=n?t.shape[c-1]:t.shape[c-2],p=r?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-2]:t.shape[c-1],m=e.shape.slice(0,-2),y=t.shape.slice(0,-2),g=z(m),v=z(y),b=Xs(e.shape.slice(0,-2),t.shape.slice(0,-2)).concat([p,f]);B(d===h,(()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${e.shape} and ${t.shape} and transposeA=${r} and transposeB=${n} must match.`));const x=r?[g,d,p]:[g,p,d],w=n?[v,f,h]:[v,h,f],_=nw({inputs:{x:e},backend:o,attrs:{shape:x}}),S=nw({inputs:{x:t},backend:o,attrs:{shape:w}}),k=[_,S],T=Math.max(g,v),E=r?_.shape[1]:_.shape[2],j=null!=s,C=null!=a,I="leakyrelu"===l,O=null!=l?Kx(l,!0):null;let A;if((1===p||1===f)&&E>mw&&!1===(j||C||I||null!=O)){let e=_,t=S;r&&(e=pw({inputs:{x:_},backend:o,attrs:{perm:[0,2,1]}}),k.push(e)),n&&(t=pw({inputs:{x:S},backend:o,attrs:{perm:[0,2,1]}}),k.push(t));const s=1===f;let a=e;1!==f&&(a=nw({inputs:{x:e},backend:o,attrs:{shape:[T,E,1]}}),k.push(a));const i=1===f?2:1;let l=t;s&&(l=nw({inputs:{x:t},backend:o,attrs:{shape:[T,1,E]}}),k.push(l));const u=tw({inputs:{a,b:l},backend:o});A=dw({inputs:{x:u},backend:o,attrs:{axis:i,keepDims:!0}}),k.push(u)}else{const l=eo(e.dtype,t.dtype),u=new Zx(x,w,[T,p,f],r,n,j,O,C,I),c=[_,S];if(null!=s&&c.push(s),C&&c.push(a),I){const e=o.makeTensorInfo([],"float32",En(i,"float32"));c.push(e),k.push(e)}A=o.runWebGLProgram(u,c,l)}const R=nw({inputs:{x:A},backend:o,attrs:{shape:b}});k.push(A);for(const e of k)o.disposeIntermediateTensorInfo(e);return R}const gw={kernelName:Jr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{a:o,b:s,bias:a,preluActivationWeights:i}=t,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=n;return yw({a:o,b:s,transposeA:l,transposeB:u,backend:r,bias:a,preluActivationWeights:i,leakyreluAlpha:d,activation:c})}},vw="return abs(x);",bw={kernelName:"Abs",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{x:n}=t;if(r.shouldExecuteOnCPU([n])&&"complex64"!==n.dtype){const e=r.texData.get(n.dataId),t=zb(e.values);return r.makeTensorInfo(n.shape,n.dtype,t)}let o;return o=be().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new jx(n.shape,vw):new px(n.shape,vw),r.runWebGLProgram(o,[n],n.dtype)}},xw=Xx({opSnippet:fx+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),ww={kernelName:ke,backendName:"webgl",kernelFunc:xw},_w=Xx({opSnippet:fx+"\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),Sw={kernelName:Te,backendName:"webgl",kernelFunc:_w},kw="return a + b;",Tw=Yx({opSnippet:kw,packedOpSnippet:kw,supportsComplex:!0,cpuKernelImpl:pb}),Ew={kernelName:Ee,backendName:"webgl",kernelFunc:Tw};class jw{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const r=[];this.variableNames.forEach((e=>{r.push(`float v${e} = get${e}AtOutCoords();`)}));const n=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        float result = ${n};\n        setOutput(result);\n      }\n    `}}class Cw{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map(((e,t)=>`T${t}`));const r=[];this.variableNames.forEach((e=>{r.push(`vec4 v${e} = get${e}AtOutCoords();`)}));const n=this.variableNames.map((e=>`v${e}`)).join(" + ");this.userCode=`\n      void main() {\n        ${r.join("\n        ")}\n\n        vec4 result = ${n};\n        setOutput(result);\n      }\n    `}}const Iw={kernelName:je,backendName:"webgl",kernelFunc:function e(t){const{inputs:r,backend:n}=t,o=r;if(1===o.length)return Dx({inputs:{x:o[0]},backend:n});if(o.length>be().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const t=Math.floor(o.length/2),r=e({inputs:o.slice(0,t),backend:n}),s=e({inputs:o.slice(t),backend:n});return e({inputs:[r,s],backend:n})}const s=o.map((e=>e.dtype)).reduce(((e,t)=>eo(e,t))),a=o.map((e=>e.shape)),i=be().getBool("WEBGL_PACK")?new Cw(o[0].shape,a):new jw(o[0].shape,a);return n.runWebGLProgram(i,o,s)}},Ow={kernelName:"All",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s,keepDims:a}=n,i=o.shape.length,l=K(s,o.shape);let u=l;const c=Xi(u,i);let d=o;null!=c&&(d=pw({inputs:{x:o},backend:r,attrs:{perm:c}}),u=Ki(u.length,i)),qi("all",u,i);const[h,p]=Wi(d.shape,u),f=nw({inputs:{x:d},backend:r,attrs:{shape:[-1,z(p)]}}),m=iw(f,f.dtype,"all",r);let y;return y=nw(a?{inputs:{x:m},backend:r,attrs:{shape:Hi(h,l)}}:{inputs:{x:m},backend:r,attrs:{shape:h}}),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(m),null!=c&&r.disposeIntermediateTensorInfo(d),y}},Aw={kernelName:"Any",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s,keepDims:a}=n,i=o.shape.length,l=K(s,o.shape);let u=l;const c=Xi(u,i);let d=o;null!=c&&(d=pw({inputs:{x:o},backend:r,attrs:{perm:c}}),u=Ki(u.length,i)),qi("any",u,i);const[h,p]=Wi(d.shape,u),f=nw({inputs:{x:d},backend:r,attrs:{shape:[-1,z(p)]}}),m=iw(f,f.dtype,"any",r);let y;return y=nw(a?{inputs:{x:m},backend:r,attrs:{shape:Hi(h,l)}}:{inputs:{x:m},backend:r,attrs:{shape:h}}),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(m),null!=c&&r.disposeIntermediateTensorInfo(d),y}};class Rw{constructor(e,t,r){this.variableNames=["A"];const{windowSize:n,batchSize:o,outSize:s}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,s];const a="max"===t?">":"<",i=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ${n};\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ${n}; i++) {\n          int inIdx = ${i};\n          float candidate = getA(batch, inIdx);\n          if (candidate ${a} bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    `}}class Nw{constructor(e,t,r,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(e.length>2,(()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`));const o=e[e.length-1],s=Math.ceil(o/t);this.outputShape=e.slice(0,-1),s>1&&this.outputShape.push(s),n||this.variableNames.push("bestIndicesA");const a=this.outputShape,i=a.length,l=Rg(i),u=ax("coords",i);let c,d;if(1===s){d=i+1;const e=Rg(d);c=`\n        ${e} sourceLocR = ${e}(${u.join()}, 0);\n        ++${u[i-1]};\n        ${e} sourceLocG = ${e}(${u.join()}, 0);\n        ++${u[i-2]};\n        ${e} sourceLocA = ${e}(${u.join()}, 0);\n        --${u[i-1]};\n        ${e} sourceLocB = ${e}(${u.join()}, 0);\n        --${u[i-2]};`}else d=i,c=`\n        ${l} sourceLocR = coords;\n        ++${u[i-1]};\n        ${l} sourceLocG = coords;\n        ++${u[i-2]};\n        ${l} sourceLocA = coords;\n        --${u[i-1]};\n        ${l} sourceLocB = coords;\n        --${u[i-2]};`;const h=["x","y","z","w","u","v"].slice(0,d),p="."+h[d-1],f=h.map((e=>"int "+e)),m=ax("sourceLocR",d-1).concat("inIdx.r"),y=ax("sourceLocG",d-1).concat("inIdx.g"),g=ax("sourceLocB",d-1).concat("inIdx.b"),v=ax("sourceLocA",d-1).concat("inIdx.a"),b="max"===r?"greaterThan":"lessThan",x=n?"":`\n          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),\n                             getBestIndicesAChannel(${y.join()}),\n                             getBestIndicesAChannel(${g.join()}),\n                             getBestIndicesAChannel(${v.join()})));`,w=`vec4(\n            getAChannel(${m.join()}),\n            hasNextCol ? getAChannel(${y.join()}) : 0.,\n            hasNextRow ? getAChannel(${g.join()}) : 0.,\n            hasNextRow && hasNextCol ? getAChannel(${v.join()}) : 0.)`,_=n?"":`\n      float getBestIndicesAChannel(${f.join()}) {\n        return getChannel(getBestIndicesA(${h.join()}),\n                                          vec2(${h.slice(-2).join()}));\n      }`;this.userCode=`\n      float getAChannel(${f.join()}) {\n        return getChannel(getA(${h.join()}),\n                               vec2(${h.slice(-2).join()}));\n      }\n      ${_}\n      void main() {\n        ${l} coords = getOutputCoords();\n        bool hasNextCol = ${u[i-1]} < ${a[i-1]-1};\n        bool hasNextRow = ${u[i-2]} < ${a[i-2]-1};\n        ${c}\n        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},\n          sourceLocB${p}, sourceLocA${p}) * ${t};\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ${w};\n\n        for (int i = 0; i < ${t}; i++) {\n          inIdx = srcIdx;\n          ${x}\n          vec4 candidate = ${w};\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(${b}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    `}}function Mw(e,t,r,n=null){let o=t.shape[0],s=t.shape[1];null!=n&&(o=n.shape[0],s=n.shape[1]);const a=th(s),i={windowSize:a,inSize:s,batchSize:o,outSize:Math.ceil(s/a)},l=new Rw(i,r,null==n),u=[t];null!=n&&u.push(n);const c=e.runWebGLProgram(l,u,"int32");if(1===c.shape[1])return c;const d=Mw(e,t,r,c);return e.disposeIntermediateTensorInfo(c),d}function Pw(e,t,r,n=null){const o=null!=n?n.shape:t.shape,s=th(o[o.length-1]),a=new Nw(o,s,r,null==n),i=null==n?[t]:[t,n],l=e.runWebGLProgram(a,i,"int32");if(l.shape.length===t.shape.length){const n=Pw(e,t,r,l);return e.disposeIntermediateTensorInfo(l),n}return l}function Lw(e,t,r,n){const o=[r];if(qi("arg"+n.charAt(0).toUpperCase()+n.slice(1),o,t.shape.length),!be().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){const r=[],s=e.texData.get(t.dataId);let a=t;null!==s&&s.isPacked&&(a=e.unpackTensor(t),r.push(a));const[i,l]=Wi(a.shape,o),u=z(l),c=nw({inputs:{x:a},backend:e,attrs:{shape:[-1,u]}});r.push(c);const d=Mw(e,c,n);r.push(d);const h=nw({inputs:{x:d},backend:e,attrs:{shape:i}});return r.forEach((t=>e.disposeIntermediateTensorInfo(t))),h}return Pw(e,t,n)}const Dw={kernelName:Ce,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s}=n;let a=K(s,o.shape);const i=Xi(a,o.shape.length);let l=o;const u=[];null!=i&&(l=pw({inputs:{x:o},backend:r,attrs:{perm:i}}),u.push(l),a=Ki(a.length,l.shape.length)),qi("argMax",[a[0]],l.shape.length);const c=Lw(r,l,a[0],"max");return u.forEach((e=>r.disposeIntermediateTensorInfo(e))),c}},Fw={kernelName:Ie,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s}=n;let a=K(s,o.shape);const i=Xi(a,o.shape.length);let l=o;const u=[];null!=i&&(l=pw({inputs:{x:o},backend:r,attrs:{perm:i}}),u.push(l),a=Ki(a.length,l.shape.length)),qi("argMin",[a[0]],l.shape.length);const c=Lw(r,l,a[0],"min");return u.forEach((e=>r.disposeIntermediateTensorInfo(e))),c}},$w=Xx({opSnippet:fx+"\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),Bw={kernelName:Oe,backendName:"webgl",kernelFunc:$w},Uw=Xx({opSnippet:fx+"return log(x + sqrt(x * x + 1.0));"}),Vw={kernelName:Ae,backendName:"webgl",kernelFunc:Uw},Gw=Xx({opSnippet:fx+"\n  return atan(x);\n"}),zw={kernelName:Re,backendName:"webgl",kernelFunc:Gw},Ww=Yx({opSnippet:Nx+"\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Px+"\n  return result;\n"}),Hw={kernelName:Me,backendName:"webgl",kernelFunc:Ww},qw=Xx({opSnippet:fx+"\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Xw={kernelName:Ne,backendName:"webgl",kernelFunc:qw};class Yw{constructor(e,t,r,n=!1,o=!1){if(this.variableNames=["x"],"avg"===t&&r)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,a=e.strideHeight,i=e.strideWidth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const f="avg"===t,m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let g="0.0";if(f||(g="-1.0 / 1e-20"),r){const t=">=";return void(this.userCode=`\n        const ivec2 strides = ivec2(${a}, ${i});\n        const ivec2 pads = ivec2(${h}, ${p});\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ${c};\n              wR += ${l}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${d};\n                wC += ${u}) {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ${t} currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ${n?o?m:y:`wR * ${d} + wC`};\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let v=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(v="avgValue / count");const b=4*Math.floor(s/4),x=s%4,w=`\n      if (${f}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec2 strides = ivec2(${a}, ${i});\n      const ivec2 pads = ivec2(${h}, ${p});\n      const float initializationValue = ${g};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${g});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ${c};\n            wR += ${l}) {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${b}; wC += 4) {\n            int xC = xCCorner + wC * ${u};\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              getValue(batch, xR, xC + 3 * ${u}, d)\n            );\n\n            ${w}\n          }\n\n          int xC = xCCorner + ${b};\n          if (${1===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${2===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              initializationValue,\n              initializationValue\n            );\n\n            ${w}\n          } else if (${3===x}) {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ${u}, d),\n              getValue(batch, xR, xC + 2 * ${u}, d),\n              initializationValue\n            );\n\n            ${w}\n          }\n        }\n        setOutput(${v});\n      }\n    `}}class Kw{constructor(e,t,r,n=!1,o=!1){if(this.variableNames=["x"],"avg"===t&&r)throw new Error("Cannot compute positions for average pool.");const s=e.filterWidth,a=e.strideDepth,i=e.strideHeight,l=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,d=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,f=e.effectiveFilterWidth,m=e.padInfo.front,y=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;const v="avg"===t;let b="0.0";if(v||(b="-1.0 / 1e-20"),r){const t=">=";return void(this.userCode=`\n        const ivec3 strides =\n            ivec3(${a}, ${i}, ${l});\n        const ivec3 pads = ivec3(${m}, ${y}, ${g});\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ${h};\n              wD += ${u}) {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int wR = 0; wR < ${p};\n                wR += ${c}) {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int wC = 0; wC < ${f};\n                  wC += ${d}) {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ${t} currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ${n?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${f} +\n                      wR * ${f} + wC`};\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      `)}let x=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;"avg"===t&&(x="avgValue / count");const w=4*Math.floor(s/4),_=s%4,S=`\n      if (${v}) {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    `;this.userCode=`\n      const ivec3 strides =\n        ivec3(${a}, ${i}, ${l});\n      const ivec3 pads = ivec3(${m}, ${y}, ${g});\n      const float initializationValue = ${b};\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ${e.inWidth}) {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(${b});\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ${h};\n            wD += ${u}) {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${p};\n            wR += ${c}) {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${w}; wC += 4) {\n              int xC = xCCorner + wC * ${d};\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                getValue(batch, xD, xR, xC + 3 * ${d}, ch)\n              );\n\n              ${S}\n            }\n\n            int xC = xCCorner + ${w};\n            if (${1===_}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${2===_}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ${S}\n            } else if (${3===_}) {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ${d}, ch),\n                getValue(batch, xD, xR, xC + 2 * ${d}, ch),\n                initializationValue\n              );\n\n              ${S}\n            }\n          }\n          setOutput(${x});\n        }\n      }\n    `}}const Zw={kernelName:Pe,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t;mg(o,"avgPool");const{filterSize:s,strides:a,pad:i,dimRoundingMode:l}=n;B(Ga(a,1),(()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '1'`));const u=Na(o.shape,s,a,1,i,l);if(1===u.filterWidth&&1===u.filterHeight&&W(u.inShape,u.outShape))return Dx({inputs:{x:o},backend:r});const c=new Yw(u,"avg",!1);return r.runWebGLProgram(c,[o],"float32")}},Qw={kernelName:Le,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{filterSize:s,strides:a,pad:i,dimRoundingMode:l,dataFormat:u}=n,c=Ma(o.shape,s,a,[1,1,1],i,l,u),d=new Kw(c,"avg",!1);return r.runWebGLProgram(d,[o],"float32")}};class Jw{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,o=e.strideWidth,s=e.dilationHeight,a=e.dilationWidth,i=e.effectiveFilterHeight,l=e.effectiveFilterWidth,u=i-1-e.padInfo.top,c=l-1-e.padInfo.left,d=1/(t*r);this.userCode=`\n      const ivec2 pads = ivec2(${u}, ${c});\n      const float avgMultiplier = float(${d});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${i};\n            wR += ${s}) {\n          float dyR = float(dyRCorner + wR) / ${n}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${l};\n            wC+= ${a}) {\n            float dyC = float(dyCCorner + wC) / ${o}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class e_{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,n=e.filterWidth,o=e.strideDepth,s=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.effectiveFilterDepth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=c-1-e.padInfo.front,f=d-1-e.padInfo.top,m=h-1-e.padInfo.left,y=1/(t*r*n);this.userCode=`\n      const ivec3 pads = ivec3(${p}, ${f}, ${m});\n      const float avgMultiplier = float(${y});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${c};\n            wD += ${i}) {\n          float dyD = float(dyDCorner + wD) / ${o}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${d};\n              wR += ${l}) {\n            float dyR = float(dyRCorner + wR) / ${s}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${h};\n                wC += ${u}) {\n              float dyC = float(dyCCorner + wC) / ${a}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const t_={kernelName:"AvgPool3DGrad",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{dy:o,input:s}=t,a=s,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=n,d=Ma(a.shape,i,l,[1,1,1],u,c),h=new e_(d);return r.runWebGLProgram(h,[o],a.dtype)}},r_={kernelName:"AvgPoolGrad",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{dy:o,input:s}=t,a=s;mg([o,s],"avgPoolGrad");const{filterSize:i,strides:l,pad:u}=n,c=Na(a.shape,i,l,1,u),d=new Jw(c);return r.runWebGLProgram(d,[o],a.dtype)}},n_={kernelName:De,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{a:o,b:s}=t,{transposeA:a,transposeB:i}=n;return yw({a:o,b:s,transposeA:a,transposeB:i,backend:r})}};class o_{constructor(e,t,r,n,o,s){this.outputShape=[],this.variableNames=["x","mean","variance"],Xs(e,t),Xs(e,r);let a="0.0";null!=n&&(Xs(e,n),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let i="1.0";null!=o&&(Xs(e,o),this.variableNames.push("scale"),i="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ${a};\n        float scale = ${i};\n        float inv = scale * inversesqrt(variance + float(${s}));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    `}}class s_{constructor(e,t,r,n,o,s){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Xs(e,t),Xs(e,r);let a="vec4(0.0)";null!=n&&(Xs(e,n),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let i="vec4(1.0)";null!=o&&(Xs(e,o),this.variableNames.push("scale"),i="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`\n      void main() {\n        vec4 offset = ${a};\n        vec4 scale = ${i};\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(${s}));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    `}}const a_={kernelName:bt,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:r})=>{const{x:n,mean:o,variance:s,offset:a,scale:i}=e;B(o.shape.length===s.shape.length,(()=>"Batch normalization gradient requires mean and variance to have equal ranks.")),B(null==a||o.shape.length===a.shape.length,(()=>"Batch normalization gradient requires mean and offset to have equal ranks.")),B(null==i||o.shape.length===i.shape.length,(()=>"Batch normalization gradient requires mean and scale to have equal ranks."));let{varianceEpsilon:l}=r;null==l&&(l=.001);const u=[n,o,s];let c=null;null!=a&&(c=a.shape,u.push(a));let d=null;null!=i&&(d=i.shape,u.push(i));const h=be().getBool("WEBGL_PACK_NORMALIZATION")?new s_(n.shape,o.shape,s.shape,c,d,l):new o_(n.shape,o.shape,s.shape,c,d,l);return t.runWebGLProgram(h,u,u[0].dtype)}};class i_{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Rg(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=function(e){if(1===e)return"sourceLoc";if(e<=6)return l_.slice(0,e).map((e=>"sourceLoc."+e)).join(",");throw Error(`Slicing for rank ${e} is not yet supported`)}(this.rank);let n;n=`\n        ${t} sourceLoc;\n        ${t} coords = getOutputCoords();\n        ${e.map(((e,t)=>`sourceLoc.${l_[t]} = start[${t}] + coords.${l_[t]};`)).join("\n")}\n      `,this.userCode=`\n      void main() {\n        ${n}\n        setOutput(getSource(${r}));\n      }\n    `}}const l_=["x","y","z","w","u","v"];class u_{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Rg(this.rank),r=ax("coords",this.rank),n=ax("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":`vec2(${n.slice(-2).join()})`,s=`getChannel(getSource(${n.join()}), ${o})`,a=`\n      result.x = ${s};\n      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {\n        ++${n[this.rank-1]};\n        result.y = ${s};\n        --${n[this.rank-1]};\n      }\n    `,i=1===this.rank?"":`\n      --${r[this.rank-1]};\n      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {\n        ++${n[this.rank-2]};\n        result.z = ${s};\n        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {\n          ++${n[this.rank-1]};\n          result.w = ${s};\n        }\n      }\n    `,l=this.rank<=4?`sourceLoc = coords +\n            ${t}(${e.map(((e,t)=>`start[${t}]`)).join()});`:e.map(((e,t)=>`${n[t]} = ${r[t]} + start[${t}];`)).join("\n");this.userCode=`\n      void main() {\n        ${t} coords = getOutputCoords();\n        ${t} sourceLoc;\n        ${l}\n        vec4 result = vec4(0.);\n        ${a}\n        ${i}\n        setOutput(result);\n      }\n    `}}function c_(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{begin:s,size:a}=n,[i,l]=ma(o,s,a);if(ta(o,i,l),0===z(l))return r.makeTensorInfo(l,o.dtype,[]);if(r.shouldExecuteOnCPU([o])||"string"===o.dtype){const e=r.texData.get(o.dataId),t=Wb(e.values,i,l,o.shape,o.dtype);return r.makeTensorInfo(l,o.dtype,t)}const{isPacked:u}=r.texData.get(o.dataId),c=pa(o.shape,i,l);if(u||!c){const e=be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new u_(l):new i_(l),t=[i];return r.runWebGLProgram(e,[o],o.dtype,t)}return r.uploadToGPU(o.dataId),function(e,t,r,n){const o=n.texData.get(e.dataId),s=n.makeTensorInfo(r,e.dtype),a=n.texData.get(s.dataId);Object.assign(a,o),a.refCount=1,a.shape=r,a.dtype=e.dtype;let i=fa(t,ie(e.shape));o.slice&&(i+=o.slice.flatOffset),a.slice={flatOffset:i,origDataId:o.slice&&o.slice.origDataId||e.dataId};const l=n.dataRefCount.get(a.slice.origDataId)||1;return n.dataRefCount.set(a.slice.origDataId,l+1),s}(o,i,l,r)}const d_={kernelName:wr,backendName:"webgl",kernelFunc:c_},h_={kernelName:Fe,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{blockShape:s,crops:a}=n;B(o.shape.length<=4,(()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"));const i=s.reduce(((e,t)=>e*t)),l=nh(o.shape,s,i),u=oh(l.length,s.length),c=sh(o.shape,s,i),d=ah(a,s.length),h=ih(c,a,s.length),p=[],f=nw({inputs:{x:o},backend:r,attrs:{shape:l}}),m=pw({inputs:{x:f},backend:r,attrs:{perm:u}}),y=nw({inputs:{x:m},backend:r,attrs:{shape:c}}),g=c_({inputs:{x:y},backend:r,attrs:{begin:d,size:h}});return p.push(f),p.push(m),p.push(y),p.forEach((e=>r.disposeIntermediateTensorInfo(e))),g}},p_={kernelName:$e,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,weights:s}=t,{size:a}=n,i=r.readSync(o.dataId),l=r.readSync(s.dataId),u=fb(i,l,s.dtype,s.shape,a);return r.makeTensorInfo([a],s.dtype,u)}},f_={kernelName:Be,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{s0:n,s1:o}=t,s=r.readSync(n.dataId),a=r.readSync(o.dataId),i=Xs(Array.from(s),Array.from(a));return r.makeTensorInfo([i.length],"int32",Int32Array.from(i))}},m_=Yx({opSnippet:"return float(a != b);",cpuKernelImpl:Lb,dtype:"bool"}),y_={kernelName:Xt,backendName:"webgl",kernelFunc:m_};function g_(e){const{inputs:t,backend:r}=e,{input:n}=t;return Dx({inputs:{x:r.texData.get(n.dataId).complexTensorInfos.real},backend:r})}const v_={kernelName:ir,backendName:"webgl",kernelFunc:g_},b_={kernelName:Ue,backendName:"webgl",kernelFunc:function e(t){const{inputs:r,backend:n,attrs:o}=t,{x:s}=r,{dtype:a}=o;if("complex64"===a){if("complex64"===s.dtype)return Dx({inputs:{x:s},backend:n});const t=Hl(s.shape),r=e({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),o=$x({inputs:{real:r,imag:t},backend:n});return t.dispose(),n.disposeIntermediateTensorInfo(r),o}if("complex64"===s.dtype){const t=g_({inputs:{input:s},backend:n}),r=e({inputs:{x:t},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(t),r}if(!ee(s.dtype,a)){const e=Dx({inputs:{x:s},backend:n});return{dataId:e.dataId,shape:e.shape,dtype:a}}if(n.shouldExecuteOnCPU([s])){const e=n.texData.get(s.dataId).values,[t,r,o]=yb(e,s.shape,s.dtype,a);return n.makeTensorInfo(t,r,o)}if("int32"===a)return function(e,t){const r=new px(e.shape,"return float(int(x));"),n=t.runWebGLProgram(r,[e],"int32");return{dataId:n.dataId,shape:n.shape,dtype:n.dtype}}(s,n);if("bool"===a){const e=n.makeTensorInfo([],"bool",Q("bool",1)),t=m_({inputs:{a:s,b:e},backend:n});return n.disposeIntermediateTensorInfo(e),t}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${a}`)}},x_="return ceil(x);",w_=Xx({opSnippet:x_,packedOpSnippet:x_,cpuKernelImpl:gb}),__={kernelName:Ve,backendName:"webgl",kernelFunc:w_};class S_{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}}class k_{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode="\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}}const T_={kernelName:Ge,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{clipValueMin:s,clipValueMax:a}=n;let i;i=be().getBool("WEBGL_PACK_CLIP")?new k_(o.shape):new S_(o.shape);const l=[[s],[a]];return r.runWebGLProgram(i,[o],o.dtype,l)}};class E_{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "}}function j_(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}const C_={kernelName:We,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{x:n}=t,o=r.texData.get(n.dataId),s=new E_(n.shape),a=[j_(n,o.complexTensorInfos.real),j_(n,o.complexTensorInfos.imag)];return r.runWebGLProgram(s,a,a[0].dtype)}};class I_{constructor(e){this.outputShape=[],this.outputShape=Xd(e,1),this.variableNames=e.map(((e,t)=>`T${t}`));const t=new Array(e.length-1);t[0]=e[0][1];for(let r=1;r<t.length;r++)t[r]=t[r-1]+e[r][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let e=1;e<t.length;e++){const n=t[e-1];r.push(`else if (yC < ${t[e]}) setOutput(getT${e}(yR, yC-${n}));`)}const n=t.length,o=t[t.length-1];r.push(`else setOutput(getT${n}(yR, yC-${o}));`),this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ${r.join("\n        ")}\n      }\n    `}}class O_{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Xd(e,t);const r=this.outputShape,n=r.length,o=Rg(n),s=ax("coords",n),a=["x","y","z","w","u","v"].slice(0,n);this.variableNames=e.map(((e,t)=>`T${t}`));const i=new Array(e.length-1);i[0]=e[0][t];for(let r=1;r<i.length;r++)i[r]=i[r-1]+e[r][t];const l=a[t],u=a.slice(-2),c=a.join();let d=`if (${l} < ${i[0]}) {\n        return getChannel(\n            getT0(${c}), vec2(${u.join()}));\n        }`;for(let e=1;e<i.length;e++){const t=i[e-1];d+=`\n        if (${l} < ${i[e]}  && ${l} >= ${i[e-1]}) {\n          return getChannel(\n            getT${e}(${A_(a,l,t)}),\n            vec2(${A_(u,l,t)}));\n        }`}const h=i.length,p=i[i.length-1];d+=`\n        return getChannel(\n          getT${h}(${A_(a,l,p)}),\n          vec2(${A_(u,l,p)}));`,this.userCode=`\n      float getValue(${a.map((e=>"int "+e))}) {\n        ${d}\n      }\n\n      void main() {\n        ${o} coords = getOutputCoords();\n        vec4 result = vec4(getValue(${s}), 0., 0., 0.);\n\n        ${s[n-1]} = ${s[n-1]} + 1;\n        if (${s[n-1]} < ${r[n-1]}) {\n          result.g = getValue(${s});\n        }\n\n        ${s[n-2]} = ${s[n-2]} + 1;\n        if (${s[n-2]} < ${r[n-2]}) {\n          result.a = getValue(${s});\n        }\n\n        ${s[n-1]} = ${s[n-1]} - 1;\n        if (${s[n-2]} < ${r[n-2]} &&\n            ${s[n-1]} < ${r[n-1]}) {\n          result.b = getValue(${s});\n        }\n        setOutput(result);\n      }\n    `}}function A_(e,t,r){const n=e.indexOf(t);return e.map(((e,t)=>t===n?`${e} - ${r}`:e)).join()}function R_(e){const{inputs:t,backend:r}=e,{input:n}=t;return Dx({inputs:{x:r.texData.get(n.dataId).complexTensorInfos.imag},backend:r})}const N_={kernelName:Et,backendName:"webgl",kernelFunc:R_};function M_(e,t,r){const n=e[0].dtype;if("complex64"===n){const n=e.map((e=>g_({inputs:{input:e},backend:r}))),o=e.map((e=>R_({inputs:{input:e},backend:r}))),s=M_(n,t,r),a=M_(o,t,r),i=$x({inputs:{real:s,imag:a},backend:r});return n.forEach((e=>r.disposeIntermediateTensorInfo(e))),o.forEach((e=>r.disposeIntermediateTensorInfo(e))),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(a),i}let o=r.shouldExecuteOnCPU(e);if("string"===n&&(o=!0),o){const o=e.map((e=>{const n=z(e.shape.slice(t));return nw({inputs:{x:e},backend:r,attrs:{shape:[-1,n]}})})),s=o.map((e=>({vals:r.readSync(e.dataId),shape:e.shape}))),a=Xd(o.map((e=>e.shape)),1),i=1===o[0].shape[0],l=vb(s,a,n,i),u=Xd(e.map((e=>e.shape)),t),c=r.makeTensorInfo(u,n,l);return o.forEach((e=>r.disposeIntermediateTensorInfo(e))),c}const s=be().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(e.length>s){const n=[];for(let o=0;o<e.length;o+=s){const a=e.slice(o,o+s);n.push(M_(a,t,r))}const o=M_(n,t,r);for(const e of n)r.disposeIntermediateTensorInfo(e);return o}if(be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){const o=new O_(e.map((e=>e.shape)),t);return r.runWebGLProgram(o,e,n)}const{tensors2D:a,outShape:i}=function(e,t,r){const n=Xd(e.map((e=>e.shape)),t);return{tensors2D:e.map((e=>nw({inputs:{x:e},attrs:{shape:[-1,z(e.shape.slice(t))]},backend:r}))),outShape:n}}(e,t,r),l=new I_(a.map((e=>e.shape))),u=r.runWebGLProgram(l,a,n);a.forEach((e=>r.disposeIntermediateTensorInfo(e)));const c=nw({inputs:{x:u},attrs:{shape:i},backend:r});return r.disposeIntermediateTensorInfo(u),c}function P_(e){const{inputs:t,backend:r,attrs:n}=e,{axis:o}=n,s=K(o,t[0].shape)[0],a=t.map((e=>e.shape));qd(a,s);const i=Xd(t.map((e=>e.shape)),s);if(0===z(i))return r.makeTensorInfo(i,t[0].dtype,[]);const l=t.filter((e=>z(e.shape)>0));return 1===l.length?Dx({inputs:{x:l[0]},backend:r}):M_(l,s,r)}const L_={kernelName:He,backendName:"webgl",kernelFunc:P_};class D_{constructor(e,t=!1,r=null,n=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const s=e.padInfo.top,a=e.padInfo.left,i=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4,m="channelsLast"===e.dataFormat,y=m?1:2,g=m?2:3,v=m?3:1;let b="",x="";r&&(b=n?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:o?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,x="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${b}\n\n      const ivec2 strides = ivec2(${i}, ${l});\n      const ivec2 pads = ivec2(${s}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[${v}];\n\n        ivec2 xRCCorner =\n            ivec2(coords[${y}], coords[${g}]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${d}; wR++) {\n          int xR = xRCorner + wR * ${u};\n\n          if (xR < 0 || xR >= ${e.inHeight}) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${h}; wC++) {\n            int xC = xCCorner + wC * ${c};\n\n            if (xC < 0 || xC >= ${e.inWidth}) {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ${p}; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (${m}) {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (${1===f}) {\n\n              if (${m}) {\n                dotProd +=\n                    getX(batch, xR, xC, ${p}) *\n                    getW(wR, wC, ${p}, d2);\n              } else {\n                dotProd +=\n                    getX(batch, ${p}, xR, xC) *\n                    getW(wR, wC, ${p}, d2);\n              }\n\n            } else if (${2===f}) {\n              vec2 wValues = vec2(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2)\n              );\n\n              if (${m}) {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (${3===f}) {\n              vec3 wValues = vec3(\n                getW(wR, wC, ${p}, d2),\n                getW(wR, wC, ${p} + 1, d2),\n                getW(wR, wC, ${p} + 2, d2)\n              );\n\n              if (${m}) {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ${p}),\n                  getX(batch, xR, xC, ${p} + 1),\n                  getX(batch, xR, xC, ${p} + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ${p}, xR, xC),\n                  getX(batch, ${p} + 1, xR, xC),\n                  getX(batch, ${p} + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ${w}\n        ${x}\n        setOutput(result);\n      }\n    `}}class F_{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,n=e.padInfo.left,o=e.strideDepth,s=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,l=e.dilationHeight,u=e.dilationWidth,c=e.filterDepth,d=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),f=e.inChannels%4;this.userCode=`\n      const ivec3 strides = ivec3(${o}, ${s}, ${a});\n      const ivec3 pads = ivec3(${t}, ${r}, ${n});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${c}; wF++) {\n          int xF = xFCorner + wF * ${i};\n\n          if (xF < 0 || xF >= ${e.inDepth}) {\n            continue;\n          }\n\n          for (int wR = 0; wR < ${d}; wR++) {\n            int xR = xRCorner + wR * ${l};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int wC = 0; wC < ${h}; wC++) {\n              int xC = xCCorner + wC * ${u};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ${p}; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (${1===f}) {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ${p}) *\n                  getW(wF, wR, wC, ${p}, d2);\n              } else if (${2===f}) {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (${3===f}) {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ${p}),\n                  getX(batch, xF, xR, xC, ${p} + 1),\n                  getX(batch, xF, xR, xC, ${p} + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ${p}, d2),\n                  getW(wF, wR, wC, ${p} + 1, d2),\n                  getW(wF, wR, wC, ${p} + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class $_{constructor(e,t=!1,r=null,n=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fg(this.outputShape.length);const s=e.padInfo.left,a=e.strideWidth,i=e.dilationWidth,l=e.filterHeight,u=e.filterWidth,c=u;let d="\n       int xR; int xC; int xCOffset;\n       vec4 wTexel; vec4 previous; vec4 final;";for(let e=0;e<u;e++)d+=`\n           vec4 xTexelC${2*e};\n           int xTexelC${2*e}Ready;\n           vec4 xTexelC${2*e+1};\n           int xTexelC${2*e+1}Ready;\n           vec4 xC${e};`;d+=`\n     for (int r = 0; r < ${l}; r++) {\n      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {\n       `;for(let e=0;e<u;e++)d+=`\n           xTexelC${2*e} = vec4(0.0);\n           xTexelC${2*e}Ready = 0;\n           xTexelC${2*e+1} = vec4(0.0);\n           xTexelC${2*e+1}Ready = 0;\n           xC${e} = vec4(0.0);`;d+="\n         xR = xRCorner + r * dilations[0];\n         if (xR >=0 && xR < inDims[0]) {\n       ";for(let t=0;t<(c+1)/2;t++){const r=2*t;if(d+=`\n           xC = xCCorner + ${r*i};\n           `,1===a){if(r<u&&(s%2==1?(d+=`\n                 xCOffset = xC + 1;\n                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${r}Ready == 0) {\n                   xTexelC${r} = getX(batch, xR, xCOffset, d1);\n\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${r}.zw = vec2(0.0);\n                   }\n                   xTexelC${r}Ready = 1;\n                 }\n               `,d+=1===i&&r>0?`\n                 xC${r} = vec4(xTexelC${r-2}.zw, xTexelC${r}.xy);\n                 `:`\n                   xCOffset = xC + 1 - 2;\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       previous.zw = vec2(0.0);\n                     }\n\n                     xC${r} = vec4(previous.zw, xTexelC${r}.xy);\n                   } else {\n                     xC${r} = vec4(0.0, 0.0, xTexelC${r}.xy);\n                   }\n                   `):d+=`\n                 if (xC >= 0 && xC < inDims[1] && xTexelC${r}Ready == 0) {\n                   xTexelC${r} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${r}.zw = vec2(0.0);\n                   }\n                   xTexelC${r}Ready = 1;\n                 }\n\n                 xC${r} = xTexelC${r};\n                 `,r+1<u)){const e=s%2==0?F(i):i;i%2==0&&s%2==1||i%2!=0&&s%2!=1?(d+=`\n                   xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${r+1}Ready == 0) {\n                     xTexelC${r+1} = getX(batch, xR, xCOffset, d1);\n\n                     // Need to manually clear unused channels in case\n                     // we're reading from recycled texture.\n                     if (xCOffset + 1 >= inDims[1]) {\n                       xTexelC${r+1}.zw = vec2(0.0);\n                     }\n                     xTexelC${r+1}Ready = 1;\n                   }\n                   `,d+=i>1?`\n                     xCOffset -= 2;\n                     if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                      previous = getX(batch, xR, xCOffset, d1);\n                      xC${r+1} = vec4(previous.zw, xTexelC${r+1}.xy);\n                     } else {\n                      xC${r+1} = vec4(0.0, 0.0, xTexelC${r+1}.xy);\n                     }\n                     `:`\n                     xC${r+1} = vec4(xTexelC${r}.zw, xTexelC${r+1}.xy);\n                     `):d+=1===e?`\n                     xC${r+1} = xTexelC${r};\n                     `:`\n                     xCOffset = xC + ${e};\n\n                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${r+1}Ready == 0) {\n                       xTexelC${r+1} = getX(batch, xR, xCOffset, d1);\n                       if (xCOffset + 1 >= inDims[1]) {\n                         xTexelC${r+1}.zw = vec2(0.0);\n                       }\n                       xTexelC${r+1}Ready = 1;\n                     }\n\n                     xC${r+1} = xTexelC${r+1};\n                     `}}else r<u&&(s%2==1?(d+=`\n                 xCOffset = xC + 1 - strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${r}Ready == 0) {\n                   xTexelC${r} = getX(batch, xR, xCOffset, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${r}.zw = vec2(0.0);\n                   }\n                   xTexelC${r}Ready = 1;\n                 }\n\n                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${r+1}Ready == 0) {\n                   xTexelC${r+1} = getX(batch, xR, xC + 1, d1);\n                   // Need to manually clear unused channels in case\n                   // we're reading from recycled texture.\n                   if (xC + 2 >= inDims[1]) {\n                     xTexelC${r+1}.zw = vec2(0.0);\n                   }\n                   xTexelC${r+1}Ready = 1;\n                 }\n\n                 xC${r} = vec4(xTexelC${r}.zw, xTexelC${r+1}.zw);\n               `,r+1<u&&(d+=`\n                   final = vec4(0.0);\n                   xCOffset = xC + 1 + strides[1];\n                   if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                     final = getX(batch, xR, xCOffset, d1);\n                   }\n                   xC${r+1} = vec4(xTexelC${r+1}.xy, final.xy);\n                 `)):(d+=`\n                 if(xC >= 0 && xC < inDims[1] && xTexelC${r}Ready == 0) {\n                   xTexelC${r} = getX(batch, xR, xC, d1);\n                   if (xC + 1 >= inDims[1]) {\n                     xTexelC${r}.zw = vec2(0.0);\n                   }\n                   xTexelC${r}Ready = 1;\n                 }\n\n                 xCOffset = xC + strides[1];\n                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${r+1}Ready == 0) {\n                   xTexelC${r+1} = getX(batch, xR, xCOffset, d1);\n                   if (xCOffset + 1 >= inDims[1]) {\n                     xTexelC${r+1}.zw = vec2(0.);\n                   }\n                   xTexelC${r+1}Ready = 1;\n                 }\n\n                 xC${r} = vec4(\n                   xTexelC${r}.xy, xTexelC${r+1}.xy);\n               `,r+1<u&&(d+=`\n                   xC${r+1} = vec4(xTexelC${r}.zw, xTexelC${r+1}.zw);\n                 `)));r<u&&(d+=`\n             wTexel = getW(r, ${r}, d1, d2);\n             dotProd += xC${r}.xxzz * vec4(wTexel.xy, wTexel.xy);\n             if(d1 + 1 < ${e.inChannels}) {\n               dotProd += xC${r}.yyww * vec4(wTexel.zw, wTexel.zw);\n             }\n           `,r+1<u&&(d+=`\n               wTexel = getW(r, ${r+1}, d1, d2);\n               dotProd += xC${r+1}.xxzz * vec4(wTexel.xy, wTexel.xy);\n               if(d1 + 1 < ${e.inChannels}) {\n                 dotProd += xC${r+1}.yyww * vec4(wTexel.zw, wTexel.zw);\n               }\n             `))}d+="\n     }\n   ",d+="\n     }\n   ",d+="\n     }\n   ";let h="",p="";r&&(h=n?`vec4 activation(vec4 a) {\n           vec4 b = getPreluActivationWeightsAtOutCoords();\n           ${r}\n         }`:o?`vec4 activation(vec4 a) {\n           vec4 b = getLeakyreluAlphaAtOutCoords();\n           ${r}\n         }`:`vec4 activation(vec4 x) {\n           ${r}\n         }`,p="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n       ${h}\n\n       void main() {\n         ivec4 coords = getOutputCoords();\n         int batch = coords.x;\n         ivec2 xRCCorner = coords.yz * strides - pads;\n         int d2 = coords.w;\n         int xRCorner = xRCCorner.x;\n         int xCCorner = xRCCorner.y;\n\n         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n         vec4 dotProd = vec4(0.000000000000001);\n\n         ${d}\n\n         vec4 result = dotProd - vec4(0.000000000000001);\n         ${f}\n         ${p}\n         setOutput(result);\n       }\n     `}}class B_{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Fg(this.outputShape.length);const{dataFormat:r}=t,n=gg(),o="channelsLast"===r,s=o?1:2,a=o?2:3,i=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let l="";for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)l+=`\n          blockIndex = rc.z + ${t};\n          pos = rc.y + ${e};\n\n          ${i}\n            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];\n            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);\n\n            if(d0 < inputShape[${s}] && d0 >= 0) {\n              // Use custom imod instead mod. On Intel GPU, mod may generate\n              // unexpected value.\n              // https://github.com/tensorflow/tfjs/issues/5447\n              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];\n              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /\n                  inChannels);\n\n              if(d1 < inputShape[${a}] && d1 >= 0) {\n\n                ch = imod(pos, inChannels);\n\n                if (${o}) {\n                  innerDims = vec2(d1, ch);\n                  result[${2*e+t}] = getChannel(\n                    getA(rc.x, d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[${2*e+t}] = getChannel(\n                    getA(rc.x, ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        `;this.userCode=`\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ${l}\n\n        ${n.output} = result;\n      }\n    `}}function U_(e,t){const r=e.length;return r>=3?t?[...e.slice(0,-3),e[r-3]*e[r-2],e[r-1]]:[...e.slice(0,-3),e[r-3],e[r-2]*e[r-1]]:!t&&1===r&&e[0]>1?[e[0],1]:null}function V_({x:e,filter:t,convInfo:r,backend:n,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:i=null}){const l=e.shape,u=n.texData.get(e.dataId),c=r.inChannels,d=l[0]*l[1]*l[2],h=r.outChannels,p="channelsLast"===r.dataFormat;let f;const m=[];if(null!=s){const e=U_(s.shape,p);null!=e&&(s=nw({inputs:{x:s},backend:n,attrs:{shape:e}}),m.push(s))}if(null!=o){const e=U_(o.shape,p);null!=e&&(o=nw({inputs:{x:o},backend:n,attrs:{shape:e}}),m.push(o))}if((1!==d&&1!==h||!(c>mw))&&u.isPacked&&p&&null!=u.texture&&l[2]%2!=0&&W(u.shape.slice(-3),l.slice(-3))){const c=l[0]*l[1]*(l[2]+1),d={dataId:e.dataId,shape:[1,c,r.inChannels],dtype:e.dtype},h=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,B(ug(u.shape,d.shape),(()=>`packed reshape ${u.shape} to ${d.shape} isn't free`));const p=nw({inputs:{x:t},backend:n,attrs:{shape:[1,r.inChannels,r.outChannels]}});m.push(p);const y=yw({a:d,b:p,backend:n,transposeA:!1,transposeB:!1,bias:o,activation:i,preluActivationWeights:s,leakyreluAlpha:a}),g=n.texData.get(y.dataId);B(g.isPacked,(()=>"batchMatMul result is expected to be packed")),u.shape=h,g.shape=r.outShape,f=Dx({inputs:{x:y},backend:n}),f.shape=r.outShape,m.push(y)}else{const l=r.outHeight*r.outWidth,u=nw({inputs:{x:e},backend:n,attrs:{shape:p?[r.batchSize,l,r.inChannels]:[r.batchSize,r.inChannels,l]}}),c=nw({inputs:{x:t},backend:n,attrs:{shape:[1,r.inChannels,r.outChannels]}}),d=yw({a:p?u:c,b:p?c:u,transposeA:!p,transposeB:!1,backend:n,bias:o,activation:i,preluActivationWeights:s,leakyreluAlpha:a});f=nw({inputs:{x:d},backend:n,attrs:{shape:r.outShape}}),m.push(u),m.push(c),m.push(d)}for(const e of m)n.disposeIntermediateTensorInfo(e);return f}function G_({x:e,filter:t,convInfo:r,backend:n,bias:o=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:i=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:h,dataFormat:p}=r,f="channelsLast"===p,m=l*u*c,y=h*d,g=[r.batchSize,m,y],v=[];if(null!=s){const e=U_(s.shape,f);null!=e&&(s=nw({inputs:{x:s},backend:n,attrs:{shape:e}}),v.push(s))}if(null!=o){const e=U_(o.shape,f);null!=e&&(o=nw({inputs:{x:o},backend:n,attrs:{shape:e}}),v.push(o))}const b=nw({inputs:{x:t},backend:n,attrs:{shape:[1,m,z(t.shape)/m]}});v.push(b);const x=new B_(g,r),w=[e.shape,[r.padInfo.top,r.padInfo.left],[r.strideHeight,r.strideWidth],[r.dilationHeight,r.dilationWidth],[r.inChannels],[r.filterWidth*r.inChannels],[r.outWidth]],_=n.runWebGLProgram(x,[e],"float32",w),S=nw({inputs:{x:_},backend:n,attrs:{shape:g}});v.push(_),v.push(S);const k=null!=o,T=null!=s,E="leakyrelu"===i,j=i?Kx(i,!0):null,C=new Zx(f?S.shape:b.shape,f?b.shape:S.shape,f?[r.batchSize,y,r.outChannels]:[r.batchSize,r.outChannels,y],!0,!1,k,j,T,E),I=f?[S,b]:[b,S];if(o&&I.push(o),T&&I.push(s),E){const e=n.makeTensorInfo([],"float32",En(a,"float32"));I.push(e),v.push(e)}const O=n.runWebGLProgram(C,I,"float32"),A=nw({inputs:{x:O},backend:n,attrs:{shape:r.outShape}});v.push(O);for(const e of v)n.disposeIntermediateTensorInfo(e);return A}const z_={kernelName:qe,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,filter:s}=t,{strides:a,pad:i,dataFormat:l,dilations:u,dimRoundingMode:c}=n,d=za(l),h=Pa(o.shape,s.shape,a,u,i,c,!1,d);let p;if(1!==h.filterHeight||1!==h.filterWidth||1!==h.dilationHeight||1!==h.dilationWidth||1!==h.strideHeight||1!==h.strideWidth||"SAME"!==h.padInfo.type&&"VALID"!==h.padInfo.type)if(h.strideWidth<=2&&"channelsLast"===d&&be().getBool("WEBGL_EXP_CONV")){const e=new $_(h),t=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];p=r.runWebGLProgram(e,[o,s],"float32",t)}else if(be().getBool("WEBGL_CONV_IM2COL"))p=G_({x:o,filter:s,convInfo:h,backend:r});else{const e=new D_(h);p=r.runWebGLProgram(e,[o,s],"float32")}else p=V_({x:o,filter:s,convInfo:h,backend:r});const f=nw({inputs:{x:p},backend:r,attrs:{shape:h.outShape}});return r.disposeIntermediateTensorInfo(p),f}};class W_{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,n=e.padInfo.top,o=e.padInfo.left,s="channelsLast"===e.dataFormat;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${n};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${r} - ${o};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              if (${s}) {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class H_{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,o=e.strideWidth,s="channelsLast"===e.dataFormat,a=t-1-e.padInfo.top,i=r-1-e.padInfo.left,l=s?1:2,u=s?2:3,c=s?3:1;this.userCode=`\n      const ivec2 pads = ivec2(${a}, ${i});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[${c}];\n\n        ivec2 dyCorner = ivec2(coords[${l}], coords[${u}]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${n}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${o}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n\n              if (${s}) {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class q_{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,n=e.strideWidth,o=e.padInfo.front,s=e.padInfo.top,a=e.padInfo.left;this.userCode=`\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yF = 0; yF < ${e.outDepth}; yF++) {\n            int xF = wF + yF * ${t} - ${o};\n\n            if (xF < 0 || xF >= ${e.inDepth}) {\n              continue;\n            }\n\n            for (int yR = 0; yR < ${e.outHeight}; yR++) {\n              int xR = wR + yR * ${r} - ${s};\n\n              if (xR < 0 || xR >= ${e.inHeight}) {\n                continue;\n              }\n\n              for (int yC = 0; yC < ${e.outWidth}; yC++) {\n                int xC = wC + yC * ${n} - ${a};\n\n                if (xC < 0 || xC >= ${e.inWidth}) {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class X_{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,n=e.filterWidth,o=e.strideDepth,s=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.front,l=r-1-e.padInfo.top,u=n-1-e.padInfo.left;this.userCode=`\n      const ivec3 pads = ivec3(${i}, ${l}, ${u});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ${t}; wF++) {\n          float dyF = float(dyFCorner + wF) / ${o}.0;\n\n          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ${t} - 1 - wF;\n\n          for (int wR = 0; wR < ${r}; wR++) {\n            float dyR = float(dyRCorner + wR) / ${s}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ${r} - 1 - wR;\n\n            for (int wC = 0; wC < ${n}; wC++) {\n              float dyC = float(dyCCorner + wC) / ${a}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ${n} - 1 - wC;\n\n              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Y_={kernelName:Xe,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,dy:s}=t,{strides:a,pad:i,dataFormat:l,dimRoundingMode:u,filterShape:c}=n,d=za(l),h=Pa(o.shape,c,a,1,i,u,!1,d),p=new W_(h);return r.runWebGLProgram(p,[o,s],"float32")}},K_={kernelName:Ye,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{dy:o,filter:s}=t,{inputShape:a,strides:i,pad:l,dataFormat:u,dimRoundingMode:c}=n,d=za(u),h=Pa(a,s.shape,i,1,l,c,!1,d),p=new H_(h);return r.runWebGLProgram(p,[o,s],"float32")}},Z_={kernelName:Ke,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,filter:s}=t,{strides:a,pad:i,dilations:l}=n,u=La(o.shape,s.shape,a,l,i),c=new F_(u);return r.runWebGLProgram(c,[o,s],"float32")}},Q_={kernelName:"Conv3DBackpropFilterV2",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,dy:s}=t,{strides:a,pad:i,filterShape:l}=n,u=La(o.shape,l,a,1,i),c=new q_(u);return r.runWebGLProgram(c,[o,s],"float32")}},J_={kernelName:Ze,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{dy:o,filter:s}=t,{pad:a,strides:i,inputShape:l}=n,u=La(l,s.shape,i,1,a),c=new X_(u);return r.runWebGLProgram(c,[o,s],"float32")}},eS={kernelName:"Cos",backendName:"webgl",kernelFunc:Xx({opSnippet:qx+"\n  return cos(x);\n"})},tS=Xx({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),rS={kernelName:Qe,backendName:"webgl",kernelFunc:tS};class nS{constructor(e,t,r,n,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[s,a,i,l]=e,[u]=t,[c,d]=r;this.outputShape=[u,c,d,l];const h="bilinear"===n?1:0,[p,f]=[a-1+".0",i-1+".0"],[m,y,g]=c>1?[""+(a-1)/(c-1),"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[v,b,x]=d>1?[""+(i-1)/(d-1),"(x2-x1) * width_ratio",`x1*${f} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${f}`];this.userCode=`\n      const float height_ratio = float(${m});\n      const float width_ratio = float(${v});\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ${s}) {\n          return;\n        }\n\n        float height_scale = ${y};\n        float width_scale = ${b};\n\n        float in_y = ${g};\n        if( in_y < 0.0 || in_y > ${p} ) {\n          setOutput(float(${o}));\n          return;\n        }\n        float in_x = ${x};\n        if( in_x < 0.0 || in_x > ${f} ) {\n          setOutput(float(${o}));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(${h} == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    `}}const oS={kernelName:tt,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:r,attrs:n}=e,{image:o,boxes:s,boxInd:a}=t,{cropSize:i,method:l,extrapolationValue:u}=n,c=new nS(o.shape,s.shape,i,l,u);return r.runWebGLProgram(c,[o,s,a],"float32")}};var sS;!function(e){e.Prod="*",e.Sum="+"}(sS||(sS={}));class aS{constructor(e,t,r,n){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,s=this.op===sS.Prod?"1.0":"0.0",a=r?s:`getX(${iS(o,"coords",this.op)})`,i=this.outputShape[this.outputShape.length-1];let l="",u="";r?(l=n?"end != "+(i-1):"end != 0",u=n?"end + 1":"end - 1"):(l=n?`end + pow2 < ${i}`:"end >= pow2",u=n?"end + pow2":"end - pow2"),this.userCode=`\n      void main() {\n        ${Rg(o)} coords = getOutputCoords();\n        int end = ${lS(o,"coords",this.op)};\n        float val = ${a};\n        int pow2 = int(pow(2.0, index));\n        if (${l}) {\n          int idx = ${u};\n          ${lS(o,"coords",this.op)} = idx;\n          val ${this.op}= getX(${iS(o,"coords",this.op)});\n        }\n        setOutput(val);\n      }\n    `}}function iS(e,t,r){if(1===e)return`${t}`;if(2===e)return`${t}.x, ${t}.y`;if(3===e)return`${t}.x, ${t}.y, ${t}.z`;if(4===e)return`${t}.x, ${t}.y, ${t}.z, ${t}.w`;throw new Error(`Cumulative ${r} for rank ${e} is not yet supported`)}function lS(e,t,r){if(1===e)return`${t}`;if(2===e)return`${t}.y`;if(3===e)return`${t}.z`;if(4===e)return`${t}.w`;throw new Error(`Cumulative ${r} for rank ${e} is not yet supported`)}function uS(e,t,r,n,o,s){const a=t.shape.length,i=Xi([n],a);let l=t;null!=i&&(l=pw({inputs:{x:t},backend:r,attrs:{perm:i}}));const u=Ki(1,a)[0];if(u!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${t.shape.length-1} but got axis=${n}`);const c=l.shape[u];let d=Dx({inputs:{x:l},backend:r});for(let t=0;t<=Math.ceil(Math.log2(c))-1;t++){const n=new aS(e,l.shape,!1,s),o=[[t]],a=d;d=r.runWebGLProgram(n,[d],d.dtype,o),r.disposeIntermediateTensorInfo(a)}if(o){const t=new aS(e,l.shape,o,s),n=d;d=r.runWebGLProgram(t,[d],d.dtype),r.disposeIntermediateTensorInfo(n)}if(null!=i){const e=pw({inputs:{x:d},backend:r,attrs:{perm:Yi(i)}});return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(l),e}return d}const cS={kernelName:Je,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s,exclusive:a,reverse:i}=n;return uS(sS.Prod,o,r,s,a,i)}},dS={kernelName:et,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s,exclusive:a,reverse:i}=n;return uS(sS.Sum,o,r,s,a,i)}},hS={kernelName:rt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,weights:s}=t,{size:a,binaryOutput:i}=n;if(1===o.shape.length){const e=r.readSync(o.dataId),t=r.readSync(s.dataId),n=fb(e,t,s.dtype,s.shape,a);return r.makeTensorInfo([a],s.dtype,n)}if(2===o.shape.length){const e=r.bufferSync(o),t=r.bufferSync(s),n=mb(e,t,a,i);return r.makeTensorInfo(n.shape,s.dtype,n.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${o.shape.length}.`)}};class pS{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ${this.getHeightCoordString()};\n      int w = ${this.getWidthCoordString()};\n      int d = ${this.getDepthCoordString()};\n\n      int in_h = h / ${t};\n      int offset_h = imod(h, ${t});\n      int in_w = w / ${t};\n      int offset_w = imod(w, ${t});\n      int offset_d = (offset_h * ${t} + offset_w) *\n        ${this.getOutputDepthSize()};\n      int in_d = d + offset_d;\n\n      float result = ${this.getInputSamplingString()};\n      setOutput(result);\n    }\n  `}getHeightCoordString(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}getWidthCoordString(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}getDepthCoordString(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}getOutputDepthSize(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}const fS={kernelName:nt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{blockSize:s,dataFormat:a}=n,i=o.shape[0],l=("NHWC"===a?o.shape[1]:o.shape[2])*s,u=("NHWC"===a?o.shape[2]:o.shape[3])*s,c=("NHWC"===a?o.shape[3]:o.shape[1])/(s*s),d=new pS("NHWC"===a?[i,l,u,c]:[i,c,l,u],s,a);return r.runWebGLProgram(d,[o],o.dtype)}};class mS{constructor(e,t=!1,r=null,n=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fg(this.outputShape.length);const s=e.filterHeight,a=e.filterWidth,i=e.outChannels/e.inChannels;let l="",u="";r&&(l=n?`float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:o?`float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`\n          float activation(float x) {\n            ${r}\n          }\n        `,u="result = activation(result);");const c=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${l}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${i};\n        int q = d2 - d1 * ${i};\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ${s}; wR++) {\n          int xR = xRCorner + wR * dilations[0];\n\n          if (xR < 0 || xR >= inDims[0]) {\n            continue;\n          }\n\n          for (int wC = 0; wC < ${a}; wC++) {\n            int xC = xCCorner + wC * dilations[1];\n\n            if (xC < 0 || xC >= inDims[1]) {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ${c}\n        ${u}\n        setOutput(result);\n      }\n    `}}class yS{constructor(e,t=!1,r=null,n=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fg(this.outputShape.length);const s=e.outChannels/e.inChannels,a=e.padInfo.left,i=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let h="\n      int xR; int xC; int xCOffset;\n      vec4 wTexel; vec4 previous; vec4 final;";for(let e=0;e<c;e++)h+=`\n          vec4 xTexelC${2*e};\n          int xTexelC${2*e}Ready;\n          vec4 xTexelC${2*e+1};\n          int xTexelC${2*e+1}Ready;\n          vec4 xC${e};`;h+=`\n    for (int r = 0; r < ${u}; r++) {\n      `;for(let e=0;e<c;e++)h+=`\n          xTexelC${2*e} = vec4(0.0);\n          xTexelC${2*e}Ready = 0;\n          xTexelC${2*e+1} = vec4(0.0);\n          xTexelC${2*e+1}Ready = 0;\n          xC${e} = vec4(0.0);`;h+="\n        xR = xRCorner + r * dilations[0];\n        if (xR >=0 && xR < inDims[0]) {\n      ";for(let e=0;e<(d+1)/2;e++){const t=2*e;if(h+=`\n          xC = xCCorner + ${t*l};\n          `,1===i){if(t<c&&(a%2==1?(h+=`\n                xCOffset = xC + 1;\n                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n              `,h+=1===l&&t>0?`\n                xC${t} = vec4(xTexelC${t-2}.zw, xTexelC${t}.xy);\n                `:`\n                  xCOffset = xC + 1 - 2;\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                    previous = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      previous.zw = vec2(0.0);\n                    }\n\n                    xC${t} = vec4(previous.zw, xTexelC${t}.xy);\n                  } else {\n                    xC${t} = vec4(0.0, 0.0, xTexelC${t}.xy);\n                  }\n                  `):h+=`\n                if (xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xC${t} = xTexelC${t};\n                `,t+1<c)){const e=a%2==0?F(l):l;l%2==0&&a%2==1||l%2!=0&&a%2!=1?(h+=`\n                  xCOffset = xC + imod(pads[1], 2) + ${e};\n\n                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                    xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n\n                    // Need to manually clear unused channels in case\n                    // we're reading from recycled texture.\n                    if (xCOffset + 1 >= inDims[1]) {\n                      xTexelC${t+1}.zw = vec2(0.0);\n                    }\n                    xTexelC${t+1}Ready = 1;\n                  }\n                  `,h+=l>1?`\n                    xCOffset -= 2;\n                    if (xCOffset >= 0 && xCOffset < inDims[1]) {\n                     previous = getX(batch, xR, xCOffset, d1);\n                     xC${t+1} = vec4(previous.zw, xTexelC${t+1}.xy);\n                    } else {\n                     xC${t+1} = vec4(0.0, 0.0, xTexelC${t+1}.xy);\n                    }\n                    `:`\n                    xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.xy);\n                    `):h+=1===e?`\n                    xC${t+1} = xTexelC${t};\n                    `:`\n                    xCOffset = xC + ${e};\n\n                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                      xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                      if (xCOffset + 1 >= inDims[1]) {\n                        xTexelC${t+1}.zw = vec2(0.0);\n                      }\n                      xTexelC${t+1}Ready = 1;\n                    }\n\n                    xC${t+1} = xTexelC${t+1};\n                    `}}else t<c&&(a%2==1?(h+=`\n                xCOffset = xC + 1 - strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xCOffset, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xC + 1, d1);\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if (xC + 2 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.0);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n              `,t+1<c&&(h+=`\n                  final = vec4(0.0);\n                  xCOffset = xC + 1 + strides[1];\n                  if(xCOffset >= 0 && xCOffset < inDims[1]) {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xC${t+1} = vec4(xTexelC${t+1}.xy, final.xy);\n                `)):(h+=`\n                if(xC >= 0 && xC < inDims[1] && xTexelC${t}Ready == 0) {\n                  xTexelC${t} = getX(batch, xR, xC, d1);\n                  if (xC + 1 >= inDims[1]) {\n                    xTexelC${t}.zw = vec2(0.0);\n                  }\n                  xTexelC${t}Ready = 1;\n                }\n\n                xCOffset = xC + strides[1];\n                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${t+1}Ready == 0) {\n                  xTexelC${t+1} = getX(batch, xR, xCOffset, d1);\n                  if (xCOffset + 1 >= inDims[1]) {\n                    xTexelC${t+1}.zw = vec2(0.);\n                  }\n                  xTexelC${t+1}Ready = 1;\n                }\n\n                xC${t} = vec4(\n                  xTexelC${t}.xy, xTexelC${t+1}.xy);\n              `,t+1<c&&(h+=`\n                  xC${t+1} = vec4(xTexelC${t}.zw, xTexelC${t+1}.zw);\n                `)));t<c&&(h+=`\n            wTexel = getW(r, ${t}, d1, q);\n            dotProd += xC${t} * vec4(wTexel.xz, wTexel.xz);\n          `,t+1<c&&(h+=`\n              wTexel = getW(r, ${t+1}, d1, q);\n              dotProd += xC${t+1} * vec4(wTexel.xz, wTexel.xz);\n            `))}h+="\n    }\n  ",h+="\n      }\n    ";let p="",f="";r&&(p=n?`vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ${r}\n        }`:o?`vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ${r}\n        }`:`vec4 activation(vec4 x) {\n          ${r}\n        }`,f="result = activation(result);");const m=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),n&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`\n      ${p}\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ${s};\n        int q = d2 - d1 * ${s};\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.\n        vec4 dotProd = vec4(0.000000000000001);\n\n        ${h}\n\n        vec4 result = dotProd - vec4(0.000000000000001);\n        ${m}\n        ${f}\n        setOutput(result);\n      }\n    `}}const gS={kernelName:ot,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,filter:s}=t,{strides:a,pad:i,dilations:l,dimRoundingMode:u}=n;let c=l;null==c&&(c=[1,1]),B(Ga(a,c),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`));const d=Pa(o.shape,s.shape,a,c,i,u,!0);let h;h=be().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels==1?new yS(d):new mS(d);const p=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return r.runWebGLProgram(h,[o,s],"float32",p)}};class vS{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,n=e.padInfo.top,o=e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ${s} + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ${e.batchSize}; b++) {\n          for (int yR = 0; yR < ${e.outHeight}; yR++) {\n            int xR = wR + yR * ${t} - ${n};\n\n            if (xR < 0 || xR >= ${e.inHeight}) {\n              continue;\n            }\n\n            for (int yC = 0; yC < ${e.outWidth}; yC++) {\n              int xC = wC + yC * ${r} - ${o};\n\n              if (xC < 0 || xC >= ${e.inWidth}) {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class bS{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,n=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.top,a=r-1-e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`\n      const ivec2 pads = ivec2(${s}, ${a});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ${t}; wR++) {\n          float dyR = float(dyRCorner + wR) / ${n}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ${t} - 1 - wR;\n\n          for (int wC = 0; wC < ${r}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${o}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ${r} - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ${i}; dm++) {\n              int d2 = d1 * ${i} + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const xS={kernelName:st,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,dy:s}=t,{strides:a,dilations:i,pad:l,dimRoundingMode:u,filterShape:c}=n,d=Pa(o.shape,c,a,i,l,u,!0),h=new vS(d);return r.runWebGLProgram(h,[o,s],"float32")}},wS={kernelName:at,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{dy:o,filter:s}=t,{strides:a,dilations:i,pad:l,dimRoundingMode:u,inputShape:c}=n,d=Pa(c,s.shape,a,i,l,u,!0),h=new bS(d);return r.runWebGLProgram(h,[o,s],"float32")}};class _S{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "}}const SS={kernelName:it,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{x:n}=t,o=[...n.shape,...n.shape],s=z(n.shape),a=nw({inputs:{x:n},backend:r,attrs:{shape:[s]}}),i=new _S(s),l=r.runWebGLProgram(i,[a],a.dtype),u=nw({inputs:{x:l},backend:r,attrs:{shape:o}});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}};class kS{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:n,strideHeight:o,strideWidth:s,filterHeight:a,filterWidth:i,dilationHeight:l,dilationWidth:u}=e,{top:c,left:d}=n;this.userCode=`\n      const ivec2 strides = ivec2(${o}, ${s});\n      const ivec2 pads = ivec2(${c}, ${d});\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ${a}; h++) {\n          int hIn = hBeg + h * ${l};\n\n          if (hIn >= 0 && hIn < ${t}) {\n            for (int w = 0; w < ${i}; w++) {\n              int wIn = wBeg + w * ${u};\n\n              if (wIn >= 0 && wIn < ${r}) {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    `}}const TS={kernelName:lt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,filter:s}=t,{strides:a,pad:i,dilations:l}=n,u=Ra(o.shape,s.shape,a,i,"NHWC",l);let c;const d=new kS(u);c=r.runWebGLProgram(d,[o,s],"float32");const h=nw({inputs:{x:c},backend:r,attrs:{shape:u.outShape}});return r.disposeIntermediateTensorInfo(c),h}},ES={kernelName:ct,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{equation:o}=n,s=t,{allDims:a,summedDims:i,idDims:l}=Ih(o,s.length);Ah(a.length,l,s);const{path:u,steps:c}=Rh(i,l),d=c.length;let h=null,p=a.length;const f=[];for(let e=0;e<d;++e){for(const t of c[e]){const{permutationIndices:e,expandDims:n}=Oh(p,l[t]);let o;Nh(e)?o=s[t]:(o=pw({inputs:{x:s[t]},backend:r,attrs:{perm:e}}),f.push(o));const a=o.shape.slice();for(let e=0;e<n.length;++e)a.splice(n[e],0,1);W(o.shape,a)||(o=nw({inputs:{x:o},backend:r,attrs:{shape:a}}),f.push(o)),null===h?h=o:(h=tw({inputs:{a:o,b:h},backend:r}),f.push(h))}e<d-1&&(u[e]>=0&&(h=dw({inputs:{x:h},backend:r,attrs:{axis:u[e]-(a.length-p),keepDims:!1}}),f.push(h)),p--)}for(const e of f)e!==h&&r.disposeIntermediateTensorInfo(e);return h}},jS={kernelName:"Elu",backendName:"webgl",kernelFunc:Xx({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"})},CS={kernelName:"EluGrad",backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:r}=e,{dy:n,y:o}=t,s=be().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Lx("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",n.shape,o.shape):new Mx("return (b >= 1.0) ? a : a * (b + 1.0);",n.shape,o.shape);return r.runWebGLProgram(s,[n,o],n.dtype)}},IS=Yx({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool",cpuKernelImpl:bb}),OS={kernelName:dt,backendName:"webgl",kernelFunc:IS},AS={kernelName:"Erf",backendName:"webgl",kernelFunc:Xx({opSnippet:`\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = ${dh};\n  float a1 = ${hh};\n  float a2 = ${ph};\n  float a3 = ${fh};\n  float a4 = ${mh};\n  float a5 = ${yh};\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n`})},RS=Xx({opSnippet:qx+"\n  return exp(x);\n",packedOpSnippet:"\n  vec4 result = exp(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:xb,dtype:"float32"}),NS={kernelName:ht,backendName:"webgl",kernelFunc:RS};function MS(e){const{inputs:t,attrs:r,backend:n}=e,{dim:o}=r,{input:s}=t,a=s.shape.length,i=s.shape.slice();let l=o;return o<0&&(B(-(a+1)<=o,(()=>`Axis must be in the interval [${-(a+1)}, ${a}]`)),l=a+o+1),i.splice(l,0,1),nw({inputs:{x:s},backend:n,attrs:{shape:i}})}const PS={kernelName:pt,backendName:"webgl",kernelFunc:MS},LS="return exp(x) - 1.0;",DS=Xx({opSnippet:LS,packedOpSnippet:LS,cpuKernelImpl:wb}),FS={kernelName:ft,backendName:"webgl",kernelFunc:DS};class $S{constructor(e,t,r){this.variableNames=["real","imag"];const n=t[1];this.outputShape=t;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,s=r?`${n}.0`:"1.0";let a;if("real"===e)a="return real * expR - imag * expI;";else{if("imag"!==e)throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);a="return real * expI + imag * expR;"}this.userCode=`\n      const float exponentMultiplier = ${o};\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ${a}\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(${n});\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ${n}; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ${s};\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    `}}function BS(e,t,r){const n=r.texData.get(e.dataId),o=z(e.shape),s=e.shape[e.shape.length-1],a=nw({inputs:{x:e},backend:r,attrs:{shape:[o/s,s]}}),i=a.shape,l=new $S("real",i,t),u=new $S("imag",i,t),c=[{dataId:n.complexTensorInfos.real.dataId,dtype:n.complexTensorInfos.real.dtype,shape:i},{dataId:n.complexTensorInfos.imag.dataId,dtype:n.complexTensorInfos.imag.dtype,shape:i}],d=r.runWebGLProgram(l,c,"float32"),h=r.runWebGLProgram(u,c,"float32"),p=$x({inputs:{real:d,imag:h},backend:r});r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h);const f=nw({inputs:{x:p},backend:r,attrs:{shape:e.shape}});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(p),f}const US={kernelName:"FFT",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{input:n}=t;return BS(n,!1,r)}};class VS{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}}function GS(e){const{backend:t,attrs:r}=e,{shape:n,value:o}=r;let{dtype:s}=r;if(s=s||oe(o),"string"===s){const e=J(s,z(n));return e.fill(o),t.makeTensorInfo(n,s,e)}{const e=new VS(n,o),r=[[o]];return t.runWebGLProgram(e,[],s,r)}}const zS={kernelName:mt,backendName:"webgl",kernelFunc:GS};class WS{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ${t} - x - 1;\n          float outputValue;\n          if(coordX >= 0 && coordX < ${t}) {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const HS={kernelName:yt,backendName:"webgl",kernelFunc:({inputs:e,backend:t})=>{const{image:r}=e,n=t,o=new WS(r.shape);return n.runWebGLProgram(o,[r],r.dtype)}},qS="return floor(x);",XS=Xx({opSnippet:qS,packedOpSnippet:qS,cpuKernelImpl:_b}),YS={kernelName:gt,backendName:"webgl",kernelFunc:XS},KS=Yx({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),ZS={kernelName:vt,backendName:"webgl",kernelFunc:KS};class QS{constructor(e){this.variableNames=["A"];const t=gg(),[r,n]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${n}.0, ${r}.0);\n\n        vec4 values = ${t.texture2D}(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    `}}class JS{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=gg(),[r,n]=e;this.outputShape=e,this.userCode=`\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(${n}.0, ${r}.0);\n            vec4 values = ${t.texture2D}(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ${t.output} = result;\n      }\n    `}}const ek={kernelName:Zr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e;let{pixels:o}=t;const{numChannels:s}=n,a="undefined"!=typeof HTMLVideoElement&&o instanceof HTMLVideoElement,i="undefined"!=typeof HTMLImageElement&&o instanceof HTMLImageElement,[l,u]=a?[o.videoWidth,o.videoHeight]:[o.width,o.height],c=[u,l],d=[u,l,s];if(i||a){const e=be().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");null!=tk&&e===rk||(rk=e,tk=document.createElement("canvas").getContext("2d",{willReadFrequently:rk})),tk.canvas.width=l,tk.canvas.height=u,tk.drawImage(o,0,0,l,u),o=tk.canvas}const h=r.makeTensorInfo(c,"int32");r.texData.get(h.dataId).usage=Uy.PIXELS,r.gpgpu.uploadPixelDataToTexture(r.getTexture(h.dataId),o);const p=be().getBool("WEBGL_PACK")?new JS(d):new QS(d),f=r.runWebGLProgram(p,[h],"int32");return r.disposeData(h.dataId),f}};let tk,rk=be().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");const nk={kernelName:en,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,filter:s,bias:a,preluActivationWeights:i}=t,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:h,activation:p,leakyreluAlpha:f}=n,m=za(c),y=Pa(o.shape,s.shape,l,d,u,h,!1,m);let g;const v=[],b=null!=a,x=null!=i,w="leakyrelu"===p,_=()=>{const e=[o,s],t=(e,t)=>{if("NCHW"===t&&1===e.shape.length&&1!==e.shape[0]){const t=nw({inputs:{x:e},backend:r,attrs:{shape:[e.shape[0],1,1]}});return v.push(t),t}return e};if(b&&e.push(t(a,c)),x&&e.push(t(i,c)),w){const t=r.makeTensorInfo([],"float32",En(f,"float32"));e.push(t),v.push(t)}return e};if(1!==y.filterHeight||1!==y.filterWidth||1!==y.dilationHeight||1!==y.dilationWidth||1!==y.strideHeight||1!==y.strideWidth||"SAME"!==y.padInfo.type&&"VALID"!==y.padInfo.type)if(y.strideWidth<=2&&"channelsLast"===m&&be().getBool("WEBGL_EXP_CONV")){const e=p?Kx(p,!0):null,t=new $_(y,b,e,x,w),n=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],o=_();g=r.runWebGLProgram(t,o,"float32",n)}else if(be().getBool("WEBGL_CONV_IM2COL"))g=G_({x:o,filter:s,convInfo:y,backend:r,bias:a,activation:p,preluActivationWeights:i,leakyreluAlpha:f});else{const e=p?Kx(p,!1):null,t=new D_(y,b,e,x,w),n=_();g=r.runWebGLProgram(t,n,"float32")}else g=V_({x:o,filter:s,convInfo:y,backend:r,bias:a,activation:p,preluActivationWeights:i,leakyreluAlpha:f});const S=nw({inputs:{x:g},backend:r,attrs:{shape:y.outShape}});return v.push(g),v.forEach((e=>r.disposeIntermediateTensorInfo(e))),S}},ok={kernelName:tn,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,filter:s,bias:a,preluActivationWeights:i}=t,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:h,leakyreluAlpha:p}=n,f=[];let m=c;null==m&&(m=[1,1]),B(Ga(l,m),(()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`));const y=Pa(o.shape,s.shape,l,m,u,d,!0),g=be().getBool("WEBGL_PACK_DEPTHWISECONV")&&y.strideWidth<=2&&y.outChannels/y.inChannels==1,v=h?Kx(h,g):null,b=[o,s],x=null!=a,w=null!=i,_="leakyrelu"===h;if(x&&b.push(a),w&&b.push(i),_){const e=r.makeTensorInfo([],"float32",En(p,"float32"));b.push(e),f.push(e)}let S;S=g?new yS(y,x,v,w,_):new mS(y,x,v,w,_);const k=[[y.padInfo.top,y.padInfo.left],[y.strideHeight,y.strideWidth],[y.dilationHeight,y.dilationWidth],[y.inHeight,y.inWidth]],T=r.runWebGLProgram(S,b,"float32",k);return f.forEach((e=>r.disposeIntermediateTensorInfo(e))),T}};class sk{constructor(e,t,r,n){this.sliceDim=e,this.strides=t,this.paramsShape=n,this.variableNames=["x","indices"],this.outputShape=r;const o=Rg(r.length);let s="\n    int index;";for(let e=0;e<this.sliceDim;e++)s+=`\n          index = round(getIndices(coords[0], ${e}));\n          out_of_bounds = out_of_bounds || index < 0;\n          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[e]};\n          flattenIndex += index * ${this.strides[e]};`;this.userCode=`\n         void main() {\n          ${o} coords = getOutputCoords();\n          int flattenIndex = 0;\n          bool out_of_bounds = false;\n\n          ${s}\n\n          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));\n        }\n      `}}const ak={kernelName:wt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{params:n,indices:o}=t,s=o.shape,a=s[s.length-1],i=z(n.shape),[l,u,c,d]=lh(n,o),h=nw({inputs:{x:o},backend:r,attrs:{shape:[u,a]}}),p=nw({inputs:{x:n},backend:r,attrs:{shape:[z(n.shape)/c,c]}});if(r.shouldExecuteOnCPU([n,o])||"string"===n.dtype){const e=r.readSync(o.dataId),t=r.bufferSync(n),s=Sb(e,t,n.dtype,u,a,c,d,n.shape,i);return r.makeTensorInfo(l,n.dtype,s.values)}const f=new sk(a,d,[u,c],n.shape),m=r.runWebGLProgram(f,[p,h],p.dtype),y=nw({inputs:{x:m},backend:r,attrs:{shape:l}});return r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(m),y}};class ik{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=Rg(this.rank),n=function(e,t){const r=["resRC.x","resRC.y","resRC.z","resRC.w"],n=[];for(let t=0;t<e.length;t++)2===t?n.push("index"):n.push(`${r[t]}`);return n.join()}(e);this.userCode=`\n      void main() {\n        ${r} resRC = getOutputCoords();\n        int index = int(getIndices(resRC.x, resRC.z));\n        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;\n        setOutput(inBounds * getA(${n}));\n      }\n    `}}function lk(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,indices:s}=t,{axis:a,batchDims:i}=n,l=K(a,o.shape)[0];if(be().get("DEBUG")){const e=r.readSync(s.dataId),t=o.shape[l];for(let r=0;r<e.length;++r){const n=e[r];B(n<=t-1&&n>=0,(()=>`GatherV2: the index value ${n} is not in [0, ${t-1}]`))}}const u=Kh(o,s,l,i),c=z(s.shape),d=[],h=nw({inputs:{x:o},backend:r,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),p=nw({inputs:{x:s},backend:r,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(h),d.push(p);const f=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(r.shouldExecuteOnCPU([o,s])||"string"===o.dtype){const e=r.bufferSync(p),t=r.bufferSync(h),n=kb(t,e,f);return d.forEach((e=>r.disposeIntermediateTensorInfo(e))),r.makeTensorInfo(u.outputShape,n.dtype,n.values)}const m=new ik(h.shape,f),y=r.runWebGLProgram(m,[h,p],h.dtype);d.push(y);const g=nw({inputs:{x:y},backend:r,attrs:{shape:u.outputShape}});return d.forEach((e=>r.disposeIntermediateTensorInfo(e))),g}const uk={kernelName:xt,backendName:"webgl",kernelFunc:lk},ck=Yx({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Tb,dtype:"bool"}),dk={kernelName:_t,backendName:"webgl",kernelFunc:ck},hk=Yx({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool",cpuKernelImpl:Eb}),pk={kernelName:St,backendName:"webgl",kernelFunc:hk},fk={kernelName:Tt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{input:n}=t;return BS(n,!0,r)}},mk=Xx({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),yk={kernelName:jt,backendName:"webgl",kernelFunc:mk},gk=Xx({opSnippet:"return float(isinf(x));",dtype:"bool"}),vk={kernelName:Ct,backendName:"webgl",kernelFunc:gk},bk=Xx({opSnippet:"return float(isnan(x));",dtype:"bool"}),xk={kernelName:It,backendName:"webgl",kernelFunc:bk},wk=Yx({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:jb,dtype:"bool"}),_k={kernelName:At,backendName:"webgl",kernelFunc:wk},Sk=Yx({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",cpuKernelImpl:Cb,dtype:"bool"}),kk={kernelName:Rt,backendName:"webgl",kernelFunc:Sk},Tk={kernelName:Nt,backendName:"webgl",kernelFunc:function(e){const{backend:t,attrs:r}=e,{start:n,stop:o,num:s}=r,a=Ib(n,o,s);return t.makeTensorInfo([a.length],"float32",a)}},Ek=Xx({opSnippet:qx+"\n  return x < 0.0 ? 0./0. : log(x);\n",packedOpSnippet:"\n  vec4 result = log(x);\n  bvec4 isNaN = isnan(x);\n  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);\n  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);\n  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);\n  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);\n  return result;\n",cpuKernelImpl:Ob}),jk={kernelName:Mt,backendName:"webgl",kernelFunc:Ek},Ck=Xx({opSnippet:qx+"\n  return log(1.0 + x);\n"}),Ik={kernelName:Pt,backendName:"webgl",kernelFunc:Ck},Ok=Yx({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),Ak={kernelName:Lt,backendName:"webgl",kernelFunc:Ok},Rk=Xx({opSnippet:"return float(!(x >= 1.0));"}),Nk={kernelName:Dt,backendName:"webgl",kernelFunc:Rk},Mk=Yx({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),Pk={kernelName:Ft,backendName:"webgl",kernelFunc:Mk};class Lk{constructor(e,t,r,n,o){this.variableNames=["x"],this.outputShape=[];const s=t,a=e[3]-1;let i;this.outputShape=e;const l=`float(${r}) + float(${n}) * sum`;i=.5===o?`inversesqrt(${l})`:1===o?`1.0/(${l})`:`exp(log(${l}) * float(-${o}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -${s}; j <= ${s}; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ${a}) {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ${i};\n        setOutput(val);\n      }\n    `}}class Dk{constructor(e,t,r,n,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const s=t,a=e[3]-1;let i;this.outputShape=e;const l=`float(${r}) + float(${n}) * sum`;i=.5===o?`inversesqrt(${l})`:1===o?`1.0/(${l})`:`exp(log(${l}) * float(-${o}));`,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ${this.outputShape[3]};\n        bool hasNextRow = c < ${this.outputShape[2]};\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ${s};\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ${s}; j <= ${s}; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ${i};\n        setOutput(result);\n      }\n    `}}const Fk={kernelName:"LRN",backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{depthRadius:s,bias:a,alpha:i,beta:l}=n,u=be().getBool("WEBGL_PACK_NORMALIZATION")?new Dk(o.shape,s,a,i,l):new Lk(o.shape,s,a,i,l);return r.runWebGLProgram(u,[o],o.dtype)}};class $k{constructor(e,t,r,n,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=n,this.beta=o,this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ${this.depth}; ++d) {\n          int depthBegin = int(max(0.0, float(d - ${t})));\n          int depthEnd = int(min(float(${this.depth}),\n              float(d + ${t} + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ${this.depth};\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(${n}) * norm + float(${r});\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(${n})\n                * float(${o})\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ${o});\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    `}}const Bk={kernelName:"LRNGrad",backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:r,attrs:n}=e,{x:o,y:s,dy:a}=t,{depthRadius:i,bias:l,alpha:u,beta:c}=n,d=new $k(o.shape,i,l,u,c);return r.runWebGLProgram(d,[o,s,a],o.dtype)}};function Uk(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{reductionIndices:s,keepDims:a}=n,i=o.shape.length,l=K(s,o.shape);let u=l;const c=Xi(u,i),d=null!=c,h=r.shouldExecuteOnCPU([o]);let p=o;if(d){if(h){const e=r.texData.get(p.dataId).values,t=new Array(i);for(let e=0;e<t.length;e++)t[e]=o.shape[c[e]];const n=nx(e,o.shape,o.dtype,c,t);p=r.makeTensorInfo(t,o.dtype),r.texData.get(p.dataId).values=n}else p=cw(o,c,r);u=Ki(u.length,i)}qi("max",u,i);const[f,m]=Wi(p.shape,u);let y,g=f;if(a&&(g=Hi(f,l)),h){const e=r.texData.get(p.dataId).values,t=Ab(e,z(m),g,o.dtype);y=r.makeTensorInfo(g,o.dtype),r.texData.get(y.dataId).values=t}else y=function(e,t,r,n){const o=z(t),s=nw({inputs:{x:e},attrs:{shape:[z(e.shape)/o,o]},backend:n}),a=iw(s,e.dtype,"max",n),i=nw({inputs:{x:a},attrs:{shape:r},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),i}(p,m,g,r);return d&&r.disposeIntermediateTensorInfo(p),y}const Vk={kernelName:"Max",backendName:"webgl",kernelFunc:Uk},Gk=Yx({opSnippet:Nx+"\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Px+"\n  return result;\n",cpuKernelImpl:Rb}),zk={kernelName:$t,backendName:"webgl",kernelFunc:Gk},Wk={kernelName:Bt,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t;mg(o,"maxPool");const{filterSize:s,strides:a,pad:i,dimRoundingMode:l}=n;B(Ga(a,1),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '1'`));const u=Na(o.shape,s,a,1,i,l);if(1===u.filterWidth&&1===u.filterHeight&&W(u.inShape,u.outShape))return Dx({inputs:{x:o},backend:r});const c=new Yw(u,"max",!1);return r.runWebGLProgram(c,[o],o.dtype)}},Hk={kernelName:Ut,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{filterSize:s,strides:a,pad:i,dataFormat:l,dimRoundingMode:u}=n,c=Ma(o.shape,s,a,[1,1,1],i,u,l),d=new Kw(c,"max",!1);return r.runWebGLProgram(d,[o],o.dtype)}};class qk{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,n=e.dilationHeight,o=e.effectiveFilterHeight,s=e.effectiveFilterWidth,a=o-1-e.padInfo.top,i=s-1-e.padInfo.left,l=o*s-1;this.userCode=`\n      const ivec2 pads = ivec2(${a}, ${i});\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ${o};\n          wR += ${n}) {\n          float dyR = float(dyRCorner + wR) / ${t}.0;\n\n          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ${s}; wC++) {\n            float dyC = float(dyCCorner + wC) / ${r}.0;\n\n            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ${l} - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ${s} + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}class Xk{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,n=e.strideWidth,o=e.dilationDepth,s=e.dilationHeight,a=e.dilationWidth,i=e.effectiveFilterDepth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=i-1-e.padInfo.front,d=l-1-e.padInfo.top,h=u-1-e.padInfo.left,p=i*l*u-1;this.userCode=`\n      const ivec3 pads = ivec3(${c}, ${d}, ${h});\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ${i};\n           wD += ${o}) {\n          float dyD = float(dyDCorner + wD) / ${t}.0;\n\n          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ${l};\n              wR += ${s}) {\n            float dyR = float(dyRCorner + wR) / ${r}.0;\n\n            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ${u};\n                wC += ${a}) {\n              float dyC = float(dyCCorner + wC) / ${n}.0;\n\n              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ${p} -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ${l} * ${u} +\n                  wR * ${u} + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    `}}const Yk={kernelName:"MaxPool3DGrad",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{dy:o,input:s}=t,a=s,{filterSize:i,strides:l,pad:u,dimRoundingMode:c}=n,d=Ma(a.shape,i,l,[1,1,1],u,c),h=new Kw(d,"max",!0),p=r.runWebGLProgram(h,[a],a.dtype),f=new Xk(d),m=r.runWebGLProgram(f,[o,p],a.dtype);return r.disposeIntermediateTensorInfo(p),m}},Kk={kernelName:"MaxPoolGrad",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{dy:o,input:s,output:a}=t,i=s;mg([s,a],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=n,h=Na(i.shape,l,u,1,c,d),p=new Yw(h,"max",!0),f=r.runWebGLProgram(p,[i],i.dtype),m=new qk(h),y=r.runWebGLProgram(m,[o,f],i.dtype);return r.disposeIntermediateTensorInfo(f),y}},Zk={kernelName:Vt,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:r})=>{const{x:n}=e,{filterSize:o,strides:s,pad:a,includeBatchInIndex:i}=t,l=r;B(4===n.shape.length,(()=>`Error in maxPool: input must be rank 4 but got rank ${n.shape.length}.`));const u=[1,1];B(Ga(s,u),(()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${u}'`));const c=Na(n.shape,o,s,u,a),[d,h]=function(e,t,r,n){let o=new Yw(r,"max",!1);const s=n.runWebGLProgram(o,[e],"float32");return o=new Yw(r,"max",!0,!0,t),[s,n.runWebGLProgram(o,[e],"float32")]}(n,i,c,l);return[d,h]}},Qk={kernelName:Gt,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:r})=>{const{x:n}=e,{keepDims:o,axis:s}=t,a=r,i=n.shape.length,l=K(s,n.shape);let u=l;const c=Xi(u,i),d=null!=c,h=a.shouldExecuteOnCPU([n]),p=[];let f=n;if(d){if(h){const e=a.texData.get(f.dataId).values,t=new Array(i);for(let e=0;e<t.length;e++)t[e]=n.shape[c[e]];const r=nx(e,n.shape,n.dtype,c,t);f=a.makeTensorInfo(t,n.dtype),a.texData.get(f.dataId).values=r}else f=cw(n,c,a);p.push(f),u=Ki(u.length,i)}qi("sum",u,i);const[m,y]=Wi(f.shape,u);let g=m;o&&(g=Hi(m,l));const v=function(e,t,r,n){const o=z(t),s=nw({inputs:{x:e},attrs:{shape:[z(e.shape)/o,o]},backend:n}),a=iw(s,"float32","mean",n),i=nw({inputs:{x:a},attrs:{shape:r},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),i}(f,y,g,a);for(const e of p)a.disposeIntermediateTensorInfo(e);return v}},Jk={kernelName:"Min",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s,keepDims:a}=n,i=o.shape.length,l=K(s,o.shape);let u=l;const c=Xi(u,i);let d=o;null!=c&&(d=pw({inputs:{x:o},backend:r,attrs:{perm:c}}),u=Ki(u.length,o.shape.length)),qi("min",u,i);const[h,p]=Wi(d.shape,u),f=nw({inputs:{x:d},backend:r,attrs:{shape:[-1,z(p)]}}),m=iw(f,f.dtype,"min",r);let y;return y=nw(a?{inputs:{x:m},backend:r,attrs:{shape:Hi(h,l)}}:{inputs:{x:m},backend:r,attrs:{shape:h}}),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(m),null!=c&&r.disposeIntermediateTensorInfo(d),y}},eT=Yx({opSnippet:Nx+"\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  bvec4 isNaNA = isnan(a);\n  bvec4 isNaNB = isnan(b);\n  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);\n  "+Px+"\n  return result;\n",cpuKernelImpl:Nb}),tT={kernelName:zt,backendName:"webgl",kernelFunc:eT};class rT{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map(((t,r)=>t[0]+e[r]+t[1]));const n=e.length,o=Rg(n),s=t.map((e=>e[0])).join(","),a=t.map(((t,r)=>t[0]+e[r])).join(","),i=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n),l="reflect"===r?0:1;this.userCode=1!==n?`\n      ${o} start = ${o}(${s});\n      ${o} end = ${o}(${a});\n\n      void main() {\n        ${o} outC = getOutputCoords();\n        for (int i = 0; i < ${n}; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ${l};\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ${l};\n          }\n        }\n        ${o} coords = outC - start;\n        setOutput(getX(${i}));\n      }\n    `:`\n        int start = ${s};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ${l};\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ${l};\n          }\n          setOutput(getX(outC - start));\n        }\n      `}}class nT{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map(((t,r)=>t[0]+e[r]+t[1]));const n=e.length,o=Rg(n),s=t.map((e=>e[0])).join(","),a=t.map(((t,r)=>t[0]+e[r])).join(","),i=ax("rc",n),l=ax("source",n),u=`${i[n-1]} < ${this.outputShape[n-1]}`,c=1===n?"source":`vec2(${l.slice(-2).join()})`,d="reflect"===r?0:1;let h="";if(1===n){const e=`\n        ${o} source = rc;\n        if (source < start) {\n          source = start * 2 - source - ${d};\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ${d};\n        }\n        source -= start;\n      `;h=`\n        ${o} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${i[n-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n      `}else{const e=`\n        ${o} source = rc;\n        ${o} lt = ${o}(lessThan(source, start));\n        ${o} gte = ${o}(greaterThanEqual(source, end));\n        ${o} orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ${d}) +\n                gte * ((end - 1) * 2 - source + ${d});\n        source -= start;\n      `;h=`\n        ${o} rc = outputLoc;\n        ${e}\n        result[0] = getChannel(getX(${l.join()}), ${c});\n        ${i[n-1]} += 1;\n        if(${u}) {\n          ${e}\n          result[1] = getChannel(getX(${l.join()}), ${c});\n        }\n        rc = outputLoc;\n        ${i[n-2]} += 1;\n        if(${i[n-2]} < ${this.outputShape[n-2]}) {\n          ${e}\n          result[2] = getChannel(getX(${l.join()}), ${c});\n          ${i[n-1]} += 1;\n          if(${u}) {\n            ${e}\n            result[3] = getChannel(getX(${l.join()}), ${c});\n          }\n        }\n      `}this.userCode=`\n      const ${o} start = ${o}(${s});\n      const ${o} end = ${o}(${a});\n\n      void main() {\n        ${o} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${h}\n        setOutput(result);\n      }\n    `}}const oT={kernelName:Wt,backendName:"webgl",kernelFunc:({inputs:e,backend:t,attrs:r})=>{const{x:n}=e,{paddings:o,mode:s}=r,a=be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nT(n.shape,o,s):new rT(n.shape,o,s);return t.runWebGLProgram(a,[n],n.dtype)}},sT={kernelName:"Mod",backendName:"webgl",kernelFunc:Yx({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  bvec4 isNaN = equal(b, vec4(0.0));\n  "+Px+"\n  return result;\n"})};class aT{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ${t-1}; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(${t-1}));\n      }\n    `}}const iT=Yx({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),lT={kernelName:ut,backendName:"webgl",kernelFunc:iT},uT="return a - b;",cT=Yx({opSnippet:uT,packedOpSnippet:uT,supportsComplex:!0,cpuKernelImpl:ex}),dT={kernelName:Br,backendName:"webgl",kernelFunc:cT};function hT(e){const{inputs:t,backend:r,attrs:n}=e,{logits:o}=t,{dim:s}=n,a=K([s],o.shape),i=Uk({inputs:{x:o},backend:r,attrs:{reductionIndices:a,keepDims:!1}}),l=Hi(i.shape,a),u=nw({inputs:{x:i},backend:r,attrs:{shape:l}}),c=cT({inputs:{a:o,b:u},backend:r}),d=RS({inputs:{x:c},backend:r}),h=dw({inputs:{x:d},backend:r,attrs:{axis:a,keepDims:!1}}),p=nw({inputs:{x:h},backend:r,attrs:{shape:l}}),f=iT({inputs:{a:d,b:p},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(u),r.disposeIntermediateTensorInfo(c),r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(p),f}const pT={kernelName:Ir,backendName:"webgl",kernelFunc:hT},fT={kernelName:Ht,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{logits:o}=t,{numSamples:s,seed:a,normalized:i}=n,l=i?o:hT({inputs:{logits:o},backend:r,attrs:{dim:o.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new aT(u,c,s),h=[[a]],p=r.runWebGLProgram(d,[l],"int32",h);return i||r.disposeIntermediateTensorInfo(l),p}},mT=fx+"\n  return -x;\n",yT={kernelName:"Neg",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{x:n}=t;if(r.shouldExecuteOnCPU([n])){const e=r.texData.get(n.dataId),[t,o]=Pb(e.values,n.shape,n.dtype);return r.makeTensorInfo(o,n.dtype,t)}let o;return o=be().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new jx(n.shape,"\n  vec4 result = -x;\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"):new px(n.shape,mT),r.runWebGLProgram(o,[n],n.dtype)}},gT=sd,vT={kernelName:Yt,backendName:"webgl",kernelFunc:function(e){rn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:r,attrs:n}=e,{boxes:o,scores:s}=t,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l}=n,u=r.readSync(o.dataId),c=r.readSync(s.dataId),{selectedIndices:d}=gT(u,c,a,i,l);return r.makeTensorInfo([d.length],"int32",new Int32Array(d))}},bT=ad,xT={kernelName:Kt,backendName:"webgl",kernelFunc:function(e){rn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:r,attrs:n}=e,{boxes:o,scores:s}=t,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,padToMaxOutputSize:u}=n,c=r.readSync(o.dataId),d=r.readSync(s.dataId),{selectedIndices:h,validOutputs:p}=bT(c,d,a,i,l,u);return[r.makeTensorInfo([h.length],"int32",new Int32Array(h)),r.makeTensorInfo([],"int32",new Int32Array([p]))]}},wT=id,_T={kernelName:Zt,backendName:"webgl",kernelFunc:function(e){rn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:t,backend:r,attrs:n}=e,{boxes:o,scores:s}=t,{maxOutputSize:a,iouThreshold:i,scoreThreshold:l,softNmsSigma:u}=n,c=r.readSync(o.dataId),d=r.readSync(s.dataId),h=a,p=i,f=l,m=u,{selectedIndices:y,selectedScores:g}=wT(c,d,h,p,f,m);return[r.makeTensorInfo([y.length],"int32",new Int32Array(y)),r.makeTensorInfo([g.length],"float32",new Float32Array(g))]}};class ST{constructor(e,t,r,n){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(${n}), float(${r}),\n                      float(index == coords.y)));\n      }\n    `}}const kT={kernelName:Jt,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:r,attrs:n}=e,{indices:o}=t,{dtype:s,depth:a,onValue:i,offValue:l}=n,u=z(o.shape),c=new ST(u,a,i,l),d=nw({inputs:{x:o},backend:r,attrs:{shape:[u]}}),h=r.runWebGLProgram(c,[d],s);r.disposeIntermediateTensorInfo(d);const p=nw({inputs:{x:h},backend:r,attrs:{shape:[...o.shape,a]}});return r.disposeIntermediateTensorInfo(h),p}};function TT(e){const{inputs:t,backend:r}=e,{x:n}=t;if("complex64"===n.dtype){const e=g_({inputs:{input:n},backend:r}),t=TT({inputs:{x:e},backend:r}),o=R_({inputs:{input:n},backend:r}),s=TT({inputs:{x:o},backend:r}),a=$x({inputs:{real:t,imag:s},backend:r});return r.disposeIntermediateTensorInfo(e),r.disposeIntermediateTensorInfo(t),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),a}return GS({attrs:{shape:n.shape,dtype:n.dtype,value:"string"===n.dtype?"":0},backend:r})}const ET={kernelName:Yr,backendName:"webgl",kernelFunc:TT},jT={kernelName:Qt,backendName:"webgl",kernelFunc:function e(t){const{inputs:r,backend:n}=t,{x:o}=r;if("string"===o.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===o.dtype){const t=g_({inputs:{input:o},backend:n}),r=e({inputs:{x:t},backend:n}),s=R_({inputs:{input:o},backend:n}),a=TT({inputs:{x:s},backend:n}),i=$x({inputs:{real:r,imag:a},backend:n});return n.disposeIntermediateTensorInfo(t),n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),i}return GS({attrs:{shape:o.shape,dtype:o.dtype,value:1},backend:n})}},CT={kernelName:er,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{axis:o}=n;if(1===t.length)return MS({inputs:{input:t[0]},backend:r,attrs:{dim:o}});const s=t[0].shape,a=t[0].dtype;t.forEach((e=>{U(s,e.shape,"All tensors passed to stack must have matching shapes"),B(a===e.dtype,(()=>"All tensors passed to stack must have matching dtypes"))}));const i=[],l=t.map((e=>{const t=MS({inputs:{input:e},backend:r,attrs:{dim:o}});return i.push(t),t})),u=P_({inputs:l,backend:r,attrs:{axis:o}});return i.forEach((e=>r.disposeIntermediateTensorInfo(e))),u}};class IT{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,r)=>t[0]+e[r]+t[1]));const n=e.length,o=Rg(n),s=t.map((e=>e[0])).join(","),a=t.map(((t,r)=>t[0]+e[r])).join(","),i=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,n);this.userCode=1!==n?`\n      ${o} start = ${o}(${s});\n      ${o} end = ${o}(${a});\n\n      void main() {\n        ${o} outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ${o} coords = outC - start;\n          setOutput(getX(${i}));\n        }\n      }\n    `:`\n        int start = ${s};\n        int end = ${a};\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      `}}class OT{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map(((t,r)=>t[0]+e[r]+t[1]));const n=e.length,o=Rg(n),s=t.map((e=>e[0])).join(","),a=t.map(((t,r)=>t[0]+e[r])).join(","),i=ax("rc",n),l=ax("source",n),u=`${i[n-1]} < ${this.outputShape[n-1]}`,c=1===n?"source":`vec2(${l.slice(-2).join()})`,d=[`${o} rc = outputLoc;`,`${i[n-1]} += 1;\n       if(${u}) {\n      `,1===n?"":`}\n       rc = outputLoc;\n       ${i[n-2]} += 1;\n       if(${i[n-2]} < ${this.outputShape[n-2]}) {`,1===n?"":`  ${i[n-1]} += 1;\n         if(${u}) {`],h=1===n?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let e=0,t=1===n?2:4;e<t;e++)p+=`\n        ${d[e]}\n        if (${h}) {\n          result[${e}] = float(value);\n        } else {\n          ${o} source = rc - start;\n          result[${e}] = getChannel(getX(${l.join()}), ${c});\n        }\n      `;p+=1===n?"} ":"}}",this.userCode=`\n      const ${o} start = ${o}(${s});\n      const ${o} end = ${o}(${a});\n\n      void main() {\n        ${o} outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ${p}\n        setOutput(result);\n      }\n    `}}const AT=e=>{const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{paddings:s,constantValue:a}=n;if(0===z(o.shape))return GS({backend:r,attrs:{shape:s.map(((e,t)=>e[0]+o.shape[t]+e[1])),value:a,dtype:o.dtype}});const i=be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new OT(o.shape,s,a):new IT(o.shape,s,a),l=[[a]];return r.runWebGLProgram(i,[o],o.dtype,l)},RT={kernelName:tr,backendName:"webgl",kernelFunc:AT},NT={kernelName:"Pow",backendName:"webgl",kernelFunc:Yx({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  bvec4 isNaN1 = lessThan(a, vec4(0.0));\n  bvec4 isNaN2 = lessThan(floor(b), b);\n  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);\n  "+Px+"\n  return result;\n"})},MT={kernelName:nr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{axis:s,keepDims:a}=n,i=o.shape.length,l=[],u=K(s,o.shape);let c=u;const d=Xi(c,i);let h,p=o;if(null!=d&&(p=pw({inputs:{x:o},backend:r,attrs:{perm:d}}),c=Ki(c.length,i),l.push(p)),qi("prod",c,i),r.shouldExecuteOnCPU([p])){const e=r.texData.get(p.dataId).values,{outVals:t,outShape:n,outDtype:o}=Db(p.shape,p.dtype,e,c);h=r.makeTensorInfo(n,o,t)}else{const[e,t]=Wi(p.shape,c),n=z(t),s=nw({inputs:{x:p},backend:r,attrs:{shape:[-1,n]}}),a=iw(s,to(o.dtype),"prod",r);h=nw({inputs:{x:a},backend:r,attrs:{shape:e}}),l.push(s),l.push(a)}if(a){l.push(h);const e=Hi(h.shape,u);h=nw({inputs:{x:h},backend:r,attrs:{shape:e}})}return l.forEach((e=>r.disposeIntermediateTensorInfo(e))),h}},PT={kernelName:or,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{paramsNestedSplits:o,paramsDenseValues:s,indices:a}=t,{outputRaggedRank:i}=n,l=o.map((e=>r.readSync(e.dataId))),u=o.map((e=>e.shape)),c=r.readSync(s.dataId),d=r.readSync(a.dataId),[h,p,f]=Fb(l,u,c,s.shape,s.dtype,d,a.shape,i),m=h.map((e=>r.makeTensorInfo([e.length],"int32",e))),y=r.makeTensorInfo(f,s.dtype,p);return m.concat([y])}},LT={kernelName:sr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{shape:o,values:s,defaultValue:a,rowPartitionTensors:i}=t,{rowPartitionTypes:l}=n,u=r.readSync(o.dataId),c=r.readSync(s.dataId),d=r.readSync(a.dataId),h=i.map((e=>r.readSync(e.dataId))),p=i.map((e=>e.shape)),[f,m]=$b(u,o.shape,c,s.shape,s.dtype,d,a.shape,h,p,l);return r.makeTensorInfo(f,s.dtype,m)}},DT=e=>{const{backend:t,attrs:r}=e,{start:n,stop:o,step:s,dtype:a}=r,i=Bb(n,o,s,a);return t.makeTensorInfo([i.length],a,i)},FT={kernelName:ar,backendName:"webgl",kernelFunc:DT},$T=Xx({opSnippet:"return 1.0 / x;"}),BT={kernelName:lr,backendName:"webgl",kernelFunc:$T},UT=Xx({opSnippet:fx+"\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),VT={kernelName:ur,backendName:"webgl",kernelFunc:UT},GT=Xx({opSnippet:fx+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),zT={kernelName:pr,backendName:"webgl",kernelFunc:GT};class WT{constructor(e,t,r,n,o){this.variableNames=["A"],this.outputShape=[];const[s,a,i,l]=e;this.outputShape=[s,t,r,l];const u=[n&&t>1?a-1:a,n&&r>1?i-1:i],c=[n&&t>1?t-1:t,n&&r>1?r-1:r];let d;d=o?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${i}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    `}}class HT{constructor(e,t,r,n,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,a,i,l]=e;this.outputShape=[s,t,r,l];const u=[n&&t>1?a-1:a,n&&r>1?i-1:i],c=[n&&t>1?t-1:t,n&&r>1?r-1:r];let d;d=o?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${i}.0,\n                                     ${i}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${d};\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${r-1};\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    `}}const qT={kernelName:hr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{images:o}=t,{alignCorners:s,halfPixelCenters:a,size:i}=n,[l,u]=i,c=be().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new HT(o.shape,l,u,s,a):new WT(o.shape,l,u,s,a);return r.runWebGLProgram(c,[o],"float32")}};class XT{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,n,o]=t,[,s,a]=e,i=[r&&s>1?n-1:n,r&&a>1?o-1:o],l=[r&&s>1?s-1:s,r&&a>1?a-1:a],u=i[0]/l[0],c=i[1]/l[1],d=1/u,h=1/c,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${h});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ${n-1}.0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const YT={kernelName:"ResizeBilinearGrad",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{images:o,dy:s}=t,{alignCorners:a}=n,i=new XT(s.shape,o.shape,a);return r.runWebGLProgram(i,[s],s.dtype)}};class KT{constructor(e,t,r,n,o){this.variableNames=["A"],this.outputShape=[];const[s,a,i,l]=e;this.outputShape=[s,t,r,l];const u=[n&&t>1?a-1:a,n&&r>1?i-1:i],c=[n&&t>1?t-1:t,n&&r>1?r-1:r],d=n?"0.5":"0.0";let h;h=o?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]});\n      const vec2 inputShapeRC = vec2(${a}.0, ${i}.0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ${h};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    `}}class ZT{constructor(e,t,r,n,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[s,a,i,l]=e;this.outputShape=[s,t,r,l];const u=[n&&t>1?a-1:a,n&&r>1?i-1:i],c=[n&&t>1?t-1:t,n&&r>1?r-1:r],d=n?"0.5":"0.0";let h;h=o?"max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ${u[0]/c[0]},\n          ${u[1]/c[1]},\n          ${u[1]/c[1]});\n      const vec3 inputShapeRC = vec3(${a}.0, ${i}.0,\n                                     ${i}.0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ${h};\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec3 sourceNearestRC = ivec3(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ${l-1};\n        bool hasNextRow = coords.z < ${r-1};\n\n        vec4 newValue = vec4(\n          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),\n          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);\n\n        setOutput(newValue);\n      }\n    `}}const QT={kernelName:dr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{images:o}=t,{alignCorners:s,halfPixelCenters:a,size:i}=n,[l,u]=i,c=be().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new ZT(o.shape,l,u,s,a):new KT(o.shape,l,u,s,a);return r.runWebGLProgram(c,[o],o.dtype)}};class JT{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,n,o]=t,[,s,a]=e,i=[r&&s>1?n-1:n,r&&a>1?o-1:o],l=[r&&s>1?s-1:s,r&&a>1?a-1:a],u=i[0]/l[0],c=i[1]/l[1],d=1/u,h=1/c,p=2*Math.ceil(d)+2,f=2*Math.ceil(h)+2;this.userCode=`\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(${u});\n        const float widthScale = float(${c});\n\n        const float invHeightScale = float(${d});\n        const float invWidthScale = float(${h});\n\n        const int winHeight = int(${p});\n        const int winWidth = int(${f});\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ${s}) {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ${a}) {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(${i[0]}) *\n                (float(dyR) / float(${l[0]}));\n\n            float sourceFracCol =\n                float(${i[1]}) *\n                  (float(dyC) / float(${l[1]}));\n\n            int sourceNearestRow = int(min(\n                float(int(${n}) - 1),\n                ${r} ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(${o}) - 1),\n                ${r} ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    `}}const eE={kernelName:"ResizeNearestNeighborGrad",backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{images:o,dy:s}=t,{alignCorners:a}=n,i=new JT(s.shape,o.shape,a);return r.runWebGLProgram(i,[s],s.dtype)}};class tE{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,1===r)return void(this.userCode=`\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(${e[0]} - coord - 1));\n        }\n      `);const n=e.map(((r,n)=>(r=>-1!==t.indexOf(r)&&1!==e[r]?`${e[r]} - coords[${r}] - 1`:`coords[${r}]`)(n))).join(","),o=Rg(r);this.userCode=`\n      void main() {\n        ${o} coords = getOutputCoords();\n        setOutput(getX(${n}));\n      }\n    `}}class rE{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const n=ax("rc",r),o=`${n[r-1]} + 1 < ${this.outputShape[r-1]}`,s=`${n[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Rg(r);function i(r){const n=e.map(((n,o)=>function(r,n){return-1!==t.indexOf(r)&&1!==e[r]?`${e[r]} - ${n[r]} - 1`:`${n[r]}`}(o,r)));return`getChannel(getX(${n.join(",")}), vec2(${n.slice(-2).join(",")}))`}this.userCode=1===r?`\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(${e[0]} - rc - 1),\n            ${e[0]} - rc - 1);\n          if(${o}){\n              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),\n                ${e[0]} - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      `:`\n        void main() {\n          ${a} rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ${function(e){return i(e)}(n.slice())};\n          if(${o}){\n            result.g = ${function(e){return e[r-1]="("+e[r-1]+" + 1)",i(e)}(n.slice())};\n          }\n          if(${s}) {\n            result.b = ${function(e){return e[r-2]="("+e[r-2]+" + 1)",i(e)}(n.slice())};\n            if(${o}) {\n              result.a = ${function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",i(e)}(n.slice())};\n            }\n          }\n          setOutput(result);\n        }\n    `}}const nE={kernelName:fr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{dims:s}=n,a=o.shape.length,i=K(s,o.shape);if(0===a)return Dx({inputs:{x:o},backend:r});const l=be().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new rE(o.shape,i):new tE(o.shape,i);return r.runWebGLProgram(l,[o],o.dtype)}};class oE{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],n=e[2];this.outputShape=e;let o="";o="number"==typeof t?`float outputValue = ${t.toFixed(2)};`:`\n        vec3 fill = vec3(${t.join(",")});\n        float outputValue = fill[coords[3]];`,this.userCode=`\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ${o}\n          if(coordX >= 0 && coordX < ${n} && coordY >= 0 && coordY < ${r}) {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    `}}const sE={kernelName:Qr,backendName:"webgl",kernelFunc:({inputs:e,attrs:t,backend:r})=>{const{image:n}=e,{radians:o,fillValue:s,center:a}=t,i=r,l=new oE(n.shape,s),[u,c]=rh(a,n.shape[1],n.shape[2]),d=[[u,c,Math.sin(o),Math.cos(o)]];return i.runWebGLProgram(l,[n],n.dtype,d)}},aE=Xx({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),iE={kernelName:mr,backendName:"webgl",kernelFunc:aE},lE=Xx({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Ub}),uE={kernelName:yr,backendName:"webgl",kernelFunc:lE};class cE{constructor(e,t,r,n,o,s,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=s;const i=Rg(o.length),l=Rg(s.length);let u="";1===r?u="i":2===r&&(u="i, j");const c=`getIndices(${u})`;let d="";1===n?d="i":2===n&&(d="i, coords[1]");const h=`getUpdates(${d})`,p=t>1?"strides[j]":"strides";this.userCode=`\n        ${i} strides = ${i}(${o});\n\n        void main() {\n          ${l} coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ${e}; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ${t}; j++) {\n              int index = round(${c});\n              flattenedIndex += index * ${p};\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ${h};\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      `}}const dE={kernelName:gr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{indices:o,updates:s}=t,{shape:a}=n,{sliceRank:i,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=Ic(0,o,a),h=[d/u,u];if(0===d)return r.makeTensorInfo(a,o.dtype);const p=nw({inputs:{x:o},backend:r,attrs:{shape:[l,i]}}),f=nw({inputs:{x:s},backend:r,attrs:{shape:[l,u]}}),m=r.makeTensorInfo([],"float32",new Float32Array([0])),y=new cE(l,i,p.shape.length,f.shape.length,c,h),g=r.runWebGLProgram(y,[f,p,m],f.dtype),v=nw({inputs:{x:g},backend:r,attrs:{shape:a}});return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(m),v}};class hE{constructor(e,t,r,n){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,s=2===be().getNumber("WEBGL_VERSION")?"while (left < right) {":o,a="left"===n?"<":"<=";this.userCode=`\n       int findBound(int batch, float value) {\n         int left = 0;\n         int right = numInputs;\n         int mid;\n         ${s}\n           mid = (left + right) / 2;\n           if (getSortedSequence(batch, mid) ${a} value) {\n             left = mid + 1;\n           } else {\n             right = mid;\n           }\n         }\n         return right;\n       }\n\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int valueIndex = coords[1];\n\n         float value = getValues(batch, valueIndex);\n\n         setOutput(float(findBound(batch, value)));\n       }\n     `}}const pE={kernelName:vr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{sortedSequence:o,values:s}=t,{side:a}=n,i=new hE(o.shape[0],o.shape[1],s.shape[1],a),l=[[o.shape[1]]];return r.runWebGLProgram(i,[o,s],"int32",l)}};class fE{constructor(e,t,r){let n,o;if(this.variableNames=["c","a","b"],this.outputShape=t,r>4)throw Error(`Where for rank ${r} is not yet supported`);if(1===r)o="resRC",n="resRC";else{const r=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],a=[];for(let n=0;n<t.length;n++)a.push(`${r[n]}`),n<e&&s.push(`${r[n]}`);n=s.join(),o=a.join()}const s=Rg(r);this.userCode=`\n      void main() {\n        ${s} resRC = getOutputCoords();\n        float cVal = getC(${n});\n        if (cVal >= 1.0) {\n          setOutput(getA(${o}));\n        } else {\n          setOutput(getB(${o}));\n        }\n      }\n    `}}const mE={kernelName:br,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{condition:n,t:o,e:s}=t,a=new fE(n.shape.length,o.shape,o.shape.length);return r.runWebGLProgram(a,[n,o,s],eo(o.dtype,s.dtype))}},yE=Xx({opSnippet:`\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ${uh};\n  float scale = ${ch};\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n`}),gE={kernelName:xr,backendName:"webgl",kernelFunc:yE},vE=Xx({opSnippet:qx+"\n  return 1.0 / (1.0 + exp(-1.0 * x));\n",packedOpSnippet:"\n  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",cpuKernelImpl:Gb}),bE={kernelName:kr,backendName:"webgl",kernelFunc:vE},xE=Xx({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),wE={kernelName:Sr,backendName:"webgl",kernelFunc:xE},_E={kernelName:"Sin",backendName:"webgl",kernelFunc:Xx({opSnippet:qx+"\n  return sin(x);\n"})},SE=Xx({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),kE={kernelName:_r,backendName:"webgl",kernelFunc:SE},TE=Xx({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),EE={kernelName:Tr,backendName:"webgl",kernelFunc:TE},jE={kernelName:jr,backendName:"webgl",kernelFunc:e=>{const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{blockShape:s,paddings:a}=n;B(o.shape.length<=4,(()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"));const i=s.reduce(((e,t)=>e*t)),l=[[0,0]];l.push(...a);for(let e=1+s.length;e<o.shape.length;++e)l.push([0,0]);const u=[],c=AT({inputs:{x:o},backend:r,attrs:{paddings:l,constantValue:0}}),d=nh(c.shape,s,i,!1),h=oh(d.length,s.length,!1),p=sh(c.shape,s,i,!1),f=nw({inputs:{x:c},backend:r,attrs:{shape:d}}),m=pw({inputs:{x:f},backend:r,attrs:{perm:h}}),y=nw({inputs:{x:m},backend:r,attrs:{shape:p}});return u.push(c),u.push(f),u.push(m),u.forEach((e=>r.disposeIntermediateTensorInfo(e))),y}},CE={kernelName:Or,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{indices:n,values:o,denseShape:s,defaultValue:a}=t;if(1!==s.shape.length)throw new Error(`Dense shape must be a vector, saw:\n         ${s.shape}`);if(2!==n.shape.length)throw new Error(`Indices must be a matrix, saw:\n         ${n.shape}`);if(1!==o.shape.length)throw new Error(`Values must be a vector, saw:\n         ${o.shape}`);if(0!==a.shape.length)throw new Error(`Default value must be a scalar, saw:\n        ${a.shape}`);const i=r.readSync(n.dataId),l=r.readSync(o.dataId),u=r.readSync(s.dataId),c=r.readSync(a.dataId)[0],[d,h,p,f,m]=Hb(i,n.shape,n.dtype,l,o.dtype,u,c);return[r.makeTensorInfo(h,n.dtype,d),r.makeTensorInfo([h[0]],o.dtype,p),r.makeTensorInfo([f.length],"bool",new Uint8Array(f.map((e=>Number(e))))),r.makeTensorInfo([m.length],n.dtype,new Int32Array(m))]}},IE={kernelName:Ar,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{inputIndices:n,inputShape:o,newShape:s}=t;if(2!==n.shape.length)throw new Error(`Input indices should be a matrix but received shape ${n.shape}`);if(1!==o.shape.length)throw new Error(`Input shape should be a vector but received shape ${o.shape}`);if(1!==s.shape.length)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const a=Array.from(r.readSync(o.dataId)),i=r.readSync(n.dataId),l=Array.from(r.readSync(s.dataId)),[u,c,d]=qb(i,n.shape,n.dtype,a,l);return[r.makeTensorInfo(c,n.dtype,u),r.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}},OE={kernelName:Rr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{data:n,indices:o,segmentIds:s}=t;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.shape.length)throw new Error(`Indices should be a vector but received shape\n              ${o.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n              ${s.shape}`);const a=r.readSync(n.dataId),i=r.readSync(o.dataId),l=r.readSync(s.dataId),[u,c]=Xb(a,n.shape,n.dtype,i,l,!0);return r.makeTensorInfo(c,n.dtype,u)}},AE={kernelName:Nr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r}=e,{data:n,indices:o,segmentIds:s}=t;if(n.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(1!==o.shape.length)throw new Error(`Indices should be a vector but received shape\n             ${o.shape}`);if(1!==s.shape.length)throw new Error(`Segment ids should be a vector but received shape\n             ${s.shape}`);const a=r.readSync(n.dataId),i=r.readSync(o.dataId),l=r.readSync(s.dataId),[u,c]=Xb(a,n.shape,n.dtype,i,l);return r.makeTensorInfo(c,n.dtype,u)}},RE={kernelName:Mr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{sparseIndices:o,sparseValues:s,defaultValue:a}=t,{outputShape:i}=n,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:h}=Ic(0,o,i);if("string"===s.dtype){const e=r.bufferSync(o),t=r.bufferSync(s),n=On(r.readSync(a.dataId)[0]),p=Vb(e,t,i,h,c,u,l,d,n,!1);return r.makeTensorInfo(i,p.dtype,p.values)}const p=new cE(u,l,o.shape.length,s.shape.length,d,[h,1],!1),f=r.runWebGLProgram(p,[s,o,a],s.dtype),m=nw({inputs:{x:f},backend:r,attrs:{shape:i}});return r.disposeIntermediateTensorInfo(f),m}},NE={kernelName:Cr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{numOrSizeSplits:s,axis:a}=n,i=K(a,o.shape)[0],l=Ph(o,s,i),u=o.shape.length,c=new Array(u).fill(0),d=o.shape.slice();return l.map((e=>{const t=[...d];t[i]=e;const n=c_({inputs:{x:o},backend:r,attrs:{begin:c,size:t}});return c[i]+=e,n}))}},ME="return sqrt(x);",PE=Xx({opSnippet:ME,packedOpSnippet:ME,cpuKernelImpl:Yb}),LE={kernelName:Er,backendName:"webgl",kernelFunc:PE},DE={kernelName:"Square",backendName:"webgl",kernelFunc:Xx({opSnippet:"return x * x;"})},FE="return (a - b) * (a - b);",$E=Yx({opSnippet:FE,packedOpSnippet:FE}),BE={kernelName:Pr,backendName:"webgl",kernelFunc:$E},UE={kernelName:Kr,backendName:"webgl",kernelFunc:function({inputs:e,attrs:t,backend:r}){const{x:n}=e,o=fx+`\n    return x > 0.0 ? 1.0 : float(${t.alpha});\n  `,s=new px(n.shape,o);return r.runWebGLProgram(s,[n],n.dtype)}};class VE{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const n=r.length,o=Rg(r.length),s=Rg(r.length);let a="";if(1===n)a="coords * strides + begin";else{let e=0;a=r.map(((t,n)=>(e++,1===r.length?`coords * strides[${n}] + begin[${n}]`:`coords[${e-1}] * strides[${n}] + begin[${n}]`))).join(",")}this.userCode=`\n      ${o} begin = ${o}(${e});\n      ${o} strides = ${o}(${t});\n\n      void main() {\n        ${s} coords = getOutputCoords();\n        setOutput(getX(${a}));\n      }\n    `}}const GE={kernelName:Lr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{begin:s,end:a,strides:i,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:h}=n,{finalShapeSparse:p,finalShape:f,isIdentity:m,sliceDim0:y,isSimpleSlice:g,begin:v,end:b,strides:x}=ya(o.shape,s,a,i,l,u,c,d,h);let w;if(m)w=nw({inputs:{x:o},backend:r,attrs:{shape:f}});else if(y||g){B(o.shape.length>=1,(()=>`Input must have rank at least 1, got: ${o.shape.length}`));const e=na(v,b,x),t=c_({inputs:{x:o},backend:r,attrs:{begin:v,size:e}});w=nw({inputs:{x:t},backend:r,attrs:{shape:f}}),r.disposeIntermediateTensorInfo(t)}else if(r.shouldExecuteOnCPU([o])){const e=r.readSync(o.dataId),t=_s(o.shape,o.dtype,e),n=Kb(p,t,x,v);w=r.makeTensorInfo(f,o.dtype,n.values)}else{const e=new VE(v,x,p);w=r.runWebGLProgram(e,[o],o.dtype)}const _=nw({inputs:{x:w},backend:r,attrs:{shape:f}});return r.disposeIntermediateTensorInfo(w),_}},zE={kernelName:Dr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{separator:o,nGramWidths:s,leftPad:a,rightPad:i,padWidth:l,preserveShortSequences:u}=n,{data:c,dataSplits:d}=t,h=r.readSync(c.dataId),p=r.readSync(d.dataId),[f,m]=Zb(h,p,o,s,a,i,l,u);return[r.makeTensorInfo([f.length],"string",f),r.makeTensorInfo(d.shape,"int32",m)]}},WE={kernelName:Fr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{skipEmpty:o}=n,{input:s,delimiter:a}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(1!==s.shape.length)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(0!==a.shape.length)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const i=r.readSync(s.dataId),l=r.readSync(a.dataId)[0],[u,c,d]=Qb(i,l,o),h=c.length;return[r.makeTensorInfo([h,2],"int32",u),r.makeTensorInfo([h],"string",c),r.makeTensorInfo([2],"int32",new Int32Array(d))]}},HE={kernelName:$r,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{numBuckets:o}=n,{input:s}=t;if("string"!==s.dtype)throw new Error("Input must be of datatype string");if(o<=0)throw new Error("Number of buckets must be at least 1");const a=r.readSync(s.dataId),i=Jb(a,o);return r.makeTensorInfo(s.shape,"int32",i)}},qE={kernelName:"Tan",backendName:"webgl",kernelFunc:Xx({opSnippet:"return tan(x);"})},XE=Xx({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),YE={kernelName:Ur,backendName:"webgl",kernelFunc:XE};class KE{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let n=0;n<r.length;n++)r[n]=e[n]*t[n];this.outputShape=r,this.rank=r.length;const n=Rg(this.rank),o=function(e){const t=e.length;if(t>5)throw Error(`Tile for rank ${t} is not yet supported`);if(1===t)return`imod(resRC, ${e[0]})`;const r=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],n=[];for(let t=0;t<e.length;t++)n.push(`imod(${r[t]}, ${e[t]})`);return n.join()}(e);this.userCode=`\n      void main() {\n        ${n} resRC = getOutputCoords();\n        setOutput(getA(${o}));\n      }\n    `}}function ZE(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{reps:s}=n;if("string"===o.dtype||o.shape.length>5){const e=r.readSync(o.dataId),t="string"===o.dtype?e.map((e=>On(e))):e,n=_s(o.shape,o.dtype,t),a=tx(n,s);return r.makeTensorInfo(a.shape,a.dtype,a.values)}const a=new KE(o.shape,s);return r.runWebGLProgram(a,[o],o.dtype)}const QE={kernelName:Vr,backendName:"webgl",kernelFunc:ZE};class JE{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode="\n       void main() {\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // We compare elements pair-wise within a group of size 2 * inc.\n         // The comparing rule for each group alternates between ascending\n         // and descending. Within each group, we compare each pair at\n         // positions i and i+inc. To decide whether an element at position i\n         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than\n         // inc, it is in the first half of the group, we denote it as x0,\n         // otherwise we denote it as x1.\n         // For example, as shown in the Bitonic top K paper referenced above,\n         // Figure5(a) shows that element[1] is in the\n         // second half of the group when group size is 2, but it is in the\n         // first half of the group when group size is 4.\n\n         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;\n         int i = isFirstInPair ? elemIdx : elemIdx - inc;\n\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));\n         float x0 = i0 < n ? getX(batch, i0) : negativeInf;\n         float x1 = i1 < n ? getX(batch, i1) : negativeInf;\n\n         // Denotes which direction indices are in (ascending or descending).\n         bool reverse = imod(elemIdx, 2 * dir) >= dir;\n         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);\n         if (reverse == isGreater) { // Elements in opposite order of direction\n           int iTemp = i0;\n           i0 = i1;\n           i1 = iTemp;\n         }\n         if (isFirstInPair) {\n            setOutput(float(i0));\n         } else {\n            setOutput(float(i1));\n         }\n       }\n     "}}class ej{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode="\n    void main() {\n         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...\n         ivec2 coords = getOutputCoords();\n         int batch = coords[0];\n         int elemIdx = coords[1];\n\n         // The output size is half of the previous size.\n         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),\n         // we only need to output the indices at positions |, the indices at\n         // positions _ can be thrown away, see Figure5(b) After Phase 2\n         // (Merge phase) in the Bitonic Top K paper referenced above.\n         // For example, the paper shows we only need to output the orange bars.\n         // The output sequence should look like this | | | | | | | |.\n         // Because the sequence is halved, to map the output index back\n         // to the previous sequence to find the corresponding value,\n         // we need to double the index. When we double the index,\n         // we basically interpolate a position, so 2i looks like\n         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position\n         // of each 2k positions by - elemIdx % k. E.g. for output at\n         // index 4,5,6,7, we want to get the corresponding element at\n         // original index 8,9,10,11, for output at index 8,9,10,11,\n         // we want to get the corresponding element at original index\n         // 16,17,18,19, so on and so forth.\n\n         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));\n         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));\n         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));\n\n         float x0 = getX(batch, i0);\n         float x1 = i1 < n ? getX(batch, i1) : x0;\n\n         setOutput(x0 >= x1 ? float(i0) : float(i1));\n       }\n     "}}function tj(e,t){null!==t&&e.disposeIntermediateTensorInfo(t)}function rj(e){let t=1;for(;t<e;)t*=2;return t}const nj={kernelName:Gr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o}=t,{k:s,sorted:a}=n,i=be().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=be().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=o.shape,c=u[u.length-1];if(r.shouldExecuteOnCPU([o])||c<i||s>l){const e=r.readSync(o.dataId),[t,n]=rx(e,u,o.dtype,s,a);return[r.makeTensorInfo(t.shape,t.dtype,t.values),r.makeTensorInfo(n.shape,n.dtype,n.values)]}if(0===s)return u[u.length-1]=0,[r.makeTensorInfo(u,o.dtype,[]),r.makeTensorInfo(u,"int32",[])];if(1===c)return[o,GS({attrs:{shape:u,dtype:"int32",value:0},backend:r})];const d=r.texData.get(o.dataId),h=null!==d&&d.isPacked,p=h?r.unpackTensor(o):o,f=z(u)/c,m=nw({inputs:{x:p},attrs:{shape:[f,c]},backend:r});h&&tj(r,p);const y=rj(s),g=rj(c);let v=null;const b=()=>null===v?[m,m]:[m,v],x=(e,t,n)=>{const o=b(),s=new JE(n),a=[[c],[null===v?1:0],[Number.NEGATIVE_INFINITY],[e],[t]],i=v;v=r.runWebGLProgram(s,o,"int32",a),tj(r,i)};for(let e=1;e<y;e*=2){const t=2*e;for(let r=e;r>=1;r/=2)x(t,r,[f,g])}for(let e=g;e>y;e/=2){const t=b(),n=new ej([f,e/2]),o=[[c],[null===v?1:0],[y]],s=v;v=r.runWebGLProgram(n,t,"int32",o),tj(r,s);const a=y/2,i=2*a;for(let e=a;e>=1;e/=2)x(i,e,v.shape)}let w=v;v=c_({inputs:{x:v},backend:r,attrs:{begin:0,size:[f,s]}}),tj(r,w);let _=lk({inputs:{x:m,indices:v},backend:r,attrs:{axis:1,batchDims:1}});tj(r,m);const S=u.slice(0,-1);S.push(s),w=v,v=nw({inputs:{x:v},attrs:{shape:S},backend:r}),tj(r,w);const k=_;return _=nw({inputs:{x:_},attrs:{shape:S},backend:r}),tj(r,k),[_,v]}};class oj{constructor(e,t,r,n,o,s){this.variableNames=["Image","Transforms"],this.outputShape=s;const a="nearest"===r?1:2;let i;switch(n){case"constant":default:i=1;break;case"reflect":i=2;break;case"wrap":i=3;break;case"nearest":i=4}this.userCode=`\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(${i} == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${i} == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (${i} == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(${o});\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(${o});\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(${t}));\n                float mapY = mapCoord(inY, float(${e}));\n\n                if (${a} == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        `}}const sj={kernelName:zr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{image:o,transforms:s}=t,{interpolation:a,fillMode:i,fillValue:l,outputShape:u}=n,[c,d,h,p]=o.shape,[f,m]=null!=u?u:[d,h],y=new oj(d,h,a,i,l,[c,f,m,p]);return r.runWebGLProgram(y,[o,s],"float32")}},aj={kernelName:Hr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,attrs:r,backend:n}=e,{axis:o}=r,{x:s}=t;mg(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=n.readSync(s.dataId),{outputValues:i,outputShape:l,indices:u}=ox(a,o,s.shape,s.dtype);return[n.makeTensorInfo(l,s.dtype,i),n.makeTensorInfo([u.length],"int32",u)]}},ij={kernelName:qr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{value:o}=t;let{axis:s}=n;s<0&&(s+=o.shape.length);const a=o,i=a.shape.length,l=o.shape[s],u=new Array(i-1);let c=0;for(let e=0;e<i;e++)e!==s&&(u[c++]=a.shape[e]);const d=[],h=new Array(i).fill(0),p=a.shape.slice();p[s]=1;const f=new Array(l);for(let e=0;e<f.length;e++){h[s]=e;const t=c_({inputs:{x:a},backend:r,attrs:{begin:h,size:p}}),n=nw({inputs:{x:t},backend:r,attrs:{shape:u}});f[e]=n,d.push(t)}return d.forEach((e=>r.disposeIntermediateTensorInfo(e))),f}};class lj{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,n=e.batchSize,o=e.inSize,s=e.numSegments,a=s*Math.ceil(o/r);this.outputShape=[n,a];const i=4*Math.floor(r/4),l=r%4,u="\n        sumValue += dot(values, segFilter);\n    ";let c="";o%r>0&&(c=`\n        if (inIdx < 0 || inIdx >= ${o}) {\n          return initializationValue;\n        }\n      `);let d="";o%r>0&&(d=`\n        if (inIdx < 0 || inIdx >= ${o}) {\n          return -1.0;\n        }\n      `),this.userCode=`\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        ${c}\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ${d}\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ${s})) * float(${r}));\n        int currentSeg = int(mod(float(outIdx), float(${s})));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ${i}; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ${u}\n        }\n\n        int inIdx = inOffset + ${i};\n        if (${1===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ${u}\n        } else if (${2===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ${u}\n        } else if (${3===l}) {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ${u}\n        }\n        setOutput(sumValue);\n      }\n    `}}const uj={kernelName:Xr,backendName:"webgl",kernelFunc:function(e){const{inputs:t,backend:r,attrs:n}=e,{x:o,segmentIds:s}=t,{numSegments:a}=n,i=o.shape.length,l=[];let u=0;const c=Xi([u],i);let d=o;null!=c&&(d=pw({inputs:{x:o},backend:r,attrs:{perm:c}}),l.push(d),u=Ki(1,i)[0]);const h=Yh(d.shape,u,a),p=z([d.shape[u]]),f=nw({inputs:{x:d},backend:r,attrs:{shape:[-1,p]}});l.push(f);const m=to(o.dtype),y=(e,t,n,o,s)=>{const a=e.shape[0],i=e.shape[1],u=Xh(i,s),c=new lj({windowSize:u,inSize:i,batchSize:a,numSegments:s},t),d=r.compileAndRun(c,[e,n],o);if(l.push(d),d.shape[1]===s)return d;const h=DT({backend:r,attrs:{start:0,stop:s,step:1,dtype:"float32"}}),p=ZE({inputs:{x:h},backend:r,attrs:{reps:[i/u]}});return l.push(h),l.push(p),y(d,t,p,o,s)},g=nw({inputs:{x:y(f,"unsortedSegmentSum",s,m,a)},backend:r,attrs:{shape:h}});let v=g;if(null!=c){l.push(g);const e=Yi(c);v=pw({inputs:{x:v},backend:r,attrs:{perm:e}})}return l.forEach((e=>r.disposeIntermediateTensorInfo(e))),v}},cj=[gw,bw,ww,Sw,Ew,Iw,Ow,Aw,Dw,Fw,Bw,Vw,zw,Hw,Xw,Zw,Qw,t_,r_,n_,a_,h_,p_,f_,b_,__,T_,Bx,C_,L_,z_,Y_,K_,Z_,Q_,J_,eS,rS,oS,cS,dS,hS,fS,gS,xS,wS,SS,TS,ES,jS,CS,OS,AS,NS,PS,FS,US,zS,HS,YS,ZS,ek,nk,ok,ak,uk,dk,pk,Fx,fk,N_,yk,vk,xk,Gx,_k,kk,Tk,jk,Ik,Ak,Nk,Pk,Fk,Bk,Vk,zk,Wk,Hk,Yk,Kk,Zk,Qk,Jk,tT,oT,sT,fT,rw,yT,vT,xT,_T,y_,kT,jT,CT,RT,NT,Hx,MT,PT,LT,FT,v_,lT,BT,VT,zT,ow,qT,YT,QT,eE,nE,sE,iE,uE,dE,pE,mE,gE,bE,wE,_E,kE,d_,pT,EE,jE,CE,IE,OE,AE,RE,NE,LE,DE,BE,UE,GE,zE,WE,HE,dT,hw,qE,YE,QE,nj,sj,fw,aj,ij,uj,ET];for(const e of cj)cn(e);let dj,hj=0,pj=0,fj=0,mj=0,yj=[],gj=0;const vj=[[0,1],[0,2],[1,3],[2,4],[5,6],[5,7],[5,11],[6,8],[6,12],[7,9],[8,10],[11,12],[11,13],[12,14],[13,15],[14,16]];let bj,xj,wj={type:"MULTIPOSE_LIGHTNING",scoreThreshold:.3,customModel:"",modelUrl:"/model.json",enableSmoothing:!0,enableTracking:!0},_j={camera:{targetFPS:60,sizeOption:"640 X 480"},backend:"",flags:{},modelConfig:wj},Sj={modelType:"MultiPose.Lightning",enableTracking:wj.enableTracking,modelUrl:wj.modelUrl,scoreThreshold:wj.scoreThreshold,enableSmoothing:wj.enableSmoothing,trackerType:Dm.BoundingBox};async function kj(){if(xj.readyState<2&&await new Promise((e=>{camera.video.onloadeddata=()=>{e(video)}})),yj=null,null!=bj){fj=(performance||Date).now();try{yj=await bj.estimatePoses(xj,{maxPoses:_j.modelConfig.maxPoses,flipHorizontal:!0})}catch(e){bj.dispose(),bj=null,console.log(e)}let e={width:O,height:A};for(const t of yj)t.keypoints=Ly.keypointsToNormalizedKeypoints(t.keypoints,e);!function(){const e=(performance||Date).now();hj+=e-fj,++mj,e-pj>=1e3&&(hj=0,mj=0,pj=e)}()}yj&&yj.length>0&&!_j.isModelChanged?gj=window.performance.now():window.performance.now()-gj>1e3&&(console.log("no pose"),gj=window.performance.now()+1e4),dj=requestAnimationFrame(kj)}const Tj=function(e,t){if(null!=t){e.push(),e.stroke(e.color(255,0,255)),e.strokeWeight(.1*(gI+yI)),e.noFill();let r=1*(gI+yI);for(let n=0;n<t.length;n++)try{Ej(e,t[n],r)}catch(e){}}e.pop()},Ej=function(e,t,r){if((null!=t.score?t.score:1)>=(_j.modelConfig.scoreThreshold||0)){let n=t.x*e.width,o=t.y*e.height;e.circle(n,o,r)}},jj=function(e,t,r){if(null!=t){e.push(),e.noStroke(),e.fill(e.color(255,0,255)),e.textSize(23);for(let n=0;n<t.length;n++)try{if((null!=t[n].score?t[n].score:1)>=(_j.modelConfig.scoreThreshold||0)){let o=t[n].x*e.width,s=t[n].y*e.height;e.text(r+"_"+n,o+3,s+3)}}catch(e){}}e.pop()},Cj=function(e,t,r){const n=e.color(0,255,255);e.push(),e.strokeWeight(.3*(gI+yI)),e.stroke(n),e.noFill(),e.rect(t.xMin*e.width,t.yMin*e.height,t.width*e.width,t.height*e.height),e.pop()},Ij=function(e,t,r){const n=e.color(255,0,255);e.push(),e.stroke(n),e.strokeWeight(.25*(gI+yI)),vj.forEach((([r,n])=>{const o=t[r],s=t[n],a=null!=o.score?o.score:1,i=null!=s.score?s.score:1,l=_j.modelConfig.scoreThreshold||0;if(a>=l&&i>=l){let t=o.x*e.width,r=o.y*e.height,n=s.x*e.width,a=s.y*e.height;e.line(t,r,n,a)}})),e.pop()},Oj=e=>{let t=300,r=300;e.color(255,0,255),e.color(240,180,0,150),e.color(255,0,255,150),e.color(255,255,255,180),e.setup=function(){console.log("new sketch"),t=sI.video.width,r=sI.video.height,e.createCanvas(t,r)},e.draw=function(){e.clear(),e.noStroke(),function(t){if(null!=t){let r=0;for(const n of t)Tj(e,n.keypoints),jj(e,n.keypoints,n.id),Ij(e,n.keypoints,n.id),Cj(e,n.box,n.id),r++}}(yj)}};function Aj(e,t){var r=e.__state.conversionName.toString(),n=Math.round(e.r),o=Math.round(e.g),s=Math.round(e.b),a=e.a,i=Math.round(e.h),l=e.s.toFixed(1),u=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===r||"SIX_CHAR_HEX"===r){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===r?"rgb("+n+","+o+","+s+")":"CSS_RGBA"===r?"rgba("+n+","+o+","+s+","+a+")":"HEX"===r?"0x"+e.hex.toString(16):"RGB_ARRAY"===r?"["+n+","+o+","+s+"]":"RGBA_ARRAY"===r?"["+n+","+o+","+s+","+a+"]":"RGB_OBJ"===r?"{r:"+n+",g:"+o+",b:"+s+"}":"RGBA_OBJ"===r?"{r:"+n+",g:"+o+",b:"+s+",a:"+a+"}":"HSV_OBJ"===r?"{h:"+i+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===r?"{h:"+i+",s:"+l+",v:"+u+",a:"+a+"}":"unknown format"}var Rj=Array.prototype.forEach,Nj=Array.prototype.slice,Mj={BREAK:{},extend:function(e){return this.each(Nj.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(t[r])||(e[r]=t[r])}.bind(this))}),this),e},defaults:function(e){return this.each(Nj.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(r){this.isUndefined(e[r])&&(e[r]=t[r])}.bind(this))}),this),e},compose:function(){var e=Nj.call(arguments);return function(){for(var t=Nj.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,t,r){if(e)if(Rj&&e.forEach&&e.forEach===Rj)e.forEach(t,r);else if(e.length===e.length+0){var n,o=void 0;for(o=0,n=e.length;o<n;o++)if(o in e&&t.call(r,e[o],o)===this.BREAK)return}else for(var s in e)if(t.call(r,e[s],s)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,r){var n=void 0;return function(){var o=this,s=arguments,a=r||!n;clearTimeout(n),n=setTimeout((function(){n=null,r||e.apply(o,s)}),t),a&&e.apply(o,s)}},toArray:function(e){return e.toArray?e.toArray():Nj.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},Pj=[{litmus:Mj.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:Aj},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:Aj},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:Aj},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:Aj}}},{litmus:Mj.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Mj.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Mj.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(Mj.isNumber(e.r)&&Mj.isNumber(e.g)&&Mj.isNumber(e.b)&&Mj.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(Mj.isNumber(e.r)&&Mj.isNumber(e.g)&&Mj.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(Mj.isNumber(e.h)&&Mj.isNumber(e.s)&&Mj.isNumber(e.v)&&Mj.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(Mj.isNumber(e.h)&&Mj.isNumber(e.s)&&Mj.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],Lj=void 0,Dj=void 0,Fj=function(){Dj=!1;var e=arguments.length>1?Mj.toArray(arguments):arguments[0];return Mj.each(Pj,(function(t){if(t.litmus(e))return Mj.each(t.conversions,(function(t,r){if(Lj=t.read(e),!1===Dj&&!1!==Lj)return Dj=Lj,Lj.conversionName=r,Lj.conversion=t,Mj.BREAK})),Mj.BREAK})),Dj},$j=void 0,Bj={hsv_to_rgb:function(e,t,r){var n=Math.floor(e/60)%6,o=e/60-Math.floor(e/60),s=r*(1-t),a=r*(1-o*t),i=r*(1-(1-o)*t),l=[[r,i,s],[a,r,s],[s,r,i],[s,a,r],[i,s,r],[r,s,a]][n];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,r){var n=Math.min(e,t,r),o=Math.max(e,t,r),s=o-n,a=void 0;return 0===o?{h:NaN,s:0,v:0}:(a=e===o?(t-r)/s:t===o?2+(r-e)/s:4+(e-t)/s,(a/=6)<0&&(a+=1),{h:360*a,s:s/o,v:o/255})},rgb_to_hex:function(e,t,r){var n=this.hex_with_component(0,2,e);return n=this.hex_with_component(n,1,t),this.hex_with_component(n,0,r)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,r){return r<<($j=8*t)|e&~(255<<$j)}},Uj="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Vj=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Gj=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),zj=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var s=Object.getPrototypeOf(t);return null===s?void 0:e(s,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},Wj=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Hj=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},qj=function(){function e(){if(Vj(this,e),this.__state=Fj.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return Gj(e,[{key:"toString",value:function(){return Aj(this)}},{key:"toHexString",value:function(){return Aj(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function Xj(e,t,r){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||qj.recalculateRGB(this,t,r),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(qj.recalculateRGB(this,t,r),this.__state.space="RGB"),this.__state[t]=e}})}function Yj(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||qj.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(qj.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}qj.recalculateRGB=function(e,t,r){if("HEX"===e.__state.space)e.__state[t]=Bj.component_from_hex(e.__state.hex,r);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");Mj.extend(e.__state,Bj.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},qj.recalculateHSV=function(e){var t=Bj.rgb_to_hsv(e.r,e.g,e.b);Mj.extend(e.__state,{s:t.s,v:t.v}),Mj.isNaN(t.h)?Mj.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},qj.COMPONENTS=["r","g","b","h","s","v","hex","a"],Xj(qj.prototype,"r",2),Xj(qj.prototype,"g",1),Xj(qj.prototype,"b",0),Yj(qj.prototype,"h"),Yj(qj.prototype,"s"),Yj(qj.prototype,"v"),Object.defineProperty(qj.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(qj.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=Bj.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var Kj=function(){function e(t,r){Vj(this,e),this.initialValue=t[r],this.domElement=document.createElement("div"),this.object=t,this.property=r,this.__onChange=void 0,this.__onFinishChange=void 0}return Gj(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),Zj={};Mj.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(e,t){Mj.each(e,(function(e){Zj[e]=t}))}));var Qj=/(\d+(\.\d+)?)px/;function Jj(e){if("0"===e||Mj.isUndefined(e))return 0;var t=e.match(Qj);return Mj.isNull(t)?0:parseFloat(t[1])}var eC={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,r){var n=r,o=t;Mj.isUndefined(o)&&(o=!0),Mj.isUndefined(n)&&(n=!0),e.style.position="absolute",o&&(e.style.left=0,e.style.right=0),n&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,r,n){var o=r||{},s=Zj[t];if(!s)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(s);switch(s){case"MouseEvents":var i=o.x||o.clientX||0,l=o.y||o.clientY||0;a.initMouseEvent(t,o.bubbles||!1,o.cancelable||!0,window,o.clickCount||1,0,0,i,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var u=a.initKeyboardEvent||a.initKeyEvent;Mj.defaults(o,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),u(t,o.bubbles||!1,o.cancelable,window,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.keyCode,o.charCode);break;default:a.initEvent(t,o.bubbles||!1,o.cancelable||!0)}Mj.defaults(a,n),e.dispatchEvent(a)},bind:function(e,t,r,n){var o=n||!1;return e.addEventListener?e.addEventListener(t,r,o):e.attachEvent&&e.attachEvent("on"+t,r),eC},unbind:function(e,t,r,n){var o=n||!1;return e.removeEventListener?e.removeEventListener(t,r,o):e.detachEvent&&e.detachEvent("on"+t,r),eC},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var r=e.className.split(/ +/);-1===r.indexOf(t)&&(r.push(t),e.className=r.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return eC},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var r=e.className.split(/ +/),n=r.indexOf(t);-1!==n&&(r.splice(n,1),e.className=r.join(" "))}else e.className=void 0;return eC},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return Jj(t["border-left-width"])+Jj(t["border-right-width"])+Jj(t["padding-left"])+Jj(t["padding-right"])+Jj(t.width)},getHeight:function(e){var t=getComputedStyle(e);return Jj(t["border-top-width"])+Jj(t["border-bottom-width"])+Jj(t["padding-top"])+Jj(t["padding-bottom"])+Jj(t.height)},getOffset:function(e){var t=e,r={left:0,top:0};if(t.offsetParent)do{r.left+=t.offsetLeft,r.top+=t.offsetTop,t=t.offsetParent}while(t);return r},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},tC=function(e){function t(e,r){Vj(this,t);var n=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),o=n;return n.__prev=n.getValue(),n.__checkbox=document.createElement("input"),n.__checkbox.setAttribute("type","checkbox"),eC.bind(n.__checkbox,"change",(function(){o.setValue(!o.__prev)}),!1),n.domElement.appendChild(n.__checkbox),n.updateDisplay(),n}return Wj(t,e),Gj(t,[{key:"setValue",value:function(e){var r=zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),r}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Kj),rC=function(e){function t(e,r,n){Vj(this,t);var o=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),s=n,a=o;if(o.__select=document.createElement("select"),Mj.isArray(s)){var i={};Mj.each(s,(function(e){i[e]=e})),s=i}return Mj.each(s,(function(e,t){var r=document.createElement("option");r.innerHTML=t,r.setAttribute("value",e),a.__select.appendChild(r)})),o.updateDisplay(),eC.bind(o.__select,"change",(function(){var e=this.options[this.selectedIndex].value;a.setValue(e)})),o.domElement.appendChild(o.__select),o}return Wj(t,e),Gj(t,[{key:"setValue",value:function(e){var r=zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),r}},{key:"updateDisplay",value:function(){return eC.isActive(this.__select)?this:(this.__select.value=this.getValue(),zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(Kj),nC=function(e){function t(e,r){Vj(this,t);var n=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),o=n;function s(){o.setValue(o.__input.value)}return n.__input=document.createElement("input"),n.__input.setAttribute("type","text"),eC.bind(n.__input,"keyup",s),eC.bind(n.__input,"change",s),eC.bind(n.__input,"blur",(function(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())})),eC.bind(n.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),n.updateDisplay(),n.domElement.appendChild(n.__input),n}return Wj(t,e),Gj(t,[{key:"updateDisplay",value:function(){return eC.isActive(this.__input)||(this.__input.value=this.getValue()),zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(Kj);function oC(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var sC=function(e){function t(e,r,n){Vj(this,t);var o=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),s=n||{};return o.__min=s.min,o.__max=s.max,o.__step=s.step,Mj.isUndefined(o.__step)?0===o.initialValue?o.__impliedStep=1:o.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(o.initialValue))/Math.LN10))/10:o.__impliedStep=o.__step,o.__precision=oC(o.__impliedStep),o}return Wj(t,e),Gj(t,[{key:"setValue",value:function(e){var r=e;return void 0!==this.__min&&r<this.__min?r=this.__min:void 0!==this.__max&&r>this.__max&&(r=this.__max),void 0!==this.__step&&r%this.__step!=0&&(r=Math.round(r/this.__step)*this.__step),zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,r)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=oC(e),this}}]),t}(Kj),aC=function(e){function t(e,r,n){Vj(this,t);var o=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,n));o.__truncationSuspended=!1;var s=o,a=void 0;function i(){s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function l(e){var t=a-e.clientY;s.setValue(s.getValue()+t*s.__impliedStep),a=e.clientY}function u(){eC.unbind(window,"mousemove",l),eC.unbind(window,"mouseup",u),i()}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),eC.bind(o.__input,"change",(function(){var e=parseFloat(s.__input.value);Mj.isNaN(e)||s.setValue(e)})),eC.bind(o.__input,"blur",(function(){i()})),eC.bind(o.__input,"mousedown",(function(e){eC.bind(window,"mousemove",l),eC.bind(window,"mouseup",u),a=e.clientY})),eC.bind(o.__input,"keydown",(function(e){13===e.keyCode&&(s.__truncationSuspended=!0,this.blur(),s.__truncationSuspended=!1,i())})),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return Wj(t,e),Gj(t,[{key:"updateDisplay",value:function(){var e,r,n;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),r=this.__precision,n=Math.pow(10,r),Math.round(e*n)/n),zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(sC);function iC(e,t,r,n,o){return n+(e-t)/(r-t)*(o-n)}var lC=function(e){function t(e,r,n,o,s){Vj(this,t);var a=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r,{min:n,max:o,step:s})),i=a;function l(e){e.preventDefault();var t=i.__background.getBoundingClientRect();return i.setValue(iC(e.clientX,t.left,t.right,i.__min,i.__max)),!1}function u(){eC.unbind(window,"mousemove",l),eC.unbind(window,"mouseup",u),i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}function c(e){var t=e.touches[0].clientX,r=i.__background.getBoundingClientRect();i.setValue(iC(t,r.left,r.right,i.__min,i.__max))}function d(){eC.unbind(window,"touchmove",c),eC.unbind(window,"touchend",d),i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),eC.bind(a.__background,"mousedown",(function(e){document.activeElement.blur(),eC.bind(window,"mousemove",l),eC.bind(window,"mouseup",u),l(e)})),eC.bind(a.__background,"touchstart",(function(e){1===e.touches.length&&(eC.bind(window,"touchmove",c),eC.bind(window,"touchend",d),c(e))})),eC.addClass(a.__background,"slider"),eC.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return Wj(t,e),Gj(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",zj(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(sC),uC=function(e){function t(e,r,n){Vj(this,t);var o=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r)),s=o;return o.__button=document.createElement("div"),o.__button.innerHTML=void 0===n?"Fire":n,eC.bind(o.__button,"click",(function(e){return e.preventDefault(),s.fire(),!1})),eC.addClass(o.__button,"button"),o.domElement.appendChild(o.__button),o}return Wj(t,e),Gj(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(Kj),cC=function(e){function t(e,r){Vj(this,t);var n=Hj(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));n.__color=new qj(n.getValue()),n.__temp=new qj(0);var o=n;n.domElement=document.createElement("div"),eC.makeSelectable(n.domElement,!1),n.__selector=document.createElement("div"),n.__selector.className="selector",n.__saturation_field=document.createElement("div"),n.__saturation_field.className="saturation-field",n.__field_knob=document.createElement("div"),n.__field_knob.className="field-knob",n.__field_knob_border="2px solid ",n.__hue_knob=document.createElement("div"),n.__hue_knob.className="hue-knob",n.__hue_field=document.createElement("div"),n.__hue_field.className="hue-field",n.__input=document.createElement("input"),n.__input.type="text",n.__input_textShadow="0 1px 1px ",eC.bind(n.__input,"keydown",(function(e){13===e.keyCode&&d.call(this)})),eC.bind(n.__input,"blur",d),eC.bind(n.__selector,"mousedown",(function(){eC.addClass(this,"drag").bind(window,"mouseup",(function(){eC.removeClass(o.__selector,"drag")}))})),eC.bind(n.__selector,"touchstart",(function(){eC.addClass(this,"drag").bind(window,"touchend",(function(){eC.removeClass(o.__selector,"drag")}))}));var s,a=document.createElement("div");function i(e){p(e),eC.bind(window,"mousemove",p),eC.bind(window,"touchmove",p),eC.bind(window,"mouseup",u),eC.bind(window,"touchend",u)}function l(e){f(e),eC.bind(window,"mousemove",f),eC.bind(window,"touchmove",f),eC.bind(window,"mouseup",c),eC.bind(window,"touchend",c)}function u(){eC.unbind(window,"mousemove",p),eC.unbind(window,"touchmove",p),eC.unbind(window,"mouseup",u),eC.unbind(window,"touchend",u),h()}function c(){eC.unbind(window,"mousemove",f),eC.unbind(window,"touchmove",f),eC.unbind(window,"mouseup",c),eC.unbind(window,"touchend",c),h()}function d(){var e=Fj(this.value);!1!==e?(o.__color.__state=e,o.setValue(o.__color.toOriginal())):this.value=o.__color.toString()}function h(){o.__onFinishChange&&o.__onFinishChange.call(o,o.__color.toOriginal())}function p(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__saturation_field.getBoundingClientRect(),r=e.touches&&e.touches[0]||e,n=r.clientX,s=r.clientY,a=(n-t.left)/(t.right-t.left),i=1-(s-t.top)/(t.bottom-t.top);return i>1?i=1:i<0&&(i=0),a>1?a=1:a<0&&(a=0),o.__color.v=i,o.__color.s=a,o.setValue(o.__color.toOriginal()),!1}function f(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=o.__hue_field.getBoundingClientRect(),r=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return r>1?r=1:r<0&&(r=0),o.__color.h=360*r,o.setValue(o.__color.toOriginal()),!1}return Mj.extend(n.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Mj.extend(n.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:n.__field_knob_border+(n.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Mj.extend(n.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Mj.extend(n.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Mj.extend(a.style,{width:"100%",height:"100%",background:"none"}),hC(a,"top","rgba(0,0,0,0)","#000"),Mj.extend(n.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(s=n.__hue_field).style.background="",s.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",s.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",s.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Mj.extend(n.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:n.__input_textShadow+"rgba(0,0,0,0.7)"}),eC.bind(n.__saturation_field,"mousedown",i),eC.bind(n.__saturation_field,"touchstart",i),eC.bind(n.__field_knob,"mousedown",i),eC.bind(n.__field_knob,"touchstart",i),eC.bind(n.__hue_field,"mousedown",l),eC.bind(n.__hue_field,"touchstart",l),n.__saturation_field.appendChild(a),n.__selector.appendChild(n.__field_knob),n.__selector.appendChild(n.__saturation_field),n.__selector.appendChild(n.__hue_field),n.__hue_field.appendChild(n.__hue_knob),n.domElement.appendChild(n.__input),n.domElement.appendChild(n.__selector),n.updateDisplay(),n}return Wj(t,e),Gj(t,[{key:"updateDisplay",value:function(){var e=Fj(this.getValue());if(!1!==e){var t=!1;Mj.each(qj.COMPONENTS,(function(r){if(!Mj.isUndefined(e[r])&&!Mj.isUndefined(this.__color.__state[r])&&e[r]!==this.__color.__state[r])return t=!0,{}}),this),t&&Mj.extend(this.__color.__state,e)}Mj.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var r=this.__color.v<.5||this.__color.s>.5?255:0,n=255-r;Mj.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+r+","+r+","+r+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,hC(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Mj.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+r+","+r+","+r+")",textShadow:this.__input_textShadow+"rgba("+n+","+n+","+n+",.7)"})}}]),t}(Kj),dC=["-moz-","-o-","-webkit-","-ms-",""];function hC(e,t,r,n){e.style.background="",Mj.each(dC,(function(o){e.style.cssText+="background: "+o+"linear-gradient("+t+", "+r+" 0%, "+n+" 100%); "}))}var pC=function(e,t){var r=e[t];return Mj.isArray(arguments[2])||Mj.isObject(arguments[2])?new rC(e,t,arguments[2]):Mj.isNumber(r)?Mj.isNumber(arguments[2])&&Mj.isNumber(arguments[3])?Mj.isNumber(arguments[4])?new lC(e,t,arguments[2],arguments[3],arguments[4]):new lC(e,t,arguments[2],arguments[3]):Mj.isNumber(arguments[4])?new aC(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new aC(e,t,{min:arguments[2],max:arguments[3]}):Mj.isString(r)?new nC(e,t):Mj.isFunction(r)?new uC(e,t,""):Mj.isBoolean(r)?new tC(e,t):null},fC=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},mC=function(){function e(){Vj(this,e),this.backgroundElement=document.createElement("div"),Mj.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),eC.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Mj.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;eC.bind(this.backgroundElement,"click",(function(){t.hide()}))}return Gj(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Mj.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",eC.unbind(e.domElement,"webkitTransitionEnd",t),eC.unbind(e.domElement,"transitionend",t),eC.unbind(e.domElement,"oTransitionEnd",t)};eC.bind(this.domElement,"webkitTransitionEnd",t),eC.bind(this.domElement,"transitionend",t),eC.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-eC.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-eC.getHeight(this.domElement)/2+"px"}}]),e}();!function(e,t){var r=t||document,n=document.createElement("style");n.type="text/css",n.innerHTML=e;var o=r.getElementsByTagName("head")[0];try{o.appendChild(n)}catch(e){}}(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var yC="Default",gC=function(){try{return!!window.localStorage}catch(e){return!1}}(),vC=void 0,bC=!0,xC=void 0,wC=!1,_C=[],SC=function e(t){var r=this,n=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),eC.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],n=Mj.defaults(n,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),n=Mj.defaults(n,{resizable:n.autoPlace,hideable:n.autoPlace}),Mj.isUndefined(n.load)?n.load={preset:yC}:n.preset&&(n.load.preset=n.preset),Mj.isUndefined(n.parent)&&n.hideable&&_C.push(this),n.resizable=Mj.isUndefined(n.parent)&&n.resizable,n.autoPlace&&Mj.isUndefined(n.scrollable)&&(n.scrollable=!0);var o,s=gC&&"true"===localStorage.getItem(IC(0,"isLocal")),a=void 0,i=void 0;if(Object.defineProperties(this,{parent:{get:function(){return n.parent}},scrollable:{get:function(){return n.scrollable}},autoPlace:{get:function(){return n.autoPlace}},closeOnTop:{get:function(){return n.closeOnTop}},preset:{get:function(){return r.parent?r.getRoot().preset:n.load.preset},set:function(e){r.parent?r.getRoot().preset=e:n.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),r.revert()}},width:{get:function(){return n.width},set:function(e){n.width=e,NC(r,e)}},name:{get:function(){return n.name},set:function(e){n.name=e,i&&(i.innerHTML=n.name)}},closed:{get:function(){return n.closed},set:function(t){n.closed=t,n.closed?eC.addClass(r.__ul,e.CLASS_CLOSED):eC.removeClass(r.__ul,e.CLASS_CLOSED),this.onResize(),r.__closeButton&&(r.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return n.load}},useLocalStorage:{get:function(){return s},set:function(e){gC&&(s=e,e?eC.bind(window,"unload",a):eC.unbind(window,"unload",a),localStorage.setItem(IC(0,"isLocal"),e))}}}),Mj.isUndefined(n.parent)){if(this.closed=n.closed||!1,eC.addClass(this.domElement,e.CLASS_MAIN),eC.makeSelectable(this.domElement,!1),gC&&s){r.useLocalStorage=!0;var l=localStorage.getItem(IC(0,"gui"));l&&(n.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,eC.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),n.closeOnTop?(eC.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(eC.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),eC.bind(this.__closeButton,"click",(function(){r.closed=!r.closed}))}else{void 0===n.closed&&(n.closed=!0);var u=document.createTextNode(n.name);eC.addClass(u,"controller-name"),i=kC(r,u),eC.addClass(this.__ul,e.CLASS_CLOSED),eC.addClass(i,"title"),eC.bind(i,"click",(function(e){return e.preventDefault(),r.closed=!r.closed,!1})),n.closed||(this.closed=!1)}n.autoPlace&&(Mj.isUndefined(n.parent)&&(bC&&(xC=document.createElement("div"),eC.addClass(xC,"dg"),eC.addClass(xC,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(xC),bC=!1),xC.appendChild(this.domElement),eC.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||NC(r,n.width)),this.__resizeHandler=function(){r.onResizeDebounced()},eC.bind(window,"resize",this.__resizeHandler),eC.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),eC.bind(this.__ul,"transitionend",this.__resizeHandler),eC.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),n.resizable&&RC(this),a=function(){gC&&"true"===localStorage.getItem(IC(0,"isLocal"))&&localStorage.setItem(IC(0,"gui"),JSON.stringify(r.getSaveObject()))},this.saveToLocalStorageIfPossible=a,n.parent||((o=r.getRoot()).width+=1,Mj.defer((function(){o.width-=1})))};function kC(e,t,r){var n=document.createElement("li");return t&&n.appendChild(t),r?e.__ul.insertBefore(n,r):e.__ul.appendChild(n),e.onResize(),n}function TC(e){eC.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&eC.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function EC(e,t){var r=e.__preset_select[e.__preset_select.selectedIndex];r.innerHTML=t?r.value+"*":r.value}function jC(e,t){var r=e.getRoot(),n=r.__rememberedObjects.indexOf(t.object);if(-1!==n){var o=r.__rememberedObjectIndecesToControllers[n];if(void 0===o&&(o={},r.__rememberedObjectIndecesToControllers[n]=o),o[t.property]=t,r.load&&r.load.remembered){var s=r.load.remembered,a=void 0;if(s[e.preset])a=s[e.preset];else{if(!s[yC])return;a=s[yC]}if(a[n]&&void 0!==a[n][t.property]){var i=a[n][t.property];t.initialValue=i,t.setValue(i)}}}}function CC(e,t,r,n){if(void 0===t[r])throw new Error('Object "'+t+'" has no property "'+r+'"');var o=void 0;if(n.color)o=new cC(t,r);else{var s=[t,r].concat(n.factoryArgs);o=pC.apply(e,s)}n.before instanceof Kj&&(n.before=n.before.__li),jC(e,o),eC.addClass(o.domElement,"c");var a=document.createElement("span");eC.addClass(a,"property-name"),a.innerHTML=o.property;var i=document.createElement("div");i.appendChild(a),i.appendChild(o.domElement);var l=kC(e,i,n.before);return eC.addClass(l,SC.CLASS_CONTROLLER_ROW),o instanceof cC?eC.addClass(l,"color"):eC.addClass(l,Uj(o.getValue())),function(e,t,r){if(r.__li=t,r.__gui=e,Mj.extend(r,{options:function(t){if(arguments.length>1){var n=r.__li.nextElementSibling;return r.remove(),CC(e,r.object,r.property,{before:n,factoryArgs:[Mj.toArray(arguments)]})}if(Mj.isArray(t)||Mj.isObject(t)){var o=r.__li.nextElementSibling;return r.remove(),CC(e,r.object,r.property,{before:o,factoryArgs:[t]})}},name:function(e){return r.__li.firstElementChild.firstElementChild.innerHTML=e,r},listen:function(){return r.__gui.listen(r),r},remove:function(){return r.__gui.remove(r),r}}),r instanceof lC){var n=new aC(r.object,r.property,{min:r.__min,max:r.__max,step:r.__step});Mj.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=r[e],o=n[e];r[e]=n[e]=function(){var e=Array.prototype.slice.call(arguments);return o.apply(n,e),t.apply(r,e)}})),eC.addClass(t,"has-slider"),r.domElement.insertBefore(n.domElement,r.domElement.firstElementChild)}else if(r instanceof aC){var o=function(t){if(Mj.isNumber(r.__min)&&Mj.isNumber(r.__max)){var n=r.__li.firstElementChild.firstElementChild.innerHTML,o=r.__gui.__listening.indexOf(r)>-1;r.remove();var s=CC(e,r.object,r.property,{before:r.__li.nextElementSibling,factoryArgs:[r.__min,r.__max,r.__step]});return s.name(n),o&&s.listen(),s}return t};r.min=Mj.compose(o,r.min),r.max=Mj.compose(o,r.max)}else r instanceof tC?(eC.bind(t,"click",(function(){eC.fakeEvent(r.__checkbox,"click")})),eC.bind(r.__checkbox,"click",(function(e){e.stopPropagation()}))):r instanceof uC?(eC.bind(t,"click",(function(){eC.fakeEvent(r.__button,"click")})),eC.bind(t,"mouseover",(function(){eC.addClass(r.__button,"hover")})),eC.bind(t,"mouseout",(function(){eC.removeClass(r.__button,"hover")}))):r instanceof cC&&(eC.addClass(t,"color"),r.updateDisplay=Mj.compose((function(e){return t.style.borderLeftColor=r.__color.toString(),e}),r.updateDisplay),r.updateDisplay());r.setValue=Mj.compose((function(t){return e.getRoot().__preset_select&&r.isModified()&&EC(e.getRoot(),!0),t}),r.setValue)}(e,l,o),e.__controllers.push(o),o}function IC(e,t){return document.location.href+"."+t}function OC(e,t,r){var n=document.createElement("option");n.innerHTML=t,n.value=t,e.__preset_select.appendChild(n),r&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function AC(e,t){t.style.display=e.useLocalStorage?"block":"none"}function RC(e){var t=void 0;function r(r){return r.preventDefault(),e.width+=t-r.clientX,e.onResize(),t=r.clientX,!1}function n(){eC.removeClass(e.__closeButton,SC.CLASS_DRAG),eC.unbind(window,"mousemove",r),eC.unbind(window,"mouseup",n)}function o(o){return o.preventDefault(),t=o.clientX,eC.addClass(e.__closeButton,SC.CLASS_DRAG),eC.bind(window,"mousemove",r),eC.bind(window,"mouseup",n),!1}e.__resize_handle=document.createElement("div"),Mj.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),eC.bind(e.__resize_handle,"mousedown",o),eC.bind(e.__closeButton,"mousedown",o),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function NC(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function MC(e,t){var r={};return Mj.each(e.__rememberedObjects,(function(n,o){var s={},a=e.__rememberedObjectIndecesToControllers[o];Mj.each(a,(function(e,r){s[r]=t?e.initialValue:e.getValue()})),r[o]=s})),r}function PC(e){0!==e.length&&fC.call(window,(function(){PC(e)})),Mj.each(e,(function(e){e.updateDisplay()}))}SC.toggleHide=function(){wC=!wC,Mj.each(_C,(function(e){e.domElement.style.display=wC?"none":""}))},SC.CLASS_AUTO_PLACE="a",SC.CLASS_AUTO_PLACE_CONTAINER="ac",SC.CLASS_MAIN="main",SC.CLASS_CONTROLLER_ROW="cr",SC.CLASS_TOO_TALL="taller-than-window",SC.CLASS_CLOSED="closed",SC.CLASS_CLOSE_BUTTON="close-button",SC.CLASS_CLOSE_TOP="close-top",SC.CLASS_CLOSE_BOTTOM="close-bottom",SC.CLASS_DRAG="drag",SC.DEFAULT_WIDTH=245,SC.TEXT_CLOSED="Close Controls",SC.TEXT_OPEN="Open Controls",SC._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||SC.toggleHide()},eC.bind(window,"keydown",SC._keydownHandler,!1),Mj.extend(SC.prototype,{add:function(e,t){return CC(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return CC(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Mj.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&xC.removeChild(this.domElement);var e=this;Mj.each(this.__folders,(function(t){e.removeFolder(t)})),eC.unbind(window,"keydown",SC._keydownHandler,!1),TC(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var r=new SC(t);this.__folders[e]=r;var n=kC(this,r.domElement);return eC.addClass(n,"folder"),r},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],TC(e);var t=this;Mj.each(e.__folders,(function(t){e.removeFolder(t)})),Mj.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=eC.getOffset(e.__ul).top,r=0;Mj.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(r+=eC.getHeight(t))})),window.innerHeight-t-20<r?(eC.addClass(e.domElement,SC.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(eC.removeClass(e.domElement,SC.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Mj.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Mj.debounce((function(){this.onResize()}),50),remember:function(){if(Mj.isUndefined(vC)&&((vC=new mC).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Mj.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&function(e){var t=e.__save_row=document.createElement("li");eC.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),eC.addClass(t,"save-row");var r=document.createElement("span");r.innerHTML="&nbsp;",eC.addClass(r,"button gears");var n=document.createElement("span");n.innerHTML="Save",eC.addClass(n,"button"),eC.addClass(n,"save");var o=document.createElement("span");o.innerHTML="New",eC.addClass(o,"button"),eC.addClass(o,"save-as");var s=document.createElement("span");s.innerHTML="Revert",eC.addClass(s,"button"),eC.addClass(s,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?Mj.each(e.load.remembered,(function(t,r){OC(e,r,r===e.preset)})):OC(e,yC,!1),eC.bind(a,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(a),t.appendChild(r),t.appendChild(n),t.appendChild(o),t.appendChild(s),gC){var i=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(IC(0,"isLocal"))&&l.setAttribute("checked","checked"),AC(e,i),eC.bind(l,"change",(function(){e.useLocalStorage=!e.useLocalStorage,AC(e,i)}))}var u=document.getElementById("dg-new-constructor");eC.bind(u,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||vC.hide()})),eC.bind(r,"click",(function(){u.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),vC.show(),u.focus(),u.select()})),eC.bind(n,"click",(function(){e.save()})),eC.bind(o,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),eC.bind(s,"click",(function(){e.revert()}))}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&NC(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=MC(this)),e.folders={},Mj.each(this.__folders,(function(t,r){e.folders[r]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=MC(this),EC(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[yC]=MC(this,!0)),this.load.remembered[e]=MC(this),this.preset=e,OC(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Mj.each(this.__controllers,(function(t){this.getRoot().load.remembered?jC(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),Mj.each(this.__folders,(function(e){e.revert(e)})),e||EC(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&PC(this.__listening)},updateDisplay:function(){Mj.each(this.__controllers,(function(e){e.updateDisplay()})),Mj.each(this.__folders,(function(e){e.updateDisplay()}))}});var LC=SC;function DC(e,t){const r=new LC;return FC(e,r.addFolder("Options"),t),r}function FC(e,t,r){for(const n in e)if(e.hasOwnProperty(n)){let o=e[n];if("object"==typeof o){let e=t.addFolder(n);FC(o,e,r)}else if("number"==typeof o){let o,s,a;"maxPoses"===n?(s=0,o=1,a=5):(s=0,a=1,o=.1),t.add(e,n,s,a).step(o).onChange((function(){r()}))}else if("boolean"==typeof o)t.add(e,n).onChange((function(){r()}));else if("function"==typeof o)console.log(o),t.add(e,n).onChange((function(){o()}));else if("string"==typeof o){let e={doNothing:function(){}};t.add(e,"doNothing").name(n+": "+o)}else t.add(e,n).onChange((function(){r()}))}}const $C=n(87),BC=8025,UC=new $C;let VC,GC,zC,WC,HC,qC,XC,YC,KC,ZC=!0,QC=!1,JC=0;function eI(e){ZC=e,JC=window.performance.now(),UC.on("/depth",(e=>{!function(e){if(JC=millis(),HC={x:e.args[3],y:e.args[4],z:e.args[5]},KC=boolean(e.args[6]),ZC){XC=e.args[0],YC=e.args[1],VC=e.args[2];try{let e=XC*YC;for(let t=0;t<e;t++){let e=VC[t];qC[t]=int(.9*qC[t]),qC[t]+=int(.1*e)}}catch(t){console.log("data not defined yet"),qC=Array.from(e.args[2])}try{QC&&(GC=e.args[7],zC=e.args[8],WC=e.args[9])}catch(e){console.log("rgb data not defined yet")}}}(e)}));try{UC.open({port:BC})}catch(e){console.log("Could not connect: "+e)}if(QC){let e=22400;GC=[],zC=[],WC=[];for(let t=0;t<e;t++)GC[t]=100,zC[t]=100,WC[t]=100}}let tI,rI={poseDetection:!1};const nI=2160,oI=1920;let sI,aI,iI,lI,uI,cI,dI,hI,pI=yj;const fI=[{x:0,y:0,w:100,h:100,cntX:50,cntY:50},{x:0,y:0,w:100,h:100,cntX:50,cntY:50}];let mI,yI=1,gI=1,vI=!1,bI=!1,xI=0,wI=!1;function _I(e,t,r){null!=r?(wI=r,eI(wI)):eI(!1),wj.modelUrl=t,console.log(wj.modelUrl),iI=createVector(0,0,0),lI=createVector(0,0,0),CI(),uI=e,uI.mousePressed=function(){uI.mouseX>0&&uI.mouseY>0&&uI.mouseX<width&&uI.mouseY<height&&function(){let e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen(),bI=window.innerHeight==screen.height}()},document.addEventListener("fullscreenchange",(e=>{document.fullscreenElement?(console.log(`Element: ${document.fullscreenElement.id} entered full-screen mode.`),bI=!0,EI()):(console.log("Leaving full-screen mode."),bI=!1,EI())})),window.onresize=EI,document.addEventListener("keypress",(e=>{try{window.parent.trackingCallback(e.code)}catch(e){}}))}async function SI(){try{tI=document.createElement("div"),document.body.appendChild(tI),tI.id="canvas-wrapper";let e=document.createElement("video");e.id="webCam",e.width="1",e.height="1";let t=document.createElement("div");t.id="output",tI.appendChild(t),tI.appendChild(e),sI=await R.setup(e),aI=await async function(e){console.log("setupMoveNet"),Sj.modelUrl=wj.modelUrl,xj=e,bj=await function(e,t){return bf(this,void 0,void 0,(function(){var r,n;return xf(this,(function(o){switch(e){case Fm.PoseNet:return[2,Py(t)];case Fm.BlazePose:if(n=void 0,null!=(r=t)){if("tfjs"===r.runtime)return[2,Lm(t)];if("mediapipe"===r.runtime)return[2,Df(t)];n=r.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+n);case Fm.MoveNet:return[2,Jm(t)];default:throw new Error(e+" is not a supported model name.")}}))}))}(Fm.MoveNet,Sj),yj=await bj.estimatePoses(xj,{maxPoses:_j.modelConfig.maxPoses,flipHorizontal:!0}),dj=requestAnimationFrame(kj)}(e),t.width=sI.video.width,t.height=sI.video.height,new(I())(Oj,t),function(e){var t=0,r=0,n=0,o=0;function s(e){(e=e||window.event).preventDefault(),n=e.clientX,o=e.clientY,document.onmouseup=i,document.onmousemove=a}function a(s){(s=s||window.event).preventDefault(),t=n-s.clientX,r=o-s.clientY,n=s.clientX,o=s.clientY,e.style.top=e.offsetTop-r+"px",e.style.left=e.offsetLeft-t+"px"}function i(){document.onmouseup=null,document.onmousemove=null}document.getElementById(e.id+"header")?document.getElementById(e.id+"header").onmousedown=s:e.onmousedown=s}(document.getElementById(tI.id))}catch(e){console.log(e)}}function kI(e){if(void 0!==tI){let t=document.getElementById(tI.id);null!==t&&(e&&1==rI.poseDetection?t.style.visibility="visible":t.style.visibility="hidden")}}function TI(){console.log(rI.poseDetection),rI.poseDetection?SI():async function(){!async function(){window.cancelAnimationFrame(dj),null!=bj&&bj.dispose(),yj=null}();try{document.getElementById(tI.id).remove()}catch(e){console.log(e)}}()}function EI(){!function(){try{percentX=uI.camera.position.x/width,percentY=uI.camera.position.y/height}catch(e){}}(),uI.resizeCanvas(OI(),AI()),function(){try{uI.camera.position.x=percentX*width,uI.camera.position.y=percentY*height}catch(e){}}(),CI();try{uI.windowScaled()}catch(e){}}function jI(){if(null!=yj&&1==rI.poseDetection){let e={x:0,y:0};for(const t of yj){let r=t.box.xMin+t.box.width/2,n=t.box.yMin+t.box.height/2;e.x+=r,e.y+=n}e.x=e.x/yj.length,e.y=e.y/yj.length,isNaN(e.x)||isNaN(e.y)?II(.5,.5,1):II(1-e.x,e.y,1)}else if(window.performance.now()-JC<1e3&&null!=HC)vI=!0,II(HC.x,HC.y,HC.z),wI&&(cI=qC,dI=XC,hI=YC);else{vI=!1;let e=uI.mouseX/uI.width;e=uI.constrain(e,0,1);let t=uI.mouseY/uI.height;t=uI.constrain(t,0,1),II(e,t,1)}if(bI)mI.hide(),kI(!1);else{mI.show(),kI(!0),uI.push(),uI._renderer.drawingContext instanceof WebGL2RenderingContext&&uI.translate(-uI.width/2,-uI.height/2,0),uI.fill(0,180,180),uI.noStroke(),xI*=.9,xI+=.1*uI.frameRate(),uI.textSize(1.2*yI),uI.textAlign(uI.LEFT,uI.TOP),uI.text("fps: "+Math.floor(xI),fI[0].x+yI,fI[0].y+gI),uI.text("Streaming: "+vI,fI[0].x+yI,fI[0].y+gI+gI+gI),uI.noFill(),uI.stroke(0,180,180),uI.rectMode(CORNER),uI.rect(fI[0].x,fI[0].y,uI.width,uI.height);for(let e=1;e<fI.length;e++)fI[e].w=uI.floor(width/fI.length),uI.line(fI[e].x,fI[e].y,fI[e].x,fI[e].y+fI[e].h);uI.fill(0,180,180),uI.noStroke(),uI.circle(iI.x,iI.y,10*iI.z),uI.pop()}}function CI(){let e=0,t=0;_renderer.drawingContext instanceof WebGLRenderingContext&&(-Math.floor(width/2),Math.floor(height/2));for(let e=0;e<fI.length;e++)fI[e].w=floor(width/fI.length),fI[e].h=height,fI[e].x=fI[e].w*e,fI[e].y=0,fI[e].cntX=fI[e].x+fI[e].w/2,fI[e].cntY=fI[e].h/2;yI=.01*width,gI=.01*height}function II(e,t,r){let n=.95;lI.mult(n),lI.x+=e*(1-n),lI.y+=t*(1-n),lI.z+=r*(1-n),iI.set(lI),iI.x=iI.x*width,iI.y=iI.y*height}function OI(){let e,t=window.innerWidth,r=window.innerHeight,n=select("body");"matrix(0, 1, -1, 0, 0, 0)"!=n.style("transform")&&"matrix(0, -1, 1, 0, 0, 0)"!=n.style("transform")||(t=window.innerHeight,r=window.innerWidth);let o=nI/oI;return e=t<r*o?t:Math.floor(r*o),e}function AI(){let e,t=window.innerWidth,r=window.innerHeight,n=select("body");"matrix(0, 1, -1, 0, 0, 0)"!=n.style("transform")&&"matrix(0, -1, 1, 0, 0, 0)"!=n.style("transform")||(t=window.innerHeight,r=window.innerWidth);let o=oI/nI;return e=t<r*(nI/oI)?Math.floor(t*o):r,bI=r==screen.height||t==screen.height,e}document.addEventListener("DOMContentLoaded",(async function(){mI=DC(rI,TI)}),!1)})(),o})()));